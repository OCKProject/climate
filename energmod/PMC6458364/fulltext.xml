<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">R Soc Open Sci</journal-id><journal-id journal-id-type="iso-abbrev">R Soc Open Sci</journal-id><journal-id journal-id-type="publisher-id">RSOS</journal-id><journal-id journal-id-type="hwp">royopensci</journal-id><journal-title-group><journal-title>Royal Society Open Science</journal-title></journal-title-group><issn pub-type="epub">2054-5703</issn><publisher><publisher-name>The Royal Society</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6458364</article-id><article-id pub-id-type="doi">10.1098/rsos.181911</article-id><article-id pub-id-type="publisher-id">rsos181911</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>1001</subject><subject>25</subject><subject>1004</subject><subject>29</subject><subject>1003</subject><subject>164</subject></subj-group><subj-group subj-group-type="heading"><subject>Engineering</subject></subj-group><subj-group subj-group-type="leader"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>From template to anchors: transfer of virtual pendulum posture control balance template to adaptive neuromuscular gait model increases walking stability</article-title><alt-title alt-title-type="short">From Template to Anchors</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Davoodi</surname><given-names>Ayoob</given-names></name><xref ref-type="aff" rid="af1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mohseni</surname><given-names>Omid</given-names></name><xref ref-type="aff" rid="af1">1</xref></contrib><contrib contrib-type="author"><name><surname>Seyfarth</surname><given-names>Andre</given-names></name><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5727-7527</contrib-id><name><surname>Sharbafi</surname><given-names>Maziar A.</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref><xref ref-type="corresp" rid="cor1"/></contrib></contrib-group><aff id="af1"><label>1</label><institution>School of ECE, Control and Intelligent Processing Center of Excellence (CIPCE), College of Engineering, University of Tehran</institution>, <addr-line>Tehran</addr-line>, <country>Iran</country></aff><aff id="af2"><label>2</label><institution>Lauflabor Locomotion Lab, Centre for Cognitive Science</institution>, <addr-line>TU Darmstadt</addr-line>, <country>Germany</country></aff><author-notes><corresp id="cor1">Author for correspondence: Maziar A. Sharbafi e-mail: <email>sharbafi@sport.tu-darmstadt.de</email></corresp><fn fn-type="other"><p>Electronic supplementary material is available online at <uri xlink:href="https://dx.doi.org/10.6084/m9.figshare.c.4440161">https://dx.doi.org/10.6084/m9.figshare.c.4440161</uri>.</p></fn></author-notes><pub-date pub-type="collection"><month>3</month><year>2019</year></pub-date><pub-date pub-type="epub"><day>27</day><month>3</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>27</day><month>3</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>6</volume><issue>3</issue><elocation-id>181911</elocation-id><history><date date-type="received"><day>8</day><month>11</month><year>2018</year></date><date date-type="accepted"><day>8</day><month>2</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; 2019 The Authors.</copyright-statement><copyright-year>2019</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>Published by the Royal Society under the terms of the Creative Commons Attribution License <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>, which permits unrestricted use, provided the original author and source are credited.</license-p></license><?release-delay 0|0?></permissions><self-uri content-type="pdf" xlink:href="rsos181911.pdf"/><self-uri content-type="reviewer_comments" xlink:href="rsos181911_review_history.pdf"/><abstract><p>Biomechanical models with different levels of complexity are of advantage to understand the underlying principles of legged locomotion. Following a minimalistic approach of gradually increasing model complexity based on <italic>Template &#x00026; Anchor</italic> concept, in this paper, a spring-loaded inverted pendulum-based walking model is extended by a rigid trunk, hip muscles and reflex control, called nmF (neuromuscular force modulated compliant hip) model. Our control strategy includes leg force feedback to activate hip muscles (originated from the FMCH approach), and a discrete linear quadratic regulator for adapting muscle reflexes. The nmF model demonstrates human-like walking kinematic and dynamic features such as the virtual pendulum (VP) concept, inherited from the FMCH model. Moreover, the robustness against postural perturbations is two times higher in the nmF model compared to the FMCH model and even further increased in the adaptive nmF model. This is due to the intrinsic muscle dynamics and the tuning of the reflex gains. With this, we demonstrate, for the first time, the evolution of mechanical template models (e.g. VP concept) to a more physiological level (nmF model). This shows that the template model can be successfully used to design and control robust locomotor systems with more realistic system behaviours.</p></abstract><kwd-group><kwd>neuromuscular models</kwd><kwd>bipedal locomotion</kwd><kwd>biarticular muscles</kwd><kwd>reflex-based control</kwd><kwd>template and anchor</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Deutsche Forschungsgemeinschaft</institution><institution-id>http://dx.doi.org/10.13039/501100001659</institution-id></institution-wrap></funding-source><award-id>AH307/2-1</award-id><award-id>SE1042/29-1</award-id></award-group><award-group><funding-source><institution-wrap><institution>Iran National Science Foundation</institution><institution-id>http://dx.doi.org/10.13039/501100003968</institution-id></institution-wrap></funding-source><award-id>95849456</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>March, 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><label>1.</label><title>Introduction</title><p>Building a legged system with agile, efficient and robust functionality requires appropriate design and control. To this end, roboticists can learn from biological locomotor systems. As a result, the biological body as the representative of the mechanical design and the neural system as the controller can be considered for understanding the basic concepts of legged locomotion. However, detailed modelling of such an intricate phenomenon is challenging and also computationally expensive. Employing template (conceptual) models were introduced as an alternative method for realizing the fundamentals of locomotion [<xref rid="RSOS181911C1" ref-type="bibr">1</xref>]. The striking feature of templates is that they ignore all the redundancies and still lend themselves to be used as simple conceptual models explaining complex problems [<xref rid="RSOS181911C2" ref-type="bibr">2</xref>].</p><p>As one of such templates, the spring-loaded inverted pendulum (SLIP), which is composed of a massless spring along with a point mass at top, can remarkably describe human running [<xref rid="RSOS181911C3" ref-type="bibr">3</xref>,<xref rid="RSOS181911C4" ref-type="bibr">4</xref>] and walking [<xref rid="RSOS181911C5" ref-type="bibr">5</xref>,<xref rid="RSOS181911C6" ref-type="bibr">6</xref>]. This simple conceptual model also helped develop some legged robots in the past [<xref rid="RSOS181911C7" ref-type="bibr">7</xref>,<xref rid="RSOS181911C8" ref-type="bibr">8</xref>]. For addressing human posture control, the extension of the point mass with a rigid trunk was introduced in TSLIP [<xref rid="RSOS181911C9" ref-type="bibr">9</xref>] or ASLIP [<xref rid="RSOS181911C10" ref-type="bibr">10</xref>] for running and BTSLIP (bipedal TSLIP) [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>,<xref rid="RSOS181911C12" ref-type="bibr">12</xref>] for walking. In constructing a model that resembles the salient features of human locomotion, employing proper control techniques for balancing the upper body warrants consideration. Several methods comprising hip joint control have been proposed for stabilizing the upper body [<xref rid="RSOS181911C7" ref-type="bibr">7</xref>,<xref rid="RSOS181911C9" ref-type="bibr">9</xref>,<xref rid="RSOS181911C12" ref-type="bibr">12</xref>&#x02013;<xref rid="RSOS181911C14" ref-type="bibr">14</xref>]. From another perspective, bioinspired control concepts such as virtual pendulum (VP) [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>] were introduced based on analysing and modelling human (or animal) gaits. Therefore, inspiration from nature (e.g. in virtual pendulum posture control (VPPC [<xref rid="RSOS181911C9" ref-type="bibr">9</xref>]) or force modulated compliant hip (FMCH [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>])) may open new doors in the design and control of legged systems which might not be accessible by engineering approaches. In FMCH, the leg force is employed to adjust hip compliance and to generate the required hip torque for balance control accordingly. This method can stabilize running [<xref rid="RSOS181911C14" ref-type="bibr">14</xref>] and walking [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>] while predicting human hip torques in walking [<xref rid="RSOS181911C15" ref-type="bibr">15</xref>]. Furthermore, this method presents a simple physical representation for implementing the control concept using minimal exchange of sensory information between different locomotor subfunctions (stance and balance) [<xref rid="RSOS181911C15" ref-type="bibr">15</xref>].</p><p>Our selected road-map for the evolution of models from template to anchor and the position of the current study are shown in <xref ref-type="fig" rid="RSOS181911F1">figure 1</xref>. Here, we take a step towards developing a biologically plausible version of the VPP concept (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>d</italic>). For this, we extend the FMCH to the neuromuscular level by replacing hip springs with the Hill-type muscle model [<xref rid="RSOS181911C16" ref-type="bibr">16</xref>]. This way, the leg force plays the role of a reflex signal to activate hip muscles. The nmF (neuromuscular FMCH) and FMCH are compared regarding their abilities in predicting human walking data. Furthermore, to deal with external disturbances, we design a discrete linear quadratic regulator (LQR) using Poincar&#x000e9; map to adapt the muscle feedback gains in an event-based manner. The robustness and efficiency of the proposed methods (nmF and adaptive nmF) are analysed and compared to those of the FMCH model and a feed-forward control approach. This latter approach which mimics preflex control [<xref rid="RSOS181911C17" ref-type="bibr">17</xref>] in the human body is considered as a baseline for stabilizing property of a controller without feedback. This minimalistic feed-forward control showed already acceptable quality in stabilizing bipedal robot gaits [<xref rid="RSOS181911C18" ref-type="bibr">18</xref>].
<fig id="RSOS181911F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Model evolution from template to anchor; (<italic>a</italic>) BSLIP template with a point mass at the hip joint and two massless springs for the legs, (<italic>b</italic>) BSLIP model extended by substituting the point mass with a rigid trunk; this model is also known as BTSLIP, (<italic>c</italic>) FMCH model wherein leg forces are used as feedback signals to generate required hip torques for posture control, (<italic>d</italic>) nmF model investigated in this paper, where hip springs are replaced by Hill-type muscle models, (<italic>e</italic>) the next step of modelling by adding segmented legs and biarticular muscles, and (<italic>f</italic>) a complete neuromuscular (anchor) model.</p></caption><graphic xlink:href="rsos181911-g1"/></fig></p><p>The remainder of the paper is organized as follows: &#x000a7;2 describes the development and formulation of the presented neuromuscular model and the developed control approaches. In &#x000a7;<xref ref-type="sec" rid="s3">3</xref>, the walking results (from human experiments and modelling) are presented and the robustness of the proposed approaches against external perturbations is investigated by demonstrating the basin of attraction for each method. The discussion about the results and predictability of the VPP concept by different models besides the future of this research are described in &#x000a7;<xref ref-type="sec" rid="s4">4</xref>. Finally, &#x000a7;<xref ref-type="sec" rid="s5">5</xref> concludes the paper. The abbreviations used throughout the paper are summarized in <xref rid="RSOS181911TB1" ref-type="table">table 1</xref>.
<table-wrap id="RSOS181911TB1" orientation="portrait" position="float"><label>Table&#x000a0;1.</label><caption><p>Nomenclature.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" rowspan="1" colspan="1">abbreviation</th><th align="left" rowspan="1" colspan="1">definition</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">CoM</td><td rowspan="1" colspan="1">centre of mass</td></tr><tr><td rowspan="1" colspan="1">BW</td><td rowspan="1" colspan="1">body weight</td></tr><tr><td rowspan="1" colspan="1">GRF</td><td rowspan="1" colspan="1">ground reaction force</td></tr><tr><td rowspan="1" colspan="1">PTS</td><td rowspan="1" colspan="1">preferred transition speed</td></tr><tr><td rowspan="1" colspan="1">SLIP</td><td rowspan="1" colspan="1">spring loaded inverted pendulum</td></tr><tr><td rowspan="1" colspan="1">TSLIP</td><td rowspan="1" colspan="1">SLIP extended by trunk</td></tr><tr><td rowspan="1" colspan="1">BTSLIP</td><td rowspan="1" colspan="1">bipedal TSLIP</td></tr><tr><td rowspan="1" colspan="1">FMCH</td><td rowspan="1" colspan="1">force modulated compliant hip</td></tr><tr><td rowspan="1" colspan="1">nmF</td><td rowspan="1" colspan="1">neuromuscular FMCH</td></tr><tr><td rowspan="1" colspan="1">VBLA</td><td rowspan="1" colspan="1">velocity-based leg adjustment</td></tr><tr><td rowspan="1" colspan="1">VPPC</td><td rowspan="1" colspan="1">virtual pendulum posture control</td></tr><tr><td rowspan="1" colspan="1">VP</td><td rowspan="1" colspan="1">virtual pendulum</td></tr><tr><td rowspan="1" colspan="1">LQR</td><td rowspan="1" colspan="1">linear quadratic regulator</td></tr><tr><td rowspan="1" colspan="1">RF</td><td rowspan="1" colspan="1">rectus femoris</td></tr><tr><td rowspan="1" colspan="1">HAM</td><td rowspan="1" colspan="1">hamstrings</td></tr><tr><td rowspan="1" colspan="1">ECC</td><td rowspan="1" colspan="1">excitation contraction coupling</td></tr><tr><td rowspan="1" colspan="1">MTC</td><td rowspan="1" colspan="1">muscle tendon complex</td></tr><tr><td rowspan="1" colspan="1">CE</td><td rowspan="1" colspan="1">contractile element</td></tr><tr><td rowspan="1" colspan="1">SEE</td><td rowspan="1" colspan="1">series elastic element</td></tr><tr><td rowspan="1" colspan="1">MCx</td><td rowspan="1" colspan="1">motor cortex</td></tr></tbody></table></table-wrap></p></sec><sec sec-type="methods" id="s2"><label>2.</label><title>Methodology</title><p>In this section, we explain the new nmF (neuromuscular FMCH) model which is used for posture control in walking. This model is placed between template models and neuromuscular anchor models (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref>). In addition, the event-based control for adapting the reflex gains to increase robustness against uncertainties and perturbations is presented.</p><sec id="s2a"><label>2.1.</label><title>Modelling</title><p>The model adopted for simulations in this paper is an extension of the bipedal TSLIP (BTSLIP) model in the sagittal plane equipped with hip muscles (<xref ref-type="fig" rid="RSOS181911F2">figure 2</xref>). Combining this model with the FMCH control concept results in the nmF (neuromuscular FMCH) model. In the following, we explain both the BTSLIP model and the muscle-tendon unit modelling.
<fig id="RSOS181911F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>(<italic>a</italic>&#x02013;<italic>e</italic>) The neuromuscular BTSLIP model with a rigid trunk and legs modelled as massless prismatic springs and definitions of walking phases. A rectus femoris (RF) and a hamstrings (HAM) muscle group are added to each leg. The muscles involved during each phase of walking are coloured in red with different shades. Muscles with dark red colour inject more force than those shown in light red. Also, the muscles silent in each phase are shown in grey. The chequered circles approximate the centre of mass (CoM) location.</p></caption><graphic xlink:href="rsos181911-g2"/></fig></p><sec id="s2a1"><label>2.1.1.</label><title>BTSLIP model</title><p>An extension of the SLIP model (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>a</italic>) for bipedal walking including the upper body to address posture control was introduced in [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>]. This BTSLIP model, which is shown in <xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>b</italic>, comprises a rigid trunk that travels on two massless compliant legs. Similar to the SLIP, in the BTSLIP model, the segmented leg is represented by a virtual leg, between the hip and the foot. In the FMCH model (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>c</italic>), adjustable springs and in the nmF model, two muscles between each leg and the trunk (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>d</italic>) provide the required hip torques. Except the hip actuation mechanism, the rest of these three models are equal, as explained in the following. In <xref ref-type="fig" rid="RSOS181911F2">figure 2</xref>, a schematic of the model is illustrated in one step.</p><p>The walking gait comprises two phases: single support and double support. The single support phase describes a period in which only one leg is in contact with the ground (stance leg) and the other, called swing leg, moves forward until its distal end hits the ground (i.e. touch down). Following the onset of swing leg contacting the ground, the double support phase (having two stance legs) starts. At the end of this phase, the former stance leg takes off, while the former swing leg remains on the ground which results in the next single support phase. In both phases, the hip torques exerted between the trunk and the stance legs (<italic>&#x003c4;</italic><sub>1</sub>, <italic>&#x003c4;</italic><sub>2</sub>) control the interactions between the stance leg and the upper body.</p><p>Changes between single support and double support phases can be easily identified as one leg touches or leaves the ground. For a leg, the stance phase initiates once the leg touches the ground. During this phase, the spring force along the leg axis is given by <italic>F</italic><sub>s</sub> = <italic>k</italic>(<italic>l</italic> &#x02212; <italic>l</italic><sub>0</sub>) where, <italic>l</italic>, <italic>l</italic><sub>0</sub> and <italic>k</italic> denote the leg length, the rest length of leg spring and stiffness, respectively. Stance phase ends once the leg leaves the ground. This moment is detected when the ground reaction force (GRF) has no vertical component. That is when GRF<sub><italic>y</italic></sub> = 0. According to <xref ref-type="fig" rid="RSOS181911F2">figure 2</xref>, the generalized coordinates required for describing the dynamical equations of the BTSLIP model are chosen as [<italic>x</italic>, <italic>y</italic>, <italic>&#x003d5;</italic>]<sup>T</sup>. In this vector, <italic>x</italic>, <italic>y</italic> and <italic>&#x003d5;</italic> represent the horizontal and vertical positions of CoM and trunk orientation, respectively, while the superscript <sup>T</sup> denotes transpose function, hereafter. As shown in <xref ref-type="fig" rid="RSOS181911F2">figure 2</xref>, the hip position (<italic>X</italic><sub>h</sub> = [<italic>x</italic><sub>h</sub>, <italic>y</italic><sub>h</sub>]<sup>T</sup>), which is the intersection of the two legs on the trunk, is placed below the CoM with distance <italic>r</italic><sub>h</sub>:
<disp-formula id="RSOS181911M2.1"><label>2.1</label><mml:math id="DM1"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>Also, the ground reaction force GRF = [GRF<sub><italic>x</italic></sub>, GRF<sub><italic>y</italic></sub>]<sup>T</sup> is produced as a result of the hip torque <italic>&#x003c4;</italic> and the spring force <italic>F</italic><sub>s</sub> along the leg axis:
<disp-formula id="RSOS181911M2.2"><label>2.2</label><mml:math id="DM2"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">GR</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>The dynamical equations in the single support phase can be written as follows:
<disp-formula id="RSOS181911M2.3"><label>2.3</label><mml:math id="DM3"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mi>J</mml:mi><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>g</italic> is the gravitational acceleration and <italic>m</italic> is the body mass.</p><p>Deriving the motion dynamics in the double support phase amounts to taking into account the spring force of both legs. For the sake of simplicity, unless otherwise specified, the parameters related to the first and second legs are denoted by subscripts <sub>1</sub> and <sub>2</sub>, respectively. In this phase, the controller applies hip torques (<italic>&#x003c4;</italic><sub>1</sub>, <italic>&#x003c4;</italic><sub>2</sub>) to maintain balance and consequently to keep the system stable. Defining the position of the second stance leg by [<italic>x</italic><sub>2</sub>, 0],<sup><xref ref-type="fn" rid="FN1">1</xref></sup> the dynamical equations in the double support phase are as follows:
<disp-formula id="RSOS181911M2.4"><label>2.4</label><mml:math id="DM4"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>J</mml:mi><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/></mml:mtd><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where
<disp-formula id="RSOS181911M2.5"><label>2.5</label><mml:math id="DM5"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>GRF</mml:mtext></mml:mstyle><mml:mrow><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>and
<disp-formula id="RSOS181911M2.6"><label>2.6</label><mml:math id="DM6"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2.</mml:mn></mml:math></disp-formula></p></sec><sec id="s2a2"><label>2.1.2.</label><title>Muscle model</title><p>In the nmF model, we replace the adjustable hip springs of the FMCH model [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>] with the Hill-type muscle models for posture control. Here, we briefly describe the muscle modelling. In the proposed neuromuscular model which is added on the top of the BTSLIP model, the hip torques (<italic>&#x003c4;</italic><sub>1</sub>, <italic>&#x003c4;</italic><sub>2</sub>) result from muscle forces. Each leg has its own pair of muscles. In general, the muscle-tendon complex (MTC) consists of a contractile element (CE) and a series elastic element (SEE). However, we only consider the CE part of the MTC to investigate the muscle properties (similar to [<xref rid="RSOS181911C19" ref-type="bibr">19</xref>]). In the Hill-type muscle model [<xref rid="RSOS181911C16" ref-type="bibr">16</xref>], the generated force by CE is given by
<disp-formula id="RSOS181911M2.7"><label>2.7</label><mml:math id="DM7"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>A</italic> is the muscle activation level which accepts values between 0 and 1. In addition, <italic>l</italic><sub>CE</sub>, <italic>v</italic><sub>CE</sub> and <italic>F</italic><sub>max</sub> are the muscle length, contraction speed and maximum isometric force, respectively. For the force&#x02013;length <italic>f</italic><sub>l</sub>(<italic>l</italic><sub>CE</sub>) and the force&#x02013;velocity <italic>f</italic><sub>v</sub>(<italic>v</italic><sub>CE</sub>) relations, we use the equations introduced by Aubert [<xref rid="RSOS181911C20" ref-type="bibr">20</xref>], which are used in the neuromuscular model of Geyer <italic>et al.</italic> [<xref rid="RSOS181911C21" ref-type="bibr">21</xref>&#x02013;<xref rid="RSOS181911C23" ref-type="bibr">23</xref>].
<disp-formula id="RSOS181911M2.8"><label>2.8</label><mml:math id="DM8"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>In this equation, <italic>l</italic><sub>opt</sub> is the optimal CE length, <italic>w</italic> denotes the width of the bell-shaped <italic>f</italic><sub>l</sub>(<italic>l</italic><sub>CE</sub>) curve and <italic>c</italic> is a constant value that can be considered as the muscle stiffness. The force&#x02013;velocity <italic>f</italic><sub>v</sub>(<italic>v</italic><sub>CE</sub>) is as follows:
<disp-formula id="RSOS181911M2.9"><label>2.9</label><mml:math id="DM9"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>7.56</mml:mn><mml:mi>&#x003ba;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true"/></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where, <italic>v</italic><sub>max</sub>, <italic>&#x003ba;</italic> and <italic>N</italic> are constant values representing the maximum contraction velocity, the curvature constant and the eccentric force enhancement [<xref rid="RSOS181911C20" ref-type="bibr">20</xref>], respectively. The values for all the constant coefficients are borrowed from [<xref rid="RSOS181911C21" ref-type="bibr">21</xref>].</p><p>The antagonistic pair of muscles in the nmF model represent the muscles actuating the upper limb of the human segmented leg. The biarticular thigh muscles (i.e. rectus femoris (RF) and hamstrings (HAM)) in the human body contribute to both knee and hip joints. In [<xref rid="RSOS181911C24" ref-type="bibr">24</xref>], it was shown that by setting the hip to knee lever arm ratio of a biarticular thigh muscle to 2, the segmented leg model, shown in <xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>e</italic>, will be equal to the nmF model, depicted in <xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>d</italic>. Hence, by representing the segmented leg with a virtual compliant leg, the biarticular thigh muscles can be responsible for balance control without cross-talk to the stance leg axial direction. Now, according to <xref ref-type="fig" rid="RSOS181911F2">figure 2</xref>, the RF and HAM muscle lengths (<italic>L</italic><sub>RF</sub> and <italic>L</italic><sub>HAM</sub>) are related to the angle between the trunk and the corresponding leg (&#x003c6;<sub>h</sub>). In the following, the equations for the single support or the rear leg in the double support are presented. Considering the position of the foot contact, similar formulation can be found for the front leg.
<disp-formula id="RSOS181911M2.10"><label>2.10</label><mml:math id="DM10"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">RF</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">HA</mml:mi><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">HAM</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>in which, <italic>r</italic><sub>0</sub> is the constant moment arm of the muscle and <italic>L</italic><sub>RF<sub>0</sub></sub> and <italic>L</italic><sub>HAM<sub>0</sub></sub> represent the rest length of the RF and HAM muscles, respectively. Also, <italic>&#x003c1;</italic> accounts for the muscle pennation angles and <inline-formula><mml:math id="IM1"><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">RF</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM2"><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">HAM</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> are the reference joint angles defined for the RF and HAM muscles, respectively. In addition, the hip angle can be calculated as follows:
<disp-formula id="RSOS181911M2.11"><label>2.11</label><mml:math id="DM11"><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msup><mml:mi>tan</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>The torque that each muscle (RF and HAM) exerts at the hip joint for one leg is given by
<disp-formula id="RSOS181911M2.12"><label>2.12</label><mml:math id="DM12"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">CE</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>and the total hip torque is resulted from these two torques as
<disp-formula id="RSOS181911M2.13"><label>2.13</label><mml:math id="DM13"><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>As already mentioned, in the double support phase, similar torques can be found for the second leg that should be summed up with this value to calculate the total hip torque on the upper body. Using these equations for the hip torque in equations (2.2)&#x02013;(2.5) completes the dynamical formulation of the neuromuscular BTSLIP model. The next step is to address the control approach required for achieving stable and robust walking.</p></sec></sec><sec id="s2b"><label>2.2.</label><title>Control approach</title><p>Inspired by the Raibert control approach [<xref rid="RSOS181911C7" ref-type="bibr">7</xref>], we consider three locomotor subfunctions [<xref rid="RSOS181911C25" ref-type="bibr">25</xref>] to generate a stable gait: (i) stance, the axial function of the stance leg; (ii) swing, the rotational movement of the swing leg; and (iii) balance, upper body posture control. Since the stance leg is passive (linear spring), the control strategy for the BTSLIP model consists of the swing and balance subfunctions (for more details about the locomotion subfunction concept see [<xref rid="RSOS181911C25" ref-type="bibr">25</xref>]). In the swing phase, a leg placement strategy for adjusting the swing leg orientation is needed. For this, the leg angle of attack should result in appropriate initiation of the next double support phase. The second task is stabilization of the upper body which is exerted in both stance and swing phases. Accordingly, we propose an adaptive control approach to maintain balancing. In the following, we detail our proposed control methods at each phase for achieving a stable and robust walking.</p><p>Stability is defined based on the step to fall concept which is a common approach in model-based model analyses of legged locomotion [<xref rid="RSOS181911C26" ref-type="bibr">26</xref>,<xref rid="RSOS181911C27" ref-type="bibr">27</xref>]. Here, the model can predict stable walking at a certain speed if it can take 50 steps, while the variations in motion speed at each step are not more than 5% of the specified speed. In other words, stability is defined by staying in the neighbourhood of a limit cycle. The system is robust against a certain perturbation, if it can maintain stability, specified here as 50 steps after perturbation occurrence.</p><sec id="s2b1"><label>2.2.1.</label><title>Velocity-based leg adjustment during swing phase</title><p>A fixed angle of attack (swing leg angle with respect to ground) is sufficient for stable running [<xref rid="RSOS181911C26" ref-type="bibr">26</xref>] and walking [<xref rid="RSOS181911C5" ref-type="bibr">5</xref>]. However, robustness against perturbations or uncertainties with a large domain of attraction cannot be achieved without leg angle adaptation. In earlier studies, the adjustment of the leg orientation was accomplished based on the horizontal velocity [<xref rid="RSOS181911C10" ref-type="bibr">10</xref>,<xref rid="RSOS181911C28" ref-type="bibr">28</xref>,<xref rid="RSOS181911C29" ref-type="bibr">29</xref>]. In [<xref rid="RSOS181911C30" ref-type="bibr">30</xref>], a robust strategy for controlling the leg angle, named VBLA (velocity-based leg adjustment) is proposed which takes into account both the CoM velocity and the gravity vectors. The potential to mimic human leg adjustment in different gaits, supporting larger range of walking velocities and having higher robustness against perturbations are some of the advantages of VBLA compared to previous approaches [<xref rid="RSOS181911C30" ref-type="bibr">30</xref>]. Due to these characteristics, we select this method in this paper.</p><p>In VBLA, a weighted average of the CoM velocity vector <bold><italic>V</italic></bold> and gravity vector <bold><italic>G</italic></bold> yields the leg direction <bold><italic>O</italic></bold> as follows:
<disp-formula id="RSOS181911M2.14"><label>2.14</label><mml:math id="DM14"><mml:mrow><mml:mi mathvariant="bold-italic">O</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>with weighting constant <italic>&#x003bc;</italic> ranging from 0 to 1. Here, <italic>&#x003bc;</italic> = 0 corresponds to a position where the leg is in parallel with the CoM velocity vector and <italic>&#x003bc;</italic> = 1 results in vertical leg orientation.</p></sec><sec id="s2b2"><label>2.2.2.</label><title>Posture stabilization with neuromuscular FMCH</title><p>An efficient stable bipedal gait (e.g. in humans) requires an upright posture [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>]. To generate stable walking with the neuromuscular BTSLIP model, a proper control framework for balancing the upper body is needed. In [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>], the leg FMCH was introduced as a new model for human-like postural control in walking. In this work, leg forces were used as feedback signals to exert the torque profile required at the hip joint. This concept was then applied to a BTSLIP model through stiffness adjustment of the rotational springs for stabilizing the posture (<xref ref-type="fig" rid="RSOS181911F1">figure 1</xref><italic>c</italic>). In the FMCH model, the hip torques are given with the following equation:
<disp-formula id="RSOS181911M2.15"><label>2.15</label><mml:math id="DM15"><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>in which, <italic>G</italic>, <italic>F</italic><sub>s</sub>, <italic>&#x003c6;</italic><sub><italic>h</italic></sub> and <italic>&#x003c6;</italic><sub><italic>h</italic>0</sub> are the normalized stiffness, the leg force, the angle between the upper body and the leg and the rest angle of the spring, respectively. It was shown that the leg force feedback (e.g. approximated using sensory information from knee extensor muscles) is crucial to tune the hip compliance, required for balancing. This model can generate different stable gaits (hopping, running [<xref rid="RSOS181911C14" ref-type="bibr">14</xref>] and walking [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>]) in addition to precise prediction of human posture control in walking at different speeds [<xref rid="RSOS181911C15" ref-type="bibr">15</xref>].</p><p>As an extension of FMCH to the neuromuscular level, in this work, the leg force <italic>F</italic><sub>s</sub>, which is the GRF in the leg axial direction, is employed as a sensory pathway for activating RF and HAM muscles. For that, the sensory signal (<italic>F</italic><sub>s</sub>) is delayed, gained and subsequently passed through the excitation-contraction coupling (ECC) to create the muscle activation <italic>A</italic> (used in Hill muscle model, equation (2.7)). A similar reflex scheme was shown to be advantageous in generating a stable hopping when using muscle length and force feedbacks [<xref rid="RSOS181911C21" ref-type="bibr">21</xref>]. However, it differs from our approach in the sense that we employ the leg force instead of muscle force as the sensory feedback. As the leg force <italic>F</italic><sub>s</sub> can be approximated by vastus muscle force in human body, our control approach can be interpreted as using the reflex signal from another muscle (vastus) to adjust the activation of the biarticular thigh muscles. Similar reflex pathways are used for walking in two dimensions [<xref rid="RSOS181911C22" ref-type="bibr">22</xref>] and three dimensions [<xref rid="RSOS181911C23" ref-type="bibr">23</xref>], while the control structure and feedback gains are obtained by optimization methods. Instead, our reflex control is developed based on a bioinspired posture control method (VPP concept). <xref ref-type="fig" rid="RSOS181911F3">Figure 3</xref> illustrates the proposed control structure, schematically. This model is termed nmF, standing for neuromuscular FMCH, which is demonstrated in <xref ref-type="fig" rid="RSOS181911F3">figure 3</xref> within the green dashed box. This neural feedback (reflex) can be formulated as follows:
<disp-formula id="RSOS181911M2.16"><label>2.16</label><mml:math id="DM16"><mml:mrow><mml:mo fence="true" stretchy="true"/><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>STIM</mml:mtext></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>STIM</mml:mtext></mml:mstyle><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>T</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>Sat</mml:mtext></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>STIM</mml:mtext></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where in the first line, STIM, STIM0 and &#x00394;<italic>P</italic> are defined as the stimulation signal, the stimulation bias and the feedback delay, respectively. In the second line, the Sat function is for saturating the stimulation to a predefined range and a first-order differential equation relating stimulation to activation signal is described with <italic>T</italic> being a time constant.
<fig id="RSOS181911F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Control loop schematic. In the inner control loop (i.e. neuromuscular FMCH control loop), the stance leg force is used as the feedback signal for creating muscle activations. In the outer loop, shown in red (i.e. LQR control loop), a discrete LQR controller is implemented to tune the reflex gains once per step at mid-stance (even based).</p></caption><graphic xlink:href="rsos181911-g3"/></fig></p><p>To demonstrate the different levels of reaction to perturbations, we compare <italic>preflex control</italic> [<xref rid="RSOS181911C31" ref-type="bibr">31</xref>] with adaptive nmF. Preflexes are defined as the intrinsic properties of muscles at the lowest level of the hierarchical sensorimotor neuromuscular control [<xref rid="RSOS181911C17" ref-type="bibr">17</xref>]. An optimal predefined stimulation to control muscle activation exhibits similarities to human preflex behaviour [<xref rid="RSOS181911C31" ref-type="bibr">31</xref>] with minimal effort for generating repetitive motions [<xref rid="RSOS181911C18" ref-type="bibr">18</xref>,<xref rid="RSOS181911C32" ref-type="bibr">32</xref>]. In this feed-forward control, the activation signals to the muscles are chosen as those obtained in the nmF model in steady walking. Finally, in adaptive nmF, for increasing the robustness against perturbations we employ a discrete LQR controller to readjust the muscle gains at each step. More details are discussed in the following.</p></sec><sec id="s2b3"><label>2.2.3.</label><title>Adaptive nmF for posture control</title><p>Our proposed neuromechanical model addresses balance control in bipedal walking. Using reflex control in the nmF model provides robustness against perturbations based on low-level sensory information and motor control. However, in human locomotion, higher level control (e.g. from brain based on visual or vestibular system) can increase robustness by reacting to larger perturbations. For implementing such a higher control layer, we adapt the reflex gains using a discrete LQR (linear quadratic regulator) [<xref rid="RSOS181911C33" ref-type="bibr">33</xref>], once per step. We use <inline-formula><mml:math id="IM3"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula> as the descritized model of walking by linearizing the continuous system dynamics about the Poincar&#x000e9; section <inline-formula><mml:math id="IM4"><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math></inline-formula>. The mid-stance configuration in which the stance leg is completely vertical in the middle of the single support is used to define <inline-formula><mml:math id="IM5"><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. A stable limit cycle in the continuous model equals the stable fixed point of the discrete model. In our reduced order linearized model, the horizontal position of the CoM (<italic>x</italic><sub><italic>k</italic></sub>) is skipped, because this state is incremental during forward walking and its regulation to a fixed value means stopping movement which is against stable walking at a certain speed. The discrete linearized model is given by
<disp-formula id="RSOS181911M2.17"><label>2.17</label><mml:math id="DM17"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>with
<disp-formula id="RSOS181911M2.18"><label>2.18</label><mml:math id="DM18"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="RSOS181911M2.19"><label>2.19</label><mml:math id="DM19"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula>
<disp-formula id="RSOS181911M2.20"><label>2.20</label><mml:math id="DM20"><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>F</italic> represents the dynamical equation of the system and the Jacobian matrices <italic>A</italic><sub>s</sub> and <italic>B</italic><sub>s</sub> are the derivatives of <italic>F</italic> with respect to the state and the input vectors at <italic>S</italic>*, respectively. Here, <italic>U</italic><sub><italic>k</italic></sub> denotes the control vector which comprises RF and HAM muscle feedback gains. Also, <inline-formula><mml:math id="IM6"><mml:msup><mml:mi>U</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">HAM</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>&#x02009;</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">RF</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> indicates the initial muscle gains before adaptation.</p><p>Since the stability of the original continuous system is related to the stability of the corresponding Poincar&#x000e9; map, we employ a discrete LQR controller which minimizes the following cost function to stabilize the discrete dynamical model of equation (2.17):
<disp-formula id="RSOS181911M2.21"><label>2.21</label><mml:math id="DM21"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x0221e;</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>R</mml:mi><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>Q</italic> and <italic>R</italic> are weighting factors defined according to performance and stability metrics. The optimal control sequence minimizing equation (2.21) and stabilizing equation (2.17) is given by state feedback
<disp-formula id="RSOS181911M2.22"><label>2.22</label><mml:math id="DM22"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>K</mml:mi><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>with <italic>K</italic> being the optimal gain vector found iteratively from the following equations:
<disp-formula id="RSOS181911M2.23"><label>2.23</label><mml:math id="DM23"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>
<disp-formula id="RSOS181911M2.24"><label>2.24</label><mml:math id="DM24"><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>and</mml:mtext></mml:mstyle><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>In this paper, we refer to the combination of neuromuscular FMCH and LQR controller as <italic>adaptive nmF</italic>. The control loop schematic is illustrated in <xref ref-type="fig" rid="RSOS181911F3">figure 3</xref>, by the red dashed line.</p></sec></sec><sec id="s2c"><label>2.3.</label><title>Human experiment</title><p>In order to compare the modelling results with human experiments, we have employed a dataset published in [<xref rid="RSOS181911C34" ref-type="bibr">34</xref>]. This dataset was collected in walking experiments on a treadmill (type ADAL-WR, Hef Tecmachine, Andrezieux Boutheon, France) at different speeds. However, we have selected one speed for comparison. For other speeds, we need to tune the model parameters if it is in the achievable walking speeds with SLIP-based models (i.e. 0.5&#x02013;1.5 m s<sup>&#x02212;1</sup>). Motion capture data and GRF data are measured by Qualisys set-up (Gothenburg, Sweden) from 11 markers and from force sensors within the treadmill, respectively. Twenty-one subjects (11 females, 10 males, age: 22&#x02013;28 yrs, height: 1.64&#x02013;1.82 m, weight: 59.2&#x02013;82.6 kg) were asked to walk at different percentages of their preferred transition speeds (PTS).<sup><xref ref-type="fn" rid="FN2">2</xref></sup> The treadmill speed was employed as the walking speed. Here, we use walking data for 50% PTS which is about 1 m s<sup>&#x02212;1</sup>, addressing <italic>moderate walking speed</italic>. Kinematic and kinetic data processing were described in [<xref rid="RSOS181911C34" ref-type="bibr">34</xref>].</p></sec></sec><sec id="s3"><label>3.</label><title>Results</title><p>In this section, the performance of the proposed control schemes on the neuromuscular BTSLIP models is compared in walking. We use the VBLA for leg adjustment and force feedback-based strategies by modulating the hip spring stiffness (FMCH) or muscle activation (nmF and adaptive nmF) for balance control. The BTSLIP and nmF model parameter values are summarized in tables <xref rid="RSOS181911TB2" ref-type="table">2</xref> and <xref rid="RSOS181911TB3" ref-type="table">3</xref>, respectively. The forward velocity considered for this model is 1 m s<sup>&#x02212;1</sup>. Also, unless noted otherwise, the values of <italic>Q</italic> and <italic>R</italic> matrices are chosen as identity matrices of proper dimensions, giving similar weights to the error and energy consumption.
<table-wrap id="RSOS181911TB2" orientation="portrait" position="float"><label>Table&#x000a0;2.</label><caption><p>BTSLIP model parameters. The model parameters are set to match the characteristics of an ordinary human being.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" rowspan="1" colspan="1">parameter</th><th align="left" rowspan="1" colspan="1">definition</th><th align="left" rowspan="1" colspan="1">value (units)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>m</italic></td><td rowspan="1" colspan="1">trunk mass</td><td rowspan="1" colspan="1">80 (kg)</td></tr><tr><td rowspan="1" colspan="1"><italic>J</italic></td><td rowspan="1" colspan="1">trunk moment of inertia</td><td rowspan="1" colspan="1">4.6 (kg m<sup>2</sup>)</td></tr><tr><td rowspan="1" colspan="1"><italic>r</italic><sub>h</sub></td><td rowspan="1" colspan="1">distance hip&#x02013;CoM</td><td rowspan="1" colspan="1">0.1 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>L</italic><sub>0</sub></td><td rowspan="1" colspan="1">leg rest length</td><td rowspan="1" colspan="1">1 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>g</italic></td><td rowspan="1" colspan="1">gravitational acceleration</td><td rowspan="1" colspan="1">9.81 (m s<sup>&#x02212;2</sup>)</td></tr><tr><td rowspan="1" colspan="1"><italic>&#x003bc;</italic></td><td rowspan="1" colspan="1">leg adjustment parameter</td><td rowspan="1" colspan="1">0.34</td></tr><tr><td rowspan="1" colspan="1"><italic>k</italic><sub><italic>N</italic></sub></td><td rowspan="1" colspan="1">normalized leg stiffness</td><td rowspan="1" colspan="1">40</td></tr></tbody></table></table-wrap>
<table-wrap id="RSOS181911TB3" orientation="portrait" position="float"><label>Table&#x000a0;3.</label><caption><p>Muscle model parameters.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1"/><th align="left" colspan="2" rowspan="1">value (units)<hr/></th></tr><tr><th align="left" rowspan="1" colspan="1">parameter</th><th align="left" rowspan="1" colspan="1">definition</th><th align="left" rowspan="1" colspan="1">RF</th><th align="left" rowspan="1" colspan="1">HAM</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>L</italic><sub><italic>mtu</italic>0</sub></td><td rowspan="1" colspan="1">MTU reference length</td><td rowspan="1" colspan="1">0.11 (m)</td><td rowspan="1" colspan="1">0.11 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>&#x003d5;</italic><sub>ref</sub></td><td rowspan="1" colspan="1">reference joint angle</td><td rowspan="1" colspan="1">3.291 (rad)</td><td rowspan="1" colspan="1">3.246 (rad)</td></tr><tr><td rowspan="1" colspan="1"><italic>r</italic></td><td rowspan="1" colspan="1">constant lever contribution</td><td rowspan="1" colspan="1">0.1 (m)</td><td rowspan="1" colspan="1">0.1 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>F</italic><sub>max</sub></td><td rowspan="1" colspan="1">maximum isometric force</td><td rowspan="1" colspan="1">2000 (N)</td><td rowspan="1" colspan="1">2000 (N)</td></tr><tr><td rowspan="1" colspan="1"><italic>L</italic><sub>opt</sub></td><td rowspan="1" colspan="1">optimum length</td><td rowspan="1" colspan="1">0.111 (m)</td><td rowspan="1" colspan="1">0.111 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>V</italic><sub>max</sub></td><td rowspan="1" colspan="1">maximum shortening velocity</td><td rowspan="1" colspan="1">&#x02212;12(<italic>L</italic><sub>opt</sub>s<sup>&#x02212;1</sup>)</td><td rowspan="1" colspan="1">&#x02212;12(<italic>L</italic><sub>opt</sub>s<sup>&#x02212;1</sup>)</td></tr><tr><td rowspan="1" colspan="1"><italic>&#x003c4;</italic></td><td rowspan="1" colspan="1">excitation-contraction coupling</td><td rowspan="1" colspan="1">1 (ms)</td><td rowspan="1" colspan="1">1 (ms)</td></tr><tr><td rowspan="1" colspan="1">&#x00394;<italic>p</italic></td><td rowspan="1" colspan="1">feedback time delay</td><td rowspan="1" colspan="1">1 (ms)</td><td rowspan="1" colspan="1">1 (ms)</td></tr><tr><td rowspan="1" colspan="1">STIM0</td><td rowspan="1" colspan="1">constant value</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.01</td></tr><tr><td rowspan="1" colspan="1"><italic>G</italic></td><td rowspan="1" colspan="1">gain of muscle feedback</td><td rowspan="1" colspan="1">0.624/<italic>F</italic><sub>max</sub></td><td rowspan="1" colspan="1">0.936/<italic>F</italic><sub>max</sub></td></tr><tr><td rowspan="1" colspan="1"><italic>w</italic></td><td rowspan="1" colspan="1">width of bell-shaped</td><td rowspan="1" colspan="1">0.2 (m)</td><td rowspan="1" colspan="1">0.2 (m)</td></tr><tr><td rowspan="1" colspan="1"><italic>c</italic></td><td rowspan="1" colspan="1">constant value</td><td rowspan="1" colspan="1">ln(0.05)</td><td rowspan="1" colspan="1">ln(0.05)</td></tr><tr><td rowspan="1" colspan="1"><italic>N</italic></td><td rowspan="1" colspan="1">eccentric force enhancement</td><td rowspan="1" colspan="1">1.5</td><td rowspan="1" colspan="1">1.5</td></tr><tr><td rowspan="1" colspan="1"><italic>&#x003ba;</italic></td><td rowspan="1" colspan="1">curvature constant</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">5</td></tr><tr><td rowspan="1" colspan="1"><italic>&#x003c1;</italic></td><td rowspan="1" colspan="1">muscle pennation angle</td><td rowspan="1" colspan="1">0.5</td><td rowspan="1" colspan="1">0.5</td></tr></tbody></table></table-wrap></p><sec id="s3a"><label>3.1.</label><title>Comparison to human walking</title><p><xref ref-type="fig" rid="RSOS181911F4">Figure 4</xref> shows the simulation and experimental results from different perspectives (kinetics and kinematics). In <xref ref-type="fig" rid="RSOS181911F4">figure 4</xref><italic>a</italic>, the CoM movement in vertical direction is depicted for FMCH and nmF models along with the human data. Double humped vertical displacement of CoM during one stride of walking is observed in both human experiments and simulation models. The CoM vertical displacements are about 5 cm for both cases. <xref ref-type="fig" rid="RSOS181911F4">Figure 4</xref><italic>b</italic> illustrates the torque applied by the hip springs for FMCH model and by the hip muscles for nmF model. Except the time shift seen in this figure, one can easily observe that the torque profile of the model is the same as the human hip torque profile. <xref ref-type="fig" rid="RSOS181911F4">Figure 4</xref><italic>c</italic>,<italic>d</italic> shows the horizontal and vertical components of the GRF. The results from the horizontal GRF depict similarity to what is observed in humans. The small positive peak force at the onset of walking cycle in human data shows the impact effect of touchdown which is missing in our models because the legs are massless. This simplification could also result in shorter swing phase in SLIP-based models compared to human walking. These differences could also be attributed to the absence of foot in the BTSLIP model, but still the patterns and the GRF magnitudes are comparable.
<fig id="RSOS181911F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Comparison between the FMCH model, nmF model and human experimental results in one stride (two steps) at 1 m s<sup>&#x02212;1</sup> walking speed. Each stride starts at touchdown of one leg to the next touchdown of the same leg. Dots shown in the figures signify the toe-off moment. The cyan solid lines and the shaded areas surrounding them show the mean and variance for 21 subjects, respectively. The black lines with star markers illustrate the graphs for FMCH and the blue dashed lines depict the results for nmF model. (<italic>a</italic>) Vertical displacement of the CoM from the initial height at touchdown, (<italic>b</italic>) hip torque variations normalized to the body weight (BW), (<italic>c</italic>,<italic>d</italic>) horizontal and vertical GRFs normalized to BW.</p></caption><graphic xlink:href="rsos181911-g4"/></fig></p></sec><sec id="s3b"><label>3.2.</label><title>Robustness against external perturbations</title><p>To investigate the robustness of the model along with the employed control approach in face of external disturbances, we perturbed the system by a sudden push on the upper body. For emulating this impact, the trunk angular velocity (<inline-formula><mml:math id="IM7"><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) is largely magnified (to &#x02212;50&#x000b0;), instantaneously. The results of comparing the preflex, the FMCH, the nmF and the adaptive nmF control methods, are displayed in <xref ref-type="fig" rid="RSOS181911F5">figure 5</xref>. The orientation of the trunk with respect to the horizontal axis and its angular velocity are depicted in <xref ref-type="fig" rid="RSOS181911F5">figure 5</xref><italic>a</italic> and <xref ref-type="fig" rid="RSOS181911F5">5</xref><italic>b</italic>, respectively. In the preflex control, after the perturbation, the trunk is leaning forward and its angle is deviating from the vertical orientation. This situation is perpetuated for almost 7 s until both legs lose contact with the ground and accordingly the model loses its stability. In the FMCH model, large oscillations in the trunk orientation are induced due to the perturbation occurrence. Yet, as seen in the figures, this model is able to recover from the perturbation and continues walking. In the nmF model, the trunk angle tends to return to the upright posture more quickly and it takes less than 2 s for this model to return to its previous orientation pattern. This is a significant improvement in terms of perturbation recovery compared to the aforementioned models. Adaptation of the control gains with discrete LQR also enables the body to keep upright posture after perturbation occurrence with a settling time similar to nmF, without considerable oscillations. The feedback gains for both nmF and adaptive nmF models in course of convergence to the steady walking are illustrated in <xref ref-type="fig" rid="RSOS181911F5">figure 5</xref><italic>c</italic>. This figure shows that following the onset of perturbation, the muscle gains are adjusted and then settled quickly to their previous values. Finally, <xref ref-type="fig" rid="RSOS181911F5">figure 5</xref><italic>d</italic> displays the consumed energy <italic>J</italic> at each stride for all models. Here, the consumed energy in one stride (with duration <italic>T</italic>) is computed from multiplication of hip torque <italic>&#x003c4;</italic><sub><italic>i</italic></sub> and hip angle <inline-formula><mml:math id="IM8"><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, (<italic>i</italic> = 1, 2) as follows:
<disp-formula id="RSOS181911M3.1"><label>3.1</label><mml:math id="DM25"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>&#x003c6;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>&#x003c6;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>d</mml:mtext></mml:mstyle><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>in which the absolute value function is used to sum up the magnitude of power from the positive and negative works. Thanks to the inherent characteristics of nmF model, less power and consequently energy is consumed during rejecting the disturbance and converging to a stable walking gait compared to the FMCH model. The results for the adaptive nmF model also show that adjusting reflex gains according to the LQR controller output has effectively helped reduce the consumed energy after perturbations.
<fig id="RSOS181911F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Simulation results showing the performance of different models in face of an external perturbation. (<italic>a</italic>,<italic>b</italic>) Orientation and angular velocity of trunk in the presence of an external perturbation at the beginning of fourth stride, (<italic>c</italic>) variation of RF and HAM muscle feedback gains with respect to number of strides in response to perturbation for nmF and adaptive nmF models and (<italic>d</italic>) consumed energy at the hip joint in different strides.</p></caption><graphic xlink:href="rsos181911-g5"/></fig></p><p>To better understand the dynamic behaviour in reaction to perturbations, the phase portrait (with <italic>&#x003d5;</italic> and <inline-formula><mml:math id="IM9"><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> being the state variables) is displayed in <xref ref-type="fig" rid="RSOS181911F6">figure 6</xref> for all models except preflex control, which is unstable after perturbation. Starting from similar initial conditions, the states in the (adaptive) nmF model converge to the stable limit cycle much faster than those of the FMCH model. Since a compromise between efficiency and performance can be set by tuning <italic>R</italic> and <italic>Q</italic> in the LQR method (adaptive nmF), increasing efficiency (<xref ref-type="fig" rid="RSOS181911F5">figure 5</xref><italic>d</italic>) results in lower performance (higher deviation from the limit cycle, <xref ref-type="fig" rid="RSOS181911F6">figure 6</xref>) compared to nmF, which is not significant.
<fig id="RSOS181911F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Phase portrait of the trunk angle (<italic>&#x003d5;</italic>) for the perturbed system controlled with FMCH, nmF and adaptive nmF methods.</p></caption><graphic xlink:href="rsos181911-g6"/></fig></p></sec><sec id="s3c"><label>3.3.</label><title>Efficiency and performance in adaptive nmF</title><p>The constraints and potentials of the proposed adaptive method can be verified by investigating the effect of weighting <italic>R</italic> and <italic>Q</italic> on the efficiency and performance of locomotion. By now, we always set these matrices to identity matrix <italic>I</italic>. Here, we repeat the perturbation recovery simulations for three different cases: (i) <italic>Q</italic> = 100<italic>I</italic>, <italic>R</italic> = <italic>I</italic>, (ii) <italic>Q</italic> = <italic>R</italic> = <italic>I</italic> and (iii) <italic>Q</italic> = <italic>I</italic>, <italic>R</italic> = 100<italic>I</italic>. The results obtained from this simulation are illustrated in <xref ref-type="fig" rid="RSOS181911F7">figure 7</xref>. The effects of selecting different pairs of (<italic>Q</italic>, <italic>R</italic>) on the orientation of trunk and its angular velocity are depicted in <xref ref-type="fig" rid="RSOS181911F7">figure 7</xref><italic>a</italic> and <xref ref-type="fig" rid="RSOS181911F7">7</xref><italic>b</italic>, respectively. The highest performance with the fastest regulation to steady state after perturbation is achieved in case (i), in which <italic>Q</italic> is larger than <italic>R</italic>. Also, by calculating the peak power and energy consumption at the hip joint as shown in <xref ref-type="fig" rid="RSOS181911F7">figure 7</xref><italic>c</italic> and <xref ref-type="fig" rid="RSOS181911F7">7</xref><italic>d</italic>, respectively, it can be observed that case (i) has the highest of both. Putting more weight on the <italic>R</italic> matrix as in case (iii) yields the lowest control effort (energy and peak power) while having the largest oscillations after perturbations.
<fig id="RSOS181911F7" orientation="portrait" position="float"><label>Figure 7.</label><caption><p>Variations of the adaptive nmF model to weighting matrices <italic>Q</italic> and <italic>R</italic> in the LQR controller. (<italic>a</italic>,<italic>b</italic>) Trunk orientation and its angular velocity for different values of <italic>Q</italic> and <italic>R</italic>, (<italic>c</italic>,<italic>d</italic>) peak power and consumed energy during each stride at the hip joint for different values of <italic>Q</italic> and <italic>R</italic>.</p></caption><graphic xlink:href="rsos181911-g7"/></fig></p></sec><sec id="s3d"><label>3.4.</label><title>Basin of attraction</title><p>Robustness against perturbations among different methods are compared in figures <xref ref-type="fig" rid="RSOS181911F5">5</xref> and <xref ref-type="fig" rid="RSOS181911F6">6</xref>, by investigating the response to a sample perturbation. For a more comprehensive and descriptive comparison, the basin of attraction&#x02014;identified by a range of initial trunk angles and angular velocities in which a model can predict stable walking&#x02014;is used. For computing the basin of attraction, we perturbed both the trunk angle (from 60 to 120&#x000b0; with a resolution of 1&#x000b0;) and its velocity (from &#x02212;200 to 150&#x000b0; s<sup>&#x02212;1</sup> with a resolution of 0.1 rad s<sup>&#x02212;1</sup>). Then, those sets of initial conditions in the space (<italic>&#x003d5;</italic>, <inline-formula><mml:math id="IM10"><mml:mrow><mml:mover><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) for which models can maintain stable walking are considered as the basin of attraction for that model. The results displayed in <xref ref-type="fig" rid="RSOS181911F8">figure 8</xref> reveal that the size of basin of attraction in the nmF model is approximately twice that of the FMCH model. Also, this figure shows that the adaptive nmF model has the largest basin of attraction, as expected. Expansion of the basin of attraction from top-left to bottom-right is clearly observable using neuromuscular model and high-level gain adaptation. These results show that our bioinspired neuromuscular models (e.g. nmF) are considerably less sensitive to the initial conditions (or probable perturbations) compared to the biomechanical models (e.g. FMCH).
<fig id="RSOS181911F8" orientation="portrait" position="float"><label>Figure 8.</label><caption><p>Basins of attraction for FMCH, nmF and adaptive nmF models.</p></caption><graphic xlink:href="rsos181911-g8"/></fig></p></sec></sec><sec id="s4"><label>4.</label><title>Discussion</title><p>There is a long debate about the applicability of conceptual models [<xref rid="RSOS181911C1" ref-type="bibr">1</xref>,<xref rid="RSOS181911C3" ref-type="bibr">3</xref>] on legged locomotion [<xref rid="RSOS181911C2" ref-type="bibr">2</xref>]. It is still challenging to translate biological movements into robotic systems. In order to achieve this goal, it is important to learn from biology without getting stuck in details of modelling the system&#x02019;s design and control. For this, mechanical template models [<xref rid="RSOS181911C1" ref-type="bibr">1</xref>] can help better understand the basic principles of legged locomotion. These models can then be extended to anchor models such that they can be implemented on robots or be verified in biological gait experiments. One of such template models is based on the virtual pivot point (VPP) concept [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>], which is selected for posture control in this paper. Previously, we used the FMCH model [<xref rid="RSOS181911C12" ref-type="bibr">12</xref>] as a representation of the VPP concept. However, on a structural level, this control model does not describe how such kind of feedback-augmented passive template models can be realized in the human body by neuromuscular control. Here, we demonstrated the functional coherence of force modulated compliant hip (FMCH) and positive leg force feedback on hip muscles (nmF). With this, we can transfer the (mechanical) template control structure directly to the neuromuscular control structure. This highlights that in this context, the muscle function can be simplified to an adjustable mechanical spring sharing the same control approach (positive leg force feedback) for postural balance. With this, a descriptive theory of FMCH can be translated to a synthetic theory of designing neuromuscular models for biological movements.</p><p>In addition to the muscles&#x02019; intrinsic properties as part of the biological actuation system, their interplay in the musculoskeletal system can be beneficial for motor control. The contribution of biarticular muscles with well-defined parameters (e.g. lever arm ratio) in control of GRF direction was shown in human perturbed standing [<xref rid="RSOS181911C35" ref-type="bibr">35</xref>] and walking experiments [<xref rid="RSOS181911C36" ref-type="bibr">36</xref>]. Using GRF direction control with biarticular muscles, the VPP can be obtained by adjustment of muscle stiffness based on the leg force feedback [<xref rid="RSOS181911C35" ref-type="bibr">35</xref>]. Here, it was shown that considering 2:1 as the ratio of hip to knee lever arms of biarticular thigh muscles (modelled by springs), the segmented leg model can be simplified into the FMCH model [<xref rid="RSOS181911C35" ref-type="bibr">35</xref>]. Hence, in our model, the hip muscles are mimicking RF and HAM muscles in the human body. To validate these theoretical findings for robotic applications, we previously demonstrated that biarticular muscles outperform monoarticular ones in control of GRF direction by comparing them in the humanoid legged robot BioBiped3 [<xref rid="RSOS181911C24" ref-type="bibr">24</xref>]. These achievements show how the human musculoskeletal body design facilitates posture control and how it can be easily implemented on a biped robot.</p><p>From the neuro-mechanical point of view, our proposed neuromuscular model predicts the emergence of the VPP. To demonstrate that, the GRFs were plotted with respect to the coordinate system centred at body CoM and aligned with trunk orientation in <xref ref-type="fig" rid="RSOS181911F9">figure 9</xref> for FMCH, nmF and adaptive nmF models. In this figure, the estimated locations of VPP and CoM are also displayed with red and green circles, respectively. The existence of an emerging intersection point shows that the addition of muscle properties (e.g. damping effect represented by force&#x02013;velocity relation) does not result in deviating from the previous FMCH balance control concept. Moreover, it supports that human muscles are able to control the upper body in a way that the VP concept holds. Hence, this phenomenon is not just an observation, but a control principle.
<fig id="RSOS181911F9" orientation="portrait" position="float"><label>Figure 9.</label><caption><p>Ground reaction forces plotted with respect to trunk coordinate system centred at CoM for FMCH, nmF and adaptive nmF models. The red and green circles illustrate the VPP and CoM location, respectively. As can be seen from these figures, the concept of VPP is also realized with the model presented in this paper. (<italic>a</italic>) FMCH, (<italic>b</italic>) nmF and (<italic>c</italic>) adaptive nmF.</p></caption><graphic xlink:href="rsos181911-g9"/></fig></p><p>Three different levels of design and control were addressed in this paper: (i) biomechanical design (ii) neuromuscular control (inner loop) and (iii) event-based control (outer loop). The nmF and adaptive nmF models were developed to focus on the second and third mentioned levels. Higher performance and robustness could be achieved by tuning of the muscle mechanical properties and the control parameters (reflex gains). This shows that in addition to the reflex control based on the sensor-motor maps [<xref rid="RSOS181911C37" ref-type="bibr">37</xref>], higher level responses to perturbations can considerably enhance the locomotion robustness. As shown in <xref ref-type="fig" rid="RSOS181911F8">figure 8</xref>, the evolution of the models results in considerable enlargement of the basin of attraction, meaning increase in robustness against postural perturbations. A similar control hierarchy was observed in perturbation recovery when a small step inferred via visual scene is reflected in a decreasing erector spinae stimulation and a forward trunk rotation [<xref rid="RSOS181911C38" ref-type="bibr">38</xref>]. Furthermore, it was shown that the motor cortex (MCx) issues voluntary motor commands and mediates reflex-like responses to stretch upper limb muscles [<xref rid="RSOS181911C39" ref-type="bibr">39</xref>]. Damaged MCx or corticospinal tract results in severe walking deficits in humans, e.g. foot drop [<xref rid="RSOS181911C40" ref-type="bibr">40</xref>,<xref rid="RSOS181911C41" ref-type="bibr">41</xref>]. Therefore, high-level event-based control of the reflex gains in the proposed posture control is also supported by evidence in biological locomotor systems. Our proposed LQR controller enables a compromise between efficiency and robustness. <xref ref-type="fig" rid="RSOS181911F7">Figure 7</xref> shows how a trade-off between <italic>R</italic> and <italic>Q</italic> could be made based on the importance of energy efficiency and tracking performance or robustness against perturbations. Such a parameter setting in the higher level control might reflect human-specific behaviours and habits in daily life. Although the cost function in LQR includes consumed energy it can also address peak power, as can be seen in <xref ref-type="fig" rid="RSOS181911F7">figure 7</xref><italic>c</italic>.</p><p>In addition to the aforementioned findings, we have previously employed the nmF model to describe gait asymmetries in stroke patients.<sup><xref ref-type="fn" rid="FN3">3</xref></sup> This model predicted that the observed gait asymmetry was not caused by deficits in the balance control, but was rather due to changes in stance and swing leg control which is in line with findings in [<xref rid="RSOS181911C42" ref-type="bibr">42</xref>]. Such insights can help design function-specific approaches to assist human locomotion, e.g. using exoskeletons. In some studies on neuromuscular system behaviour after stroke, the muscle properties (volume [<xref rid="RSOS181911C42" ref-type="bibr">42</xref>], activation [<xref rid="RSOS181911C43" ref-type="bibr">43</xref>]) were analysed, while in others the effects on locomotor subfunctions were investigated [<xref rid="RSOS181911C44" ref-type="bibr">44</xref>,<xref rid="RSOS181911C45" ref-type="bibr">45</xref>]. However, the huge number of parameters in a detailed complex walking model makes understanding of the general concepts of impaired gaits quite difficult. These concepts become more visible in a more abstract level using the proposed template-based biomechanical models. For example, in a detailed model developed in OpenSim (<uri xlink:href="https://simtk.org/projects/hemigait">https://simtk.org/projects/hemigait</uri>), 23 d.f. and 54 muscle actuators are considered and each muscle comprises many different parameters. Extracting high-level concepts from these numerous parameters is almost impossible unless there exists an abstract model to explain variations in walking and not in each muscle property. As there is no similar architecture (e.g. muscle-like actuators) in exoskeletons, understanding the underlying mechanisms for asymmetry in stroke walking based on the locomotor subfunction concept can help design and control assistive devices. In [<xref rid="RSOS181911C46" ref-type="bibr">46</xref>], we showed that implementation of the FMCH concept on a lower-extremity powered exoskeleton (LOPES II) supports this control approach for assisting (reducing metabolic cost) healthy subjects. In future, similar methods can be implemented on assistive devices for rehabilitation training with patients.</p><p>In summary, the key advantages of our newly developed neuromuscular model can be categorized as follows: (i) presenting a neuromechanical model to start the journey from template to anchors, (ii) presenting a proof of concept to show that by considering physiological body properties (muscle mechanics and neural control) FMCH can be translated into the human locomotor system, (iii) demonstrating the stiffness modulation as described in FMCH in the neuromuscular system, (iv) introducing LQR as an adaptation method for higher control level which can increase robustness and efficiency. The modulation of reflex gain is also observed in human locomotion and can be represented in future models by reflex networks with higher topological levels (e.g. neural networks modulating reflex gains).</p><p>Our future work involves establishing a more elaborate model for human locomotion as in an extended nmF model with segmented legs. In order to develop assistive devices with higher quality inspired by biological gaits, the concepts need to be implemented on more detailed models and robots. These extended models will help to get a better match to gait kinematics and kinetics, e.g. with respect to contact time and push-off mechanics. Our model predicted larger duty factors (stance period over gait cycle duration) than what was observed experimentally, due to the inheritance of the VPP concept [<xref rid="RSOS181911C11" ref-type="bibr">11</xref>]. For instance, a matching FMCH-based control could also be present at the ankle joint. In fact, the concerted action of different leg joints and even of the upper body could together contribute to the postural balance which can be represented by the VPP [<xref rid="RSOS181911C47" ref-type="bibr">47</xref>]. Such an extension of the model could help to better understand the interplay between ankle and hip strategies for balance control in both normal and pathological gaits.</p></sec><sec id="s5"><label>5.</label><title>Conclusion</title><p>In this study, balance control in a neuromuscular bipedal TSLIP model, which represents a template for human walking, is achieved through activating hip muscles (RF and HAM) proportional to the leg force feedback. We demonstrated that this positive feedback of leg force as muscle activation signals is sufficient for ensuring a stable walking gait and also supports the VP concept that is observed in humans. Moreover, we showed that the model by itself is able to increase the range of tolerable disturbances and convergence speed to steady-state walking motion after perturbation. This is attributed to the mechanical function of hip muscles. To further enlarge the domain of attraction and consequently increase robustness, we used a discrete LQR controller designed using the Poincar&#x000e9; map. These results can be interpreted as the outer-loop control. Such a higher level of control can also be found in the neural system like corticospinal layer. This aligns with findings in human walking experiments [<xref rid="RSOS181911C38" ref-type="bibr">38</xref>&#x02013;<xref rid="RSOS181911C41" ref-type="bibr">41</xref>].</p><p>Both BTSLIP and FMCH are mechanical conceptual models which fail to describe the neuromuscular structure of the human body. In order to validate the value of the predictions made by these models, we need to test them in a more human-like body structure. The nmF model is an attempt to overcome this limitation by representing a pair of thigh muscles and its neural control. In our study, the primary outcome is not to show any advantages of the nmF model compared to the other two conceptual models. Instead, we prove that the concepts hold for a more human-like structure of the model (the idea of an anchor in relation to a template, [<xref rid="RSOS181911C1" ref-type="bibr">1</xref>]). With the nmF model, we can now investigate in more detail which structural and functional conditions (e.g. muscle properties and arrangements) are required for a given motor task (e.g. walking). This study is a step towards anchoring a conceptual model. The FMCH model approach with adjustable compliance is a mechanically plausible implementation of the bioinspired VPP concept. However, it is not a biologically plausible realization of the posture control concept. Here, we tried to show that by considering muscle properties, the concept is also biologically plausible and can result in control enhancement. In addition, the proposed adaptive nmF could be considered as a new method to model a higher level of control, e.g. from the spinal cord or the brain in humans. Such an adaptation increases the robustness of the gait against perturbations. This could also open a new door in developing hierarchical neural controls, e.g. by implementing reflex-based and central pattern generators at different control layers.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><caption><title>Code_Third_Submission.rar</title></caption><media mimetype="application" mime-subtype="rar" xlink:href="rsos181911supp1.rar" orientation="portrait" id="d35e4513" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="d35e166"><caption><title>Reviewer comments</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rsos181911_review_history.pdf"/></supplementary-material></sec></body><back><ack><title>Acknowledgements</title><p>We thank colleagues in the BALANCE (<uri xlink:href="http://www.balance-fp7.eu/">http://www.balance-fp7.eu/</uri>) project who contributed in discussions about this research and advised on modelling studies.</p></ack><fn-group><fn id="FN1"><label>1</label><p>It is assumed that the rear leg is positioned at [0, 0].</p></fn><fn id="FN2"><label>2</label><p>PTS is the preferred speed for transition between running and walking which is typically about 1.9&#x02013;2.1 m s<sup>&#x02212;1</sup> for humans [<xref rid="RSOS181911C34" ref-type="bibr">34</xref>].</p></fn><fn id="FN3"><label>3</label><p>The results are not described in this paper, but reported in &#x02018;Report on neuro-mechanical modelling of neurologically impaired gait&#x02019; (Deliverable 7.4) which is publicly available in <uri xlink:href="http://www.balance-fp7.eu/private_area/archivo.php?archivo=34">http://www.balance-fp7.eu/private_area/archivo.php?archivo=34</uri>.</p></fn></fn-group><sec id="s6"><title>Data accessibility</title><p>All simulations are performed in Matlab/Simulink. The codes are available in a folder in the electronic supplementary material. Human experimental data for moderate walking speed collected from [<xref rid="RSOS181911C34" ref-type="bibr">34</xref>] are also presented in the same folder. There is also a file named <italic>main.m</italic> in the same directory that reproduces the figures presented in this paper.</p></sec><sec id="s7"><title>Authors' contributions</title><p>A.D. developed the simulation models, implemented control approaches, prepared the results and contributed in data analysis. O.M. contributed in data analysis, writing the manuscript and providing the descriptive figures (figures <xref ref-type="fig" rid="RSOS181911F1">1</xref> and <xref ref-type="fig" rid="RSOS181911F2">2</xref>). M.A.S. is the corresponding author of the article, responsible for the conception and design of simulations and analysis and interpretation of data and writing of the manuscript; A.S. contributed in conception of the study, to discussions and commenting on and writing the article. All authors gave final approval for participation.</p></sec><sec id="s8" sec-type="COI-statement"><title>Competing interests</title><p>We declare we have no competing interests.</p></sec><sec id="s9"><title>Funding</title><p>This research was partially supported by INSF under grant no. 95849456 and partially by the German Research Foundation (DFG) under grants nos. AH307/2-1 and SE1042/29-1.</p></sec><ref-list><title>References</title><ref id="RSOS181911C1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Full</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Koditschek</surname><given-names>DE</given-names></name></person-group>
<year>1999</year>
<article-title>Templates and anchors: neuromechanical hypotheses of legged locomotion on land</article-title>. <source>J. Exp. Biol.</source>
<volume>202</volume>, <fpage>3325</fpage>&#x02013;<lpage>3332</lpage>.<pub-id pub-id-type="pmid">10562515</pub-id></mixed-citation></ref><ref id="RSOS181911C2"><label>2</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Kvalheim</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Revzen</surname><given-names>S</given-names></name></person-group>
<year>2017</year>
<comment>Templates and anchors. In <italic>Bioinspired legged locomotion: models, concepts, control and applications</italic> (eds M Sharbafi, A Seyfarth), pp. 62&#x02013;78. Oxford, UK: Elsevier</comment>.</mixed-citation></ref><ref id="RSOS181911C3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blickhan</surname><given-names>R</given-names></name></person-group>
<year>1989</year>
<article-title>The spring-mass model for running and hopping</article-title>. <source>J. Biomech.</source>
<volume>22</volume>, <fpage>1217</fpage>&#x02013;<lpage>1227</lpage>. (<pub-id pub-id-type="doi">10.1016/0021-9290(89)90224-8</pub-id>)<pub-id pub-id-type="pmid">2625422</pub-id></mixed-citation></ref><ref id="RSOS181911C4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McMahon</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>GC</given-names></name></person-group>
<year>1990</year>
<article-title>The mechanics of running: how does stiffness couple with speed?</article-title>
<source>J. Biomech.</source>
<volume>23</volume>, <fpage>65</fpage>&#x02013;<lpage>78</lpage>. (<pub-id pub-id-type="doi">10.1016/0021-9290(90)90042-2</pub-id>)<pub-id pub-id-type="pmid">2081746</pub-id></mixed-citation></ref><ref id="RSOS181911C5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geyer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Blickhan</surname><given-names>R</given-names></name></person-group>
<year>2006</year>
<article-title>Compliant leg behaviour explains basic dynamics of walking and running</article-title>. <source>Proc. R. Soc. B</source>
<volume>273</volume>, <fpage>2861</fpage>&#x02013;<lpage>2867</lpage>. (<pub-id pub-id-type="doi">10.1098/rspb.2006.3637</pub-id>)</mixed-citation></ref><ref id="RSOS181911C6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shahbazi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Saranl&#x00131;</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Babu&#x00161;ka</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Lopes</surname><given-names>GA</given-names></name></person-group>
<year>2016</year>
<article-title>Approximate analytical solutions to the double-stance dynamics of the lossy spring-loaded inverted pendulum</article-title>. <source>Bioinspir. Biomim.</source>
<volume>12</volume>, <fpage>016003</fpage> (<pub-id pub-id-type="doi">10.1088/1748-3190/12/1/016003</pub-id>)<pub-id pub-id-type="pmid">27918291</pub-id></mixed-citation></ref><ref id="RSOS181911C7"><label>7</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Raibert</surname><given-names>MH</given-names></name></person-group>
<year>1986</year>
<source>Legged robots that balance</source>. <publisher-loc>Cambridge, MA:</publisher-loc>
<publisher-name>MIT Press</publisher-name>.</mixed-citation></ref><ref id="RSOS181911C8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saranli</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Buehler</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Koditschek</surname><given-names>DE</given-names></name></person-group>
<year>2001</year>
<article-title>RHex: a simple and highly mobile hexapod robot</article-title>. <source>Int. J. Rob. Res.</source>
<volume>20</volume>, <fpage>616</fpage>&#x02013;<lpage>631</lpage>. (<pub-id pub-id-type="doi">10.1177/02783640122067570</pub-id>)</mixed-citation></ref><ref id="RSOS181911C9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Maufroy</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ahmadabadi</surname><given-names>MN</given-names></name>, <name name-style="western"><surname>Yazdanpanah</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2013</year>
<article-title>Robust hopping based on virtual pendulum posture control</article-title>. <source>Bioinspir. Biomim.</source>
<volume>8</volume>, <fpage>036002</fpage> (<pub-id pub-id-type="doi">10.1088/1748-3182/8/3/036002</pub-id>)<pub-id pub-id-type="pmid">23735558</pub-id></mixed-citation></ref><ref id="RSOS181911C10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Poulakakis</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Grizzle</surname><given-names>JW</given-names></name></person-group>
<year>2009</year>
<article-title>The spring loaded inverted pendulum as the hybrid zero dynamics of an asymmetric hopper</article-title>. <source>IEEE Trans. Autom. Control</source>
<volume>54</volume>, <fpage>1779</fpage>&#x02013;<lpage>1793</lpage>. (<pub-id pub-id-type="doi">10.1109/TAC.2009.2024565</pub-id>)</mixed-citation></ref><ref id="RSOS181911C11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maus</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Lipfert</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gross</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rummel</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2010</year>
<article-title>Upright human gait did not provide a major mechanical challenge for our ancestors</article-title>. <source>Nat. Commun.</source>
<volume>1</volume>, <fpage>70</fpage> (<pub-id pub-id-type="doi">10.1038/ncomms1073</pub-id>)<pub-id pub-id-type="pmid">20842191</pub-id></mixed-citation></ref><ref id="RSOS181911C12"><label>12</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2015</year>
<comment>FMCH: a new model for human-like postural control in walking. In <italic>IEEE/RSJ Int. Conf. on Intelligent Robots and Systems (IROS), Hamburg, Germany, 28 September&#x02013;2 October</italic>, pp. 5742&#x02013;5747. IEEE</comment>.</mixed-citation></ref><ref id="RSOS181911C13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wisse</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hobbelen</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Schwab</surname><given-names>AL</given-names></name></person-group>
<year>2007</year>
<article-title>Adding an upper body to passive dynamic walking robots by means of a bisecting hip mechanism</article-title>. <source>IEEE Trans. Rob.</source>
<volume>23</volume>, <fpage>112</fpage>&#x02013;<lpage>123</lpage>. (<pub-id pub-id-type="doi">10.1109/TRO.2006.886843</pub-id>)</mixed-citation></ref><ref id="RSOS181911C14"><label>14</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2014</year>
<comment>Stable running by leg force-modulated hip stiffness. In <italic>BioRob 2014: 5th IEEE RAS &#x00026; EMBS Int. Conf. on Biomedical Robotics and Biomechatronics, S&#x000e3;o Paulo, Brazil, 12&#x02013;15 August</italic>, pp. 204&#x02013;210. IEEE</comment>.</mixed-citation></ref><ref id="RSOS181911C15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<article-title>How locomotion sub-functions can control walking at different speeds?</article-title>
<source>J. Biomech.</source>
<volume>53</volume>, <fpage>163</fpage>&#x02013;<lpage>170</lpage>. (<pub-id pub-id-type="doi">10.1016/j.jbiomech.2017.01.018</pub-id>)<pub-id pub-id-type="pmid">28131486</pub-id></mixed-citation></ref><ref id="RSOS181911C16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hill</surname><given-names>A</given-names></name></person-group>
<year>1938</year>
<article-title>The heat of shortening and the dynamic constants of muscle</article-title>. <source>Proc. R. Soc. Lond. B</source>
<volume>126</volume>, <fpage>136</fpage>&#x02013;<lpage>195</lpage>. (<pub-id pub-id-type="doi">10.1098/rspb.1938.0050</pub-id>)</mixed-citation></ref><ref id="RSOS181911C17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Loeb</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>IE</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>EJ</given-names></name></person-group>
<year>1999</year>
<article-title>A hierarchical foundation for models of sensorimotor control</article-title>. <source>Exp. Brain Res.</source>
<volume>126</volume>, <fpage>1</fpage>&#x02013;<lpage>18</lpage>. (<pub-id pub-id-type="doi">10.1007/s002210050712</pub-id>)<pub-id pub-id-type="pmid">10333003</pub-id></mixed-citation></ref><ref id="RSOS181911C18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Iida</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Tedrake</surname><given-names>R</given-names></name></person-group>
<year>2010</year>
<article-title>Minimalistic control of biped walking in rough terrain</article-title>. <source>Auton. Rob.</source>
<volume>28</volume>, <fpage>355</fpage>&#x02013;<lpage>368</lpage>. (<pub-id pub-id-type="doi">10.1007/s10514-009-9174-3</pub-id>)</mixed-citation></ref><ref id="RSOS181911C19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haeufle</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Grimmer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2010</year>
<article-title>The role of intrinsic muscle properties for stable hopping&#x02013;stability is achieved by the force&#x02013;velocity relation</article-title>. <source>Bioinspir. Biomim.</source>
<volume>5</volume>, <fpage>016004</fpage> (<pub-id pub-id-type="doi">10.1088/1748-3182/5/1/016004</pub-id>)</mixed-citation></ref><ref id="RSOS181911C20"><label>20</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Aubert</surname><given-names>X</given-names></name></person-group>
<year>1956</year>
<comment><italic>Le Couplage &#x000e9;nerg&#x000e9;tique de la contraction musculaire, par Xavier Aubert. Th&#x000e8;se</italic>&#x02026; Brussels, Belgium: Editions Arscia</comment>.</mixed-citation></ref><ref id="RSOS181911C21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geyer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Blickhan</surname><given-names>R</given-names></name></person-group>
<year>2003</year>
<article-title>Positive force feedback in bouncing gaits?</article-title>
<source>Proc. R. Soc. B</source>
<volume>270</volume>, <fpage>2173</fpage>&#x02013;<lpage>2183</lpage>. (<pub-id pub-id-type="doi">10.1098/rspb.2003.2454</pub-id>)</mixed-citation></ref><ref id="RSOS181911C22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geyer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Herr</surname><given-names>H</given-names></name></person-group>
<year>2010</year>
<article-title>A muscle-reflex model that encodes principles of legged mechanics produces human walking dynamics and muscle activities</article-title>. <source>IEEE Trans. Neural Syst. Rehabil. Eng.</source>
<volume>18</volume>, <fpage>263</fpage>&#x02013;<lpage>273</lpage>. (<pub-id pub-id-type="doi">10.1109/TNSRE.2010.2047592</pub-id>)<pub-id pub-id-type="pmid">20378480</pub-id></mixed-citation></ref><ref id="RSOS181911C23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Geyer</surname><given-names>H</given-names></name></person-group>
<year>2015</year>
<article-title>A neural circuitry that emphasizes spinal feedback generates diverse behaviours of human locomotion</article-title>. <source>J. Physiol.</source>
<volume>593</volume>, <fpage>3493</fpage>&#x02013;<lpage>3511</lpage>. (<pub-id pub-id-type="doi">10.1113/JP270228</pub-id>)<pub-id pub-id-type="pmid">25920414</pub-id></mixed-citation></ref><ref id="RSOS181911C24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name></person-group>
<italic>et al.</italic>
<year>2016</year>
<article-title>A new biarticular actuator design facilitates control of leg function in BioBiped3</article-title>. <source>Bioinspir. Biomim.</source>
<volume>11</volume>, <fpage>046003</fpage> (<pub-id pub-id-type="doi">10.1088/1748-3190/11/4/046003</pub-id>)<pub-id pub-id-type="pmid">27367459</pub-id></mixed-citation></ref><ref id="RSOS181911C25"><label>25</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kiemel</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<comment>Fundamental subfunctions of locomotion. In <italic>Bioinspired legged locomotion: models, concepts, control and applications</italic> (eds M Sharbafi, A Seyfarth), pp. 11&#x02013;53. Oxford, UK: Elsevier</comment>.</mixed-citation></ref><ref id="RSOS181911C26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Geyer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>G&#x000fc;nther</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Blickhan</surname><given-names>R</given-names></name></person-group>
<year>2002</year>
<article-title>A movement criterion for running</article-title>. <source>J. Biomech.</source>
<volume>35</volume>, <fpage>649</fpage>&#x02013;<lpage>655</lpage>. (<pub-id pub-id-type="doi">10.1016/S0021-9290(01)00245-7</pub-id>)<pub-id pub-id-type="pmid">11955504</pub-id></mixed-citation></ref><ref id="RSOS181911C27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lu</surname><given-names>WC</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>PC</given-names></name></person-group>
<year>2018</year>
<article-title>Clock-torqued rolling SLIP model and its application to variable-speed running in a hexapod robot</article-title>. <source>IEEE Trans. Rob.</source>
<volume>34</volume>, <fpage>1643</fpage>&#x02013;<lpage>1650</lpage>. (<pub-id pub-id-type="doi">10.1109/TRO.2018.2862903</pub-id>)</mixed-citation></ref><ref id="RSOS181911C28"><label>28</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Sato</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Buehler</surname><given-names>M</given-names></name></person-group>
<year>2004</year>
<comment>A planar hopping robot with one actuator: design, simulation, and experimental results. In <italic>IEEE/RSJ Int. Conf. on Intelligent Robots and Systems (IROS), Sendai, Japan, 28 September&#x02013;2 October</italic>, pp. 3540&#x02013;3545. IEEE</comment>.</mixed-citation></ref><ref id="RSOS181911C29"><label>29</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Raibert</surname><given-names>MH</given-names></name></person-group>
<italic>et al.</italic>
<year>1989</year>
<comment><italic>Dynamically stable legged locomotion (September 1985&#x02013;September 1989)</italic>. Report No.: AITR-1179. Cambridge, MA: MIT</comment>.</mixed-citation></ref><ref id="RSOS181911C30"><label>30</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Sharbafi</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2016</year>
<comment>VBLA, a swing leg control approach for humans and robots. In: <italic>Humanoid robots, 2016 IEEE-RAS 16th Int. Conf. on.</italic> pp. 952&#x02013;957</comment>.</mixed-citation></ref><ref id="RSOS181911C31"><label>31</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Loeb</surname><given-names>G</given-names></name></person-group>
<year>1995</year>
<comment>Control implications of musculoskeletal mechanics. In <italic>Engineering in medicine and biology society, IEEE 17th Annual Conf.</italic>, vol. 2, pp. 1393&#x02013;1394. IEEE</comment>.</mixed-citation></ref><ref id="RSOS181911C32"><label>32</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Iida</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pfeifer</surname><given-names>R</given-names></name></person-group>
<year>2004</year>
<comment>Cheap rapid locomotion of a quadruped robot: self-stabilization of bounding gait. In <italic>Intelligent autonomous systems</italic>. vol. 8. pp. 642&#x02013;649</comment>.</mixed-citation></ref><ref id="RSOS181911C33"><label>33</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Bertsekas</surname><given-names>DP</given-names></name></person-group>
<year>1995</year>
<source>Dynamic programming and optimal control</source>. <volume>vol. 1</volume>
<publisher-name>Belmont, MA: Athena Scientific</publisher-name>.</mixed-citation></ref><ref id="RSOS181911C34"><label>34</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Lipfert</surname><given-names>SW</given-names></name></person-group>
<year>2010</year>
<source>Kinematic and dynamic similarities between walking and running</source>. <publisher-name>Hamburg, Germany: Verlag Dr. Kova&#x00109;</publisher-name>.</mixed-citation></ref><ref id="RSOS181911C35"><label>35</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Rode</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Siebert</surname><given-names>T</given-names></name></person-group>
<year>2017</year>
<comment>Muscle-like actuation for locomotion. In <italic>Bioinspired legged locomotion: models, concepts, control and applications</italic> (eds M Sharbafi, A Seyfarth), pp. 565&#x02013;590. Oxford, UK: Elsevier</comment>.</mixed-citation></ref><ref id="RSOS181911C36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pijnappels</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bobbert</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>van Die&#x000eb;n</surname><given-names>JH</given-names></name></person-group>
<year>2005</year>
<article-title>How early reactions in the support limb contribute to balance recovery after tripping</article-title>. <source>J. Biomech.</source>
<volume>38</volume>, <fpage>627</fpage>&#x02013;<lpage>634</lpage>. (<pub-id pub-id-type="doi">10.1016/j.jbiomech.2004.03.029</pub-id>)<pub-id pub-id-type="pmid">15652564</pub-id></mixed-citation></ref><ref id="RSOS181911C37"><label>37</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schumacher</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<article-title>Sensor-motor maps for describing linear reflex composition in hopping</article-title>. <source>Front. Comput. Neurosci.</source>
<volume>11</volume>, <fpage>108</fpage> (<pub-id pub-id-type="doi">10.3389/fncom.2017.00108</pub-id>)<pub-id pub-id-type="pmid">29230172</pub-id></mixed-citation></ref><ref id="RSOS181911C38"><label>38</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Logan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kiemel</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jeka</surname><given-names>JJ</given-names></name></person-group>
<year>2017</year>
<article-title>Using a system identification approach to investigate subtask control during human locomotion</article-title>. <source>Front. Comput. Neurosci.</source>
<volume>10</volume>, <fpage>46</fpage> (<pub-id pub-id-type="doi">10.3389/fncom.2016.00146</pub-id>)</mixed-citation></ref><ref id="RSOS181911C39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Matthews</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Farmer</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Ingram</surname><given-names>DA</given-names></name></person-group>
<year>1990</year>
<article-title>On the localization of the stretch reflex of intrinsic hand muscles in a patient with mirror movements</article-title>. <source>J. Physiol.</source>
<volume>428</volume>, <fpage>561</fpage>&#x02013;<lpage>577</lpage>. (<pub-id pub-id-type="doi">10.1113/jphysiol.1990.sp018228</pub-id>)<pub-id pub-id-type="pmid">2231424</pub-id></mixed-citation></ref><ref id="RSOS181911C40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Knutsson</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Richards</surname><given-names>C</given-names></name></person-group>
<year>1994</year>
<article-title>Different types of disturbed motor control in gait of hemiparetic patients</article-title>. <source>Brain</source>
<volume>102</volume>, <fpage>405</fpage>&#x02013;<lpage>430</lpage>. (<pub-id pub-id-type="doi">10.1093/brain/102.2.405</pub-id>)</mixed-citation></ref><ref id="RSOS181911C41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nathan</surname><given-names>PW</given-names></name></person-group>
<year>1994</year>
<article-title>Effects on movement of surgical incisions into the human spinal cord</article-title>. <source>Brain</source>
<volume>117</volume>, <fpage>337</fpage>&#x02013;<lpage>346</lpage>. (<pub-id pub-id-type="doi">10.1093/brain/117.2.337</pub-id>)<pub-id pub-id-type="pmid">7514479</pub-id></mixed-citation></ref><ref id="RSOS181911C42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Knarr</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Higginson</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Binder-MacLeod</surname><given-names>SA</given-names></name></person-group>
<year>2012</year>
<article-title>Validation of an adjustment equation for the burst superimposition technique in subjects post-stroke</article-title>. <source>Muscle Nerve</source>
<volume>46</volume>, <fpage>267</fpage>&#x02013;<lpage>269</lpage>. (<pub-id pub-id-type="doi">10.1002/mus.23431</pub-id>)<pub-id pub-id-type="pmid">22806377</pub-id></mixed-citation></ref><ref id="RSOS181911C43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Knarr</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Ramsay</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Buchanan</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Higginson</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Binder-Macleod</surname><given-names>SA</given-names></name></person-group>
<year>2013</year>
<article-title>Muscle volume as a predictor of maximum force generating ability in the plantar flexors post-stroke</article-title>. <source>Muscle Nerve</source>
<volume>48</volume>, <fpage>971</fpage>&#x02013;<lpage>976</lpage>. (<pub-id pub-id-type="doi">10.1002/mus.v48.6</pub-id>)<pub-id pub-id-type="pmid">23494851</pub-id></mixed-citation></ref><ref id="RSOS181911C44"><label>44</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peterson</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Kautz</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Neptune</surname><given-names>RR</given-names></name></person-group>
<year>2010</year>
<article-title>Pre-swing deficits in forward propulsion, swing initiation and power generation by individual muscles during hemiparetic walking</article-title>. <source>J. Biomech.</source>
<volume>43</volume>, <fpage>2348</fpage>&#x02013;<lpage>2355</lpage>. (<pub-id pub-id-type="doi">10.1016/j.jbiomech.2010.04.027</pub-id>)<pub-id pub-id-type="pmid">20466377</pub-id></mixed-citation></ref><ref id="RSOS181911C45"><label>45</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hall</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Peterson</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Kautz</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Neptune</surname><given-names>RR</given-names></name></person-group>
<year>2011</year>
<article-title>Relationships between muscle contributions to walking subtasks and functional walking status in persons with post-stroke hemiparesis</article-title>. <source>Clin. Biomech.</source>
<volume>26</volume>, <fpage>509</fpage>&#x02013;<lpage>515</lpage>. (<pub-id pub-id-type="doi">10.1016/j.clinbiomech.2010.12.010</pub-id>)</mixed-citation></ref><ref id="RSOS181911C46"><label>46</label><mixed-citation publication-type="std"><person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Sharbafi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Vlutters</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Van Asseldonk</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Seyfarth</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<comment>Template model inspired leg force feedback based control can assist human walking. In <italic>ICORR 2017: 15th IEEE Int. Conf. on Rehabilitation Robotics, London, UK, 17&#x02013;20 July</italic>, pp. 473&#x02013;478. IEEE</comment>.</mixed-citation></ref><ref id="RSOS181911C47"><label>47</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>M&#x000fc;ller</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rode</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aminiaghdam</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Vielemeyer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Blickhan</surname><given-names>R</given-names></name></person-group>
<year>2017</year>
<article-title>Force direction patterns promote whole body stability even in hip-flexed walking, but not upper body stability in human upright walking</article-title>. <source>Proc. R. Soc. A</source>
<volume>473</volume>, <fpage>20170404</fpage> (<pub-id pub-id-type="doi">10.1098/rspa.2017.0404</pub-id>)<pub-id pub-id-type="pmid">29225495</pub-id></mixed-citation></ref></ref-list></back></article>