<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="materials|methods" id="sec004" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Materials and Methods</div>
 <sec id="sec005" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Ethical Statement</div>
  <p xmlns="http://www.w3.org/1999/xhtml">This study was carried out with the approval of the Animal Experimentation Committee of the Royal Dutch Academy of Sciences.</p>
 </sec>
 <sec id="sec006" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Study Area and Field Work</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We analysed data from 1980 until 2010 from the Hoge Veluwe study area (52°059 N, 05°509 E, the Netherlands), where about 400 nest boxes are supplied in a 171 ha study area of mixed deciduous and coniferous forest. We only analysed data until 2010 to get reliable estimates of the number of recruits produced since about half of the offspring is found to recruit only two years after fledging as a breeding individual (see “Age at recruitment” in 
   <a rid="sec004" ref-type="sec" href="#sec004">Materials and Methods</a>). The broods of 1995 were excluded from all analyses since in this year almost all broods in the population were manipulated in a way that affected their breeding success [
   <a rid="pbio.1002120.ref061" ref-type="bibr" href="#pbio.1002120.ref061">61</a>].
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Nest boxes were checked weekly during the egg-laying period, and first egg-dates (henceforth called egg-laying dates) were calculated on the assumption that one egg is laid per day. We included only clutches that we considered as first clutches of females: repeats of known females that failed were excluded, as were all clutches that started &gt;30 d after the first egg-laying date in that year. During these regular checks, nest-building stages were reported. Adults were caught during chick feeding using nest box traps for identification based on their ring numbers. All nestlings were ringed with standard aluminium rings at an age of 7 to 12 d.</p>
 </sec>
 <sec id="sec007" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Capture Probabilities</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The observed temporal pattern in the strength of selection (
   <a rid="pbio.1002120.g001" ref-type="fig" href="#pbio.1002120.g001">Fig. 1A</a>) could be caused by a systematic change over the study period in how the adult recapture probabilities differed for birds hatched in late or in early-laid clutches. In order to test this possibility, we estimated survival and capture probabilities using a formal capture-mark-recapture analysis [
   <a rid="pbio.1002120.ref062" ref-type="bibr" href="#pbio.1002120.ref062">62</a>] using the software MARK [
   <a rid="pbio.1002120.ref063" ref-type="bibr" href="#pbio.1002120.ref063">63</a>]. We first fitted simple models, in which adult survival and recapture probability were constant over years and possibly only differed among the sexes. We then tested whether survival and recapture probabilities would differ among years and whether they depended on the egg-laying date of the clutch an individual was born in (“birth clutch lay date”), and whether this relationship differed between years, by adding the interaction of “birth clutch lay date” with year to the model. If recapture probabilities would depend on “birth clutch lay date,” and this relationship would differ among years, it could possibly bias our results.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">To test whether recapture probabilities could explain the observed selection and its temporal change, we fitted a range of capture-mark-recapture models in which recapture probability depended on sex, year (linear and squared effect), and the egg-laying date of the clutch from which an individual hatched. While there was clear support for a linear temporal change in recapture probability (
   <a rid="pbio.1002120.t003" ref-type="table" href="#pbio.1002120.t003">Table 3</a>, model 1), the support for a quadratic change of recapture probability over time was less clear (
   <a rid="pbio.1002120.t003" ref-type="table" href="#pbio.1002120.t003">Table 3</a>, model 2: Δ AICc = 2.0 and AICc weight = 0.27). However, we found no evidence for capture probability being correlated with birth clutch lay date (
   <a rid="pbio.1002120.t003" ref-type="table" href="#pbio.1002120.t003">Table 3</a>, model 4: Δ AICc = 9.7 and AICc weight = 0.005).
  </p>
  <div id="pbio.1002120.t003" orientation="portrait" position="float" class="table-wrap" xmlns="http://www.w3.org/1999/xhtml">
   <span pub-id-type="doi" class="object-id">10.1371/journal.pbio.1002120.t003</span>
   <span class="label">Table 3</span>
   <div class="caption">
    <div class="title">Results of capture-mark-recapture analysis.</div>
   </div>
   <div class="alternatives">
    <div id="pbio.1002120.t003g" xlink:href="pbio.1002120.t003" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    <table frame="hsides" rules="groups">
     <colgroup span="1">
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
     </colgroup>
     <thead>
      <tr>
       <th align="left" rowspan="1" colspan="1">Model</th>
       <th align="left" rowspan="1" colspan="1">AICc</th>
       <th align="left" rowspan="1" colspan="1">Δ AICc</th>
       <th align="left" rowspan="1" colspan="1">AICc Weight</th>
       <th align="left" rowspan="1" colspan="1">Likelihood</th>
       <th align="left" rowspan="1" colspan="1">No. parameters</th>
       <th align="left" rowspan="1" colspan="1">Model deviance</th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left" rowspan="1" colspan="1">1 Φ(s) p(s + y)</td>
       <td align="char" char="." rowspan="1" colspan="1">2704.5</td>
       <td align="left" rowspan="1" colspan="1">0</td>
       <td align="char" char="." rowspan="1" colspan="1">0.71</td>
       <td align="char" char="." rowspan="1" colspan="1">1.00</td>
       <td align="left" rowspan="1" colspan="1">5</td>
       <td align="char" char="." rowspan="1" colspan="1">2694.5</td>
      </tr>
      <tr>
       <td align="left" rowspan="1" colspan="1">2 Φ(s) p(s + y + y
        <span class="sup">2</span>)
       </td>
       <td align="char" char="." rowspan="1" colspan="1">2706.5</td>
       <td align="left" rowspan="1" colspan="1">2.0</td>
       <td align="char" char="." rowspan="1" colspan="1">0.27</td>
       <td align="char" char="." rowspan="1" colspan="1">0.37</td>
       <td align="left" rowspan="1" colspan="1">6</td>
       <td align="char" char="." rowspan="1" colspan="1">2694.4</td>
      </tr>
      <tr>
       <td align="left" rowspan="1" colspan="1">3 Φ(s) p(s)</td>
       <td align="char" char="." rowspan="1" colspan="1">2713.5</td>
       <td align="left" rowspan="1" colspan="1">9.0</td>
       <td align="char" char="." rowspan="1" colspan="1">0.008</td>
       <td align="char" char="." rowspan="1" colspan="1">0.011</td>
       <td align="left" rowspan="1" colspan="1">4</td>
       <td align="char" char="." rowspan="1" colspan="1">2705.46</td>
      </tr>
      <tr>
       <td align="left" rowspan="1" colspan="1">4 Φ(s) p(s + ld)</td>
       <td align="char" char="." rowspan="1" colspan="1">2714.2</td>
       <td align="left" rowspan="1" colspan="1">9.7</td>
       <td align="char" char="." rowspan="1" colspan="1">0.005</td>
       <td align="char" char="." rowspan="1" colspan="1">0.008</td>
       <td align="left" rowspan="1" colspan="1">5</td>
       <td align="char" char="." rowspan="1" colspan="1">2704.20</td>
      </tr>
      <tr>
       <td align="left" rowspan="1" colspan="1">5 Φ(.) p(.)</td>
       <td align="char" char="." rowspan="1" colspan="1">2714.5</td>
       <td align="left" rowspan="1" colspan="1">10.0</td>
       <td align="char" char="." rowspan="1" colspan="1">0.005</td>
       <td align="char" char="." rowspan="1" colspan="1">0.007</td>
       <td align="left" rowspan="1" colspan="1">2</td>
       <td align="char" char="." rowspan="1" colspan="1">2710.48</td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="table-wrap-foot">
    <fn id="t003fn001" class="fn" xmlns="">
     <p xmlns="http://www.w3.org/1999/xhtml">Survival probability (Φ) and recapture probability (p) were modelled depending on sex (s), year (y), year squared (y
      <span class="sup">2</span>), and egg-laying date of the clutch in which the individual was born (ld).
     </p>
    </fn>
   </div>
  </div>
 </sec>
 <sec id="sec008" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Male and Female Arrival Dates</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Male arrival date was determined from 2002 to 2010 through daily observations covering the whole study area, from April to early May by one to three trained observers. In our pied flycatcher population, males greatly vary in their plumage characteristics (i.e., size and shape of forehead patch and darkness of dorsal feathers; see [
   <a rid="pbio.1002120.ref064" ref-type="bibr" href="#pbio.1002120.ref064">64</a>]), and about half of them had been marked in previous years with aluminium and colour rings. We made notes of these features during our daily observations to characterise males singing at each nest box, allowing ascribing arrival dates—based on the similarity of features—to individual males, which were captured during chick feeding in the nest boxes. Pied flycatcher males commonly breed in the immediate surroundings of the area where they are first observed singing [
   <a rid="pbio.1002120.ref065" ref-type="bibr" href="#pbio.1002120.ref065">65</a>], and hence in most cases the description of the male repeatedly singing in a particular nest box matched the characteristics of the bird captured in it during breeding, which supports the validity of this approach to gather information on spring arrival phenology in this species (see [
   <a rid="pbio.1002120.ref065" ref-type="bibr" href="#pbio.1002120.ref065">65</a>] for a similar approach). This procedure allowed us to assign the arrival date in 571 cases (397 different individuals) in nine years, which is more than half of the males present in our study site.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">For female arrival date, we used the estimated start of nest building as proxy. Female flycatchers select a mate within hours upon their arrival [
   <a rid="pbio.1002120.ref066" ref-type="bibr" href="#pbio.1002120.ref066">66</a>,
   <a rid="pbio.1002120.ref067" ref-type="bibr" href="#pbio.1002120.ref067">67</a>], and they start nest building immediately after. Over the entire study period, the stage of nest building was scored (using a six-point scale, from little material to a complete nest) during the weekly nest checks. We assumed that little material meant that nest building had started the day of the check, whereas a complete nest started six days (i.e., the day after the previous nest box check) earlier (and other stages in between). The validity of this proxy was tested using observational data on arrival dates of male and female pied flycatchers in a nearby population (Dwingeloo, The Netherlands).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The Dwingeloo study area has 100 nest boxes and approximately 50 pairs of pied flycatchers annually. The same observer (CB) checked arriving pied flycatcher on a mostly daily basis from April 10 to May 15 for 2007, 2008, 2009, 2010, and 2013. Note that the years 2010 and 2013 were exceptionally cold springs, resembling what was normal during the early part of our time series (1980s), and therefore this allows us testing under the full range of environmental circumstances whether this proxy indeed can be used. Male flycatcher arrival was determined based on individual plumage characteristics (see above). Female arrival date was determined as the pairing date, which was often clearly visible because males reduced or completely stopped singing after being paired, and these behavioural changes were mostly confirmed by the observation of a female with the focal male. Nest boxes were checked at least once every five days, but more often to confirm female arrival, and the contents of the box were noted on the same six-point scale as at the Hoge Veluwe.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">To test whether female arrival date correlated well with the start of nest building, we used 194 observations in which female arrival date and the start of nest building were known. The estimated slope was 1.05 ± 0.02 (t
   <sub>1</sub> = 66.84, 
   <span class="italic">p</span> &lt; 0.001). These data clearly show the validity of using the start of nest building as proxy for female arrival, as there is an almost 1:1 relationship. However, it must be noted that if females give up their nest and renest, their arrival dates cannot be estimated from the start of nest building. Especially late nests therefore should be treated with caution, adding noise to the data and, especially in cases where a large fraction of nests are abandoned, this proxy becomes inappropriate. In our Hoge Veluwe study population, however, this is rarely the case.
  </p>
 </sec>
 <sec id="sec009" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Fitness Variables</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used the number of offspring produced that return as a breeding bird in the Hoge Veluwe population (local recruit) as a fitness measure. This number of recruits produced is the total number of recruits from first and replacement clutches (after a failed first clutch) within a single season.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">The number of recruits produced can be partitioned in two components, the number of fledglings produced and the probability for these fledglings to recruit. These two components can be affected by very different climatic variables, and hence we also analysed how these two components were affected by the selected climatic variables to gain more insight in how our overall fitness measure, the number of recruits, was related to climate variables. The number of fledglings was the number of chicks ringed minus the number of offspring found dead in the nest box after the offspring had fledged. The probability to recruit was calculated as the number of recruits per nest divided by the number of fledglings per nest (thus excluding the nests without fledglings). As capture probability of a locally recruiting offspring was not correlated with the egg-laying date of the brood a recruit originated from (see above and 
   <a rid="sec003" ref-type="sec" href="#sec003">Discussion</a>), we did not correct the number of recruiting offspring for capture probability. Note that an offspring is a recruit when it is caught at any age at the Hoge Veluwe, so even when birds are missed in their first breeding year, they are likely to be caught in their second year of breeding.
  </p>
 </sec>
 <sec id="sec010" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Age at Recruitment</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Most locally-hatched pied flycatchers are caught as breeding adults for the first time either in their first or second year after fledging: 32% of all male recruits returned to breed for the first time at age one and 54% at age two; this pattern is almost exactly reversed in female recruits, of which 59% returned at age one and 32% at age two. Only 14% (males) and 9% (females), respectively, returned at older ages to breed for the first time. Given our capture probabilities (see above), the records of birds breeding for the first time two years after fledging is unlikely to be due to birds breeding but not being identified in their first year after fledging.</p>
 </sec>
 <sec id="sec011" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Environmental Variables</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Data on daily mean and minimum temperature (°C) and rain duration (number of hours of rain in 24 hours) from the weather station directly adjacent to the study area (Deelen, 52°059 N, 05°509 E) were obtained from the Royal Dutch Meteorological Institute (KNMI; 
   <span ext-link-type="uri" xlink:href="http://www.knmi.nl/klimatologie/uurgegevens/#no" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.knmi.nl/klimatologie/uurgegevens/#no</span>). We used daily mean temperature as the predictor variable for the nestling period (defined per year as the period from the mean egg-laying date plus 18 d (6 d of egg laying plus 12 d of incubation) to mean egg-laying date plus 30 d (an additional 12 d of chick rearing) and the fledging period (defined per year as the period of the mean egg-laying date plus 31 d to mean egg-laying date plus 42 d (12 d of post-fledging care [
   <a rid="pbio.1002120.ref064" ref-type="bibr" href="#pbio.1002120.ref064">64</a>]). We used minimum temperature for the arrival period because we hypothesised that while nestling survival would be affected by a variety of factors better reflected by mean temperature, the survival of recruits upon arrival would depend on the severity of harsh conditions reflected by minimum temperatures.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Temperatures at the time of arrival in spring were calculated during the period when 90% of all females arrived (averaged over the 30 y). This “arrival period” was defined as the interval from the average annual 5% quantile (between-year standard deviation 5.3 d) until the average annual 95% quantile (between-year standard deviation 6.7 d) of female arrival dates (using nest building as proxy): April 23 until May 12. As most pied flycatchers were caught breeding for the first time either in their first or second year after fledging (see “Age at recruitment” in 
   <a rid="sec004" ref-type="sec" href="#sec004">Materials and Methods</a>), we took the average daily minimum temperature during the arrival period one and two years after fledging as a measure of environmental conditions upon first arrival. We used temperatures averaged over a fixed period because using temperatures measured over the realised arrival period, i.e., an annually variable period, would “reverse” causality: in that case, the behaviour of the birds would have determined the climatic variable rather than vice versa.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Caterpillars form an important prey for the nestlings of many passerine bird species including pied flycatchers [
   <a rid="pbio.1002120.ref037" ref-type="bibr" href="#pbio.1002120.ref037">37</a>], and caterpillar biomass has been monitored between 1985–2010 in the Hoge Veluwe-study area by collecting caterpillar droppings (“frass”) using special nets placed on the ground under oak trees (
   <span class="italic">Quercus robur</span>). “Frass” was collected two to three times a week, dried, sorted, and weighed. Caterpillar biomass was then calculated from its weight using the formula given in [
   <a rid="pbio.1002120.ref068" ref-type="bibr" href="#pbio.1002120.ref068">68</a>]. See [
   <a rid="pbio.1002120.ref011" ref-type="bibr" href="#pbio.1002120.ref011">11</a>] for more details on study area and the described methods.
  </p>
 </sec>
 <sec id="sec012" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Data Analysis</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We estimated annual standardised directional selection gradients following methods outlined in [
   <a rid="pbio.1002120.ref069" ref-type="bibr" href="#pbio.1002120.ref069">69</a>]. Briefly, we first characterised the relationship between egg-laying date and the number of local recruits produced, in each year using generalised linear models with a Poisson error structure. GLMs included linear and quadratic linear predictor scale regression terms (to detect directional, stabilising or disruptive selection), except for 1981, 1989, 1990, 1991, and 2006, where we fitted only linear regression terms because low numbers of recruits (&lt; 15) precluded fitting more complex models. Next, we used the R package gsg [
   <a rid="pbio.1002120.ref069" ref-type="bibr" href="#pbio.1002120.ref069">69</a>] to obtain yearly standardised directional selection gradients (sensu [
   <a rid="pbio.1002120.ref070" ref-type="bibr" href="#pbio.1002120.ref070">70</a>]), and their standard errors and 
   <span class="italic">p</span>-values using a parametric bootstrap algorithm. Because of the large statistical uncertainty associated with each annual selection gradient, we developed a method to robustly estimate the regression of selection gradients against predictors (e.g., year or environmental variables). We fitted the model β
   <sub>
    <span class="italic">t</span>
   </sub> ~ μ + 
   <span class="italic">b</span>
   <sub>1
    <span class="italic">t</span>
   </sub> + 
   <span class="italic">b</span>
   <sub>2
    <span class="italic">t</span>
   </sub>
   <span class="sup">2</span> + 
   <span class="italic">m</span>
   <sub>
    <span class="italic">t</span>
   </sub> + 
   <span class="italic">e</span>
   <sub>
    <span class="italic">t</span>
   </sub>, where β
   <sub>
    <span class="italic">t</span>
   </sub> are estimated selection gradients for year t, and 
   <span class="italic">m</span>
   <sub>
    <span class="italic">t</span>
   </sub> are deviates of estimated selection gradients from their unknown true values and are assumed to be drawn from the distributions N(0, SE
   <sub>
    <span class="italic">t</span>
   </sub>
   <span class="sup">2</span>), where SE
   <sub>
    <span class="italic">t</span>
   </sub> are the standard errors associated with each estimated selection gradients. 
   <span class="italic">b</span>
   <sub>1</sub> and 
   <span class="italic">b</span>
   <sub>2</sub> are regression coefficients relating selection to year. When testing whether other environmental variables affected selection strength, coefficients relating selection to these environmental variables were included similarly in addition to linear and quadratic effects of year. 
   <span class="italic">e</span>
   <sub>
    <span class="italic">t</span>
   </sub> are residuals, and are assumed to be normally distributed with estimated variance. We fitted the model by maximum likelihood, tested regression terms with LRTs, and approximated the standard errors of regression coefficients from the information matrix. The maximum likelihood techniques provided nearly identical inferences to a complimentary Bayesian approach implemented by extending the meta-analytic approaches used in [
   <a rid="pbio.1002120.ref071" ref-type="bibr" href="#pbio.1002120.ref071">71</a>]. When formally analysing stabilising selection, we pooled data (for reasons mentioned above), into the periods (1980–1989, 1990–1999, and 2000–2010) and regressed relative fitness against the linear and quadratic term of centred egg-laying date using the approach described above.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The relationship of single fitness components (number of recruits, number of fledglings and recruitment probability) with egg-laying date and environmental variables was tested with GLMMs, with year as random effect, to account for nonindependence of data from the same year with respect to the environmental variables that were measured at an annual scale. Female identity was included as random effect to account for females breeding in more than one year. Number of fledglings and recruits were analysed using a log-link and a Poisson error-distribution. An observation-level random effect was included in the Poisson models, the commonly observed overdispersion in reproductive success [
   <a rid="pbio.1002120.ref072" ref-type="bibr" href="#pbio.1002120.ref072">72</a>]. The recruitment probability per brood was analysed using a logit-link and a Binomial error-distribution.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The heritability of egg-laying date was calculated based on standard quantitative genetic approaches implemented in the so-called “animal model” ([
   <a rid="pbio.1002120.ref073" ref-type="bibr" href="#pbio.1002120.ref073">73</a>]. To account for year-to-year variation and age effects, year and age were included as fixed factors. Female identity was included as “permanent environment” random effect to account for repeated breeding events of the same female. The additive genetic effect was included as random effect to estimate heritability as the ration of the variance explained by the additive genetic effect over the total phenotypic variance (excluding year and age effects as these were fitted as fixed effects).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">All estimates are reported ± standard error.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">Data deposited in the Dryad repository: 
   <span ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.cv24c" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://dx.doi.org/10.5061/dryad.cv24c</span> [
   <a rid="pbio.1002120.ref074" ref-type="bibr" href="#pbio.1002120.ref074">74</a>].
  </p>
 </sec>
</sec>
