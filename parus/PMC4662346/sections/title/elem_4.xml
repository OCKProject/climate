<?xml version="1.0" encoding="UTF-8"?>
<sec class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Statistical analysis</div>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Controlling for statistical nonindependence of provenances</div>
  <p xmlns="http://www.w3.org/1999/xhtml">One way to address potential statistical nonindependence of populations within species is to incorporate expected similarities among populations (due to shared common ancestry and/or gene flow) as one or more variance–covariance matrices in the random effect structure of a generalized linear mixed model (Stone et al. 
   <a rid="b76" ref-type="bibr" href="#b76">2011</a>). Covariance matrices for nonindependence arising through each of migration and common ancestry can be generated for small numbers of populations using population genomic data (e.g., Hearn et al. 
   <a rid="b37" ref-type="bibr" href="#b37">2014</a>). However, for larger numbers of populations (as here), and where more limited genotypic data are available, an alternative is to use a measure of pairwise genetic differentiation between populations such as 
   <span class="italic">F</span>
   <sub>ST</sub> (Weir and Cockerham 
   <a rid="b86" ref-type="bibr" href="#b86">1984</a>) as an estimate of their expected covariance (Stone et al. 
   <a rid="b76" ref-type="bibr" href="#b76">2011</a>). Where genetic differentiation between populations correlates strongly with geographic distance, variance–covariance can be estimated as a function of geographic separation between populations.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">We used data from 10 putatively neutral microsatellite markers (listed in 
   <a ref-type="supplementary-material" rid="sd1" href="#sd1">Data S2</a>; Guichoux et al. 
   <a rid="b31" ref-type="bibr" href="#b31">2011</a>) available for 17 of our 20 study provenances (Table
   <a ref-type="table" rid="tbl1" href="#tbl1">1</a>) to estimate pairwise 
   <span class="italic">F</span>
   <sub>ST</sub> as implemented in 
   <span class="sc">fstat</span> version 2.8.3.2 (Weir and Cockerham 
   <a rid="b86" ref-type="bibr" href="#b86">1984</a>; Goudet 
   <a rid="b30" ref-type="bibr" href="#b30">1995</a>). For comments on the impact of using alternative measures of genetic differentiation related to 
   <span class="italic">F</span>
   <sub>ST</sub>, see 
   <a ref-type="supplementary-material" rid="sd2" href="#sd2">Data S2</a>. To allow us to analyse data for all 20 study provenances, we used the highly significant relationship between 
   <span class="italic">F</span>
   <sub>ST</sub> and geographic distance for the 17 provenances (Mantel test in the 
   <span class="italic">adegenet</span>
   <span class="sc">r</span> package, 
   <span class="italic">P </span>=
   <span class="italic"> </span>0.01 with 999 iterations) to estimate a pseudo-
   <span class="italic">F</span>
   <sub>ST</sub> for the full set of 20 provenances, referred to hereafter as 
   <span class="italic">GeoF</span>
   <sub>ST</sub> (full details are given in 
   <a ref-type="supplementary-material" rid="sd2" href="#sd2">Data S2</a>). Variance–covariances between provenances were then estimated as either 1−
   <span class="italic">F</span>
   <sub>ST</sub> or 1−
   <span class="italic">GeoF</span>
   <sub>ST</sub>, such that expected covariance was greatest between provenances with lowest differentiation.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">To explore the consequences of using alternative approaches to control for provenance nonindependence, all of the analyses described below were conducted using the following five dataset/covariance matrix combinations: (i) the subset of 17 provenances for which genotypic data were available, using an identity matrix as the provenance covariance matrix. This identity model assumes provenances to be statistically entirely independent (i.e., 0 covariance between all populations); (ii) the same 17 provenances, using a covariance matrix estimated as 1−
   <span class="italic">F</span>
   <sub>ST</sub>; (iii) the same 17 provenances, using a covariance matrix estimated as 1−
   <span class="italic">GeoF</span>
   <sub>ST</sub>; (iv) the full set of 20 provenances using an identity model; and (v) the full set of 20 provenances where covariance is estimated as 1−
   <span class="italic">GeoF</span>
   <sub>ST</sub>. A detailed discussion of this approach to addressing population nonindependence, and values used in the covariance matrices, are provided in the 
   <a ref-type="supplementary-material" rid="sd2" href="#sd2">Data S2</a>.
  </p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Statistical modelling of provenance effects on gall abundance</div>
  <p xmlns="http://www.w3.org/1999/xhtml">To investigate the influence of tree provenance on the abundance of each individual gall type, we combined the data for the two survey years and used generalized linear mixed models (GLMMs) to partition the variance of gall counts per shoot into the effects of year (as a fixed effect with two levels) and provenance, soil zone, plot and tree (all as random effects). When applying an identity model for the relationship between provenances, the effect of provenance was represented by a single random effect with a unique independent level for each provenance. In models that incorporated the relationship between provenances, provenance co-variance was represented by two random effects. One incorporated the specified variance–covariance matrix (1−
   <span class="italic">F</span>
   <sub>ST</sub> or 1−
   <span class="italic">GeoF</span>
   <sub>ST</sub>) to account for provenance nonindependence, while the second incorporated an identity matrix to capture the ‘nugget effect’ (Matheron 
   <a rid="b201" ref-type="bibr" href="#b201">1963</a>), in which variation in the response variable exceeds that expected through correlation between levels of the effect. Models were fitted in a Bayesian Markov Chain Monte Carlo (MCMC) framework using the package MCMCglmm version 2.16 (Hadfield 
   <a rid="b32" ref-type="bibr" href="#b32">2010</a>) in 
   <span class="sc">r</span> version 2.15.1. For fixed effects, prior settings assumed a normal distribution with a mean (
   <span class="italic">µ</span>) of 0 and a variance (
   <span class="italic">V</span>) of 10
   <span class="sup">8</span>. For random effect variances, scaled 
   <span class="italic">F</span>_{1,1} priors (with scale 1000) were used (Gelman 
   <a rid="b28" ref-type="bibr" href="#b28">2006</a>) except for the residual variance for which an inverse-gamma prior was used with shape and scale equal to 0.001. Models were run for 500 000 iterations with a burn-in of 50 000 and parameter sampling every 450 iterations. As the response variable was count data and usually contained many zeros, a Poisson error distribution was applied. Our incorporation of 
   <span class="italic">year</span> as a fixed effect allowed for variation in abundance between years, while estimating the relationship between gall abundance and tree phenotypic traits across both years. The proportion of variance explained by the 
   <span class="italic">year</span> fixed effect was estimated as the marginal 
   <span class="italic">R</span>
   <span class="sup">2</span> of the model (RsqM), following Nakagawa and Schielzeth (
   <a rid="b55" ref-type="bibr" href="#b55">2013</a>) (
   <span class="sc">r</span> code for deriving RsqM from MCMCglmm objects is provided in 
   <a ref-type="supplementary-material" rid="sd3" href="#sd3">Data S3</a>). The variance component of each random effect was calculated by dividing its estimated variance parameter by the sum of all the random effect variance parameters, including the residual UNIT term – a random effect with a distinct level for each data unit that is fitted automatically for Poisson distributed models in the MCMCglmm package to account for overdispersion – and then multiplying each by the proportion of variance not explained by the fixed effect (i.e., 1−RsqM). We addressed the effects of multiple tests on false discovery rates – the expected proportion of false discoveries among the rejected hypotheses – following Benjamini and Hochberg (
   <a rid="b8" ref-type="bibr" href="#b8">1995</a>) and Benjamini and Yekutieli (
   <a rid="b9" ref-type="bibr" href="#b9">2001</a>). The false discovery rate is a less stringent condition than the family-wise error rate, so this approach is more powerful than alternatives such as Bonferroni (Nakagawa 
   <a rid="b54" ref-type="bibr" href="#b54">2004</a>).
  </p>
 </sec>
</sec>
