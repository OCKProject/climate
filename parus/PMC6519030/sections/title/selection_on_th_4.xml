<?xml version="1.0" encoding="UTF-8"?>
<sec id="evo13660-sec-0050" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">SELECTION ON THE SLOPE AND ELEVATION OF THE GREAT TIT REACTION NORM</div>
 <p xmlns="http://www.w3.org/1999/xhtml">To estimate period‐specific (fecundity) selection on plasticity, we assigned each female with at least two breeding attempts to a breeding cohort (based on the first year a bird was observed breeding) and split the phenotypic dataset into three time periods as above. A female's lifetime reproductive success (LRS) was the sum of all recruits she produced over her lifetime. To avoid truncation of LRS of birds breeding in 1973, we added broods from earlier years (before 1973) to complete each individual's LRS. For the same reason, we removed all observations of birds from the 2013 breeding cohort or later, as some birds from these cohorts were still known to be breeding in 2017 and therefore had incomplete LRS. Hence, the periods in this analysis were 1969–1987, 1988–2001 and 2002–2012 (Table 
  <a rid="evo13660-tbl-0001" ref-type="table" href="#evo13660-tbl-0001">1</a>).
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">As pointed out above, some broods had been manipulated, likely affecting the female's fitness. Since we were interested in the lifetime fitness consequences of being more or less phenotypically plastic with respect to temperature, as well as having a higher or lower mean response (i.e., the elevation of the reaction norm), we opted to include manipulated broods in this analysis. The reason for this was that because the probability of having any of her broods manipulated increases with a female's age, discarding data from manipulated females would lead to a biased subset of shorter lived individuals. Consequently, the inclusion of manipulated broods in our analysis may create some noise in the selection estimates, but we nevertheless believe it is a superior approach to removing a nonrandom subset of individuals from the dataset.</p>
 <p xmlns="http://www.w3.org/1999/xhtml">For each of the three periods, we fitted a bivariate random regression model (RRM) in “MCMCglmm” (Hadfield 
  <a rid="evo13660-bib-0035" ref-type="ref" href="#evo13660-bib-0035">2010</a>; Hadfield 
  <a rid="evo13660-bib-0034" ref-type="ref" href="#evo13660-bib-0034">2014</a>) with laying date as a Gaussian and LRS as a (overdispersed) Poisson trait. Breaking down this bivariate model in scalar notation, the laying date (
  <span class="italic">z</span>) of the 
  <span class="italic">i</span>
  <span class="sup">th</span> individual in the 
  <span class="italic">j</span>
  <span class="sup">th</span> year in the 
  <span class="italic">k</span>
  <span class="sup">th</span> nest box within the 
  <span class="italic">l</span>
  <span class="sup">th</span> “environmental block” was modelled as 
  <div id="evo13660-disp-0001" class="disp-formula">
   <span class="label">(1)</span>
   <div id="nlm-math-2" class="math">
    <div displaystyle="true" class="mtable">
     <div class="mtr">
      <div columnalign="right" class="mtd">
       <div class="msub">
        <span class="mi">z</span>
        <span mathvariant="italic" class="mi">ijkl</span>
       </div>
      </div>
      <div class="mtd">
       <span class="mo">=</span>
      </div>
      <div columnalign="left" class="mtd">
       <div class="mrow">
        <div class="msub">
         <span class="mi">α</span>
         <span class="mi">z</span>
        </div>
        <span class="mo">+</span>
        <div class="msub">
         <span class="mi">a</span>
         <span class="mi">i</span>
        </div>
        <span class="mo">+</span>
        <div class="msub">
         <span class="mi">b</span>
         <span class="mi">i</span>
        </div>
        <div separators="" open="(" close=")" class="mfenced">
         <div class="mrow">
          <div class="msub">
           <span class="mi">T</span>
           <span mathvariant="italic" class="mi">ij</span>
          </div>
          <span class="mo">−</span>
          <div class="msub">
           <div class="mover">
            <span class="mi">T</span>
            <span class="mo">¯</span>
           </div>
           <span class="mi">i</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="mtr">
      <div class="mtd"/>
      <div class="mtd"/>
      <div columnalign="left" class="mtd">
       <div class="mrow">
        <span class="mo">+</span>
        <span width="0.33em" class="mspace"/>
        <span class="mi">b</span>
        <div class="msub">
         <div class="mover">
          <span class="mi">T</span>
          <span class="mo">¯</span>
         </div>
         <span class="mi">i</span>
        </div>
        <span class="mo">+</span>
        <span mathvariant="italic" class="mi">age</span>
        <div class="msub">
         <div class="mrow"/>
         <span mathvariant="italic" class="mi">ij</span>
        </div>
        <span class="mo">+</span>
        <span class="mi">n</span>
        <div class="msub">
         <span class="mi">b</span>
         <span class="mi">k</span>
        </div>
        <span class="mo">+</span>
        <span class="mi">y</span>
        <div class="msub">
         <span class="mi">r</span>
         <span class="mi">j</span>
        </div>
        <span class="mo">+</span>
        <div class="msub">
         <span class="mi">e</span>
         <div class="mrow">
          <span class="mi">z</span>
          <span class="mo">,</span>
          <span mathvariant="italic" class="mi">ijl</span>
         </div>
        </div>
        <span width="0.16em" class="mspace"/>
        <span class="mo">,</span>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>where 
  <div id="nlm-math-3" class="math">
   <div class="msub">
    <span class="mi">α</span>
    <span class="mi">z</span>
   </div>
  </div> is the overall mean laying date (intercept), 
  <div id="nlm-math-4" class="math">
   <div class="msub">
    <span class="mi">a</span>
    <span class="mi">i</span>
   </div>
  </div> and 
  <div id="nlm-math-5" class="math">
   <div class="msub">
    <span class="mi">b</span>
    <span class="mi">i</span>
   </div>
  </div> are the individual intercept and slope, respectively, related to temperature (
  <span class="italic">T</span>) and 
  <span class="italic">b</span> is the population‐level slope, 
  <div id="nlm-math-6" class="math">
   <div class="mrow">
    <span mathvariant="italic" class="mi">age</span>
    <div class="msub">
     <div class="mrow"/>
     <span mathvariant="italic" class="mi">ij</span>
    </div>
   </div>
  </div> is the female's age (first‐year breeder, older, or unknown), 
  <div id="nlm-math-7" class="math">
   <div class="mrow">
    <span class="mi">n</span>
    <div class="msub">
     <span class="mi">b</span>
     <span class="mi">k</span>
    </div>
   </div>
  </div> and 
  <div id="nlm-math-8" class="math">
   <div class="mrow">
    <span class="mi">y</span>
    <div class="msub">
     <span class="mi">r</span>
     <span class="mi">j</span>
    </div>
   </div>
  </div> are the 
  <span class="italic">k</span>
  <span class="sup">th</span> nest box and 
  <span class="italic">j</span>
  <span class="sup">h</span> year, respectively (treated as random effects with estimated variance 
  <div id="nlm-math-9" class="math">
   <div class="mrow">
    <span class="mi">n</span>
    <div class="msub">
     <span class="mi">b</span>
     <span class="mi">k</span>
    </div>
    <span class="mo">∼</span>
    <span class="mi">N</span>
    <div class="mrow">
     <span stretchy="false" class="mo">(</span>
     <div class="mrow">
      <span class="mn">0</span>
      <span class="mo">,</span>
      <div class="msubsup">
       <span class="mi">σ</span>
       <div class="mrow">
        <span class="mi">n</span>
        <span class="mi">b</span>
       </div>
       <span class="mn">2</span>
      </div>
     </div>
     <span stretchy="false" class="mo">)</span>
    </div>
   </div>
  </div> and 
  <div id="nlm-math-10" class="math">
   <div class="mrow">
    <span class="mi">y</span>
    <div class="msub">
     <span class="mi">r</span>
     <span class="mi">j</span>
    </div>
    <span class="mo">∼</span>
    <span class="mi">N</span>
    <div class="mrow">
     <span stretchy="false" class="mo">(</span>
     <div class="mrow">
      <span class="mn">0</span>
      <span class="mo">,</span>
      <div class="msubsup">
       <span class="mi">σ</span>
       <div class="mrow">
        <span class="mi">y</span>
        <span class="mi">r</span>
       </div>
       <span class="mn">2</span>
      </div>
     </div>
     <span stretchy="false" class="mo">)</span>
    </div>
   </div>
  </div>) and 
  <div id="nlm-math-11" class="math">
   <div class="msub">
    <span class="mi">e</span>
    <div class="mrow">
     <span class="mi">z</span>
     <span class="mo">,</span>
     <span mathvariant="italic" class="mi">ijl</span>
    </div>
   </div>
  </div> is the residual term. This residual term was estimated as 
  <div id="nlm-math-12" class="math">
   <div class="mrow">
    <div class="msub">
     <span class="mi">e</span>
     <div class="mrow">
      <span class="mi">z</span>
      <span class="mo">,</span>
      <span mathvariant="italic" class="mi">ijl</span>
     </div>
    </div>
    <span class="mo">∼</span>
    <span class="mi">N</span>
    <div class="mrow">
     <span stretchy="false" class="mo">(</span>
     <div class="mrow">
      <span class="mn">0</span>
      <span class="mo">,</span>
      <div class="msubsup">
       <span class="mi">σ</span>
       <div class="mrow">
        <span class="mi">e</span>
        <span class="mo">,</span>
        <span class="mi">l</span>
       </div>
       <span class="mn">2</span>
      </div>
     </div>
     <span stretchy="false" class="mo">)</span>
    </div>
   </div>
  </div>, where 
  <span class="italic">l</span> is one of two equal‐interval groups of years with similar temperatures, which was done to accommodate changes in residual variance along the temperature gradient (Lillehammer et al. 
  <a rid="evo13660-bib-0051" ref-type="ref" href="#evo13660-bib-0051">2009</a>; Nicolaus et al. 
  <a rid="evo13660-bib-0060" ref-type="ref" href="#evo13660-bib-0060">2013</a>). Temperature was divided into a within‐individual (
  <div id="nlm-math-13" class="math">
   <div class="mrow">
    <div class="msub">
     <span class="mi">b</span>
     <span class="mi">i</span>
    </div>
    <div class="mrow">
     <span stretchy="false" class="mo">(</span>
     <div class="mrow">
      <div class="msub">
       <span class="mi">T</span>
       <span mathvariant="italic" class="mi">ij</span>
      </div>
      <span class="mo">−</span>
      <div class="msub">
       <div class="mover">
        <span class="mi">T</span>
        <span class="mo">¯</span>
       </div>
       <span class="mi">i</span>
      </div>
     </div>
     <span stretchy="false" class="mo">)</span>
    </div>
   </div>
  </div>) and a between‐individual (
  <div id="nlm-math-14" class="math">
   <div class="mrow">
    <span class="mi">b</span>
    <div class="msub">
     <div class="mover">
      <span class="mi">T</span>
      <span class="mo">¯</span>
     </div>
     <span class="mi">i</span>
    </div>
   </div>
  </div>) component, following Van de Pol and Wright (
  <a rid="evo13660-bib-0090" ref-type="ref" href="#evo13660-bib-0090">2009</a>). This method disentangles any effect of temperature on laying date caused by having observed certain individuals only under certain temperatures and others under different temperatures (a between‐subject effect of 
  <span class="italic">T</span> on 
  <span class="italic">z</span>) from a real, within‐subject effect (but note that for the purpose of estimating variance in intercepts, centring may not be desired in all context; see Kreft et al. (
  <a rid="evo13660-bib-0045" ref-type="ref" href="#evo13660-bib-0045">1995</a>)).
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">A female's LRS (
  <span class="italic">W</span>) is described as 
  <div id="evo13660-disp-0002" class="disp-formula">
   <span class="label">(2)</span>
   <div id="nlm-math-15" class="math">
    <div class="mrow">
     <span form="prefix" class="mo">log</span>
     <span width="0.28em" class="mspace"/>
     <div class="mrow">
      <span stretchy="false" class="mo">(</span>
      <span class="mi">E</span>
      <div class="msub">
       <div class="mrow">
        <span stretchy="false" class="mo">[</span>
        <span class="mi">W</span>
        <span stretchy="false" class="mo">]</span>
       </div>
       <span class="mi">i</span>
      </div>
      <span stretchy="false" class="mo">)</span>
     </div>
     <span class="mo">=</span>
     <div class="msub">
      <span class="mi">α</span>
      <span class="mi">W</span>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <span class="mi">c</span>
      <span class="mi">i</span>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <span class="mi">e</span>
      <div class="mrow">
       <span class="mi">W</span>
       <span class="mo">,</span>
       <span class="mi">i</span>
      </div>
     </div>
     <span class="mo">,</span>
    </div>
   </div>
  </div>where 
  <div id="nlm-math-16" class="math">
   <div class="msub">
    <span class="mi">α</span>
    <span class="mi">W</span>
   </div>
  </div> is the overall mean LRS, 
  <div id="nlm-math-17" class="math">
   <div class="msub">
    <span class="mi">c</span>
    <span class="mi">i</span>
   </div>
  </div> is the individual intercept and 
  <div id="nlm-math-18" class="math">
   <div class="mrow">
    <div class="msub">
     <span class="mi">W</span>
     <span class="mi">i</span>
    </div>
    <span class="mo">∼</span>
    <span mathvariant="italic" class="mi">Poisson</span>
    <div class="mrow">
     <span stretchy="false" class="mo">(</span>
     <span class="mi">E</span>
     <div class="msub">
      <div class="mrow">
       <span stretchy="false" class="mo">[</span>
       <span class="mi">W</span>
       <span stretchy="false" class="mo">]</span>
      </div>
      <span class="mi">i</span>
     </div>
     <span stretchy="false" class="mo">)</span>
    </div>
   </div>
  </div>. We set the residual term, 
  <div id="nlm-math-19" class="math">
   <div class="msub">
    <span class="mi">e</span>
    <div class="mrow">
     <span class="mi">W</span>
     <span class="mo">,</span>
     <span class="mi">i</span>
    </div>
   </div>
  </div>, to a fixed small variance (0.01) since LRS is a repeated measures trait and laying date is not; ideally, we would constrain variance to 0 (Brommer et al. 
  <a rid="evo13660-bib-0008" ref-type="ref" href="#evo13660-bib-0008">2012</a>; Morrissey et al. 
  <a rid="evo13660-bib-0057" ref-type="ref" href="#evo13660-bib-0057">2012</a>), but since the MCMC chain does not mix well under these conditions a minimum nonzero value needs to be assigned.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">Variance in intercepts (
  <span class="italic">a</span>) and slopes (
  <span class="italic">b</span>) of the reaction norm (eq. 
  <a rid="evo13660-disp-0001" ref-type="disp-formula" href="#evo13660-disp-0001">(1)</a>), as well as in intercepts of LRS (
  <div id="nlm-math-20" class="math">
   <div class="mrow">
    <span class="mi">c</span>
    <span class="mo">;</span>
    <span width="0.33em" class="mspace"/>
   </div>
  </div>eq. 
  <a rid="evo13660-disp-0002" ref-type="disp-formula" href="#evo13660-disp-0002">(2)</a>) were jointly fitted as the random effect “female identity,” such that individual values were estimated as 
  <div id="evo13660-disp-0003" class="disp-formula">
   <div id="nlm-math-21" class="math">
    <div class="mrow">
     <div class="msub">
      <div separators="" open="[" close="]" class="mfenced">
       <div class="mtable">
        <div class="mtr">
         <div class="mtd">
          <span class="mi">a</span>
         </div>
        </div>
        <div class="mtr">
         <div class="mtd">
          <span class="mi">b</span>
         </div>
        </div>
        <div class="mtr">
         <div class="mtd">
          <span class="mi">c</span>
         </div>
        </div>
       </div>
      </div>
      <span class="mi">i</span>
     </div>
     <span class="mo">∼</span>
     <span class="mi">N</span>
     <div separators="" open="(" close=")" class="mfenced">
      <div class="mrow">
       <div separators="" open="[" close="]" class="mfenced">
        <div class="mtable">
         <div class="mtr">
          <div class="mtd">
           <span class="mn">0</span>
          </div>
         </div>
         <div class="mtr">
          <div class="mtd">
           <span class="mn">0</span>
          </div>
         </div>
         <div class="mtr">
          <div class="mtd">
           <span class="mn">0</span>
          </div>
         </div>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <div separators="" open="[" close="]" class="mfenced">
         <div class="mtable">
          <div class="mtr">
           <div class="mtd">
            <div class="msubsup">
             <span class="mi">σ</span>
             <span class="mi">a</span>
             <span class="mn">2</span>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msub">
              <span class="mi">σ</span>
              <div class="mrow">
               <span class="mi">a</span>
               <span class="mo">,</span>
               <span class="mi">b</span>
              </div>
             </div>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msub">
              <span class="mi">σ</span>
              <div class="mrow">
               <span class="mi">a</span>
               <span class="mo">,</span>
               <span class="mi">c</span>
              </div>
             </div>
            </div>
           </div>
          </div>
          <div class="mtr">
           <div class="mtd">
            <div class="msub">
             <span class="mi">σ</span>
             <div class="mrow">
              <span class="mi">a</span>
              <span class="mo">,</span>
              <span class="mi">b</span>
             </div>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msubsup">
              <span class="mi">σ</span>
              <span class="mi">b</span>
              <span class="mn">2</span>
             </div>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msub">
              <span class="mi">σ</span>
              <div class="mrow">
               <span class="mi">b</span>
               <span class="mo">,</span>
               <span class="mi">c</span>
              </div>
             </div>
            </div>
           </div>
          </div>
          <div class="mtr">
           <div class="mtd">
            <div class="msub">
             <span class="mi">σ</span>
             <div class="mrow">
              <span class="mi">a</span>
              <span class="mo">,</span>
              <span class="mi">c</span>
             </div>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msub">
              <span class="mi">σ</span>
              <div class="mrow">
               <span class="mi">b</span>
               <span class="mo">,</span>
               <span class="mi">c</span>
              </div>
             </div>
            </div>
           </div>
           <div class="mtd">
            <div class="mrow">
             <span width="1em" class="mspace"/>
             <div class="msubsup">
              <span class="mi">σ</span>
              <span class="mi">c</span>
              <span class="mn">2</span>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
        <span class="mi">i</span>
       </div>
      </div>
     </div>
     <span class="mo">,</span>
    </div>
   </div>
  </div>that is, drawn from a 3 × 3 unstructured, phenotypic covariance matrix with the variance components on the diagonals and the covariances between them on the off‐diagonals.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">To obtain independent samples from the MCMC sampling process, we used a thinning interval of 10
  <span class="sup">4</span>, a burn‐in period of 10
  <span class="sup">5</span> and a total sample size of 10.1 × 10
  <span class="sup">6</span> (i.e., an effective sample size of 1000). We used default normal priors for the fixed effects and parameter‐expanded priors for the random terms (V = diag(
  <span class="italic">n</span>), nu = 
  <span class="italic">n</span>, alpha.mu = 0, alpha.V = diag(
  <span class="italic">n</span>)*25^2, 
  <span class="italic">n</span> being the dimension of the matrix), following Hadfield (
  <a rid="evo13660-bib-0034" ref-type="ref" href="#evo13660-bib-0034">2014</a>). For the residual variance in equation 
  <a rid="evo13660-disp-0001" ref-type="disp-formula" href="#evo13660-disp-0001">(1)</a>, we used inverse‐Wishart priors with V = diag(2) and nu = 0.002.
 </p>
</sec>
