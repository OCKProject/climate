<?xml version="1.0" encoding="UTF-8"?>
<sec id="evo12635-sec-0270" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">UPDATE RULES FOR 
  <div id="nlm-math-345" class="math">
   <div class="msubsup">
    <div accent="true" class="mover">
     <span class="mi">z</span>
     <span class="mo">¯</span>
    </div>
    <div class="mrow">
     <span class="mi">t</span>
    </div>
    <span class="mo">*</span>
   </div>
  </div> AND COVARIANCES
 </div>
 <p xmlns="http://www.w3.org/1999/xhtml">To update the phenotypic components each time step, we also need to update 
  <div id="nlm-math-346" class="math">
   <div class="msubsup">
    <div accent="true" class="mover">
     <span class="mi">z</span>
     <span class="mo">¯</span>
    </div>
    <div class="mrow">
     <span class="mi">t</span>
    </div>
    <span class="mo">*</span>
   </div>
  </div>. Referring to equation 
  <a rid="evo12635-disp-0016" ref-type="disp-formula" href="#evo12635-disp-0016">(A3)</a> gives 
  <div id="evo12635-disp-0041" class="disp-formula">
   <span class="label">(A18)</span>
   <div id="nlm-math-347" class="math">
    <div class="mrow">
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">*</span>
     </div>
     <span class="mo">=</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">a</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">b</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msub">
      <span class="mi">ɛ</span>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mi">τ</span>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msubsup">
        <span class="mi">m</span>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <span class="mo">*</span>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">m</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mn">1</span>
      </div>
      <span class="mo">*</span>
     </div>
     <span class="mo">.</span>
    </div>
   </div>
  </div>To make further progress we approximate 
  <div id="nlm-math-348" class="math">
   <div class="mrow">
    <div class="msub">
     <span class="mi">C</span>
     <div class="mrow">
      <div class="msubsup">
       <span class="mi">m</span>
       <div class="mrow">
        <span class="mi">t</span>
       </div>
       <span class="mo">*</span>
      </div>
      <div class="msubsup">
       <span class="mi">z</span>
       <div class="mrow">
        <span class="mi">t</span>
        <span class="mo">−</span>
        <span class="mn">1</span>
       </div>
       <span class="mo">*</span>
      </div>
     </div>
    </div>
    <span class="mo">≈</span>
    <div class="msub">
     <span class="mi">C</span>
     <div class="mrow">
      <div class="msub">
       <span class="mi">m</span>
       <span class="mi">t</span>
      </div>
      <div class="msubsup">
       <span class="mi">z</span>
       <div class="mrow">
        <span class="mi">t</span>
        <span class="mo">−</span>
        <span class="mn">1</span>
       </div>
       <span class="mo">*</span>
      </div>
     </div>
    </div>
   </div>
  </div>, and so 
  <div id="evo12635-disp-0042" class="disp-formula">
   <span class="label">(A19)</span>
   <div id="nlm-math-349" class="math">
    <div class="mrow">
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">*</span>
     </div>
     <span class="mo">≈</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">a</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">b</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msub">
      <span class="mi">ɛ</span>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mi">τ</span>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msub">
        <span class="mi">m</span>
        <span class="mi">t</span>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">m</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mn">1</span>
      </div>
      <span class="mo">*</span>
     </div>
     <span class="mo">.</span>
    </div>
   </div>
  </div>To step forward in time for a given sequence of environments, we need to find 
  <div id="nlm-math-350" class="math">
   <div class="msub">
    <span class="mi">C</span>
    <div class="mrow">
     <div class="msub">
      <span class="mi">m</span>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msubsup">
      <span class="mi">z</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">*</span>
     </div>
    </div>
   </div>
  </div>, 
  <div id="nlm-math-351" class="math">
   <div class="msub">
    <span class="mi">C</span>
    <div class="mrow">
     <div class="msub">
      <span class="mi">a</span>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msubsup">
      <span class="mi">z</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">*</span>
     </div>
    </div>
   </div>
  </div>, and 
  <div id="nlm-math-352" class="math">
   <div class="msub">
    <span class="mi">C</span>
    <div class="mrow">
     <div class="msub">
      <span class="mi">b</span>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msubsup">
      <span class="mi">z</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">*</span>
     </div>
    </div>
   </div>
  </div> in terms of known quantities at time 
  <span class="italic">t</span>. From equation 
  <a rid="evo12635-disp-0020" ref-type="disp-formula" href="#evo12635-disp-0020">(A4)</a> we have 
  <div id="evo12635-disp-0043" class="disp-formula">
   <div id="nlm-math-353" class="math">
    <div class="mrow">
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msub">
        <span class="mi">m</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">=</span>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">m</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msub">
        <span class="mi">m</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="mfrac">
      <span class="mn">1</span>
      <span class="mn">2</span>
     </div>
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mn">1</span>
      </div>
      <span class="mo">*</span>
     </div>
     <div class="msub">
      <span class="mi">G</span>
      <div class="mrow">
       <span class="mi">m</span>
       <span class="mi">m</span>
      </div>
     </div>
     <span class="mo">.</span>
    </div>
   </div>
  </div>Under the weak selection, close to equilibrium assumption we approximate 
  <div id="nlm-math-354" class="math">
   <div class="mrow">
    <div class="msub">
     <span class="mi">C</span>
     <div class="mrow">
      <div class="msub">
       <span class="mi">m</span>
       <div class="mrow">
        <span class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <div class="msubsup">
       <span class="mi">z</span>
       <div class="mrow">
        <span class="mi">t</span>
        <span class="mo">−</span>
        <span class="mn">1</span>
       </div>
       <span class="mo">*</span>
      </div>
     </div>
    </div>
    <span class="mo">≈</span>
    <div class="mrow">
     <span class="mo">(</span>
     <span class="mn">1</span>
     <span class="mo">/</span>
     <span class="mn">2</span>
     <span class="mo">)</span>
    </div>
    <div class="msub">
     <span class="mi">C</span>
     <div class="mrow">
      <div class="msub">
       <span class="mi">m</span>
       <span class="mi">t</span>
      </div>
      <div class="msubsup">
       <span class="mi">z</span>
       <div class="mrow">
        <span class="mi">t</span>
        <span class="mo">−</span>
        <span class="mn">1</span>
       </div>
       <span class="mo">*</span>
      </div>
     </div>
    </div>
   </div>
  </div> to get 
  <div id="evo12635-disp-0044" class="disp-formula">
   <span class="label">(A20)</span>
   <div id="nlm-math-355" class="math">
    <div class="mrow">
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msub">
        <span class="mi">m</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">≈</span>
     <div class="mfrac">
      <span class="mn">1</span>
      <span class="mn">2</span>
     </div>
     <div class="msub">
      <div accent="true" class="mover">
       <span class="mi">m</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">+</span>
       <span class="mn">1</span>
      </div>
     </div>
     <div class="msub">
      <span class="mi">C</span>
      <div class="mrow">
       <div class="msub">
        <span class="mi">m</span>
        <span class="mi">t</span>
       </div>
       <div class="msubsup">
        <span class="mi">z</span>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
        <span class="mo">*</span>
       </div>
      </div>
     </div>
     <span class="mo">+</span>
     <div class="mfrac">
      <span class="mn">1</span>
      <span class="mn">2</span>
     </div>
     <div class="msubsup">
      <div accent="true" class="mover">
       <span class="mi">z</span>
       <span class="mo">¯</span>
      </div>
      <div class="mrow">
       <span class="mi">t</span>
       <span class="mo">−</span>
       <span class="mn">1</span>
      </div>
      <span class="mo">*</span>
     </div>
     <div class="msub">
      <span class="mi">G</span>
      <div class="mrow">
       <span class="mi">m</span>
       <span class="mi">m</span>
      </div>
     </div>
     <span class="mo">.</span>
    </div>
   </div>
  </div>From equations 
  <a rid="evo12635-disp-0035" ref-type="disp-formula" href="#evo12635-disp-0035">(A14)</a> and 
  <a rid="evo12635-disp-0036" ref-type="disp-formula" href="#evo12635-disp-0036">(A15)</a> we also have 
  <div id="evo12635-disp-0045" class="disp-formula">
   <span class="label">(A21)</span>
   <div id="nlm-math-356" class="math">
    <div displaystyle="true" class="mtable">
     <div class="mtr">
      <div columnalign="right" class="mtd">
       <div class="msub">
        <span class="mi">C</span>
        <div class="mrow">
         <div class="msub">
          <span class="mi">a</span>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msubsup">
          <span class="mi">z</span>
          <div class="mrow">
           <span class="mi">t</span>
          </div>
          <span class="mo">*</span>
         </div>
        </div>
       </div>
      </div>
      <div class="mtd">
       <div scriptlevel="0" displaystyle="true" class="mstyle">
        <div class="mrow">
         <span class="mo">≈</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <span class="mi">G</span>
          <div class="mrow">
           <span class="mi">a</span>
           <span class="mi">a</span>
          </div>
         </div>
         <span class="mo">+</span>
         <div class="msub">
          <div accent="true" class="mover">
           <span class="mi">m</span>
           <span class="mo">¯</span>
          </div>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">C</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">a</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">+</span>
             <span class="mn">1</span>
            </div>
           </div>
           <div class="msubsup">
            <span class="mi">z</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">−</span>
             <span class="mn">1</span>
            </div>
            <span class="mo">*</span>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="mtr">
      <div class="mtd"/>
      <div class="mtd">
       <div scriptlevel="0" displaystyle="true" class="mstyle">
        <div class="mrow">
         <span class="mo">≈</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <span class="mi">G</span>
          <div class="mrow">
           <span class="mi">a</span>
           <span class="mi">a</span>
          </div>
         </div>
         <span class="mo">+</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <div accent="true" class="mover">
           <span class="mi">m</span>
           <span class="mo">¯</span>
          </div>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">C</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">a</span>
            <span class="mi">t</span>
           </div>
           <div class="msubsup">
            <span class="mi">z</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">−</span>
             <span class="mn">1</span>
            </div>
            <span class="mo">*</span>
           </div>
          </div>
         </div>
         <span class="mo">,</span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div id="evo12635-disp-0046" class="disp-formula">
   <span class="label">(A22)</span>
   <div id="nlm-math-357" class="math">
    <div displaystyle="true" class="mtable">
     <div class="mtr">
      <div columnalign="right" class="mtd">
       <div class="msub">
        <span class="mi">C</span>
        <div class="mrow">
         <div class="msub">
          <span class="mi">b</span>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msubsup">
          <span class="mi">z</span>
          <div class="mrow">
           <span class="mi">t</span>
          </div>
          <span class="mo">*</span>
         </div>
        </div>
       </div>
      </div>
      <div class="mtd">
       <div scriptlevel="0" displaystyle="true" class="mstyle">
        <div class="mrow">
         <span class="mo">≈</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <span class="mi">G</span>
          <div class="mrow">
           <span class="mi">b</span>
           <span class="mi">b</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">ɛ</span>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">−</span>
           <span class="mi">τ</span>
          </div>
         </div>
         <span class="mo">+</span>
         <div class="msub">
          <div accent="true" class="mover">
           <span class="mi">m</span>
           <span class="mo">¯</span>
          </div>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">C</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">b</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">+</span>
             <span class="mn">1</span>
            </div>
           </div>
           <div class="msubsup">
            <span class="mi">z</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">−</span>
             <span class="mn">1</span>
            </div>
            <span class="mo">*</span>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="mtr">
      <div class="mtd"/>
      <div class="mtd">
       <div scriptlevel="0" displaystyle="true" class="mstyle">
        <div class="mrow">
         <span class="mo">≈</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <span class="mi">G</span>
          <div class="mrow">
           <span class="mi">b</span>
           <span class="mi">b</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">ɛ</span>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">−</span>
           <span class="mi">τ</span>
          </div>
         </div>
         <span class="mo">+</span>
         <div class="mfrac">
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <div class="msub">
          <div accent="true" class="mover">
           <span class="mi">m</span>
           <span class="mo">¯</span>
          </div>
          <div class="mrow">
           <span class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
         <div class="msub">
          <span class="mi">C</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">b</span>
            <span class="mi">t</span>
           </div>
           <div class="msubsup">
            <span class="mi">z</span>
            <div class="mrow">
             <span class="mi">t</span>
             <span class="mo">−</span>
             <span class="mn">1</span>
            </div>
            <span class="mo">*</span>
           </div>
          </div>
         </div>
         <span class="mo">,</span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>using the equivalent of approximations 
  <a rid="evo12635-disp-0037" ref-type="disp-formula" href="#evo12635-disp-0037">(A16)</a>.
 </p>
</sec>
