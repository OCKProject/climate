<?xml version="1.0" encoding="UTF-8"?>
<sec id="S0004-S2008" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Bioinformatic methods</div>
 <sec id="S0004-S2008-S3001" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Sequence processing</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Quality trimming was performed in short sequences with SeqyClean tool v. 1.9.10 [
   <a rid="CIT0039" href="#CIT0039">39</a>] using a Phred quality score ≥24 and a fragment size ≥50. The quality of the 
   <span class="italic">reads</span> was checked before and after the cleaning by FastQC v.0.11.3 [
   <a rid="CIT0072" href="#CIT0072">72</a>].
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">For the SNP assessment, the Tassel v.3.0 program was used to process the data [
   <a rid="CIT0073" href="#CIT0073">73</a>], while for CNV and methylation assessments, Stacks v.1.39 was used for de-multiplex the barcodes identifying individuals. For each sample stored in a FASTQ file, one identification map key file exists. This key file has the matching information of the sample, flow-cell and lane. The reads that begin with one of the expected barcodes (found in the key map) are followed by the expected cut site remnant (CTGCA for 
   <span class="italic">PstI</span>). For SNP calling, fragments were then trimmed to 64 bases and grouped into a single list called “master” by the TASSEL-GBS Discovery Pipeline. For methylation analysis and CNV calling this FASTQ information of each individual sample was stored to be further analyzed.
  </p>
 </sec>
 <sec id="S0004-S2008-S3002" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Alignment and coverage</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The alignment of quality-trimmed reads was performed using the Bowtie2 tool v.2.2.5 [
   <a rid="CIT0074" href="#CIT0074">74</a>] against the chicken reference sequence (
   <span class="italic">Gallus_gallus</span> 4.0, NCBI). For coverage analyses, Samtools v.0.1.19 [
   <a rid="CIT0075" href="#CIT0075">75</a>] with the ‘depth’ option was used in all the individuals that were de-multiplexed by the Stacks v.1.39 [
   <a rid="CIT0076" href="#CIT0076">76</a>] pipeline.
  </p>
 </sec>
 <sec id="S0004-S2008-S3003" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Identification of genetic variants</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The aligned reads were then used as input in the Tassel v.3.0 default pipeline [
   <a rid="CIT0073" href="#CIT0073">73</a>] for SNP identification. We aligned the sequences of each individual (from each breed) against our sequenced Red Jungle Fowl (RJF) reference genome. We filtered the polymorphisms initially identified based on the sequencing quality criteria and on the genomic bases identified. After individual SNP calling, we merged all the SNPs called for each breed to be filtered together following the parameters: i) minimum taxon call rate (mnTCov) of 20%; ii) minimum site coverage (mnScov) of 70%; iii) mismatch rate (misMat) of 5%; iv) minimum minor allele frequency (mnMAF) of 0.01. A more detailed description of these filters parameters was provided by Glaubitz et al. [
   <a rid="CIT0073" href="#CIT0073">73</a>].
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">For CNV calling, the aligned sequence files (.bam) of each individual (from each breed) were merged into unique files representing CNVs emerging within each breed (regarding RJF). The “view“ option from Samtools v.1.3.14 was used to generate a “hit” file from each unique file containing the coverage information for each base pair sequenced from each breed. This ”hit” file was then used for CNV calling by the CNV-Seq tool [
   <a rid="CIT0077" href="#CIT0077">77</a>] across the chicken genome (
   <span class="italic">Gallus_gallus</span> 4.0, NCBI) using default parameters.
  </p>
 </sec>
 <sec id="S0004-S2008-S3004" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Determination of relatedness between breeds</div>
  <p xmlns="http://www.w3.org/1999/xhtml">A cladogram was elaborated to determine relatedness between the domesticated breeds and RJF, using the Japanese quail (
   <span class="italic">Coturnix japonica</span>) as the outgroup. The sequencing reads from the Japanese quail were retrieved from a previous study [
   <a rid="CIT0078" href="#CIT0078">78</a>]. The Japanese quail sequencing reads were processed in a similar way as for the chicken breeds in regard to the cleaning and filtering criteria. The only difference was that the SNP call was performed using the Samtools v.0.1.19 [
   <a rid="CIT0075" href="#CIT0075">75</a>] program with default parameters. After this, the SNPs were merged with those from the chickens. A relatedness cladogram was then generated using the neighbour joining clustering method [
   <a rid="CIT0079" href="#CIT0079">79</a>] using bootstrap = 100 to determine relatedness between the domesticated chicken breed and RJF. The Japanese quail (
   <span class="italic">Coturnix japonica</span>) was used as the outgroup. The results were then plotted using the ‘ape’ package from the R repository. Additionally, we performed a Fixed Index (F
   <sub>st</sub>) analysis using the LOSITAN [
   <a rid="CIT0080" href="#CIT0080">80</a>] package (with default parameters) to identify SNPs evolving either under neutrality or balancing or positive selection. The F
   <sub>st</sub> analysis was based on 34,218 SNPs that were common among our four domesticated breeds, RJF and the Japanese quail.
  </p>
 </sec>
 <sec id="S0004-S2008-S3005" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Determination of states of methylation in CpG sites</div>
  <p xmlns="http://www.w3.org/1999/xhtml">A combination of R packages from both the CRAN and the Bioconductor projects was used to handle the DNA methylation data. A reference set of CpGs that contained all the CpG sites within the chicken (
   <span class="italic">Gallus gallus</span>) genome (UCSC version galGal4) was built to be compared with the CpGs obtained by our 
   <span class="italic">PstI</span>-MeDIP method. Based on this, the number of CpGs covered by our approach was defined. For the normalization of CpG coverage, we used the ‘calcNormFactors’ function from the edgeR package [
   <a rid="CIT0081" href="#CIT0081">81</a>]. With the normalized data, we performed a quasi-likelihood pipeline for differential methylation using negative binomial generalized linear models [
   <a rid="CIT0082" href="#CIT0082">82</a>] with F-tests instead of likelihood ratio tests [
   <a rid="CIT0083" href="#CIT0083">83</a>]. Dispersion estimates were then calculated based on the normalized data to determine the biological coefficient of variation (BCV), which represents inter-individual variability in DNA methylation. The BCV was then plotted using the edgeR function against the level of DNA methylation measured per window, represented by the average of CpGs coverage (expressed as the log of counts per million, logCPM) and termed ‘tags’ [
   <a rid="CIT0084" href="#CIT0084">84</a>] (
   <a rid="F0006" href="#F0006">Figure 6(a</a>)).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">We then proceeded to calculate tag-wise dispersion trends to determine how DNA methylation levels relate to BCV in general. As DNA methylation levels have non-identical and dependent distribution between windows, we employed an Empirical Bayes strategy that generated two kinds of trends [
   <a rid="CIT0085" href="#CIT0085">85</a>]. One trend line (red line in 
   <a rid="F0006" href="#F0006">Figure 6(a</a>)) assumes a normal distribution of all the tags (common dispersion), while the other (green line in 
   <a rid="F0006" href="#F0006">Figure 6(a</a>)) corresponds to the distribution of tags assuming non-identical methylation levels across the genome (adjusted dispersion) [
   <a rid="CIT0084" href="#CIT0084">84</a>]. In addition, we generated a distribution based on the ‘square root of the trended dispersion’ (blue line in 
   <a rid="F0006" href="#F0006">Figure 6(a</a>)). Information from these different distributions was used to establish the limits of our categories of CpG methylation levels and inter-individual variability in the sperm of RJF. The two intersection points between the ‘common’ and the ‘trended’ dispersions (coordinates −0.25; 1.35 Y and 2.40; 1.35) were calculated to define the X-axis thresholds dividing three coverage states, which correspond to levels of DNA methylation categorized as low (containing 71.1% of all tags), medium (containing 26.6% of all tags) or high (containing 2.3% of all tags).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">To define the Y-axis thresholds that divide states of inter-individual variation, we calculated the lowest and highest values of the ‘square root of the trended dispersion’, which corresponds, respectively, to the Y-axis values 0.86 and 1.83. These thresholds delimited three categories of inter-individual variation, namely low (containing 15.4% of all tags), medium (containing 67.7% of all tags) and high (containing 16.9% of all tags).</p>
 </sec>
 <sec id="S0004-S2008-S3006" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Comparison of SNPs and CNVs within CpG states</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Using R, we made tables with the positions of all the SNPs by breeds according to our reference or alternative alleles. We merged the SNPs of each breed with the CpGs coverage and dispersion states table. For the CNVs, we took the individual positions of each CNV range within each breed and merged these positions with the CpG table. From these merged files we were able to make all comparisons described in this manuscript in order to determine differences between the observations and expected values.</p>
 </sec>
 <sec id="S0004-S2008-S3007" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Bayesian analysis of CpG-related mutation rates</div>
  <p xmlns="http://www.w3.org/1999/xhtml">To assess the mutation probabilities per CpG category and breeds, we treated each SNP or CNV as a Bernoulli trial, where each location is either mutated or not. Using a Bayesian approach with the prior distribution for the mutation rate expressed by the beta distribution, the posterior density of the mutation probability of CpG category 
   <span class="italic">i</span> and breed 
   <span class="italic">j</span>, denoted 
   <div id="ILM0001" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0001.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1566" class="math">
      <div class="mrow">
       <div class="msub">
        <span class="mi">p</span>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mi">j</span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>, is given by 
   <div id="ILM0002" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0002.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1582" class="math">
      <div class="mrow">
       <div class="msub">
        <span class="mi">p</span>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mi">j</span>
        </div>
       </div>
      </div>
      <span class="mo">∼</span>
      <div class="mrow">
       <div class="mrow">
        <span mathvariant="normal" class="mi">B</span>
        <span mathvariant="normal" class="mi">e</span>
        <span mathvariant="normal" class="mi">t</span>
        <span mathvariant="normal" class="mi">a</span>
       </div>
      </div>
      <div open="[" close="]" class="mfenced">
       <div class="mrow">
        <span class="mi">α</span>
        <span class="mo">+</span>
        <div class="mrow">
         <div class="munderover">
          <span movablelimits="false" class="mo">∑</span>
          <div class="mrow">
           <span class="mi">k</span>
           <span class="mo">=</span>
           <span class="mn">1</span>
          </div>
          <div class="mrow">
           <div class="mrow">
            <div class="msub">
             <span class="mi">n</span>
             <div class="mrow">
              <span class="mi">i</span>
              <span class="mi">j</span>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="mrow">
         <div class="mrow">
          <div class="msub">
           <span class="mi">x</span>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mi">j</span>
            <span class="mi">k</span>
           </div>
          </div>
         </div>
        </div>
        <span class="mo">,</span>
        <span class="mi">β</span>
        <span class="mo">+</span>
        <div class="mrow">
         <div class="msub">
          <span class="mi">n</span>
          <div class="mrow">
           <span class="mi">i</span>
           <span class="mi">j</span>
          </div>
         </div>
        </div>
        <span class="mo">−</span>
        <div class="mrow">
         <div class="munderover">
          <span movablelimits="false" class="mo">∑</span>
          <div class="mrow">
           <span class="mi">k</span>
           <span class="mo">=</span>
           <span class="mn">1</span>
          </div>
          <div class="mrow">
           <div class="mrow">
            <div class="msub">
             <span class="mi">n</span>
             <div class="mrow">
              <span class="mi">i</span>
              <span class="mi">j</span>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="mrow">
         <div class="mrow">
          <div class="msub">
           <span class="mi">x</span>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mi">j</span>
            <span class="mi">k</span>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>, where 
   <div id="ILM0003" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0003.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1699" class="math">
      <div class="mrow">
       <div class="msub">
        <span class="mi">x</span>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mi">j</span>
         <span class="mi">k</span>
        </div>
       </div>
      </div>
      <span class="mo">=</span>
      <span class="mn">1</span>
     </div>
    </div>
   </div> if location 
   <span class="italic">k</span> in category 
   <span class="italic">i</span> and breed 
   <span class="italic">j</span> is mutated and otherwise 
   <div id="ILM0004" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0004.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1731" class="math">
      <div class="mrow">
       <div class="msub">
        <span class="mi">x</span>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mi">j</span>
         <span class="mi">k</span>
        </div>
       </div>
      </div>
      <span class="mo">=</span>
      <span class="mn">0</span>
     </div>
    </div>
   </div>, 
   <div id="ILM0005" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0005.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1753" class="math">
      <div class="mrow">
       <div class="msub">
        <span class="mi">n</span>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mi">j</span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div> the corresponding total number of locations, and 
   <div id="ILM0006" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0006.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1769" class="math">
      <span class="mi">α</span>
     </div>
    </div>
   </div> and 
   <div id="ILM0007" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0007.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1779" class="math">
      <span class="mi">β</span>
     </div>
    </div>
   </div> the prior parameters. We wanted to make inference primarily based on the data, and used Jeffreys prior to express a vague prior with 
   <div id="ILM0008" class="inline-formula">
    <div class="alternatives">
     <span xlink:href="kepi-14-07-1609868-eilm0008.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="d27e1788" class="math">
      <span class="mi">α</span>
      <span class="mo">=</span>
      <span class="mi">β</span>
      <span class="mo">=</span>
      <span class="mn">0.5</span>
     </div>
    </div>
   </div>.
  </p>
 </sec>
</sec>
