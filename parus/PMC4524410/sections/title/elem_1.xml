<?xml version="1.0" encoding="UTF-8"?>
<sec class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Conceptual Model Framework</div>
 <p xmlns="http://www.w3.org/1999/xhtml">The framework is based on IPMs for continuous traits and matrix models for discrete traits (and can include combinations of the two). For simplicity of notation we will present the model and results within the IPM framework, but all results are easily converted to the case of discrete traits, replacing integrals by sums. A schematic overview of the framework and the demographic outputs considered is given in 
  <a ref-type="fig" rid="fig01" href="#fig01">Fig. 1</a>, and a more detailed model description is given in 
  <a ref-type="supplementary-material" rid="SD1" href="#SD1">Appendix S1</a>. Calculations were done using the software R (R Development Core Team, 
  <a rid="b57" ref-type="bibr" href="#b57">2013</a>), and R code for all examples is provided as supplementary material.
 </p>
 <div position="float" class="boxed-text" xmlns="http://www.w3.org/1999/xhtml">
  <sec class="sec" xmlns="">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">Box 1 General description of integral projection models</div>
   <p xmlns="http://www.w3.org/1999/xhtml">Integral projection models (IPMs) were introduced for size-structured populations (Easterling 
    <span class="italic">et al</span>. 
    <a rid="b21" ref-type="bibr" href="#b21">2000</a>), and are the continuous-state analogue to matrix models. Both matrix models and IPMs belong to the same general model class of discrete time steps, and an IPM can be thought of as a high dimension matrix model. In the simplest case of an IPM, the population is structured according to one trait (e.g. size) 
    <span class="italic">x</span>, with a sample space 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu88.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> (e.g. the range from 0 to infinity in the case of size). In contrast to most matrix models, vital rates of IPMs are estimated from data using regression techniques. There is an implicit assumption that the structuring trait carries information that can be used to predict the vital rates. Two recent papers describe general methods for construction and analysis of IPMs from data, including numerical methods for calculation and model diagnosis (Merow 
    <span class="italic">et al</span>. 
    <a rid="b45" ref-type="bibr" href="#b45">2014</a>; Rees 
    <span class="italic">et al</span>. 
    <a rid="b58" ref-type="bibr" href="#b58">2014</a>).
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">The individual level processes of survival, reproduction and transition between trait values are characterised by four main vital rate functions: (1) survival probability 
    <span class="italic">s</span>(
    <span class="italic">x</span>), (2) a distribution 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu89.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> describing transition in trait value from 
    <span class="italic">x</span> to 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu90.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>, conditional on survival, (3) fecundity 
    <span class="italic">b</span>(
    <span class="italic">x</span>) and (4) a distribution 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu91.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> for offspring trait 
    <span class="italic">x</span>′ given parental trait 
    <span class="italic">x</span>. Together, these functions define the projection kernel,
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">
    <div class="disp-formula">
     <div xlink:href="ele0018-0417-m92.jpg" mimetype="image" position="float" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">The projection kernel describes the contribution from individuals in state 
    <span class="italic">x</span> to state 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu93.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> the next time step, in terms of survival/trait transitions and reproduction/offspring trait allocations. Letting 
    <span class="italic">n</span>(
    <span class="italic">x</span>) describe the population density of individuals across the trait 
    <span class="italic">x</span>, the total population size is 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu94.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>. The population size the next time step is given by 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu95.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>. By analysis of 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu96.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> we find the parameters describing asymptotic properties, i.e. the long-term growth rate 
    <span class="italic">λ</span> (average fitness), the stable structure 
    <span class="italic">u</span>(
    <span class="italic">x</span>) and reproductive values 
    <span class="italic">v</span>(
    <span class="italic">x</span>) (Easterling 
    <span class="italic">et al</span>. 
    <a rid="b21" ref-type="bibr" href="#b21">2000</a>). The functions 
    <span class="italic">u</span>(
    <span class="italic">x</span>) and 
    <span class="italic">v</span>(
    <span class="italic">x</span>) also define the sensitivity surface of 
    <span class="italic">λ</span> to the projection kernel (Ellner &amp; Rees 
    <a rid="b23" ref-type="bibr" href="#b23">2006</a>).
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">IPMs have been applied on a number of organisms from different taxa, with various extensions such as age structure, spatial structure, environmental drivers, density dependence, species interactions and demographic and environmental stochasticity (see summary and references in Rees 
    <span class="italic">et al</span>. 
    <a rid="b58" ref-type="bibr" href="#b58">2014</a>).
   </p>
  </sec>
 </div>
 <div id="fig01" position="float" class="fig" xmlns="http://www.w3.org/1999/xhtml">
  <span class="label">Figure 1</span>
  <div class="caption">
   <p>A schematic overview of the main model components and the demographic outputs considered in the analyses. Together with environmental variable(s) 
    <span class="italic">θ</span>, the dynamic trait 
    <span class="italic">x</span> and static trait 
    <span class="italic">y</span> define individual vital rate functions. Here, these are illustrated for a constant environment (only means are shown for the offspring trait distribution and the distribution of dynamic transitions). The offspring inheritance is a joint distribution for 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu1.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div> and 
    <div class="inline-formula">
     <span xlink:href="ele0018-0417-mu2.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>, in this illustration they are independent. Once vital rates are defined, demographic outputs are obtained by analysis of the projection kernel, for instance the stable structure and reproductive value in a given environment, as shown here. The final four outputs require an extension of the model to include demographic and/or environmental stochasticity (
    <a ref-type="supplementary-material" rid="SD1" href="#SD1">Appendix S1</a>).
   </p>
  </div>
  <div xlink:href="ele0018-0417-f1" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </div>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Static and dynamic traits</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Demographic models are often based on one or a few traits, typically age in matrix models, or body size in IPMs. To include individual heterogeneity in life histories, we propose a framework including two types of traits, classified as static and dynamic (Hill 
   <span class="italic">et al</span>. 
   <a rid="b31" ref-type="bibr" href="#b31">1999</a>). Static traits remain the same over the lifetime of an individual, or represent events that occur only once and have a lasting impact on the individual life history. Such traits can therefore capture individual effects beyond the population level average. Examples of static traits could be body size at birth, genotype or spatial location of a sessile organism. Dynamic traits are changing over the lifetime, randomly or non-randomly. Age and body size are particularly important cases of dynamic traits, as either one or both are often found to be a major determinant of vital rates (Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>). Other examples that may be important for some organisms include spatial location (mobile organisms), body condition, or social status. A non-comprehensive list of empirical studies including various types of static and dynamic traits is provided in Table 
   <a ref-type="table" rid="tbl1" href="#tbl1">1</a>. Among these, we see that the static trait is often some property of the environment, while the dynamic trait is often age, life-history stage or some measure of organism size.
  </p>
  <div id="tbl1" position="float" class="table-wrap" xmlns="http://www.w3.org/1999/xhtml">
   <span class="label">Table 1</span>
   <div class="caption">
    <p>Examples of empirical studies including static and dynamic traits (not a comprehensive overview), including the type of traits considered and the vital rates found to be affected by the static trait in the study species (not including theoretical model explorations). In most studies, the dynamic trait was found to affect all vital rates</p>
   </div>
   <table frame="hsides" rules="groups">
    <thead>
     <tr>
      <th align="left" rowspan="1" colspan="1">Species</th>
      <th align="left" rowspan="1" colspan="1">Dynamic trait</th>
      <th align="left" rowspan="1" colspan="1">Static trait</th>
      <th align="left" rowspan="1" colspan="1">Vital rates affected by static trait</th>
      <th align="left" rowspan="1" colspan="1">References</th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td align="left" rowspan="1" colspan="1">Pike (
       <span class="italic">Esox lucius</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Body length</td>
      <td align="left" rowspan="1" colspan="1">Length at age 1</td>
      <td align="left" rowspan="1" colspan="1">Growth</td>
      <td align="left" rowspan="1" colspan="1">This study, Vindenes 
       <span class="italic">et al</span>. (
       <a rid="b75" ref-type="bibr" href="#b75">2014</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Red-billed chough (
       <span class="italic">Pyrrhocorax pyrrhocorax</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Age</td>
      <td align="left" rowspan="1" colspan="1">Natal habitat</td>
      <td align="left" rowspan="1" colspan="1">Survival</td>
      <td align="left" rowspan="1" colspan="1">Reid 
       <span class="italic">et al</span>. (
       <a rid="b60" ref-type="bibr" href="#b60">2004</a>, 
       <a rid="b61" ref-type="bibr" href="#b61">2006</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Eurasian oystercatcher (
       <span class="italic">Haematopus ostralegus</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Life-history stage</td>
      <td align="left" rowspan="1" colspan="1">Natal habitat</td>
      <td align="left" rowspan="1" colspan="1">Survival, fecundity</td>
      <td align="left" rowspan="1" colspan="1">van de Pol 
       <span class="italic">et al</span>. (
       <a rid="b55" ref-type="bibr" href="#b55">2006</a>, 
       <a rid="b56" ref-type="bibr" href="#b56">2010</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Great tit (
       <span class="italic">Parus major</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Age</td>
      <td align="left" rowspan="1" colspan="1">Personality (behaviour in new environment)</td>
      <td align="left" rowspan="1" colspan="1">Survival, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Dingemanse 
       <span class="italic">et al</span>. (
       <a rid="b20" ref-type="bibr" href="#b20">2004</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Grey wolf (
       <span class="italic">Canis lupus</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Body weight</td>
      <td align="left" rowspan="1" colspan="1">Genotype (coat colour)</td>
      <td align="left" rowspan="1" colspan="1">Survival, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Coulson 
       <span class="italic">et al</span>. (
       <a rid="b16" ref-type="bibr" href="#b16">2011</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Columbian ground squirrel (
       <span class="italic">Urocitellus columbianus</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Body weight</td>
      <td align="left" rowspan="1" colspan="1">Sex</td>
      <td align="left" rowspan="1" colspan="1">Fecundity (mating function)</td>
      <td align="left" rowspan="1" colspan="1">Schindler 
       <span class="italic">et al</span>. (
       <a rid="b65" ref-type="bibr" href="#b65">2013</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Red deer (
       <span class="italic">Cervus elaphus</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Age class</td>
      <td align="left" rowspan="1" colspan="1">Environmental and density conditions in birth year</td>
      <td align="left" rowspan="1" colspan="1">Male survival, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Rose 
       <span class="italic">et al</span>. (
       <a rid="b64" ref-type="bibr" href="#b64">1998</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Roe deer (
       <span class="italic">Capreolus capreolus</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Body weight, age class</td>
      <td align="left" rowspan="1" colspan="1">Birth date</td>
      <td align="left" rowspan="1" colspan="1">Growth, survival</td>
      <td align="left" rowspan="1" colspan="1">Plard 
       <span class="italic">et al</span>. (
       <a rid="b54" ref-type="bibr" href="#b54">2015</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Brook trout (
       <span class="italic">Salvelinus fontinalis</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Age</td>
      <td align="left" rowspan="1" colspan="1">Habitat (food)</td>
      <td align="left" rowspan="1" colspan="1">Survival, growth, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Hutchings (
       <a rid="b32" ref-type="bibr" href="#b32">1992</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Coho salmon (
       <span class="italic">Oncorhynchus kisutch</span>) Chinook salmon (
       <span class="italic">O. tshawytscha</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Age</td>
      <td align="left" rowspan="1" colspan="1">Natal habitat (freshwater)</td>
      <td align="left" rowspan="1" colspan="1">Male fecundity, growth (maturation decision)</td>
      <td align="left" rowspan="1" colspan="1">Vøllestad 
       <span class="italic">et al</span>. (
       <a rid="b78" ref-type="bibr" href="#b78">2011</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Bulb mite (
       <span class="italic">Rhizoglyphus robini</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Body length</td>
      <td align="left" rowspan="1" colspan="1">Food type (habitat)</td>
      <td align="left" rowspan="1" colspan="1">Survival, growth, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Smallegange 
       <span class="italic">et al</span>. (
       <a rid="b68" ref-type="bibr" href="#b68">2014</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Lady orchid (
       <span class="italic">Orchis purpurea</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Total leaf area</td>
      <td align="left" rowspan="1" colspan="1">Habitat (light conditions)</td>
      <td align="left" rowspan="1" colspan="1">Survival, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Jacquemyn 
       <span class="italic">et al</span>. (
       <a rid="b34" ref-type="bibr" href="#b34">2010</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">Tree cholla cactus (
       <span class="italic">Opuntia imbricata</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Plant volume</td>
      <td align="left" rowspan="1" colspan="1">Elevation (herbivory level)</td>
      <td align="left" rowspan="1" colspan="1">Fecundity, growth</td>
      <td align="left" rowspan="1" colspan="1">Miller 
       <span class="italic">et al</span>. (
       <a rid="b48" ref-type="bibr" href="#b48">2009</a>)
      </td>
     </tr>
     <tr>
      <td align="left" rowspan="1" colspan="1">White hellebore (
       <span class="italic">Veratrum album</span>)
      </td>
      <td align="left" rowspan="1" colspan="1">Stem diameter</td>
      <td align="left" rowspan="1" colspan="1">Habitat type</td>
      <td align="left" rowspan="1" colspan="1">Survival, growth, fecundity</td>
      <td align="left" rowspan="1" colspan="1">Hesse 
       <span class="italic">et al</span>. (
       <a rid="b30" ref-type="bibr" href="#b30">2008</a>)
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">Static traits will often result from conditions of early development, a particularly important time in the life cycle of most organisms (Lindström, 
   <a rid="b42" ref-type="bibr" href="#b42">1999</a>; Beckerman 
   <span class="italic">et al</span>. 
   <a rid="b1" ref-type="bibr" href="#b1">2002</a>; Cam 
   <span class="italic">et al</span>. 
   <a rid="b5" ref-type="bibr" href="#b5">2003</a>; Monaghan, 
   <a rid="b49" ref-type="bibr" href="#b49">2008</a>). For instance, in early ontogenetic stages, nutritional conditions can have lasting effects on development and growth (Metcalfe &amp; Monaghan 
   <a rid="b47" ref-type="bibr" href="#b47">2001</a>). Maternal effects and cohort effects are general concepts characterising such early effects, and both are commonly found in natural populations (Beckerman 
   <span class="italic">et al</span>. 
   <a rid="b1" ref-type="bibr" href="#b1">2002</a>). Maternal effects represent parental influences beyond additive genetic effects (Mousseau &amp; Fox 
   <a rid="b50" ref-type="bibr" href="#b50">1998</a>), while cohort effects refer to lasting effects of environmental factors (Beckerman 
   <span class="italic">et al</span>. 
   <a rid="b1" ref-type="bibr" href="#b1">2002</a>). Moreover, in many organisms, the early stages of the life history often correspond to the time when individuals are most likely to migrate or disperse to new environments. Sessile organisms generally follow such a life history, but even in some mobile animals adults may show more limited dispersal than juveniles, for instance after they establish a territory.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">In a population model based on Markov processes, Tuljapurkar 
   <span class="italic">et al</span>. (
   <a rid="b71" ref-type="bibr" href="#b71">2009</a>) distinguished between dynamic and fixed heterogeneity in life-history trajectories. In that model dynamic heterogeneity referred to stochastic transitions between stages, while fixed heterogeneity referred to unobserved or measured differences generating random variation in life histories. These concepts are similar to our distinction between dynamic and static traits, but not quite the same since fixed vs. dynamic heterogeneity focus on classifying variability in stochastic processes. Here, we use the terms static and dynamic to classify the traits that structure the population.
  </p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Vital rates and projection kernel</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The vital rates are one way to summarise the life history of an organism (Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>). In IPMs, these are functions describing how survival, reproduction and trait development depend on the static and dynamic traits and the environment. For the sake of simplicity, we will consider cases with only one static and one dynamic trait, but note that in general the framework can include more than one trait of each type. Let 
   <span class="italic">x</span> and 
   <span class="italic">y</span> denote the dynamic and static trait, respectively, and let the environment be described by a variable 
   <span class="italic">θ</span> representing one or more environmental variables like temperature, rainfall or resource availability, taking a new value each time step. For simpler notation, we will omit 
   <span class="italic">θ</span> where suitable. Interactions between 
   <span class="italic">x</span>, 
   <span class="italic">y</span> and 
   <span class="italic">θ</span> over time will shape the life history (i.e. vital rates) of each individual, including mechanisms of inheritance (
   <a ref-type="fig" rid="fig01" href="#fig01">Fig. 1</a>). Each individual will have a constant value of 
   <span class="italic">y</span> set at birth, but will experience different values of 
   <span class="italic">x</span> and 
   <span class="italic">θ</span> over the lifetime. Together, the effects of the static and dynamic traits on the vital rates can be combined in a number of ways, including interactions between them, so that a range of different life histories can be modelled using only two traits.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The population density distribution describing the expected number of individuals across the two traits is given by the function 
   <span class="italic">n</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>). Changes in this joint distribution over time is described by the projection kernel, which is a function of all the underlying vital rate functions (Easterling 
   <span class="italic">et al</span>. 
   <a rid="b21" ref-type="bibr" href="#b21">2000</a>). For an IPM of static and dynamic traits, it is given by
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="m3" class="disp-formula">
    <div xlink:href="ele0018-0417-m3.jpg" mimetype="image" position="float" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    <span class="label">(1)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">where the survival kernel 
   <span class="bold">S</span> describes survival and transitions of the dynamic trait, while the reproduction kernel 
   <span class="bold">B</span> describes production of offspring including the offspring distribution of both traits. Two important aspects separate this model from a model defined for only one trait: (1) the Dirac delta function 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu4.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> enters the survival kernel to keep the static trait 
   <span class="italic">y</span> constant for an individual during its lifetime (in the case of a discrete trait matrix model this would be replaced by a Kronecker delta), and (2) in the reproduction kernel, the joint distribution 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu5.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> allows the static and the dynamic trait to be correlated at birth (or whenever offspring are counted), which is likely often the case. For example, if the static trait is within-season timing of birth and the dynamic trait is body size, then early born individuals will have more time to grow so that if offspring are counted as 1-year-olds the two traits will be correlated at this point.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The joint distribution 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu6.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> allows for many mechanisms of inheritance to be considered (Danchin, 
   <a rid="b19" ref-type="bibr" href="#b19">2013</a>), including (1) no inheritance, i.e. no effect of parental traits, (2) cohort effects through the environment 
   <span class="italic">θ</span>, (3) additive genetic inheritance of the static trait 
   <span class="italic">y</span> and (4) maternal effects (including epigenetic inheritance) through the dynamic trait 
   <span class="italic">x</span> and interactions with 
   <span class="italic">y</span> and/or 
   <span class="italic">θ</span>. The specific form of the offspring trait distribution 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu7.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> will in each case depend on the relevant mechanisms for inheritance, that may lead to a frequency-dependent model. The model definition here is general, and for each specific application, the potential mechanisms of inheritance should be considered. For instance, the general definition does not preclude mechanisms causing runaway selection (Darwinian demons). This could occur, for instance with directional selection on a trait where offspring values do not regress towards a mean.
  </p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Demographic outputs calculated from the model</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Several demographic outputs can be calculated based on the projection kernel or projection matrix (methods are essentially the same for matrix models and IPMs; Easterling 
   <span class="italic">et al</span>. 
   <a rid="b21" ref-type="bibr" href="#b21">2000</a>; Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>; Ellner &amp; Rees 
   <a rid="b23" ref-type="bibr" href="#b23">2006</a>). In particular, the dominant eigenvalue corresponds to the long-term population growth rate 
   <span class="italic">λ</span>, while the right and left eigenvectors correspond to the joint stable trait structure 
   <span class="bold">u</span> = 
   <span class="italic">u</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>) (scaled so that 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu8.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
   <span class="italic">u</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>)d
   <span class="italic">x</span>d
   <span class="italic">y</span> = 1) and reproductive values 
   <span class="bold">v</span> = 
   <span class="italic">v</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>) (scaled so that 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu9.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
   <span class="italic">u</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>)
   <span class="italic">v</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>)d
   <span class="italic">x</span>d
   <span class="italic">y</span> = 1), respectively (Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>; Ellner &amp; Rees 
   <a rid="b23" ref-type="bibr" href="#b23">2006</a>). The marginal distributions of 
   <span class="italic">x</span> and 
   <span class="italic">y</span> are found by integrating 
   <span class="italic">u</span>(
   <span class="italic">x</span>,
   <span class="italic">y</span>) with respect to the other trait. The stable structure and reproductive values also define the sensitivity (and elasticity) of 
   <span class="italic">λ</span> to the projection kernel (Ellner &amp; Rees 
   <a rid="b23" ref-type="bibr" href="#b23">2006</a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Other widely applied demographic outputs are the net reproductive rate and generation time. The net reproductive rate 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu10.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> describes the expected number of offspring over the lifetime. It is a measure of the level of reproductive output as well as the generation-to-generation population growth rate, while the generation time measures the timing of reproduction and life-history speed (Steiner 
   <span class="italic">et al</span>. 
   <a rid="b69" ref-type="bibr" href="#b69">2014</a>). For structured models with overlapping generations, different measures of generation time are available (Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>). Here, we will consider two of them, the time it takes for the population to grow by a factor 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu11.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>, 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu12.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> (Caswell, 
   <a rid="b7" ref-type="bibr" href="#b7">2001</a>), and the mean age of mothers in a population at the stable distribution, 
   <div class="inline-formula">
    <span xlink:href="ele0018-0417-mu13.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div> (Bienvenu 
   <span class="italic">et al</span>. 
   <a rid="b2" ref-type="bibr" href="#b2">2013</a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">So far, we have considered properties of a deterministic model in a constant environment. The model can also be extended to stochastic dynamics arising from demographic and environmental stochasticity (Vindenes 
   <span class="italic">et al</span>. 
   <a rid="b77" ref-type="bibr" href="#b77">2012</a>). Demographic stochasticity arises from inherent randomness in the processes of survival, reproduction and transitions of traits, while environmental stochasticity arises from fluctuations in the environment affecting the underlying vital rates (May, 
   <a rid="b44" ref-type="bibr" href="#b44">1973</a>). The demographic and environmental variance are parameters that measure the amount of each type of stochasticity in the population growth (Engen 
   <span class="italic">et al</span>. 
   <a rid="b26" ref-type="bibr" href="#b26">2009</a>; Vindenes 
   <span class="italic">et al</span>. 
   <a rid="b77" ref-type="bibr" href="#b77">2012</a>). In general, estimating the long-term properties of stochastic dynamics in structured populations is complicated by transient fluctuations in the trait distribution leading to temporal autocorrelation in the population size. Engen 
   <span class="italic">et al</span>. (
   <a rid="b25" ref-type="bibr" href="#b25">2007</a>) demonstrated for an age-structured model that the dynamics could be described by considering the total reproductive value, calculated using the reproductive values of the mean environment that work as a filter for the transient fluctuations. This method was later generalised to stage-structured cases, both for IPMs and matrix models (Vindenes 
   <span class="italic">et al</span>. 
   <a rid="b77" ref-type="bibr" href="#b77">2012</a>).
  </p>
 </sec>
</sec>
