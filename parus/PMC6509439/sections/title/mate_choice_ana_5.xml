<?xml version="1.0" encoding="UTF-8"?>
<sec id="ece35087-sec-0005" class="sec">
 <span class="label" xmlns="http://www.w3.org/1999/xhtml">2.3</span>
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Mate choice analysis</div>
 <p xmlns="http://www.w3.org/1999/xhtml">To test whether song sparrows pair nonrandomly at MHC class II, we compared genetic distances between socially mated pairs to the randomized set of possible opposite‐sex combinations based on adults captured at the site during the corresponding field season. Because some allelic pairs are more similar in sequence than others, rather than simply quantify allele sharing, we used UniFrac (Lozupone &amp; Knight, 
  <a rid="ece35087-bib-0038" ref-type="ref" href="#ece35087-bib-0038">2005</a>) to take into account phylogenetic distances between alleles. Based on a phylogeny of all alleles detected, the algorithm calculates the distance between two individuals’ translated MHC repertoires, such that two individuals with the identical set of alleles would have a UniFrac distance of zero and two individuals with alleles derived from completely different clades in the reference tree would have a UniFrac distance of one (Lozupone &amp; Knight, 
  <a rid="ece35087-bib-0038" ref-type="ref" href="#ece35087-bib-0038">2005</a>). We first constructed a maximum‐likelihood phylogeny of all alleles recovered, over both field seasons, using Whelan and Goldman (
  <a rid="ece35087-bib-0071" ref-type="ref" href="#ece35087-bib-0071">2001</a>) substitution with five discrete gamma categories. Based on this phylogeny, we calculated pairwise amino acid UniFrac distances for observed pairings (i.e., between socially mated pairs). Because genotype data were binary (i.e., presence or absence of an allele within an individual's genotype) rather than continuous, we calculated unweighted (qualitative) rather than weighted (quantitative) UniFrac. UniFrac distances were calculated using the package GUniFrac (Chen et al., 
  <a rid="ece35087-bib-0013" ref-type="ref" href="#ece35087-bib-0013">2012</a>), implemented in R 3.4.0 (R Core Team, 
  <a rid="ece35087-bib-0053" ref-type="ref" href="#ece35087-bib-0053">2017</a>).
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">We used a Monte Carlo simulation (Manly, 
  <a rid="ece35087-bib-0039" ref-type="ref" href="#ece35087-bib-0039">1997</a>) implemented in a custom Microsoft Excel macro (Neff, Garner, Heath, &amp; Heath, 
  <a rid="ece35087-bib-0047" ref-type="ref" href="#ece35087-bib-0047">2008</a>) to generate 10,000 randomized male–female adult pairings. Genotypes from which randomized pairings were drawn were sorted by year, such that, for example, an adult female captured at the field site in 2014 was assumed to have had the potential to pair with any of the adult males present in that year. We then calculated pairwise genetic distance for each randomized pairing using unweighted UniFrac as described above. Finally, we calculated the average genetic distance over the 40 observed social pairings and compared this to the expected distribution of genetic distances based on random mating.
 </p>
</sec>
