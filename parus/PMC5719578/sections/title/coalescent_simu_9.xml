<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec5" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Coalescent simulations</div>
 <p id="Par18" xmlns="http://www.w3.org/1999/xhtml">Coalescent simulations were conducted to uncover demographic changes through time. For each species studied, 17–34 (typically 25–34, except 17–19 for 
  <span class="italic">F. ruficapilla</span>, 
  <span class="italic">S. semitorques,</span> and 
  <span class="italic">P. monticolus</span>) individuals were sampled, a number sufficient to accurately estimate population size changes [
  <a ref-type="bibr" rid="CR38" href="#CR38">38</a>].
 </p>
 <p id="Par19" xmlns="http://www.w3.org/1999/xhtml">Genomic DNA was extracted using conventional proteinase 
  <span class="italic">K</span> digestion and phenol/chloroform extraction [
  <a ref-type="bibr" rid="CR39" href="#CR39">39</a>]. For each species, totally 25–31 nuclear loci (including introns and exons, see details in Additional file 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>: Table S2) were amplified and sequenced for all samples using published primers and protocols [
  <a ref-type="bibr" rid="CR40" href="#CR40">40</a>–
  <a ref-type="bibr" rid="CR42" href="#CR42">42</a>]. The DNA sequences were compiled in SeqMan 7.1.0 (DNAStar Inc., Madison, WI) and were aligned in Clustal X 1.83 [
  <a ref-type="bibr" rid="CR43" href="#CR43">43</a>]. Nuclear genotypes were phased using PHASE 2.1.1 [
  <a ref-type="bibr" rid="CR44" href="#CR44">44</a>] with five runs for 1000 iterations. Genotypes with low phasing probability (&lt; 0.60) were excluded from all subsequent analyses, considering their uncertainties [
  <a ref-type="bibr" rid="CR45" href="#CR45">45</a>]. Recombination within each locus was detected by three non-parametric methods (RDP, GENECONV and MAXCHI) with RDP 3.44 [
  <a ref-type="bibr" rid="CR46" href="#CR46">46</a>]. Evolutionary neutrality was tested using Tajima’s 
  <span class="italic">D</span> [
  <a ref-type="bibr" rid="CR47" href="#CR47">47</a>] and Fu and Li’s 
  <span class="italic">D*</span> [
  <a ref-type="bibr" rid="CR48" href="#CR48">48</a>] statistics in DnaSP 5.10.01 [
  <a ref-type="bibr" rid="CR49" href="#CR49">49</a>].
 </p>
 <p id="Par20" xmlns="http://www.w3.org/1999/xhtml">Bayesian coalescent inference of demographic history was conducted using BEAST 1.8.2 [
  <a ref-type="bibr" rid="CR50" href="#CR50">50</a>] with model selection. For each species, five demographic models were considered, including four parametric models (constant, expansion, exponential and logistic growth) and the flexible Bayesian Skygrid model [
  <a ref-type="bibr" rid="CR51" href="#CR51">51</a>]. The margin likelihoods of each model were estimated using both stepping-stone and path sampling methods [
  <a ref-type="bibr" rid="CR52" href="#CR52">52</a>] based on three replicates of 500 million MCMC generations with the HKY substitution model and strict molecular clocks, and compared by 
  <span class="italic">log Bayes factor</span> with values larger than three indicating a strong preference of one model against others [
  <a ref-type="bibr" rid="CR53" href="#CR53">53</a>]. Recent mounting evidence has suggested time-dependent rates of molecular evolution with faster rates over shorter time frames than what are calibrated by phylogenetic divergences, in some cases by half [
  <a ref-type="bibr" rid="CR54" href="#CR54">54</a>] to an order of magnitude [
  <a ref-type="bibr" rid="CR55" href="#CR55">55</a>, 
  <a ref-type="bibr" rid="CR56" href="#CR56">56</a>]. In present study, the BEAST analyses were first conducted with a fixing mean substitution rate across genes of 3.3 × 10
  <span class="sup">−9</span> substitutions per site per year (s/s/y) for Passeriformes [
  <a ref-type="bibr" rid="CR57" href="#CR57">57</a>], and then rescaled using 5-fold (i.e. 1.65 × 10
  <span class="sup">−8</span> s/s/y) and 10-fold (3.3 × 10
  <span class="sup">−9</span> s/s/y) faster rates, respectively, to test the sensitivity of the prior settings. Convergence for each run was visually inspected and diagnosed with an effective sample size &gt;200 in Tracer 1.6 [
  <a ref-type="bibr" rid="CR58" href="#CR58">58</a>]. Final plotting of the best-fit demographic model for each species was generated based on the combined MCMC generations after discarding the first 10% as burn-in.
 </p>
 <p id="Par21" xmlns="http://www.w3.org/1999/xhtml">In addition, we tested population expansions using a Bayesian algorithm implemented in LAMARC 2.1.8 [
  <a ref-type="bibr" rid="CR59" href="#CR59">59</a>] by inferring exponential population growth rates. Positive growth rates would indicate a growing population, while negative values suggest population shrinkage. We performed one short MCMC run (1000 samples, 100 steps as interval and 10,000 samples as burn-in) followed by a longer one (10,000 samples, 100 steps as interval and 10,000 samples as burn-in) for each species with default model priors. To improve search performance, a heating scheme was used with one cold and three heated chains with default temperature settings. Convergence on the parameter estimates was visually inspected in Tracer 1.6 with an effective sample size &gt;200.
 </p>
</sec>
