<?xml version="1.0" encoding="UTF-8"?>
<sec disp-level="2" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Climate-density–dependent population model</div>
 <p xmlns="http://www.w3.org/1999/xhtml">Because all the best models explaining variation in demographic rates retained an effect of mean winter temperatures (table S1), we standardized the variable “mean winter temperature” for the study period (that is, from 1979 to 2013) with the mean and the variance of the mean winter temperatures observed between 1921 and 2015 (fig. S4, left). Such standardization was useful for further population projections (see Climate and population projections). Each demographic rate may thus be defined as a function of density and mean winter temperature (table S2). Therefore, for given winter conditions and densities, age-specific survival and recruitment rates and also the number of immigrants joining the local population may be simulated (hereafter denoted as 
  <span class="italic">S</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub>, 
  <span class="italic">R</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub>, and 
  <span class="italic">I</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub>). As a result, the number of breeding females in the population 
  <span class="italic">N</span>
  <sub>sim
   <span class="italic">,t</span>
  </sub> may be simulated. Note that the number of immigrants joining the local population at 
  <span class="italic">t</span> + 1 
  <span class="italic">I</span>
  <sub>sim,
   <span class="italic">t</span>+1
  </sub> was simulated from the function defined in table S2 using a Poisson distribution.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">In detail, the total number of breeding females in the population at time 
  <span class="italic">t</span> + 1 
  <span class="italic">N</span>
  <sub>sim,</sub>
  <sub>
   <span class="italic">t</span>+1
  </sub> corresponded to the sum of breeding females in each age class 
  <span class="italic">i N</span>
  <sub>sim 
   <span class="italic">i,t</span>+1
  </sub> at time 
  <span class="italic">t</span> + 1 (
  <a ref-type="fig" rid="F1" href="#F1">Fig. 1B</a>)
  <div id="E7" class="disp-formula">
   <div id="m14" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">=</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">+</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">+</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">+</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
     </div>
    </div>
   </div>
   <span class="label">(7)</span>
  </div>
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">(i) Because most of the immigrant breeding females were females of age class 1 (on average, 82% during the study period and fluctuating between 58 and 100%; fig. S3), we assumed that 
  <span class="italic">N</span>
  <sub>sim 1,</sub>
  <sub>
   <span class="italic">t</span>+1
  </sub> (first term in 
  <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>) corresponded to the sum of the number of daughters that was locally recruited into the population 
  <span class="italic">n</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub> (that is, produced by the breeding females of each age class) and also of the number of immigrants 
  <span class="italic">I</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub> arriving into the population
  <div id="E8" class="disp-formula">
   <div id="m15" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">=</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">n</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">+</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">I</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
     </div>
    </div>
   </div>
   <span class="label">(8)</span>
  </div>
  <span class="italic">n</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub> was modeled using a Poisson distribution to include demographic stochasticity
  <div id="E9" class="disp-formula">
   <div id="m16" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">n</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">~</span>
      <span class="mo"> </span>
      <span class="mtext">Poisson</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">×</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">R</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
      <span class="mo">+</span>
      <span class="mo"> </span>
      <span class="mtext">Poisson</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">×</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">R</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
      <span class="mo">+</span>
      <span class="mo"> </span>
      <span class="mtext">Poisson</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">×</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">R</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
      <span class="mo">+</span>
      <span class="mo"> </span>
      <span class="mtext">Poisson</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">×</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">R</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
     </div>
    </div>
   </div>
   <span class="label">(9)</span>
  </div>
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">(ii) 
  <span class="italic">N</span>
  <sub>sim 2
   <span class="italic">,t</span>+1
  </sub> (second term in 
  <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>) corresponded to the number of females of age class 1 that survived from time 
  <span class="italic">t</span> to time 
  <span class="italic">t</span> + 1 and was modeled using a binomial process to include demographic stochasticity
  <div id="E10" class="disp-formula">
   <div id="m17" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">~</span>
      <span class="mo"> </span>
      <span class="mtext">Bin</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">,</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">S</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">1</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
     </div>
    </div>
   </div>
   <span class="label">(10)</span>
  </div>
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">(iii) Similarly, 
  <span class="italic">N</span>
  <sub>sim 3
   <span class="italic">,t</span>+1
  </sub> and 
  <span class="italic">N</span>
  <sub>sim 4
   <span class="italic">,t</span>+1
  </sub> (the third and fourth terms in 
  <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>, respectively) corresponded to the number of females in the previous age class that survived from time 
  <span class="italic">t</span> to time 
  <span class="italic">t</span> + 1
  <div id="E11" class="disp-formula">
   <div id="m18" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">~</span>
      <span class="mo"> </span>
      <span class="mtext">Bin</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">,</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">S</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">2</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
     </div>
    </div>
   </div>
   <span class="label">(11)</span>
  </div>
  <div id="E12" class="disp-formula">
   <div id="m19" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
        <span class="mo">+</span>
        <span class="mn">1</span>
       </div>
      </div>
      <span class="mo">~</span>
      <span class="mo"> </span>
      <span class="mtext">Bin</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">,</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">S</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">3</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
      <span class="mo">+</span>
      <span class="mo"> </span>
      <span class="mtext">Bin</span>
      <span stretchy="false" class="mo">(</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">N</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span class="mo">,</span>
      <div class="msub">
       <span mathvariant="italic" class="mi">S</span>
       <div class="mrow">
        <span class="mtext">sim</span>
        <span class="mo"> </span>
        <span class="mn">4</span>
        <span class="mo">,</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
      </div>
      <span stretchy="false" class="mo">)</span>
     </div>
    </div>
   </div>
   <span class="label">(12)</span>
  </div>
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">Therefore, for given winter conditions and densities, 
  <span class="italic">S</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub>, 
  <span class="italic">R</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub>, and 
  <span class="italic">I</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub> may be computed (from the relationships shown in table S2). To account for sources of environmental stochasticity due to processes other than covariates included in the model, a covariance matrix 
  <div class="inline-formula">
   <div id="m20" class="math">
    <div class="mrow">
     <div class="mrow">
      <span mathvariant="normal" class="mi">Σ</span>
     </div>
    </div>
   </div>
  </div> of “random year effect + 
  <div class="inline-formula">
   <div id="m21" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="normal" class="mi">ε</span>
       <div class="mrow">
        <div class="msub">
         <span mathvariant="italic" class="mi">S</span>
         <div class="mrow">
          <span mathvariant="italic" class="mi">i</span>
          <span class="mo">,</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>,” “random year effect + 
  <div class="inline-formula">
   <div id="m22" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="normal" class="mi">ε</span>
       <div class="mrow">
        <div class="msub">
         <span mathvariant="italic" class="mi">R</span>
         <div class="mrow">
          <span mathvariant="italic" class="mi">i</span>
          <span class="mo">,</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>,” and “random year effect + 
  <div class="inline-formula">
   <div id="m23" class="math">
    <div class="mrow">
     <div class="mrow">
      <div class="msub">
       <span mathvariant="normal" class="mi">ε</span>
       <div class="mrow">
        <div class="msub">
         <span mathvariant="italic" class="mi">I</span>
         <div class="mrow">
          <span mathvariant="italic" class="mi">t</span>
          <span class="mo">+</span>
          <span class="mn">1</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>” was estimated, and new residuals were generated from a multivariate normal distribution with a covariance matrix equal to 
  <div class="inline-formula">
   <div id="m24" class="math">
    <div class="mrow">
     <div class="mrow">
      <span mathvariant="normal" class="mi">Σ</span>
     </div>
    </div>
   </div>
  </div>. Then, 
  <span class="italic">N</span>
  <sub>sim 1
   <span class="italic">,t</span>+1
  </sub>, 
  <span class="italic">N</span>
  <sub>sim 2
   <span class="italic">,t</span>+1
  </sub>, 
  <span class="italic">N</span>
  <sub>sim 3
   <span class="italic">,t</span>+1
  </sub>, and 
  <span class="italic">N</span>
  <sub>sim 4
   <span class="italic">,t</span>+1
  </sub> that are functions of 
  <span class="italic">S</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub>, 
  <span class="italic">R</span>
  <sub>sim 
   <span class="italic">i,t</span>
  </sub> and 
  <span class="italic">I</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub>, may be computed (
  <a ref-type="disp-formula" rid="E8" href="#E8">Eqs. 8</a> to 
  <a ref-type="disp-formula" rid="E12" href="#E12">12</a>), and finally, the density 
  <span class="italic">N</span>
  <sub>sim
   <span class="italic">,t</span>+1
  </sub> may be simulated (
  <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>).
 </p>
</sec>
