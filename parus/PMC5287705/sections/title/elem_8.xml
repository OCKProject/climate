<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="materials|methods" disp-level="1" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">MATERIALS AND METHODS</div>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">General approach</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Our aim was to build a population model that includes climate effects on all demographic rates and at all ages of the life cycle of a white-throated dipper population while also accounting for other sources of environmental and demographic stochasticity and, in addition, density dependence. The model was built to, first, gain a good understanding of the demographic responses of the population to changes in its environment and, second, use this knowledge to project the fate of the population under different climate scenarios. We proceeded by several steps:</p>
  <p xmlns="http://www.w3.org/1999/xhtml">(i) We estimated the annual survival and recruitment rates of breeding females of age classes 1, 2, 3, and 4. We also jointly estimated the annual age-specific densities. These estimates were obtained from 1978 to 2013.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">(ii) We explored the effects of climate variables (mean winter temperature, mean winter precipitation, and NAO index) and density on age-specific survival and recruitment rates and also on the number of immigrants joining the population.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">(iii) On the basis of these relationships between demographic rates and climate-density, we built a CDDPM that predicts the age-specific numbers of breeding females under given conditions of climate-density. Using the observed time series of climate variables between 1979 and 2013, we reconstructed the past population structure and compared it with the observed number of breeding females during this period.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">(iv) By feeding this CDDPM with climate scenarios from the study area, we projected the population to mid-century and examined its properties (population structure and population size).</p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">White-throated dipper data</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The studied population is located in the river system of Lyngdalselva in southern Norway (58°08′–58°40′N, 6°56′–7°20′E). The study site covers 60 km inland from the river mouth, and the river is interrupted by Lake Lygne. The white-throated dipper (
   <span class="italic">C. cinclus</span>) is a 50- to 70-g small passerine bird species distributed in mountainous regions across the Palearctic. It is a short-lived species; the oldest breeding female recorded in our population was 8 years of age. This species depends on open water for foraging and running water for nesting. The amount of ice during the winter thus influences the availability of feeding and breeding habitats. Breeding sites are concentrated on the many small tributaries and on rapids in the main river. Locations of breeding territories span from sea level to an altitude of about 600 m above sea level.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">From 1978 to 2013, all breeding sites were visited during the nest building period to identify breeding pairs and record occupied nests, denoted as 
   <span class="italic">C</span>
   <sub>
    <span class="italic">t</span>
   </sub>. During visits in the breeding season, fledglings were ringed, ringed mothers were identified, and unringed mothers were given a ring to allow for future identifications. These unringed mothers (1094 over the study period, with 233 of them females of unknown age) were assumed to have immigrated into the population during the year in question. The following year, they are then considered to be local females. The mother was not identified in 88 of the occupied nests. Overall, 992 breeding females of known age (local and immigrant) were monitored, providing capture-recapture (CR) data of known age females. Moreover, ringed fledglings were recorded as recruited to the breeding population if they were caught breeding in a subsequent year. From the monitoring of breeding females of known age, we reported for each year 
   <span class="italic">t</span> the observed number of breeding females in age class 
   <span class="italic">i</span> (
   <span class="italic">B</span>
   <sub>
    <span class="italic">i,t</span>
   </sub>) and also the observed number of locally recruited females produced per age class 
   <span class="italic">i</span> (
   <span class="italic">J</span>
   <sub>
    <span class="italic">i,t</span>
   </sub>). In total, this type of demographic data based on reproductive success consisted of 1880 breeding events. One hundred fourteen females were locally recruited.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Estimating annual age-specific demographic rates and densities using an IPM</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We simultaneously integrated the recorded number of occupied nests (
   <span class="italic">C</span>
   <sub>
    <span class="italic">t</span>
   </sub>), CR data of females with known age, and data on reproductive success (that is, 
   <span class="italic">B</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> and 
   <span class="italic">J</span>
   <sub>
    <span class="italic">i,t</span>
   </sub>) into a Bayesian integrated population model (IPM) (
   <a rid="R18" ref-type="bibr" href="#R18">
    <span class="italic">18</span>
   </a>). This allows estimating annual survival, recruitment, and densities (that is, the number of breeding females 
   <span class="italic">N</span>) for each age class. Note that we defined density here as the annual number of breeding females because of the complexity of the breeding system in this species (
   <a rid="R13" ref-type="bibr" href="#R13">
    <span class="italic">13</span>
   </a>). Females become reproductively mature in their first spring, which is the second calendar year of life. We used four age classes of breeding females, with age class 1 corresponding to the first year of breeding (second calendar year of life), age class 2 to the second year of breeding and third calendar year of life, age class 3 to the third year of breeding and fourth calendar year of life, and age class 4 to older breeding females. The joint analysis of these three data sets (recorded number of occupied nests, CR data, and data on reproductive success) increases the precision of the estimates of the shared parameters. Such a framework allows accounting for observation error associated with the recorded number of nests (
   <a rid="R19" ref-type="bibr" href="#R19">
    <span class="italic">19</span>
   </a>), for the incomplete information on age structure in the monitoring data (for example, some females are of unknown age), for imperfect detection (for example, recapture probability is not 1), for emigration in the first year of life, which is potentially high in this species (
   <a rid="R20" ref-type="bibr" href="#R20">
    <span class="italic">20</span>
   </a>), and for demographic stochasticity (
   <a rid="R21" ref-type="bibr" href="#R21">
    <span class="italic">21</span>
   </a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The model was fitted within the Bayesian framework, and noninformative priors were specified for all the parameters, allowing the inference to be dominated by information in the data and not by the information in the priors. Markov chain Monte Carlo (MCMC) simulation was used for parameter estimation. To assess convergence, we ran four independent chains with different starting values for 1,000,000 MCMC iterations, with a burn-in of 500,000 iterations, thinning every 1000th observation and resulting in 2000 posterior samples. We used the Brooks and Gelman diagnostic 
   <div class="inline-formula">
    <div id="m3" class="math">
     <div class="mrow">
      <div class="mrow">
       <div accent="true" class="mover">
        <span mathvariant="italic" class="mi">R</span>
        <span stretchy="true" class="mo">^</span>
       </div>
      </div>
     </div>
    </div>
   </div> to assess the convergence of the simulations and used the rule 
   <div class="inline-formula">
    <div id="m4" class="math">
     <div class="mrow">
      <div class="mrow">
       <div accent="true" class="mover">
        <span mathvariant="italic" class="mi">R</span>
        <span stretchy="true" class="mo">^</span>
       </div>
       <span class="mo">&lt;</span>
       <span class="mn">1.02</span>
      </div>
     </div>
    </div>
   </div> to determine whether convergence was reached (
   <a rid="R22" ref-type="bibr" href="#R22">
    <span class="italic">22</span>
   </a>). The analyses were implemented using JAGS version 3.4.0 (
   <a rid="R23" ref-type="bibr" href="#R23">
    <span class="italic">23</span>
   </a>) called from R version 3.1.1 (
   <a rid="R24" ref-type="bibr" href="#R24">
    <span class="italic">24</span>
   </a>) with package R2jags (
   <a rid="R25" ref-type="bibr" href="#R25">
    <span class="italic">25</span>
   </a>). For a full description of the IPM, the priors used, and the R code to fit the IPM, see the example on great tit 
   <span class="italic">Parus major</span> (
   <a rid="R26" ref-type="bibr" href="#R26">
    <span class="italic">26</span>
   </a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The IPM allowed us to estimate for each year 
   <span class="italic">t</span> the posterior means and the 95% credible intervals (CRIs) of the apparent survival rates 
   <span class="italic">S</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> between age class 
   <span class="italic">i</span> and 
   <span class="italic">i</span> + 1 and the recruitment rates 
   <span class="italic">R</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> (that is, the contribution of breeding females of age class 
   <span class="italic">i</span> to recruitment into the age class 1 breeding class next year) (fig. S1). We also estimated for each year 
   <span class="italic">t</span> the number of local (
   <span class="italic">N</span>
   <sub>local
    <span class="italic">,t</span>
   </sub>) and immigrant (
   <span class="italic">I</span>
   <sub>
    <span class="italic">t</span>
   </sub>) breeding females in each age class 
   <span class="italic">N</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> and in total 
   <span class="italic">N</span>
   <sub>
    <span class="italic">t</span>
   </sub> (fig. S3). To ensure that the priors for initial population sizes did not influence estimates of demographic rates and density in each age class during the first year of the study (that is, in 1978), we considered estimates provided by our IPM from 1979 onward.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Climate data</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Both global and local weather conditions during the winter months have been shown to influence the growth rate of this population (
   <a rid="R12" ref-type="bibr" href="#R12">
    <span class="italic">12</span>
   </a>, 
   <a rid="R13" ref-type="bibr" href="#R13">
    <span class="italic">13</span>
   </a>). As a measure of global winter conditions, we used the extended winter NAO index (December to March). This index is a commonly used weather variable influencing numerous winter climatic variables in the Northern Hemisphere (
   <a rid="R14" ref-type="bibr" href="#R14">
    <span class="italic">14</span>
   </a>, 
   <a rid="R27" ref-type="bibr" href="#R27">
    <span class="italic">27</span>
   </a>). The NAO index was provided by the Climate and Global Dynamics Division, National Center for Atmospheric Research, Boulder, CO (
   <span ext-link-type="uri" xlink:href="https://climatedataguide.ucar.edu/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">https://climatedataguide.ucar.edu/</span>) (
   <a rid="R14" ref-type="bibr" href="#R14">
    <span class="italic">14</span>
   </a>). We used the mean winter temperature (temp) and mean winter precipitation (prec) (December to February) of the whole region called Sørlandet as measures of local weather conditions. These data were available from the Norwegian Meteorological Institute (
   <span ext-link-type="uri" xlink:href="http://www.yr.no/sted/Norge/Vest-Agder/Audnedal/Konsmo~6051/klima.vinter.html" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">www.yr.no/sted/Norge/Vest-Agder/Audnedal/Konsmo~6051/klima.vinter.html</span>).
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Effects of climate, density, and their interaction on demographic rates</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The IPM was used to estimate age-specific demographic rates and age-specific densities (figs. S1 and S3). Once these were estimated, we investigated the combined effects of both deterministic and environmental stochastic factors on demographic rates of all ages. We linked annual age-specific demographic rates as response variables to annual densities 
   <span class="italic">N</span>
   <sub>
    <span class="italic">t</span>
   </sub> and winter conditions as explanatory variables. Because the considered environmental variables can strongly covary, we looked for possible multicollinearity among explanatory variables that can lead to high SEs and difficulties in interpreting parameter estimates in regressions (
   <a rid="R28" ref-type="bibr" href="#R28">
    <span class="italic">28</span>
   </a>). We thus calculated Spearman pairwise correlation coefficients ρ and used the rule ρ &lt; 0.5 to determine whether two environmental variables could be included in the same model (
   <a rid="R29" ref-type="bibr" href="#R29">
    <span class="italic">29</span>
   </a>, 
   <a rid="R30" ref-type="bibr" href="#R30">
    <span class="italic">30</span>
   </a>). Because all correlation coefficients ρ among weather variables were higher than 0.7, environmental variables were not included simultaneously in the tested models.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">More specifically, survival between two successive breeding seasons 
   <span class="italic">t</span> and 
   <span class="italic">t</span> + 1 could be affected by the number of breeding females at time 
   <span class="italic">t</span> in the population and also by winter conditions between the two breeding seasons (that is, winter 
   <span class="italic">t</span>) (
   <a ref-type="fig" rid="F1" href="#F1">Fig. 1A</a>). Therefore, we linked the age-specific survival rates 
   <span class="italic">S</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> (on a logit scale) to density at 
   <span class="italic">t N</span>
   <sub>t</sub> and to environmental conditions during winter at 
   <span class="italic">t</span>. Because the effect of density and climate may be age-specific, we explored the interaction between age and environmental conditions and also the interaction between age and density. To account for the nonindependence of the survival rates among age classes of a given year, we included the year as a random effect. As a consequence, the global linear-mixed model (LMM) investigating an effect of deterministic and environmental stochastic factors on survival rates of age class 
   <span class="italic">i</span> took the following form
   <div id="E1" class="disp-formula">
    <div id="m5" class="math">
     <div class="mrow">
      <div class="mrow">
       <span class="mtext">logit</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">i</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <span mathvariant="normal" class="mi">μ</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mn">2</span>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">3</span>
        </div>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">5</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mtext">year</span>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">S</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(1)</span>
   </div>where μ is the intercept, 
   <span class="italic">a</span> is the age class (that is, 1, 2, 3, and 4), 
   <span class="italic">E</span>
   <sub>
    <span class="italic">t</span>
   </sub> is one environmental variable (that is, NAO index, temp, or prec), 
   <span class="italic">N</span>
   <sub>
    <span class="italic">t</span>
   </sub> is the density, β are the regression coefficients, year is the random effect, and 
   <div class="inline-formula">
    <div id="m6" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">S</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div> corresponds to the residuals of the LMM. The Akaike information criterion corrected for small sample size (AICc) was used for model selection (
   <a rid="R31" ref-type="bibr" href="#R31">
    <span class="italic">31</span>
   </a>). In addition, because the effects of density on demographic rates may differ according to climate conditions, we tested for the interaction between each environmental variable and density using the Ricker model
   <div id="E2" class="disp-formula">
    <div id="m7" class="math">
     <div class="mrow">
      <div class="mrow">
       <span class="mtext">logit</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">i</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <span mathvariant="normal" class="mi">μ</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mn">2</span>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">3</span>
        </div>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">×</span>
       <div class="msup">
        <span mathvariant="italic" class="mi">e</span>
        <div class="mrow">
         <span class="mo">−</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">k</span>
          <div class="mrow">
           <span mathvariant="normal" class="mi">R</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
         <span class="mo">×</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">E</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">5</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">×</span>
       <div class="msup">
        <span mathvariant="italic" class="mi">e</span>
        <div class="mrow">
         <span class="mo">−</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">k</span>
          <div class="mrow">
           <span mathvariant="normal" class="mi">R</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
         <span class="mo">×</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">E</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mtext">year</span>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">S</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(2)</span>
   </div>and the Beverton-Holt model
   <div id="E3" class="disp-formula">
    <div id="m8" class="math">
     <div class="mrow">
      <div class="mrow">
       <span class="mtext">logit</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">i</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <span mathvariant="normal" class="mi">μ</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mn">2</span>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mn">3</span>
       </div>
       <div class="mfrac">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">N</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">+</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">k</span>
          <div class="mrow">
           <span class="mtext">BH</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
         <span class="mo">×</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">E</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span class="mn">5</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">i</span>
        </div>
       </div>
       <span stretchy="true" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="mfrac">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">N</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">+</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">k</span>
          <div class="mrow">
           <span class="mtext">BH</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
         <span class="mo">×</span>
         <div class="msub">
          <span mathvariant="italic" class="mi">E</span>
          <span mathvariant="italic" class="mi">t</span>
         </div>
        </div>
       </div>
       <span stretchy="true" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <span class="mtext">year</span>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">S</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(3)</span>
   </div>where 
   <span class="italic">k</span>
   <sub>R
    <span class="italic">,i</span>
   </sub> and 
   <span class="italic">k</span>
   <sub>BH
    <span class="italic">,i</span>
   </sub> are two parameters to be estimated. Note that 
   <span class="italic">k</span>
   <sub>R
    <span class="italic">,i</span>
   </sub> can be equal for all age classes (
   <span class="italic">k</span>
   <sub>R,1</sub> = 
   <span class="italic">k</span>
   <sub>R,2</sub> = 
   <span class="italic">k</span>
   <sub>R,3</sub> = 
   <span class="italic">k</span>
   <sub>R,4</sub>). Similarly, 
   <span class="italic">k</span>
   <sub>BH
    <span class="italic">,i</span>
   </sub> can be equal for all age classes (
   <span class="italic">k</span>
   <sub>BH,1</sub> = 
   <span class="italic">k</span>
   <sub>BH,2</sub> = 
   <span class="italic">k</span>
   <sub>BH,3</sub> = 
   <span class="italic">k</span>
   <sub>BH,4</sub>). Alternatively, 
   <span class="italic">k</span>
   <sub>R
    <span class="italic">,i</span>
   </sub> and 
   <span class="italic">k</span>
   <sub>BH
    <span class="italic">,i</span>
   </sub> may be age-specific. We used an optimization function to find the values of 
   <span class="italic">k</span>
   <sub>R</sub> and 
   <span class="italic">k</span>
   <sub>BH</sub> providing the lowest AICc. Then, we used AICc for model selection (
   <a rid="R31" ref-type="bibr" href="#R31">
    <span class="italic">31</span>
   </a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Similarly, the recruitment rate of a given breeding season 
   <span class="italic">t</span> could be affected by the number of breeding females at time 
   <span class="italic">t</span> in the population. Moreover, environmental conditions in the winter following the breeding season (that is, winter 
   <span class="italic">t</span>) could potentially affect survival in the first year of life of the young produced (
   <a ref-type="fig" rid="F1" href="#F1">Fig. 1A</a>). Therefore, we linked the age-specific recruitment rates 
   <span class="italic">R</span>
   <sub>
    <span class="italic">i,t</span>
   </sub> (on a log scale) to density at 
   <span class="italic">t N</span>
   <sub>t</sub> and to environmental conditions during winter at 
   <span class="italic">t.</span> The global LMM took the following form
   <div id="E4" class="disp-formula">
    <div id="m9" class="math">
     <div class="mrow">
      <div class="mrow">
       <span class="mtext">log</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">R</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">i</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <span mathvariant="normal" class="mi">ν</span>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <div class="mrow">
           <span class="mn">1</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <span class="mn">2</span>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <span class="mn">3</span>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <div class="mrow">
           <span class="mn">4</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <div class="mrow">
           <span class="mn">5</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">i</span>
          </div>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <span stretchy="false" class="mo">[</span>
       <span mathvariant="italic" class="mi">a</span>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span stretchy="false" class="mo">]</span>
       <span class="mo">+</span>
       <div class="msup">
        <div class="mrow">
         <div class="msub">
          <span mathvariant="normal" class="mi">β</span>
          <span class="mn">6</span>
         </div>
        </div>
        <span class="mo">′</span>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">R</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(4)</span>
   </div>where ν is the intercept, 
   <span class="italic">a</span> is the age class (that is, 1, 2, 3, and 4), 
   <span class="italic">E</span>
   <sub>
    <span class="italic">t</span>
   </sub> is one environmental variable (that is, NAO index, temp, or prec), 
   <span class="italic">N</span>
   <sub>
    <span class="italic">t</span>
   </sub> is the density, β′ are the regression coefficients, year is the random effect, and 
   <div class="inline-formula">
    <div id="m10" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">R</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div> corresponds to the residuals of the LMM. As for survival, we also tested the interactions between each environmental variable and density with the Ricker and the Beverton-Holt models and used AICc for model selection.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The number of immigrants joining the population during the breeding season 
   <span class="italic">t</span> + 1 may be influenced by the winter conditions just before the breeding season (that is, winter 
   <span class="italic">t</span>). In addition, the number of local breeding females 
   <span class="italic">N</span>
   <sub>local</sub> may influence the number of immigrant breeding females arriving into the population 
   <span class="italic">I</span> (
   <a ref-type="fig" rid="F1" href="#F1">Fig. 1A</a>). Therefore, we linked the number of immigrant breeding females 
   <span class="italic">I</span>
   <sub>
    <span class="italic">t+1</span>
   </sub> to the number of local breeding females at 
   <span class="italic">t</span> + 1 
   <span class="italic">N</span>
   <sub>local
    <span class="italic">,t</span>+1
   </sub> and to environmental conditions during winter at 
   <span class="italic">t</span> using a generalized linear mixed model (GLMM) with Poisson distribution and the year as random effect
   <div id="E5" class="disp-formula">
    <div id="m11" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">I</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span mathvariant="normal" class="mi">η</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">I</span>
         <span class="mo">,</span>
         <span class="mn">1</span>
        </div>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">E</span>
        <span mathvariant="italic" class="mi">t</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">I</span>
         <span class="mo">,</span>
         <span class="mn">2</span>
        </div>
       </div>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">local</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">I</span>
         <span class="mo">,</span>
         <span class="mtext">year</span>
        </div>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">I</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(5)</span>
   </div>where η is the intercept, β
   <sub>
    <span class="italic">I</span>
   </sub> are the regression coefficients, and 
   <div class="inline-formula">
    <div id="m12" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">I</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div> corresponds to the residuals of the GLMM. AICc was used for model selection. In addition, we tested the interaction between each environmental variable and the number of local breeding females on the number of immigrants joining the local population using a generalized logistic function with Poisson distribution and the year as a random effect
   <div id="E6" class="disp-formula">
    <div id="m13" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">I</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div class="mfrac">
        <span mathvariant="italic" class="mi">U</span>
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">+</span>
         <span stretchy="false" class="mo">(</span>
         <div class="msup">
          <span mathvariant="italic" class="mi">e</span>
          <div class="mrow">
           <div class="msub">
            <span mathvariant="italic" class="mi">q</span>
            <span class="mn">0</span>
           </div>
           <span class="mo">+</span>
           <div class="msub">
            <span mathvariant="italic" class="mi">q</span>
            <span class="mn">1</span>
           </div>
           <span class="mo">×</span>
           <div class="msub">
            <span mathvariant="italic" class="mi">E</span>
            <span mathvariant="italic" class="mi">t</span>
           </div>
          </div>
         </div>
         <span stretchy="false" class="mo">)</span>
         <span class="mo">×</span>
         <div class="msup">
          <span mathvariant="italic" class="mi">e</span>
          <div class="mrow">
           <span class="mo">−</span>
           <span mathvariant="italic" class="mi">B</span>
           <span class="mo">×</span>
           <div class="msub">
            <span mathvariant="italic" class="mi">N</span>
            <div class="mrow">
             <span class="mtext">local</span>
             <span class="mo">,</span>
             <span mathvariant="italic" class="mi">t</span>
             <span class="mo">+</span>
             <span class="mn">1</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">β</span>
        <div class="mrow">
         <span mathvariant="italic" class="mi">I</span>
         <span class="mo">,</span>
         <span class="mtext">year</span>
        </div>
       </div>
       <span class="mo"> </span>
       <span class="mtext">year</span>
       <span class="mo"> </span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">I</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(6)</span>
   </div>where 
   <span class="italic">U</span> (which corresponds to the upper asymptote), 
   <span class="italic">q</span>
   <sub>0</sub>, 
   <span class="italic">q</span>
   <sub>1</sub>, and 
   <span class="italic">B</span> were estimated using an optimization function aimed at minimizing the AICc value. The model with the lowest AICc was retained as the best one.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Climate-density–dependent population model</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Because all the best models explaining variation in demographic rates retained an effect of mean winter temperatures (table S1), we standardized the variable “mean winter temperature” for the study period (that is, from 1979 to 2013) with the mean and the variance of the mean winter temperatures observed between 1921 and 2015 (fig. S4, left). Such standardization was useful for further population projections (see Climate and population projections). Each demographic rate may thus be defined as a function of density and mean winter temperature (table S2). Therefore, for given winter conditions and densities, age-specific survival and recruitment rates and also the number of immigrants joining the local population may be simulated (hereafter denoted as 
   <span class="italic">S</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub>, 
   <span class="italic">R</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub>, and 
   <span class="italic">I</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub>). As a result, the number of breeding females in the population 
   <span class="italic">N</span>
   <sub>sim
    <span class="italic">,t</span>
   </sub> may be simulated. Note that the number of immigrants joining the local population at 
   <span class="italic">t</span> + 1 
   <span class="italic">I</span>
   <sub>sim,
    <span class="italic">t</span>+1
   </sub> was simulated from the function defined in table S2 using a Poisson distribution.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">In detail, the total number of breeding females in the population at time 
   <span class="italic">t</span> + 1 
   <span class="italic">N</span>
   <sub>sim,</sub>
   <sub>
    <span class="italic">t</span>+1
   </sub> corresponded to the sum of breeding females in each age class 
   <span class="italic">i N</span>
   <sub>sim 
    <span class="italic">i,t</span>+1
   </sub> at time 
   <span class="italic">t</span> + 1 (
   <a ref-type="fig" rid="F1" href="#F1">Fig. 1B</a>)
   <div id="E7" class="disp-formula">
    <div id="m14" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(7)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">(i) Because most of the immigrant breeding females were females of age class 1 (on average, 82% during the study period and fluctuating between 58 and 100%; fig. S3), we assumed that 
   <span class="italic">N</span>
   <sub>sim 1,</sub>
   <sub>
    <span class="italic">t</span>+1
   </sub> (first term in 
   <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>) corresponded to the sum of the number of daughters that was locally recruited into the population 
   <span class="italic">n</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub> (that is, produced by the breeding females of each age class) and also of the number of immigrants 
   <span class="italic">I</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub> arriving into the population
   <div id="E8" class="disp-formula">
    <div id="m15" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">n</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">I</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(8)</span>
   </div>
   <span class="italic">n</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub> was modeled using a Poisson distribution to include demographic stochasticity
   <div id="E9" class="disp-formula">
    <div id="m16" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">n</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">~</span>
       <span class="mo"> </span>
       <span class="mtext">Poisson</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">R</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">+</span>
       <span class="mo"> </span>
       <span class="mtext">Poisson</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">R</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">+</span>
       <span class="mo"> </span>
       <span class="mtext">Poisson</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">R</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">+</span>
       <span class="mo"> </span>
       <span class="mtext">Poisson</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">×</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">R</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
     </div>
    </div>
    <span class="label">(9)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">(ii) 
   <span class="italic">N</span>
   <sub>sim 2
    <span class="italic">,t</span>+1
   </sub> (second term in 
   <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>) corresponded to the number of females of age class 1 that survived from time 
   <span class="italic">t</span> to time 
   <span class="italic">t</span> + 1 and was modeled using a binomial process to include demographic stochasticity
   <div id="E10" class="disp-formula">
    <div id="m17" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">~</span>
       <span class="mo"> </span>
       <span class="mtext">Bin</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">1</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
     </div>
    </div>
    <span class="label">(10)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">(iii) Similarly, 
   <span class="italic">N</span>
   <sub>sim 3
    <span class="italic">,t</span>+1
   </sub> and 
   <span class="italic">N</span>
   <sub>sim 4
    <span class="italic">,t</span>+1
   </sub> (the third and fourth terms in 
   <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>, respectively) corresponded to the number of females in the previous age class that survived from time 
   <span class="italic">t</span> to time 
   <span class="italic">t</span> + 1
   <div id="E11" class="disp-formula">
    <div id="m18" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">~</span>
       <span class="mo"> </span>
       <span class="mtext">Bin</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">2</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
     </div>
    </div>
    <span class="label">(11)</span>
   </div>
   <div id="E12" class="disp-formula">
    <div id="m19" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
         <span class="mo">+</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">~</span>
       <span class="mo"> </span>
       <span class="mtext">Bin</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">3</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">+</span>
       <span class="mo"> </span>
       <span class="mtext">Bin</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">N</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <span mathvariant="italic" class="mi">S</span>
        <div class="mrow">
         <span class="mtext">sim</span>
         <span class="mo"> </span>
         <span class="mn">4</span>
         <span class="mo">,</span>
         <span mathvariant="italic" class="mi">t</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
     </div>
    </div>
    <span class="label">(12)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Therefore, for given winter conditions and densities, 
   <span class="italic">S</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub>, 
   <span class="italic">R</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub>, and 
   <span class="italic">I</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub> may be computed (from the relationships shown in table S2). To account for sources of environmental stochasticity due to processes other than covariates included in the model, a covariance matrix 
   <div class="inline-formula">
    <div id="m20" class="math">
     <div class="mrow">
      <div class="mrow">
       <span mathvariant="normal" class="mi">Σ</span>
      </div>
     </div>
    </div>
   </div> of “random year effect + 
   <div class="inline-formula">
    <div id="m21" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">S</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>,” “random year effect + 
   <div class="inline-formula">
    <div id="m22" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">R</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">i</span>
           <span class="mo">,</span>
           <span mathvariant="italic" class="mi">t</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>,” and “random year effect + 
   <div class="inline-formula">
    <div id="m23" class="math">
     <div class="mrow">
      <div class="mrow">
       <div class="msub">
        <span mathvariant="normal" class="mi">ε</span>
        <div class="mrow">
         <div class="msub">
          <span mathvariant="italic" class="mi">I</span>
          <div class="mrow">
           <span mathvariant="italic" class="mi">t</span>
           <span class="mo">+</span>
           <span class="mn">1</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>” was estimated, and new residuals were generated from a multivariate normal distribution with a covariance matrix equal to 
   <div class="inline-formula">
    <div id="m24" class="math">
     <div class="mrow">
      <div class="mrow">
       <span mathvariant="normal" class="mi">Σ</span>
      </div>
     </div>
    </div>
   </div>. Then, 
   <span class="italic">N</span>
   <sub>sim 1
    <span class="italic">,t</span>+1
   </sub>, 
   <span class="italic">N</span>
   <sub>sim 2
    <span class="italic">,t</span>+1
   </sub>, 
   <span class="italic">N</span>
   <sub>sim 3
    <span class="italic">,t</span>+1
   </sub>, and 
   <span class="italic">N</span>
   <sub>sim 4
    <span class="italic">,t</span>+1
   </sub> that are functions of 
   <span class="italic">S</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub>, 
   <span class="italic">R</span>
   <sub>sim 
    <span class="italic">i,t</span>
   </sub> and 
   <span class="italic">I</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub>, may be computed (
   <a ref-type="disp-formula" rid="E8" href="#E8">Eqs. 8</a> to 
   <a ref-type="disp-formula" rid="E12" href="#E12">12</a>), and finally, the density 
   <span class="italic">N</span>
   <sub>sim
    <span class="italic">,t</span>+1
   </sub> may be simulated (
   <a ref-type="disp-formula" rid="E7" href="#E7">Eq. 7</a>).
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Strength of density dependence and climate</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The strength of the density dependence γ corresponds to the negative elasticity of the population growth rate λ with respect to changes in the total number of breeding females 
   <span class="italic">N</span>, evaluated at the carrying capacity 
   <span class="italic">K</span>: 
   <div class="inline-formula">
    <div id="m25" class="math">
     <div class="mrow">
      <div class="mrow">
       <span mathvariant="normal" class="mi">γ</span>
       <span class="mo">=</span>
       <span class="mo">−</span>
       <div class="msub">
        <div class="mrow">
         <span stretchy="true" class="mo">[</span>
         <div class="mfrac">
          <div class="mrow">
           <span class="mo">∂</span>
           <span class="mo"> </span>
           <span class="mtext">log</span>
           <span class="mo"> </span>
           <span mathvariant="normal" class="mi">λ</span>
          </div>
          <div class="mrow">
           <span class="mo">∂</span>
           <span class="mo"> </span>
           <span class="mtext">log</span>
           <span class="mo"> </span>
           <span mathvariant="italic" class="mi">N</span>
          </div>
         </div>
         <span stretchy="true" class="mo">]</span>
        </div>
        <span mathvariant="italic" class="mi">K</span>
       </div>
      </div>
     </div>
    </div>
   </div>. That is, γ provides a measure of the effect of a small change of density (that is, 
   <span class="italic">N</span>) on the population growth rate λ at the equilibrium. From the deterministic version of our CDDPM, γ was calculated for different standardized mean winter temperatures, from −2 to 2.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Similarly, evaluating the effect of a small change in mean winter temperature temp on λ at equilibrium may be calculated as 
   <div class="inline-formula">
    <div id="m26" class="math">
     <div class="mrow">
      <div class="mrow">
       <span mathvariant="normal" class="mi">Γ</span>
       <span class="mo">=</span>
       <div class="msub">
        <div class="mrow">
         <span stretchy="true" class="mo">[</span>
         <div class="mfrac">
          <div class="mrow">
           <span class="mo">∂</span>
           <span class="mo"> </span>
           <span class="mtext">log</span>
           <span class="mo"> </span>
           <span mathvariant="normal" class="mi">λ</span>
          </div>
          <div class="mrow">
           <span class="mo">∂</span>
           <span class="mo"> </span>
           <span class="mtext">log temp</span>
          </div>
         </div>
         <span stretchy="true" class="mo">]</span>
        </div>
        <span mathvariant="italic" class="mi">K</span>
       </div>
      </div>
     </div>
    </div>
   </div>. From the deterministic version of our CDDPM, Γ was calculated for different standardized mean winter temperatures, from −2 to 2.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Using the CDDPM to reconstruct past population structure</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Using the age-specific densities in 1979 that were previously estimated with the IPM and the standardized mean winter temperatures from 1979 to 2013 (fig. S4, left), we simulated 
   <span class="italic">S</span>
   <sub>sim 
    <span class="italic">i</span>
   </sub>, 
   <span class="italic">R</span>
   <sub>sim 
    <span class="italic">i</span>
   </sub>, 
   <span class="italic">I</span>
   <sub>sim</sub>, 
   <span class="italic">N</span>
   <sub>sim 
    <span class="italic">i</span>
   </sub>, and finally 
   <span class="italic">N</span>
   <sub>sim</sub> over the study period. We simulated 1000 stochastic trajectories of population sizes (fig. S5). On the basis of the data from 1979, the observed density 
   <span class="italic">N</span> (fig. S5A, thin line) was within the 95% prediction interval in 94.1% of the cases, and within the 50% prediction interval in 61.8% of the cases, indicating a good match between observed and predicted total population size. Note that the observed densities were the densities obtained from the IPM (that is, corrected for observation error, the incomplete information on age structure in the monitoring data, and imperfect detection). To ensure that the CDDPM correctly modeled the full development of the population and not only the total population size, we computed the Pearson’s product-moment correlations 
   <span class="italic">r</span> and their associated 95% confidence intervals between the observed and predicted number of breeding females in each age class. That is, we compared the observed population structure (fig. S5, B and C, thin lines) with the population structure predicted with the CDDPM (fig. S5, C and D, thick lines). In practice, for each year between 1979 and 2013, we estimated the mean number of breeding females in each age class among the 1000 simulated stochastic trajectories and compared it with the observed number of breeding females [
   <span class="italic">r</span>
   <sub>
    <span class="italic">I,I</span>sim
   </sub> = 0.79(0.62; 0.89), 
   <span class="italic">r</span>
   <sub>
    <span class="italic">n,n</span>sim
   </sub> = 0.66(0.42; 0.82), 
   <span class="italic">r</span>
   <sub>
    <span class="italic">N</span>2
    <span class="italic">,N</span>2sim
   </sub> = 0.78(0.60; 0.89), 
   <span class="italic">r</span>
   <sub>
    <span class="italic">N</span>3
    <span class="italic">,N</span>3sim
   </sub> = 0.82(0.66; 0.91), 
   <span class="italic">r</span>
   <sub>
    <span class="italic">N</span>4
    <span class="italic">,N</span>4sim
   </sub> = 0.72(0.50; 0.85)].
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Climate and population projections</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We obtained from the CESM Large Ensemble Community Project (
   <a rid="R16" ref-type="bibr" href="#R16">
    <span class="italic">16</span>
   </a>) the daily average surface temperatures at the closest model grid point (58.9°N, 7.5°E) for 40 ensemble members [see the work of Kay 
   <span class="italic">et al</span>. (
   <a rid="R16" ref-type="bibr" href="#R16">
    <span class="italic">16</span>
   </a>) for a full description of the climate projections]. For these 40 ensemble members, we calculated the mean temperature for each winter (December to February) between 1921 and 2050. As with the observed temperatures (see Climate-density–dependent population model), we standardized the winter weather scenarios (with the mean and the variance of the mean winter temperatures predicted between 1921 and 2015). Thus, the mean and the SD used for standardizing each of the members were the mean of means and the mean of SDs calculated for each member. Such a rescaling allowed observed temperatures and climate scenarios (on average across all 40 of them) to be aligned between 1921 and 2015 so that they had the same mean and variance (fig. S4, right).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Using the age-specific densities in 2013 that were previously estimated with the IPM and these standardized values of mean winter temperatures, we simulated with the CDDPM 100 stochastic trajectories in population sizes per ensemble member from 2013 to 2050, resulting in a total of 4000 stochastic trajectories. We computed the 95 and 50% prediction intervals of the predicted total population size (
   <a ref-type="fig" rid="F4" href="#F4">Fig. 4A</a>), of the number of local breeding females (
   <a ref-type="fig" rid="F4" href="#F4">Fig. 4B</a>), and of the number of immigrant breeding females (
   <a ref-type="fig" rid="F4" href="#F4">Fig. 4C</a>). All of these analyses were performed with R software (
   <a rid="R24" ref-type="bibr" href="#R24">
    <span class="italic">24</span>
   </a>).
  </p>
 </sec>
</sec>
