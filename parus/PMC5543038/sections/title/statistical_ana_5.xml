<?xml version="1.0" encoding="UTF-8"?>
<sec class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Statistical Analyses</div>
 <p xmlns="http://www.w3.org/1999/xhtml">Individual egg-laying dates were corrected for among-year and among-area variation prior to analyses by centering to the annual mean egg-laying date separately per area. To test whether SNP effects differed depending on spring temperature we divided the years in our data set into three categories according to their spring temperature. For every year we calculated the average daily mean temperature for the period March 11 to April 20. Average temperature during this period correlates best with annual mean egg-laying dates for our study population (
  <a rid="B54" ref-type="bibr" href="#B54">Visser et al., 2006</a>). The used daily mean temperatures from the weather station De Bilt were obtained from the website of the Royal Dutch Meteorological Institute (KNMI
  <span class="sup">
   <a ref-type="fn" rid="fn01" href="#fn01">1</a>
  </span>). We then calculated the 33%iles and grouped the first, second and third 33%ile into the ‘cold,’ ‘intermediate’ and ‘warm’ category, respectively. The ‘cold’ category comprised 1074 observed egg-laying date of 941 individuals in 6 years, the ‘intermediate’ category 770 observed egg-laying dates of 651 individuals in 6 years and the ‘warm’ category 1615 observed egg-laying dates of 1310 individuals in 5 years. Note that the total number of individuals in our analysis (2045) is not the sum of the individuals breeding in cold, intermediate and warm years, since the same individual can be included in more than one category. The average (and standard deviation in brackets) of the temperature during the period March 11 to April 20 was 6.2°C (0.96°C) for the ‘cold’ category, 7.8°C (0.27°C) for the ‘intermediate’ category, and 9.4°C (0.66°C) for the ‘warm’ category, respectively. Our model to test for SNP effect and their interaction with temperature was:
 </p>
 <div id="E1" class="disp-formula" xmlns="http://www.w3.org/1999/xhtml">
  <div id="M1" class="math">
   <div class="mrow">
    <div class="msub">
     <div class="mrow">
      <span mathvariant="italic" class="mi">y</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
      <span mathvariant="italic" class="mo">,</span>
      <span mathvariant="italic" class="mi">j</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">=</span>
    <span mathvariant="normal" class="mi">μ</span>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="normal" class="mi">a</span>
      <span mathvariant="normal" class="mi">g</span>
      <span mathvariant="normal" class="mi">e</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="normal" class="mi">S</span>
      <span mathvariant="normal" class="mi">N</span>
      <span mathvariant="normal" class="mi">P</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="normal" class="mi">t</span>
      <span mathvariant="normal" class="mi">e</span>
      <span mathvariant="normal" class="mi">m</span>
      <span mathvariant="normal" class="mi">p</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">:</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="normal" class="mi">S</span>
      <span mathvariant="normal" class="mi">N</span>
      <span mathvariant="normal" class="mi">P</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="italic" class="mi">p</span>
      <span mathvariant="italic" class="mi">e</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="italic" class="mi">a</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
     </div>
    </div>
    <span mathvariant="normal" class="mo">+</span>
    <div class="msub">
     <div class="mrow">
      <span mathvariant="italic" class="mi">e</span>
     </div>
     <div class="mrow">
      <span mathvariant="italic" class="mi">i</span>
      <span mathvariant="italic" class="mo">,</span>
      <span mathvariant="italic" class="mi">j</span>
     </div>
    </div>
   </div>
  </div>
 </div>
 <p xmlns="http://www.w3.org/1999/xhtml">where the phenotype 
  <span class="italic">y
   <sub>i,j</sub>
  </span> of observation 
  <span class="italic">j</span> of individual 
  <span class="italic">i</span> is a function of the population mean μ, its age (two-level factor: first year breeder or older), its SNP genotype, the interaction between SNP genotype and temperature class 
  <span class="italic">temp</span>, its ‘permanent environment’ (i.e., individual) effect 
  <span class="italic">pe
   <sub>i</sub>
  </span>, its breeding values 
  <span class="italic">a
   <sub>i</sub>
  </span> and the residual effect 
  <span class="italic">e
   <sub>i</sub>
  </span>. μ, age, the SNP genotype and temperature class are fixed effects and 
  <span class="italic">pe
   <sub>i</sub>
  </span> and 
  <span class="italic">a
   <sub>i</sub>
  </span> random effects. The variance-covariance matrix for 
  <span class="italic">a</span> is derived from the expected covariance between individuals due to their additive genetic effects. Fitting the additive genetic variance-covariance matrix accounts for the fact that individuals in our study population are related.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">All GWA analyses were run in ASReml-R 3.0 (
  <a rid="B16" ref-type="bibr" href="#B16">Gilmour et al., 2015</a>). Due to computation-time constraints we fitted the (sparse) relatedness matrix calculated from a pedigree instead of the (full) ‘genomic’ relatedness matrix. This should not affect the results as results for a simple model testing only the SNP effect (RepeatABEL cannot fit interactions) run in RepeatABEL (genomic relatedness matrix) and ASReml (pedigree relatedness matrix) correlated highly (Supplementary Figure 
  <a ref-type="supplementary-material" rid="SM1" href="#SM1">S2</a>).
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">An assumption underlying linear regression and ANOVA is that the variance of the dependent variable is homoscedastic with respect to the independent variable, i.e., that its variance does not change with the covariate in linear regression or that its variance is roughly equal in the different factor groups in ANOVA. If this assumption is violated, the resulting heteroscedasticity leads to biased results. This problem is exacerbated by fitting SNP
  <span class="sup">∗</span>environment interactions and can lead to inflation of 
  <span class="italic">p</span>-values as has been recognized in the field of psychiatric genetics (
  <a rid="B56" ref-type="bibr" href="#B56">Voorman et al., 2011</a>; 
  <a rid="B1" ref-type="bibr" href="#B1">Almli et al., 2014</a>). To account for this problem we allowed the residual variance to differ among temperature classes in the models fitted with ASReml. Residual variances did indeed differ among temperature classes and fitting them avoided inflating 
  <span class="italic">p</span>-values. See Supplementary Materials for further details.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">Because the standard Bonferroni correction is generally considered overly conservative, an adjusted Bonferroni correction taking linkage disequilibrium (LD) between all SNP loci into account has been suggested (
  <a rid="B31" ref-type="bibr" href="#B31">Moskvina and Schmidt, 2008</a>). We calculated this correction with a sliding window of 20 SNPs using the software KEFF VSEP 2007 (
  <a rid="B31" ref-type="bibr" href="#B31">Moskvina and Schmidt, 2008</a>). However, because of low LD between SNPs in our great tit population, the amount of effective tests, on which the Bonferroni correction depends, dropped by just 4% and we hence did not apply this correction.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">Although previous work in of the study populations analyzed here showed that egg-laying dates are heritable in general (
  <a rid="B13" ref-type="bibr" href="#B13">Gienapp et al., 2006</a>; 
  <a rid="B20" ref-type="bibr" href="#B20">Husby et al., 2010</a>) and also under different spring temperatures (
  <a rid="B21" ref-type="bibr" href="#B21">Husby et al., 2011</a>), we here analyzed whether egg-laying date would be heritable in each of the three temperature classes. To increase the power of our analysis, we not only included the genotyped individuals but all females with known identity in our analysis. This data set consisted of 4624 observations of 4032 females, 3737 observations of 3019 females and 4147 of 3532 females for the cold, medium and warm temperature class, respectively. We hence had to include a pedigree-based relatedness matrix instead of a genomic relatedness matrix in our animal model. Besides the additive genetic (random) effect, we fitted female identity as random effect to account for repeated observations as well as age (two level factor as above), year (as factor), area, and the interaction year
  <span class="sup">∗</span>area as fixed effects. These analyses were also run in ASReml-R 3.0.
 </p>
</sec>
