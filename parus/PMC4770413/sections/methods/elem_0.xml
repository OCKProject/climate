<?xml version="1.0" encoding="UTF-8"?>
<sec disp-level="1" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Sample collection and DNA sequencing</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We selected 31 sampling sites for 
   <span class="italic">M. horvathi</span> across the natural distributional area, which largely covered the whole distributional range of this species in China (
   <a ref-type="fig" rid="f1" href="#f1">Fig. 1</a>, 
   <a ref-type="supplementary-material" rid="S1" href="#S1">Fig. S1</a>). Distribution maps were generated by the software ArcGIS 10 (ESRI, Redlands, CA, USA). In each population, three to ten (mean of eight) mature males or females were collected. All the materials were deposited in the College of Life Sciences at Nankai University (Tianjin, China). Genomic DNA was extracted from the entire body excluding the genitalia. A total of 250 individuals were sequenced for mitochondrial markers (COI + COII) and nuclear markers (ITS1 + 5.8S + ITS2). Polymerase chain reactions (PCR) were performed using specific primers following Ye 
   <span class="italic">et al.</span> (2014). The PCR procedure for COI, COII and nuclear markers (ITS1 + 5.8S + ITS2) included an initial denaturation at 94 °C for 2 minutes, followed by 31–33 cycles of 30 seconds at 92 °C, 30 seconds at 48–52 °C and 1 minute at 72 °C, ending with a final extension at 72 °C for 8 minutes. The chromatograms of sequences were unimodal, which excluded pseudogene disturbance. Sequences were visually proofread and aligned in Bioedit 7.1 software
   <a ref-type="bibr" rid="b31" href="#b31">31</a>.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Paleoclimate niche modeling reconstruction</div>
  <p xmlns="http://www.w3.org/1999/xhtml">A total of 47 occurrence records were obtained for niche modeling, including 33 records from the alcohol preserved specimens and 14 records from pinned specimens in Nankai University or the published literature. We chose the seven bioclimatic variables from the WorldClim database (
   <span ext-link-type="uri" xlink:href="http://www.worldclim.org/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.worldclim.org/</span>) that were thought to most likely restrict semi-aquatic bugs distribution
   <a ref-type="bibr" rid="b12" href="#b12">12</a>, namely, annual mean temperature (BIO1), mean diurnal temperature range (BIO2), maximum temperature of the warmest month (BIO5), minimum temperature of the coldest month (BIO6), annual mean precipitation (BIO12), precipitation of the wettest month (BIO13), and precipitation of the driest month (BIO14). All the variables were derived from the WorldClim data center at a resolution of 2.5-arc. We used maximum entropy implemented in Maxent (version 3.3.3 k
   <a ref-type="bibr" rid="b32" href="#b32">32</a>) to estimate niches in environmental dimensions. Analysis was run using default program conditions. Area Under Curve (AUC) of the Receiver Operating Characteristic (ROC) plot was used for model evaluation. For hindcasting the effect of Pleistocene climatic fluctuations, the current native niche models were calibrated using the above environmental variables and then transferred onto the reconstructed climatic conditions during the LGM and LIG periods. The Community Climate System Model 3 (CCSM 3) for LGM conditions was used.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Genetic polymorphism and phylogenetic analysis</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We estimated genetic diversities by the number of polymorphic sites (
   <span class="italic">S</span>), haplotype distribution (Hap), number of haplotypes (Nhap), haplotype diversity (
   <span class="italic">Hd</span>), and nucleotide diversity (
   <span class="italic">π</span>), which were all calculated in DNASP 4.0
   <a ref-type="bibr" rid="b33" href="#b33">33</a>. We used the uncorrected 
   <span class="italic">p</span> distances to reconstruct an unrooted NJ tree to elucidate the phylogenetic relationships among mitochondrial haplotypes of 
   <span class="italic">M. horvathi</span> using PAUP* 4.0b10
   <a ref-type="bibr" rid="b34" href="#b34">34</a>. Statistical support for phylogenetic grouping was assessed by 1000 bootstrap replicates. To further investigate the relationships among unique haplotypes, we constructed unrooted networks using two methods: the neighbor-net algorithm with SplitsTree 4.6
   <a ref-type="bibr" rid="b35" href="#b35">35</a>, and a median-joining method
   <a ref-type="bibr" rid="b36" href="#b36">36</a> constructed with default settings in Network 4.6.1.3 (Fluxus Technology, Suffolk, UK).
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Phylogeographic structure and hierarchical partitioning of genetic structure</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The SAMOVA 1.0
   <a ref-type="bibr" rid="b37" href="#b37">37</a> program was used to simulate 100 simulated annealing processes for 
   <span class="italic">K</span> = 2 to 10. The potential geographical zones associated with genetic discontinuities across the entire sample region were further investigated using Monmonier’s algorithm implemented in Barrier 2.2
   <a ref-type="bibr" rid="b38" href="#b38">38</a>. Mitochondrial DNA identified two major clades, which were apparently consistent with a north-south geographic partition (
   <a ref-type="fig" rid="f1" href="#f1">Figs 1</a> and 
   <a ref-type="fig" rid="f3" href="#f3">3</a>a). We assessed the hierarchical partitioning of genetic structure between the two groups (north and south) resulting from SAMOVA analysis in each marker using analysis of molecular variance (AMOVA) in Arlequin 3.5
   <a ref-type="bibr" rid="b39" href="#b39">39</a>. The statistical significance of variance components was assessed using 10000 random permutations. Additionally, for testing an isolation-by-distance model, the Mantel test was performed in IBDWS
   <a ref-type="bibr" rid="b40" href="#b40">40</a> for each genetic marker using 1000 randomizations.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Historical demographic changes based on mitochondrial data</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used three neutrality tests, the Tajima’s 
   <span class="italic">D</span>, Fu and Li’s 
   <span class="italic">D</span>* and Fu’s Fs tests, implemented in DNASP 4.0
   <a ref-type="bibr" rid="b33" href="#b33">33</a> or Arlequin 3.5
   <a ref-type="bibr" rid="b39" href="#b39">39</a>, to detect deviations from the mutation-drift equilibrium that would be indicative of changes in historical demography and natural selection. We used BEAST 1.8.2
   <a ref-type="bibr" rid="b41" href="#b41">41</a> to estimate divergence time for the mitochondrial lineages obtained. The best fit nucleotide substitution model GTR + G + I was estimated by Modeltest 3.7
   <a ref-type="bibr" rid="b42" href="#b42">42</a>. Divergence time was estimated with an uncorrelated lognormal relaxed clock with the mutation rate 0.4–0.8%/Myr for 
   <span class="italic">M. horvathi</span>
   <a ref-type="bibr" rid="b43" href="#b43">43</a>. We adopted one year as seven generation for 
   <span class="italic">M. horvathi</span>
   <a ref-type="bibr" rid="b44" href="#b44">44</a>, using a coalescent tree prior model with the chains run for 100 million generations, checked to make sure the ESS was more than 200 and then discarded the first 10% as burn-in. We also estimated divergence time using the isolation-with-migration model implemented in IMa2
   <a ref-type="bibr" rid="b45" href="#b45">45</a>. The HKY model and 0.25 as inheritance scalar were used. We set the upper prior bounds to 80 for the population size (q), 32 for the divergence time (t) and 0.125 for the migration rate (m). Final runs consisted of 1 × 10
   <span class="sup">8</span> steps with a burn-in of 1 × 10
   <span class="sup">7</span> steps, with the lowest ESS among the parameters at least above 50.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Then two methods were used to estimate population expansion time. One approach used 
   <span class="italic">t</span> = 
   <span class="italic">τ</span>/2
   <span class="italic">u</span> (where 
   <span class="italic">τ</span> is the crest of mismatch distribution, 
   <span class="italic">u</span> is the mutation rate per generation for the whole sequence, and 
   <span class="italic">t</span> is the expansion time in number of generations; the value 
   <span class="italic">u</span> was calculated using the formula 
   <span class="italic">u</span> = 
   <span class="italic">μk</span> (
   <span class="italic">μ</span> is the mutation rate per nucleotide and 
   <span class="italic">k</span> is the number of nucleotides). The other approach used a Bayesian coalescent-based method (Bayesian Skyline Plot, BSP) in BEAST 1.8.2. A relaxed uncorrelated lognormal molecular clock was applied. We ran the chains for 100 million generations, and checked to make sure the ESS was more than 200, after which the first 10% were discarded as “burn-in”.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Ecological vicariance analyses</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used two approaches to test ecological divergences between two phylogenetic lineages of 
   <span class="italic">M. horvathi</span>. First, we tested the correlations between the ecological divergences and the phylogenetic splits using spatial evolutionary and ecological vicariance analysis (SEEVA
   <a ref-type="bibr" rid="b46" href="#b46">46</a>). We extracted seven environmental variables (BIO1, BIO5, BIO6, BIO12, BIO13, BIO14 and Elevation) for each sampling site in ArcGIS (ESRI, Redlands, CA, USA), and primary GIS data layers for temperature and precipitation were obtained from the WorldClim data (
   <span ext-link-type="uri" xlink:href="http://www.worldclim.org/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.worldclim.org/</span>). Quantitative variables (temperature, elevation and precipitation) were scored as ordered continuous data, while the qualitative variables (vegetation type) were treated as non-ordered categorical data. We divided these variables into four states according to the default setting in SEEVA. We investigated the correlations between ecological shifts and the phylogenetic splits using Fisher’s exact tests and divergence indices (D). Second we used PCA-env function in the R script
   <a ref-type="bibr" rid="b47" href="#b47">47</a> to measure niche overlaps in gridded environmental space between the two lineages
   <a ref-type="bibr" rid="b48" href="#b48">48</a>. Observed densities for each region were corrected in light of the availability of environmental space using kernel density functions. Niche overlap was measured along gradients of a multivariate analysis (i.e. principal component analysis, PCA), and the statistical tests of niche equivalency and similarity
   <a ref-type="bibr" rid="b45" href="#b45">45</a> were computed from the density estimations of taxa in environmental space. Similarity was quantified using Schoener’s 
   <span class="italic">D</span>, with values ranging from 0 to 1, or from more to less similar respectively.
  </p>
 </sec>
</sec>
