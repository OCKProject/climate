<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="methods" id="s2" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <sec id="s2a" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Ethics statement</div>
  <p xmlns="http://www.w3.org/1999/xhtml">All used samples are unprotected bird specimens from the specimen collection of the National Zoological Museum, Institute of Zoology, Chinese Academy of Sciences (address: No1 Beichen West Road, Chaoyang District, Beijing, China). The collection was under the permit from Forestry Department and conformed to the National Wildlife Conservation Law in China. No living animal experiments were conducted in the current research.</p>
 </sec>
 <sec id="s2b" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Sample collection, DNA extraction, PCR amplification and sequencing</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We examined a total of 203 individuals from 32 localities within the breeding range of 
   <span class="italic">A. c. talifuensis–concinnus</span> (
   <a ref-type="fig" rid="pone-0029329-g001" href="#pone-0029329-g001">Fig. 1</a>). Total genomic DNA was extracted from blood or tissue samples using the QIAGEN DNeasy Tissue kit following the manufacturer's instructions. Polymerase chain reaction (PCR) was used to amplify the Cytochrome c oxidase subunit I (COI), Cytochrome b (
   <span class="italic">cyt b</span>) and NADH dehydrogenase subunit 2 (ND2) genes. As described in 
   <a rid="pone.0029329-Sorenson1" ref-type="bibr" href="#pone.0029329-Sorenson1">[33]</a>, the primers H7956 and L6615 were used to amplify COI, and H6313 and L5219 for ND2. PCR reactions were run using the following parameters: denaturation at 94°C for 2 min, followed by 40 cycles at 93°C for 1 min, 46°C for COI and 53°C for ND2 for 45 s, and 72°C for 2 min, and a final 8 min at 72°C. The primers and amplification conditions used for cytochrome b were as described in 
   <a rid="pone.0029329-Gill1" ref-type="bibr" href="#pone.0029329-Gill1">[34]</a>.
  </p>
  <div id="pone-0029329-g001" position="float" class="fig" xmlns="http://www.w3.org/1999/xhtml">
   <span pub-id-type="doi" class="object-id">10.1371/journal.pone.0029329.g001</span>
   <span class="label">Figure 1</span>
   <div class="caption">
    <div class="title">Sampling sites, geographical and lineages distribution of 
     <span class="italic">A. c. talifuensis–concinnus</span>.
    </div>
    <p>Circles and associated letters indicate sample sizes and sampling localities. Each color represents a lineage. PZH includes populations in Panzhihua, Miyi, Yanbian and Yanyuan Counties and LC includes populations in Gengma, Shuangjiang and Yunxian Counties. The distribution of subspecies is based on that in Chinese Fauna Sinica 
     <a rid="pone.0029329-Li2" ref-type="bibr" href="#pone.0029329-Li2">[80]</a>, but has been slightly modified based on our field observations.
    </p>
   </div>
   <div xlink:href="pone.0029329.g001" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">Each round of PCR reactions also included one negative control to check for contamination. The PCR products were purified using a QIAquick PCR purification kit (QIAGEN) and sequenced on a Perkin-Elmer 377 semiautomated DNA sequencer (Applied BioSystems) using a Perkin-Elmer Prism terminator cycle sequencing kit (Applied BioSystems) with Ampli Taq FS polymerase and BigDye terminators. Both strands of each PCR product were sequenced. Complete sequences were assembled using Seqman II (DNASTAR). Sequences were compared visually to the original chromatograms to avoid reading errors. All sequences are accessible at GenBank under the accession No. HQ605086 - HQ605288 for COI, No. HQ605289 - HQ605491 for 
   <span class="italic">cyt b</span> and No. HQ605492 - HQ605694 for ND2.
  </p>
 </sec>
 <sec id="s2c" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Genetic diversity</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Sequences for COI, 
   <span class="italic">cyt b</span> and ND2 were aligned using ClustalW as implemented in MEGA 4 
   <a rid="pone.0029329-Tamura1" ref-type="bibr" href="#pone.0029329-Tamura1">[35]</a>. Since all fragments belong to the same DNA molecule, all subsequent analyses were performed with three sequences per individual concatenated in three partitions: COI from nucleotide 1–1227, 
   <span class="italic">cyt b</span> from nucleotide 1228–2211 and ND2 from nucleotide 2212–3192. The number of segregating sites, haplotype diversity and nucleotide diversity for each population and all populations combined were estimated using DnaSP 5.0 
   <a rid="pone.0029329-Librado1" ref-type="bibr" href="#pone.0029329-Librado1">[36]</a>.
  </p>
 </sec>
 <sec id="s2d" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Phylogenetic analyses</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Maximum likelihood (ML) and Bayesian methods (BI) were used to identify major lineages and evaluate relationships among haplotypes. An individual from the great tit 
   <span class="italic">(Parus major)</span> and long-tailed tit 
   <span class="italic">(Aegithalos caudatus)</span> were used as outgroups. The substitution models for each of the three gene sequence and the concatenated data sets were selected using MrMODELTEST 2.2 
   <a rid="pone.0029329-Nylander1" ref-type="bibr" href="#pone.0029329-Nylander1">[37]</a> as implemented in MrMTgui (
   <span ext-link-type="uri" xlink:href="http://genedrift.org/mtgui.php" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://genedrift.org/mtgui.php</span>) based on the Akaike information criterion 
   <a rid="pone.0029329-Akaike1" ref-type="bibr" href="#pone.0029329-Akaike1">[38]</a>. The best fit models for the COI and ND2 sequence data sets were GTR+I. The best fit model for the cytochrome-b sequence data set was HKY+I and the GTR+I+G model was selected as the best fit model for the concatenated data set.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">ML trees were constructed using PhyML version 3 
   <a rid="pone.0029329-Guindon1" ref-type="bibr" href="#pone.0029329-Guindon1">[39]</a>. The GTR model was used and the number of rate categories was set to 6. Proportion of invariable sites and gamma shape parameter were 0.92 and 1.92 respectively (estimated by MrMODELTEST). The robustness of lineages in the ML tree was tested by the bootstrap test with 100 resamplings. Bayesian inference (BI) was conducted in “partitioned by gene” using MrBayes 3.1.2 
   <a rid="pone.0029329-Ronquist1" ref-type="bibr" href="#pone.0029329-Ronquist1">[40]</a>. The concatenated sequence data was divided into three different partitions corresponding to the three mitochondrial regions and applied the best fit model for each partition. The model parameters were as following: lset applyto = (1, 3) nst = 6 rates = propinv; lset applyto = (2) nst = 2 rates = propinv. We allowed the overall rate to vary between partitions by setting the priors &lt;ratepr = variable&gt; and model parameters (e.g. gamma shape, proportion of invariable sites) unlinked across partitions. Four Metropolis-coupled Markov chains Monte Carlo (one cold and three heated) were run for 15 million iterations, with trees sampled every 1000 iterations. The first three million iterations (3000 trees) were discarded (‘burn-in’ period), and the posterior probabilities were estimated for remaining sampled iterations. Two independent Bayesian runs initiated from random starting trees were performed, and the log-likelihood values, posterior probabilities and average deviations of split frequencies were checked to ascertain that the chains had reached convergence.
  </p>
 </sec>
 <sec id="s2e" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Phylogeographic structure</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used unrooted networks to explore the phylogeographic structure of 
   <span class="italic">A. c. talifuensis–concinnus</span> because many of the underlying assumptions of traditional tree-building methods (e.g. fully bifurcating trees, complete lineage sorting) are often violated in intraspecific studies 
   <a rid="pone.0029329-Posada1" ref-type="bibr" href="#pone.0029329-Posada1">[41]</a>. The major-joining network was constructed with program NETWORK 4.5 
   <a rid="pone.0029329-Bandelt1" ref-type="bibr" href="#pone.0029329-Bandelt1">[42]</a>. An analysis of molecular variance was performed using ARLEQUIN 3.1.2 
   <a rid="pone.0029329-Excoffier1" ref-type="bibr" href="#pone.0029329-Excoffier1">[43]</a> to test the segregation of individuals according to the haplotype clusters indicated in the phylogenetic tree. Significance levels were determined by conducting nonparametric procedures 1000 times. In addition, because of the large number of samplings of lineage C, pairwise population differentiation was estimated by computing pairwise 
   <span class="italic">F</span>
   <sub>ST</sub>. Genetic distance and pairwise number of nucleotide differences were used to calculate the pairwise 
   <span class="italic">F</span>
   <sub>ST</sub>. A permutation test was used to calculate the probability that two populations had no genetic differentiation. For both tests, the significant level was set to 0.01.
  </p>
 </sec>
 <sec id="s2f" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">MDIV analysis</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used the coalescent-based program MDIV 
   <a rid="pone.0029329-Nielsen1" ref-type="bibr" href="#pone.0029329-Nielsen1">[44]</a> to determine the divergences between major lineages. MDIV uses a Bayesian approach to simultaneously approximate the posterior distribution of three parameters: divergence time between populations (
   <span class="italic">T = t
    <sub>div</sub>
   </span>/2
   <span class="italic">N
    <sub>e</sub>
   </span>), the migration rate between populations since divergence (
   <span class="italic">M</span> = 2
   <span class="italic">N
    <sub>e</sub>m
   </span>), and the population parameter theta (θ = 2
   <span class="italic">N
    <sub>e</sub>
   </span>µ, where µ is the per locus mutation rate). The program was first run using default search settings and priors (for theta and divergence time). Following this data exploration, we set our prior for 
   <span class="italic">T</span> and M to 5. Analyses were run for 5 million generations following a burn-in period of 500,000 generations, and repeated three times to ensure convergence upon the same posterior distributions for each of the parameter estimates. Because direct rate estimates for the concentrated sequence were not available, estimates of 
   <span class="italic">T</span> were converted to real time assuming a neutral mutation rate of 1.05×10
   <span class="sup">−8</span> substitutions/site/year according to the recent studies 
   <a rid="pone.0029329-Pckert2" ref-type="bibr" href="#pone.0029329-Pckert2">[45]</a>, 
   <a rid="pone.0029329-Weir3" ref-type="bibr" href="#pone.0029329-Weir3">[46]</a>. These rates were multiplied by the number of sequenced nucleotides to obtain our estimate of µ for the conversions. Divergence time estimates are intended only to give a general idea of the timescale of diversification; as with any such molecular clock estimates, they should be interpreted with caution. We used the formula 
   <div class="inline-formula">
    <span xlink:href="pone.0029329.e001.jpg" mimetype="image" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>estimate divergence times.
  </p>
 </sec>
 <sec id="s2g" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Historical demography</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Three commonly used methods were applied to explore the demographical history of 
   <span class="italic">A. c. talifuensis–concinnus</span>. First, statistical tests designed to assess whether nucleotide polymorphisms deviated from expectations under neutral theory [Tajima's D 
   <a rid="pone.0029329-Tajima1" ref-type="bibr" href="#pone.0029329-Tajima1">[47]</a> and Fu's 
   <a rid="pone.0029329-Fu1" ref-type="bibr" href="#pone.0029329-Fu1">[48]</a>
   <span class="italic">F
    <sub>S</sub>
   </span>] were carried out in ARLEQUIN 3.1.2. Significance of D and 
   <span class="italic">F
    <sub>S</sub>
   </span> values were determined using 1000 simulated samples to produce an expected distribution under selective neutrality and population equilibrium. The cut-off level for statistical significance was 0.05. For Fu's 
   <span class="italic">F
    <sub>S</sub>
   </span>, significance at the 0.05 level was indicated when P values were &lt;0.02 
   <a rid="pone.0029329-Excoffier1" ref-type="bibr" href="#pone.0029329-Excoffier1">[43]</a>.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Second, the program ARLEQUIN 3.1.2 was used to compare the observed frequency distribution of pairwise nucleotide differences among haplotypes with that expected from a population under expansion (Mismatch distribution analysis). For populations which have undergone historical expansions, plots of the distribution of pairwise differences among haplotypes are expected to be unimodal, whereas populations in equilibrium generally show multimodal distributions 
   <a rid="pone.0029329-Harpending1" ref-type="bibr" href="#pone.0029329-Harpending1">[49]</a>. Parametric bootstrapping was used to test the goodness-of-fit between the observed mismatch and sudden expansion model, and to obtain confidence intervals 
   <a rid="pone.0029329-Schneider1" ref-type="bibr" href="#pone.0029329-Schneider1">[50]</a>. The timing of population expansion was estimated by the mode (
   <span class="italic">τ</span>) of the mismatch distribution expressed in units of mutational time as 
   <span class="italic">t = τ</span>/2
   <span class="italic">u</span>
   <a rid="pone.0029329-Rogers1" ref-type="bibr" href="#pone.0029329-Rogers1">[51]</a>, where 
   <span class="italic">t</span> is the expansion time in number of generations and 
   <span class="italic">u</span> is the mutation rate per generation for the whole sequence.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Third, past population dynamics were examined using Bayesian skyline plots (BSP) in the program BEAST 1.4.8 
   <a rid="pone.0029329-Drummond1" ref-type="bibr" href="#pone.0029329-Drummond1">[52]</a>. This genealogical method utilizes MCMC sampling of sequence data to estimate a posterior distribution of effective population size through time and does not require a specified demographic model (e.g. constant size, exponential growth, logistic growth, or expansive growth) prior to the analysis. Bayesian skyline analyses were run under the conditions of the SRD06 model (four gamma categories), which has been found to provide a better fit for protein-coding nucleotide data. The mutation rate was the same as that used in the MDIV analyses. The number of grouped intervals (m) was set to five for lineages A and B because of the small number of sequences. For lineage C, m was set to ten. Five million iterations of the MCMC chains were run and sampled every 1000 iterations with the first 500,000 chains discarded as burnin. Bayesian skyline plots were generated with TRACER version 1.2.1 
   <a rid="pone.0029329-Drummond1" ref-type="bibr" href="#pone.0029329-Drummond1">[52]</a>.
  </p>
 </sec>
 <sec id="s2h" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Ecological niche models</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We used algorithms of MAXENT 
   <a rid="pone.0029329-Phillips1" ref-type="bibr" href="#pone.0029329-Phillips1">[53]</a>–
   <a rid="pone.0029329-Phillips2" ref-type="bibr" href="#pone.0029329-Phillips2">[54]</a> and DesktopGARP implementation of GARP with the best subsets provided by a free and open source software package OPENMODELLER 
   <a rid="pone.0029329-Anderson1" ref-type="bibr" href="#pone.0029329-Anderson1">[55]</a>–
   <a rid="pone.0029329-Giovanni1" ref-type="bibr" href="#pone.0029329-Giovanni1">[56]</a> to predict the distribution of target species during three periods; present, LGM (0.021–0.018 Ma) and LIG (0.14–0.12 Ma). Nineteen available environment data layers generated from CCSM paleo-climatic model 
   <a rid="pone.0029329-Collins1" ref-type="bibr" href="#pone.0029329-Collins1">[57]</a> during three periods were downloaded from the WorldClim dataset (
   <span ext-link-type="uri" xlink:href="http://www.worldclim.org/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.worldclim.org/</span>) 
   <a rid="pone.0029329-Hijmans1" ref-type="bibr" href="#pone.0029329-Hijmans1">[58]</a>. These data are high-resolution 
   <a rid="pone.0029329-Hijmans1" ref-type="bibr" href="#pone.0029329-Hijmans1">[58]</a> and have been applied to investigate Pleistocene climatic effects on an East Asian bat, the greater horseshoe bat 
   <span class="italic">Rhinolophus ferrumequinum</span>
   <a rid="pone.0029329-Flanders1" ref-type="bibr" href="#pone.0029329-Flanders1">[59]</a>.The data layers were 2.5′ spatial resolution for the present and LGM. The 30″ spatial resolution layers for LIG were subsequently resampled to a spatial resolution of 2.5' using ARC GIS 9.3. These environmental variables reflected annual trends for temperature and precipitation, bioclimatic seasonality, extreme conditions or potential limiting factors. ENMs were built according to current environmental factors, and then projected to three periods. All sample points were used as the model input.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">For MAXENT, we used the quadratic features and set the maximum iterations to 2000, replicates to 10. Eighty percent of the localities were randomly selected to train the model and the remaining 20% to test the model performance. The fade-by-clamp option was selected to remove heavily clamped pixels from the final prediction. Other parameters were used default values. For GARP, We changed the total run to 100, max generations to 900 and training proportion to 80. The training data was divided into true training data (for model rule development) and intrinsic testing data (for rule-testing intrinsic to GARP processing), and the remaining 20% data was set aside for an independent test of model quality. The ‘best subset’ was generated according to the soft omission threshold of 20% and the commission threshold of 50%.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">The value of AUC (Area under curves), sensitivity and omission error were used to assess the model's performance 
   <a rid="pone.0029329-Swets1" ref-type="bibr" href="#pone.0029329-Swets1">[60]</a>–
   <a rid="pone.0029329-Lobo1" ref-type="bibr" href="#pone.0029329-Lobo1">[61]</a>. We selected the Arc/Info ASC II Grid as output format, which can be easily handled with GIS software. The output maps were imported to ARC GIS 9.3 to produce final maps. Different map colors corresponded to different fitting indices in the potential distribution maps. The two algorithms generated the similar potential suitable distribution for each period but were different in range and location of the most suitable habitat. As the GARP modelling also showed the values of sensitivity (1) and omission error (0) 
   <a rid="pone.0029329-Lobo1" ref-type="bibr" href="#pone.0029329-Lobo1">[61]</a>, we described the change of species distribution mainly based on the predictions of GARP but drew the conclusions by adopting a conservative approach by including areas predicted as ‘suitable’ or “unsuitable” by both models 
   <a rid="pone.0029329-Flanders1" ref-type="bibr" href="#pone.0029329-Flanders1">[59]</a>, 
   <a rid="pone.0029329-Waltari1" ref-type="bibr" href="#pone.0029329-Waltari1">[62]</a>.
  </p>
 </sec>
</sec>
