<?xml version="1.0" encoding="UTF-8"?>
<p class="p">In the first stage, we used a time series Poisson regression model for hot season data to obtain community-specific estimates allowing for over-dispersed death counts. Seasonality was controlled for using a natural cubic spline with 4 degrees of freedom (equally spaced knots) for day of the season. Long-term trend was controlled for using a natural cubic spline with 1 degree of freedom per 10 years. A categorical variable was used to control for the potential confounding effect of day of the week. As the effects of heatwaves on mortality usually appeared immediately and lasted for several days, a natural cubic spline with 4 degrees of freedom was used to capture the distributed lag effect of waves (as a 0–1 variable) over time, up to 10 days [
 <xref rid="pmed.1002629.ref005" ref-type="bibr" class="xref">5</xref>]. The residual deviance was used to check the model fit, which is a standard method for time series analysis of the associations between air pollution/temperature and mortality [
 <xref rid="pmed.1002629.ref028" ref-type="bibr" class="xref">28</xref>]. We chose the last year’s data as test data and other years’ data as training data for each city, to cross-validate our model. The cross-validation indicated that our model had a high predictive ability, with correlation of R
 <sup class="sup">2</sup> = 0.9 between predicted deaths and observed deaths during heatwave days (Fig A in 
 <bold class="bold">
  <xref ref-type="supplementary-material" rid="pmed.1002629.s001" class="xref">S1 Appendix</xref>
 </bold>).
</p>
