<?xml version="1.0" encoding="UTF-8"?>
<p id="Par28" class="p">We modelled the colonization rate 
 <italic class="italic">r</italic>
 <sub class="sub">
  <italic class="italic">γ,s,t</italic>
 </sub> of the species as a function of spatial connectivity to extant cells with a 
 <italic class="italic">logarithmic</italic>-link function. Connectivity describes the distance-dependent influence of all potential neighbouring source populations 
 <italic class="italic">s</italic>' via a negative exponential dispersal kernel
 <sup class="sup">
  <xref ref-type="bibr" rid="CR62" class="xref">62</xref>
 </sup>:
 <disp-formula id="Equ6" class="disp-formula">
  <label class="label">6</label>
  <alternatives class="alternatives">
   <tex-math id="M11" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm{log}({r}_{\gamma ,s,t})=\lambda \sum _{s\ne {s}^{^{\prime} }}\exp (-\alpha {d}_{s,{s}^{^{\prime} }}){z}_{{s}^{^{\prime} },t}$$\end{document}</tex-math>
   <math id="M12" display="block" class="math">
    <mi class="mi">log</mi>
    <mrow class="mrow">
     <mo stretchy="true" class="mo">(</mo>
     <mrow class="mrow">
      <msub class="msub">
       <mrow class="mrow">
        <mi class="mi">r</mi>
       </mrow>
       <mrow class="mrow">
        <mi class="mi">γ</mi>
        <mo class="mo">,</mo>
        <mi class="mi">s</mi>
        <mo class="mo">,</mo>
        <mi class="mi">t</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="true" class="mo">)</mo>
    </mrow>
    <mo class="mo">=</mo>
    <mi class="mi">λ</mi>
    <munder class="munder">
     <mo class="mo">∑</mo>
     <mrow class="mrow">
      <mi class="mi">s</mi>
      <mo class="mo">≠</mo>
      <msup class="msup">
       <mrow class="mrow">
        <mi class="mi">s</mi>
       </mrow>
       <mo class="mo">′</mo>
      </msup>
     </mrow>
    </munder>
    <mi class="mi">exp</mi>
    <mrow class="mrow">
     <mo stretchy="true" class="mo">(</mo>
     <mrow class="mrow">
      <mo class="mo">−</mo>
      <mi class="mi">α</mi>
      <msub class="msub">
       <mrow class="mrow">
        <mi class="mi">d</mi>
       </mrow>
       <mrow class="mrow">
        <mi class="mi">s</mi>
        <mo class="mo">,</mo>
        <msup class="msup">
         <mrow class="mrow">
          <mi class="mi">s</mi>
         </mrow>
         <mo class="mo">′</mo>
        </msup>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="true" class="mo">)</mo>
    </mrow>
    <msub class="msub">
     <mrow class="mrow">
      <mi class="mi">z</mi>
     </mrow>
     <mrow class="mrow">
      <msup class="msup">
       <mrow class="mrow">
        <mi class="mi">s</mi>
       </mrow>
       <mo class="mo">′</mo>
      </msup>
      <mo class="mo">,</mo>
      <mi class="mi">t</mi>
     </mrow>
    </msub>
   </math>
   <graphic xlink:href="41598_2017_10772_Article_Equ6.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>where 
 <italic class="italic">z</italic>
 <sub class="sub">
  <italic class="italic">s′,t</italic>
 </sub> is the occupancy of cell 
 <italic class="italic">s′</italic> in period 
 <italic class="italic">t</italic>, 
 <italic class="italic">d</italic>
 <sub class="sub">
  <italic class="italic">s,s′</italic>
 </sub> is the distance between cells 
 <italic class="italic">s</italic> and 
 <italic class="italic">s′</italic>, 1⁄
 <italic class="italic">α</italic> is the average dispersal distance, and 
 <italic class="italic">λ</italic> is a constant. We did not estimate the additional scaling constant 
 <italic class="italic">λ</italic> from our data
 <sup class="sup">
  <xref ref-type="bibr" rid="CR62" class="xref">62</xref>
 </sup>, because direct estimation of this parameter from our data would cause parameter redundancy with the intercept 
 <italic class="italic">β</italic>
 <sub class="sub">
  <italic class="italic">φ</italic>,0
 </sub> in equation (
 <xref rid="Equ5" ref-type="" class="xref">5</xref>). To avoid problems with parameter identifiability, we estimated 
 <italic class="italic">β</italic>
 <sub class="sub">
  <italic class="italic">φ</italic>,0
 </sub> and set 
 <italic class="italic">λ</italic> = 1
 <sup class="sup">
  <xref ref-type="bibr" rid="CR43" class="xref">43</xref>
 </sup>. Using alternative values of 
 <italic class="italic">λ</italic> did not affect any of our conclusions, because it causes a proportional shift of the estimate for the intercept 
 <italic class="italic">β</italic>
 <sub class="sub">
  <italic class="italic">φ</italic>,0
 </sub>. To account for coastline shape and elevation differences (terrain shape), we calculated dispersal distances 
 <italic class="italic">d</italic> between cells as Least Cost Path (LCP) distances (Supplementary Methods). We extracted high-resolution elevation data from WorldClim
 <sup class="sup">
  <xref ref-type="bibr" rid="CR35" class="xref">35</xref>
 </sup> (0.5′ × 0.5′ resolution) and resampled these data to a resolution of 5 × 5 km
 <sup class="sup">2</sup> for calculation of Least Cost Path (LCP) distances. To account for uncertainty regarding colonization of the European continent by the brown bear from Asia
 <sup class="sup">
  <xref ref-type="bibr" rid="CR19" class="xref">19</xref>, 
  <xref ref-type="bibr" rid="CR38" class="xref">38</xref>, 
  <xref ref-type="bibr" rid="CR63" class="xref">63</xref>
 </sup> we considered two scenarios with and without colonization of Europe from Asia, respectively (Supplementary Methods and Supplementary Fig. 
 <xref rid="MOESM1" ref-type="media" class="xref">5</xref>).
</p>
