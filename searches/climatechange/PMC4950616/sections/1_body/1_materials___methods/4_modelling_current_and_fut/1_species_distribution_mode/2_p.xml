<?xml version="1.0" encoding="UTF-8"?>
<p class="p">We used species occurrence data and environmental predictors to build species distribution models using eight modelling techniques: three regression methods (generalized additive models, GAM; generalized linear models, GLM; multivariate adaptive regression splines, MARS), two classification methods (mixture discriminant analysis, MDA; classification tree analysis, CTA) and three machine learning methods (artificial neural networks, ANN; generalized boosted models, GBM; random forest, RF). All models were produced using default BIOMOD parameters where appropriate (
 <xref rid="ref-95" ref-type="bibr" class="xref">Thuiller et al.</xref>, 
 <xref rid="ref-95" ref-type="bibr" class="xref">2009</xref>). Further parameters were as follows: GLMs were generated using quadratic terms and a stepwise procedure with the AIC criteria; GAMs were generated with a spline function with three degrees of smoothing; GBMs were built with a maximum of 2,000 trees; ANNs were produced with five cross-validations (see 
 <xref rid="ref-61" ref-type="bibr" class="xref">Marmion et al.</xref>, 
 <xref rid="ref-61" ref-type="bibr" class="xref">2009a</xref> for further details on these modelling techniques). For each species, we built the eight species distribution models using a random subset of data containing 70% of the 20 × 20-km cells (i.e., 4,493 cells). We used the remaining 30% (i.e., 1,925 cells) to evaluate the predictive performance of the models. We repeated this split-sample procedure ten times, thus calibrating 80 different statistical models for each species. We simulated suitability under climate change (future suitability) by projecting each of the 80 projections under each of the seven climate simulations for 2080. This generated a total of 560 probabilities (ten repetitions × eight modelling techniques × seven climate simulations) of habitat suitability for each species for the 2080 period. We combined the different probabilities of habitat suitability (P) based on the area under the receiver-operating characteristic (ROC) curve (AUC) values; we assigned the AUC values from each modelling technique as the weights of the weighted average in order to enhance the contributions of models with higher performance values: 
 <disp-formula id="fd1" class="disp-formula">
  <label class="label">(1)</label>
  <alternatives class="alternatives">
   <graphic xlink:href="peerj-04-2218-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <tex-math id="M1" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} }{}\begin{eqnarray*}{\mathrm{WAP}}_{{i}_{\mathrm{baseline}}}= \frac{\sum _{j=1}^{8}\sum _{k=1}^{10} \left( {\mathrm{AUC}}_{jk}\times {P}_{ijk} \right) }{\sum _{j=1}^{8}\sum _{k=1}^{10}({\mathrm{AUC}}_{jk})} \end{eqnarray*}\end{document}</tex-math>
   <math id="mml-fd1" class="math">
    <mstyle displaystyle="true" class="mstyle">
     <msub class="msub">
      <mrow class="mrow">
       <mi mathvariant="normal" class="mi">WAP</mi>
      </mrow>
      <mrow class="mrow">
       <msub class="msub">
        <mrow class="mrow">
         <mi class="mi">i</mi>
        </mrow>
        <mrow class="mrow">
         <mi mathvariant="normal" class="mi">baseline</mi>
        </mrow>
       </msub>
      </mrow>
     </msub>
     <mo class="mo">=</mo>
     <mfrac class="mfrac">
      <mrow class="mrow">
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo">∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">j</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">8</mn>
        </mrow>
       </munderover>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">k</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">10</mn>
        </mrow>
       </munderover>
       <mfenced separators="" open="(" close=")" class="mfenced">
        <mrow class="mrow">
         <msub class="msub">
          <mrow class="mrow">
           <mi mathvariant="normal" class="mi">AUC</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
          </mrow>
         </msub>
         <mo class="mo">×</mo>
         <msub class="msub">
          <mrow class="mrow">
           <mi class="mi">P</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">i</mi>
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
          </mrow>
         </msub>
        </mrow>
       </mfenced>
      </mrow>
      <mrow class="mrow">
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">j</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">8</mn>
        </mrow>
       </munderover>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">k</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">10</mn>
        </mrow>
       </munderover>
       <mrow class="mrow">
        <mfenced separators="" open="(" close=")" class="mfenced">
         <msub class="msub">
          <mrow class="mrow">
           <mi mathvariant="normal" class="mi">AUC</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
          </mrow>
         </msub>
        </mfenced>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
   </math>
  </alternatives>
 </disp-formula>
 <disp-formula id="fd2" class="disp-formula">
  <label class="label">(2)</label>
  <alternatives class="alternatives">
   <graphic xlink:href="peerj-04-2218-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <tex-math id="M2" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} }{}\begin{eqnarray*}{\mathrm{WAP}}_{{i}_{2080}}= \frac{\sum _{j=1}^{8}\sum _{k=1}^{10}\sum _{l=1}^{7} \left( {\mathrm{AUC}}_{jk}\times {P}_{ijkl} \right) }{7\times \sum _{j=1}^{8}\sum _{k=1}^{10}({\mathrm{AUC}}_{jk})} \end{eqnarray*}\end{document}</tex-math>
   <math id="mml-fd2" class="math">
    <mstyle displaystyle="true" class="mstyle">
     <msub class="msub">
      <mrow class="mrow">
       <mi mathvariant="normal" class="mi">WAP</mi>
      </mrow>
      <mrow class="mrow">
       <msub class="msub">
        <mrow class="mrow">
         <mi class="mi">i</mi>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">2080</mn>
        </mrow>
       </msub>
      </mrow>
     </msub>
     <mo class="mo">=</mo>
     <mfrac class="mfrac">
      <mrow class="mrow">
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo">∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">j</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">8</mn>
        </mrow>
       </munderover>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">k</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">10</mn>
        </mrow>
       </munderover>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">l</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">7</mn>
        </mrow>
       </munderover>
       <mfenced separators="" open="(" close=")" class="mfenced">
        <mrow class="mrow">
         <msub class="msub">
          <mrow class="mrow">
           <mi mathvariant="normal" class="mi">AUC</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
          </mrow>
         </msub>
         <mo class="mo">×</mo>
         <msub class="msub">
          <mrow class="mrow">
           <mi class="mi">P</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">i</mi>
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
           <mi class="mi">l</mi>
          </mrow>
         </msub>
        </mrow>
       </mfenced>
      </mrow>
      <mrow class="mrow">
       <mn class="mn">7</mn>
       <mo class="mo">×</mo>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo">∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">j</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">8</mn>
        </mrow>
       </munderover>
       <munderover class="munderover">
        <mrow class="mrow">
         <mo mathsize="big" movablelimits="false" class="mo"> ∑</mo>
        </mrow>
        <mrow class="mrow">
         <mi class="mi">k</mi>
         <mo class="mo">=</mo>
         <mn class="mn">1</mn>
        </mrow>
        <mrow class="mrow">
         <mn class="mn">10</mn>
        </mrow>
       </munderover>
       <mrow class="mrow">
        <mfenced separators="" open="(" close=")" class="mfenced">
         <msub class="msub">
          <mrow class="mrow">
           <mi mathvariant="normal" class="mi">AUC</mi>
          </mrow>
          <mrow class="mrow">
           <mi class="mi">j</mi>
           <mi class="mi">k</mi>
          </mrow>
         </msub>
        </mfenced>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
   </math>
  </alternatives>
 </disp-formula>where WAP is the weighted average probability of habitat suitability, 
 <italic class="italic">i</italic> is the index of the grid cell (1, …, 6418), 
 <italic class="italic">j</italic> is the modelling technique (GAM, GLM, MARS, CTA, MDA, ANN, GBM, RF), 
 <italic class="italic">k</italic> is the repetition (1, …, 10) and 
 <italic class="italic">l</italic> is the climate simulation (1, …, 7). Averaged projections resulted in a single projection at each grid cell for each species (hereafter referred as the “average model”) for the baseline period (WAP
 <sub class="sub">
  <italic class="italic">i</italic>
  <sub class="sub">baseline</sub>
 </sub>; 
 <xref ref-type="disp-formula" rid="fd1" class="xref">Eq. 1</xref>) and the 2080 period (WAP
 <sub class="sub">
  <italic class="italic">i</italic>
  <sub class="sub">2080</sub>
 </sub>; 
 <xref ref-type="disp-formula" rid="fd2" class="xref">Eq. 2</xref>). This method is considered to be more robust than other model fusion methods or single model projections (
 <xref rid="ref-62" ref-type="bibr" class="xref">Marmion et al.</xref>, 
 <xref rid="ref-62" ref-type="bibr" class="xref">2009b</xref>).
</p>
