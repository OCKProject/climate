<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec10" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Model construction</div>
 <sec id="Sec11" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Species distribution models</div>
  <p id="Par30" xmlns="http://www.w3.org/1999/xhtml">To assess the impact of climate change on the distribution of 
   <span class="italic">L. muta japonica</span> in the alpine zones of central Japan, we developed a species distribution model that included three sub-models (Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2</a>). The model was constructed based on the hypotheses that the functional relationships of 
   <span class="italic">L. muta japonica</span> depend highly on the alpine plant communities in terms of quantity and quality, which depend on climate at macro-scales and topography at small scales. The model was constructed in two main parts. The first part of the model aimed to predict potential habitat for 
   <span class="italic">L. muta japonica</span> based on the area fractions of three alpine vegetation communities and distance from the ridge (sub-model A). The second part of the model aimed to predict the area fractions of alpine vegetation communities based on climatic and topographic variables (sub-model B1 and B2). Potential habitats for 
   <span class="italic">L. muta japonica</span> under future climate change scenarios were projected by applying the future area fractions of alpine vegetation communities, which were predicted from sub-model B2, on sub-model A. All of the models (sub-model A, B1 and B2) were developed by using R2.15.2 [
   <a ref-type="bibr" rid="CR42" href="#CR42">42</a>]. Detailed explanations of each model are provided in the following sections.
   <div id="Fig2" class="fig">
    <span class="label">Fig. 2</span>
    <div class="caption">
     <p>Model scheme for assessing the impact of climate change on the distribution of 
      <span class="italic">Lagopus muta japonica</span> in the alpine zones of central Japan. Abbreviations in this scheme are as follows: WI (warmth index), Warmth Index; TMC (minimum temperature), minimum temperature of the coldest month; PRS (summer precipitation), precipitation of the coldest month; MSW (maximum snowwater), maximum snowwater equivalent (see “
      <a rid="Sec2" ref-type="sec" href="#Sec2">Methods</a>” for details)
     </p>
    </div>
    <div xlink:href="12898_2019_238_Fig2_HTML" id="MO2" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
 </sec>
 <sec id="Sec12" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Sub-model A for predicting the potential habitat of 
   <span class="italic">L. muta japonica</span>
  </div>
  <p id="Par31" xmlns="http://www.w3.org/1999/xhtml">A generalized additive model (GAM) [
   <a ref-type="bibr" rid="CR43" href="#CR43">43</a>] was used to predict the potential habitat for 
   <span class="italic">L. muta japonica</span>. We used the package “mgcv” to construct a GAM in R. Data on the presence and absence of territories for 
   <span class="italic">L. muta japonica</span> were used as a response variable. The area fractions of three alpine vegetation communities in the territories and 300-m grid cells of absent areas were used as explanatory variables, together with distance from the ridge. The three communities used were the 
   <span class="italic">P. pumila</span>, snowbed grassland, and alpine fellfield communities. The number of surveys was included as an offset term, to incorporate the effect of survey effort. The area fraction of the 
   <span class="italic">P. pumila</span> community was used as a combination term with distance from the ridge, based on the thin plate smoothing spline algorithm (see Additional file 
   <a rid="MOESM4" ref-type="media" href="#MOESM4">4</a>: Appendix S2). The relative importance of the variables (IOV) was calculated based on the Akaike weight for all of the models, which was developed by all combinations of explanatory variables [
   <a ref-type="bibr" rid="CR44" href="#CR44">44</a>].
  </p>
  <p id="Par32" xmlns="http://www.w3.org/1999/xhtml">We validated the accuracy of the model by calculating the area under the curve (AUC) of the receiver operating characteristic (ROC) analysis [
   <a ref-type="bibr" rid="CR45" href="#CR45">45</a>] based on predicted presence/absence data and the validation data, which was bootstrapped from all of the training data with 100 repetitions. We chose using whole data for modeling and bootstrapped data for validation because we considered development of good model more important than the robustness of validation (although validation results could be slightly overestimated). The AUC ranges from 0.5 for models with no discrimination ability to 1.0 for models with perfect discrimination [
   <a ref-type="bibr" rid="CR45" href="#CR45">45</a>]. In addition, we calculated model sensitivity and specificity (the proportions of presence and absence data correctly predicted) based on the predicted and actual presence/absence data of 
   <span class="italic">L. muta japonica</span> territories. We defined a threshold value by assigning a cutoff sensitivity (95%), as recommended by Pearson et al. [
   <a ref-type="bibr" rid="CR46" href="#CR46">46</a>]. The threshold was defined based on model predictions for the entire training data set. We defined areas with probabilities greater than, or equal to, the threshold probability as potential habitat, and areas with probabilities lower than the threshold value as non-habitat.
  </p>
 </sec>
 <sec id="Sec13" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Sub-models B1 and B2 for predicting the area fractions of alpine vegetation communities</div>
  <p id="Par33" xmlns="http://www.w3.org/1999/xhtml">We developed two sub-models to predict the area fractions of alpine vegetation communities (B1 and B2). In general, plant species distributions are assumed to be controlled by climate at large scales and by non-climatic factors at small scales, including topography, soil conditions, and biotic interactions [
   <a ref-type="bibr" rid="CR47" href="#CR47">47</a>]. In the present study, we assumed that climatic conditions control the occurrence of alpine vegetation zones at macro-scales, whereas topographic conditions with climatic suitability control the area fractions of alpine vegetation communities at micro-scales. On the basis of this assumption, we constructed two sub-models by using different explanatory variables at different spatial scales for each sub-model as follows.
  </p>
  <p id="Par34" xmlns="http://www.w3.org/1999/xhtml">We used a GAM to predict the occurrence of the alpine vegetation zone (sub-model B1), which contained the 
   <span class="italic">P. pumila</span> community, snowbed grassland community, and alpine fellfield community, at 100-m grid cells (ca. 0.01 km
   <span class="sup">2</span>). Four climatic variables—warmth index [
   <a ref-type="bibr" rid="CR32" href="#CR32">32</a>], minimum temperature, summer precipitation, and maximum snowwater—at 1-km resolution were used as explanatory variables. Warmth index was used as an interaction term with minimum temperature based on the thin plate smoothing spline algorithm [
   <a ref-type="bibr" rid="CR43" href="#CR43">43</a>]. Model accuracy was evaluated by using the AUC together with sensitivity and specificity. Current and future occurrence probabilities of the alpine vegetation zone were predicted by applying the GAM on the current climate and 24 future climate scenarios.
  </p>
  <p id="Par35" xmlns="http://www.w3.org/1999/xhtml">We used random forests (RF) [
   <a ref-type="bibr" rid="CR48" href="#CR48">48</a>] to predict area fractions of alpine vegetation communities (sub-model B2). The package “randomForest” was used for constructing an RF in R. The RF is a model that is based on the machine learning method and has a powerful and high generalizing capability. The model was developed based on the ensemble of numerous classification tree models, by using sub-sampled data from the training data. Area fractions of alpine vegetation communities in each grid cell were used as response variables. As explanatory variables, we used five topographic variables (slope, aspect, curvature, TWI, and distance from the ridgeline) and the occurrence probability of the alpine vegetation zone calculated by sub-model B1. The occurrence probability of the alpine vegetation zone was used as an indicator of climatic suitability for each alpine vegetation community. Correlations between actual and predicted values of area fractions were verified by using Spearman’s rank sum test. The importance of each variable was identified based on increased mean square errors (increased MSE). Increased MSE measures the effect on the predictive power when the value of a specific original variable is randomly permuted [
   <a ref-type="bibr" rid="CR49" href="#CR49">49</a>].
  </p>
 </sec>
</sec>
