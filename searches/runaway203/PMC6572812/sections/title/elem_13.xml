<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec14" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Challenges from a methodological perspective</div>
 <sec id="Sec15" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Process challenges</div>
  <p id="Par31" xmlns="http://www.w3.org/1999/xhtml">At the process level, a number of challenges arise due to the time-dependent nature of the processes giving rise to strong autocorrelation (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 1) and time delays (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 2). Next, ubiquitous nonlinearity (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 3), also in the form of state-dependence (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 4) and synergy (see Fig. 
   <a rid="Fig3" ref-type="fig" href="#Fig3">3c</a>), requires a careful selection of the estimation method (see nonlinear methods in method overview section). Note that sometimes variables from model output can be deterministically related via a set of equations, which poses a serious problem for many, but not all, causal methods
   <span class="sup">
    <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span>. As mentioned in the jet stream example, a geoscientific time series will typically contain signals from different processes acting on vastly different time scales, e.g., oceanic and atmospheric ones, which may need to be disentangled to better interpret causal links (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 5). A basic assumption in a number of statistical methods used in causal inference frameworks (e.g., linear regression) is the assumption that the noise distribution is Gaussian, which is violated by processes featuring heavy tails and extreme events (e.g., precipitation; Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 6). On the other hand, some methods turn non-Gaussianity into an advantage
   <span class="sup">
    <a ref-type="bibr" rid="CR54" href="#CR54">54</a>
   </span> (Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2d</a>).
   <div id="Fig4" class="fig">
    <span class="label">Fig. 4</span>
    <div class="caption">
     <p>Methodological challenges for causal discovery in complex spatio-temporal systems such as the Earth system. At the process level, autocorrelation (1), time delays (2), and nonlinearity (3), also in the form of state-dependence and synergistic behavior (4), require a careful selection of the estimation method. Further, a time series might contain signals from different processes acting on vastly different time scales (5). Noise distributions (6) can feature heavy tails and extreme-values which challenges the ubiquitous methodological Gaussian assumption. At the data aggregation level, the most basic challenge is the definition of the causally relevant variables (7) representing the subprocesses of interest from spatio-temporally gridded data (e.g., from satellites) or station data measurements. Unobserved variables (8) need to be taken into account regarding a causal interpretation of the estimated graph. Time sub-sampling (9) and aggregation (10) can make causal links appear contemporaneous and even cyclic due to insufficient time resolution (e.g., due to the standard practice of time averaging depicted here in a time series graph
      <span class="sup">
       <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
      </span>). Causal inferences are degraded due to measurement errors (11) such as observational noise, systematic biases (first few samples), or even missing values (grey samples), that may be causally related to the measured process, constituting a form of selection bias (12). Some datasets are of a discrete type (13), either due to quantization, or as categorical data, e.g., an index representing different weather regimes, and require methods that deal with discrete, and also mixed data types. Next to measurement value uncertainties, for paleo-climatic data even the measurement time points typically are given only with uncertainty (14), which especially challenges methods exploiting time-order. At the computational and statistical level, the scalability of methods, regarding both sample size (15) and high dimensionality (16) due to the number of variables as well as large time delays, is of crucial practical relevance for computational run-time and detection power. Finally, uncertainty estimation (17, width of links), also taking into account data uncertainties, poses a major challenge
     </p>
    </div>
    <div xlink:href="41467_2019_10105_Fig4_HTML" id="d29e2545" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
 </sec>
 <sec id="Sec16" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Data challenges</div>
  <p id="Par32" xmlns="http://www.w3.org/1999/xhtml">At the data aggregation level, our generic examples demonstrate that a major challenge is to define and reconstruct the causally relevant variables that represent the subprocesses of interest (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 7). These variables have to be extracted from typically high-dimensional spatio-temporal gridded datasets (e.g., from satellite observations or model output) or station data measurements, which can be done by dimensionality reduction methods. Moreover, these extracted variables should be interpretable and represent physical subprocesses of the system.
  </p>
  <p id="Par33" xmlns="http://www.w3.org/1999/xhtml">Often, relevant drivers cannot be measured, which requires to consider the possibility of unobserved variables (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 8) regarding a causal interpretation of the estimated graph, since they may render detected links spurious (see also Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>). Arguably, identifying the absence of a causal link, implying that a physical mechanism is unlikely
   <span class="sup">
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span>, is a more robust finding, which requires less strong assumptions (no Causal Sufficiency). Another aspect of Causal Sufficiency is that not taking into account important drivers, such as anthropogenic climate forcings, may render time series nonstationary. Time series pose a particular challenge regarding time-subsampling (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 9), which can also be considered as a case of unobserved samples of a variable, and time-aggregation (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 10) which can let causal dependencies appear contemporaneous or even cyclic. The standard GC cannot deal with contemporaneous links, which can be identified using network learning algorithms or SCMs (see also Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>).
  </p>
  <p id="Par34" xmlns="http://www.w3.org/1999/xhtml">On the data quality side, satellites, as well as station instruments, are plagued by all kinds of measurement errors (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 11) such as observational noise, systematic biases, and also missing values (notably cloud occlusions or sensor malfunctioning). These may also be causally related to the measured process, constituting a form of selection bias (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 12).
  </p>
  <p id="Par35" xmlns="http://www.w3.org/1999/xhtml">While in Earth system sciences the data will often attain a continuous range of values (e.g., temperature), variables can also be of a discrete type (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 13), either due to quantization, or as categorical data. For example, one may be interested in causal drivers of an index representing different weather regimes or a time series of rarely occurring extreme events, which additionally raises the challenge of class imbalance—many 0 and few 1. Causal inference problems with such data require a suitable choice of methods, for example, conditional independence tests adapted to mixed data types. For paleo-climate data, the assumption of a time order is challenged since the measurement time points typically are given only with uncertainty (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 14).
  </p>
 </sec>
 <sec id="Sec17" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Computational and statistical challenges</div>
  <p id="Par36" xmlns="http://www.w3.org/1999/xhtml">From a computational and statistical point of view, scalability is a crucial issue, both regarding sample size (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 15) and high dimensionality (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 16). While larger sample sizes (long time series) are typically always beneficial for more reliable causal inferences, the computational time of methods may scale unfavorably with sample size (e.g., cubically for some kernel methods
   <span class="sup">
    <a ref-type="bibr" rid="CR16" href="#CR16">16</a>
   </span>). The more variables are taken into account for explaining a potentially spurious relationship, the more credible a causal discovery becomes. However, many variables together with large time lags to account for physical time delays (e.g., to identify atmospheric teleconnections), lead to high dimensionality which may strongly affect statistical reliability. This compromises statistical power, that is, the probability to detect a true causal link, and potentially also the control of false positives at a desired significance level
   <span class="sup">
    <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span>. Low-statistical power implies that, especially, weak causal effects with low signal-to-noise ratio, which are sometimes of interest, are not well detected. Last, uncertainty estimation (Fig. 
   <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, point 17) that also takes into account potentially available data uncertainties (measurement value as well as dating uncertainties, see points 11 and 14), poses a major challenge for causal inference methods.
  </p>
  <p id="Par37" xmlns="http://www.w3.org/1999/xhtml">Most of the challenges discussed in this section are the same for correlation or regression methods which are, in addition, ambiguous to interpret and often lead to incorrect conclusions as shown in the examples section. We therefore emphasize that there is no strong reason to avoid adoption and exploration of modern causal inference techniques. Each of the methods summarized in the method overview section addresses one or several of these challenges. In Table 
   <a rid="Tab1" ref-type="table" href="#Tab1">1</a> we list key strengths and suggest future research directions further discussed in the next section.
   <div id="Tab1" class="table-wrap">
    <span class="label">Table 1</span>
    <div class="caption">
     <p>List of methods, key strengths, and further research directions addressing current limitations</p>
    </div>
    <table frame="hsides" rules="groups">
     <thead>
      <tr>
       <th>Method</th>
       <th>Key strengths</th>
       <th>Further research directions</th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>Granger causality and nonparametric extensions
        <span class="sup">
         <a ref-type="bibr" rid="CR9" href="#CR9">9</a>,
         <a ref-type="bibr" rid="CR37" href="#CR37">37</a>,
         <a ref-type="bibr" rid="CR99" href="#CR99">99</a>
        </span>
       </td>
       <td>Significance assessment; nonparametric versions</td>
       <td>Dealing with contemporaneous effects and feedback cycles; high-dimensionality; deterministic dependencies; synergistic effects; time scales; unobserved variables</td>
      </tr>
      <tr>
       <td>Nonlinear state-space methods
        <span class="sup">
         <a ref-type="bibr" rid="CR10" href="#CR10">10</a>,
         <a ref-type="bibr" rid="CR11" href="#CR11">11</a>
        </span>
       </td>
       <td>State-dependent nonlinear systems; contemporaneous effects</td>
       <td>Significance assessment; high-dimensionality; highly synchronous dynamics; high stochasticity; time scales; unobserved variables</td>
      </tr>
      <tr>
       <td>Conditional independence-based algorithms
        <span class="sup">
         <a ref-type="bibr" rid="CR12" href="#CR12">12</a>
        </span>
       </td>
       <td>High-dimensionality; unobserved variables; nonparametric tests</td>
       <td>Significance assessment; deterministic effects; synergistic effects; time scales; contemporaneous feedback cycles</td>
      </tr>
      <tr>
       <td>PCMCI
        <span class="sup">
         <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
         <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
        </span>
       </td>
       <td>High-dimensionality; time delays; strong autocorrelation; nonparametric tests</td>
       <td>Unobserved variables; deterministic effects; synergistic effects; time scales; contemporaneous feedback cycles</td>
      </tr>
      <tr>
       <td>Information-theoretic algorithms
        <span class="sup">
         <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
         <a ref-type="bibr" rid="CR24" href="#CR24">24</a>,
         <a ref-type="bibr" rid="CR51" href="#CR51">51</a>
        </span>
       </td>
       <td>High-dimensionality; nonparametric; time delays; information-theoretic interpretation</td>
       <td>Significance assessment; unobserved variables; deterministic effects; synergistic effects; time scales; contemporaneous feedback cycles; efficient entropy estimation</td>
      </tr>
      <tr>
       <td>Structural causal models
        <span class="sup">
         <a ref-type="bibr" rid="CR13" href="#CR13">13</a>,
         <a ref-type="bibr" rid="CR38" href="#CR38">38</a>
        </span>
       </td>
       <td>Contemporaneous effects; nonparametric versions</td>
       <td>High-dimensionality; synergistic effects; time scales; unobserved variables; time delays</td>
      </tr>
      <tr>
       <td>Invariance-based methods
        <span class="sup">
         <a ref-type="bibr" rid="CR4" href="#CR4">4</a>,
         <a ref-type="bibr" rid="CR13" href="#CR13">13</a>,
         <a ref-type="bibr" rid="CR57" href="#CR57">57</a>,
         <a ref-type="bibr" rid="CR58" href="#CR58">58</a>,
         <a ref-type="bibr" rid="CR60" href="#CR60">60</a>,
         <a ref-type="bibr" rid="CR61" href="#CR61">61</a>
        </span>
       </td>
       <td>Utilizes heterogeneity in space and time</td>
       <td>Causality in stationary regimes; same as for SCMs</td>
      </tr>
      <tr>
       <td>Bayesian score-based approaches
        <span class="sup">
         <a ref-type="bibr" rid="CR48" href="#CR48">48</a>
        </span>
       </td>
       <td>Bayesian uncertainty assessment; inclusion of expert knowledge</td>
       <td>High-dimensionality; nonlinearity; deterministic effects; synergistic effects; time scales; contemporaneous feedback cycles; unobserved variables; combine with cond. independence-based methods
        <span class="sup">
         <a ref-type="bibr" rid="CR100" href="#CR100">100</a>
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <div class="table-wrap-foot">
     <p>This table is intended to be a rough method guide. A detailed overview is beyond the scope of this Perspective and hardly possible because comparison studies are currently largely lacking. Spurring research to overcome this lack is a goal of this Perspective and the accompanying platform 
      <span ext-link-type="uri" xlink:href="http://www.causeme.net" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">causeme.net</span>. The terms used in this table are explained in the challenges section and illustrated in Fig. 
      <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>
     </p>
    </div>
   </div>
  </p>
  <p id="Par38" xmlns="http://www.w3.org/1999/xhtml">Finally, a crucial challenge when interpreting the output of causal inference methods is that causal conclusions are based on the assumptions underlying the different methods
   <span class="sup">
    <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
    <a ref-type="bibr" rid="CR13" href="#CR13">13</a>,
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span>. These assumptions should, but often cannot, be tested and it is important to make them transparent and discuss how different assumptions would alter conclusions for a particular application.
  </p>
 </sec>
</sec>
