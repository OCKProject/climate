<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec14" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Numerical methods</div>
 <p id="Par31" xmlns="http://www.w3.org/1999/xhtml">The numerical results showing the optimal and market solutions are demonstrated in Figs. 
  <a rid="Fig2" ref-type="fig" href="#Fig2">2</a> and 
  <a rid="Fig3" ref-type="fig" href="#Fig3">3</a>, system 1. The optimal solution is given by the unique set of non-negative aggregate harvest functions, 
  <div id="IEq13" class="inline-formula">
   <div class="alternatives">
    <span id="M61" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$H_{\mathrm{s}}^1(t),\hskip 4ptH_{\mathrm{s}}^2(t),\hskip 4ptH_{\mathrm{n}}^1$$\end{document}</span>
    <div id="M62" class="math">
     <div class="msubsup">
      <div class="mrow">
       <span class="mi">H</span>
      </div>
      <div class="mrow">
       <span mathvariant="normal" class="mi">s</span>
      </div>
      <div class="mrow">
       <span class="mn">1</span>
      </div>
     </div>
     <div class="mrow">
      <span class="mo">(</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">)</span>
     </div>
     <span class="mo">,</span>
     <div class="msubsup">
      <div class="mrow">
       <span class="mi">H</span>
      </div>
      <div class="mrow">
       <span mathvariant="normal" class="mi">s</span>
      </div>
      <div class="mrow">
       <span class="mn">2</span>
      </div>
     </div>
     <div class="mrow">
      <span class="mo">(</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">)</span>
     </div>
     <span class="mo">,</span>
     <div class="msubsup">
      <div class="mrow">
       <span class="mi">H</span>
      </div>
      <div class="mrow">
       <span mathvariant="normal" class="mi">n</span>
      </div>
      <div class="mrow">
       <span class="mn">1</span>
      </div>
     </div>
    </div>
    <span xlink:href="41467_2019_9246_Article_IEq13.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </div>, and 
  <div id="IEq14" class="inline-formula">
   <div class="alternatives">
    <span id="M63" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$H_{\mathrm{n}}^2(t)$$\end{document}</span>
    <div id="M64" class="math">
     <div class="msubsup">
      <div class="mrow">
       <span class="mi">H</span>
      </div>
      <div class="mrow">
       <span mathvariant="normal" class="mi">n</span>
      </div>
      <div class="mrow">
       <span class="mn">2</span>
      </div>
     </div>
     <div class="mrow">
      <span class="mo">(</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">)</span>
     </div>
    </div>
    <span xlink:href="41467_2019_9246_Article_IEq14.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </div>, that maximize social welfare: max
  <span class="italic">U</span>
  <span class="sup">
   <span class="italic">T</span>
  </span> (Eq. 
  <a rid="Equ4" ref-type="" href="#Equ4">4</a>) in the limit 
  <span class="italic">T</span> 
  <div id="IEq24" class="inline-formula">
   <div class="alternatives">
    <span id="M65" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
    <div id="M66" class="math">
     <span class="mo">→</span>
    </div>
    <span xlink:href="41467_2019_9246_Article_IEq24.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </div> ∞, where 
  <span class="italic">c</span>(
  <span class="italic">t</span>) and 
  <span class="italic">f</span>(
  <span class="italic">t</span>) are given by Eqs. 
  <a rid="Equ6" ref-type="" href="#Equ6">6</a> and 
  <a rid="Equ10" ref-type="" href="#Equ10">9</a>, subject to the constraint given in Eqs. 
  <a rid="Equ7" ref-type="" href="#Equ7">7</a> and 
  <a rid="Equ8" ref-type="" href="#Equ8">8</a>. (Note that using the social welfare function given in Eq.  
  <a rid="Equ4" ref-type="" href="#Equ4">4</a> with a constant 
  <span class="italic">ρ</span>, and considering deterministic dynamics of 
  <span class="italic">c</span> and 
  <span class="italic">f</span>, guarantee that the optimization problem is time consistent and has a unique solution
  <span class="sup">
   <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
   <a ref-type="bibr" rid="CR37" href="#CR37">37</a>
  </span>.) In turn, the market solution is determined by a perfectly competitive market where each manager maximizes her/his own profit. Specifically, consider the set of non-negative harvest functions that maximize utility, max
  <span class="italic">U</span>
  <span class="sup">
   <span class="italic">T</span>
  </span> (Eq. 
  <a rid="Equ4" ref-type="" href="#Equ4">4</a>) as 
  <span class="italic">T</span> 
  <div id="IEq25" class="inline-formula">
   <div class="alternatives">
    <span id="M67" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
    <div id="M68" class="math">
     <span class="mo">→</span>
    </div>
    <span xlink:href="41467_2019_9246_Article_IEq25.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </div> ∞, subject to the constraint given by Eqs. 
  <a rid="Equ7" ref-type="" href="#Equ7">7a</a> and 
  <a rid="Equ9" ref-type="" href="#Equ9">8</a> and the constraint d
  <span class="italic">x</span>
  <sub>2</sub>/d
  <span class="italic">t</span> = 
  <span class="italic">X</span>(
  <span class="italic">t</span>). Then, the market harvest is given by the unique solution that satisfies 
  <div id="IEq15" class="inline-formula">
   <div class="alternatives">
    <span id="M69" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$X(t) = H_{\mathrm{n}}^2(t)$$\end{document}</span>
    <div id="M70" class="math">
     <span class="mi">X</span>
     <div class="mrow">
      <span class="mo">(</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">)</span>
     </div>
     <span class="mo">=</span>
     <div class="msubsup">
      <div class="mrow">
       <span class="mi">H</span>
      </div>
      <div class="mrow">
       <span mathvariant="normal" class="mi">n</span>
      </div>
      <div class="mrow">
       <span class="mn">2</span>
      </div>
     </div>
     <div class="mrow">
      <span class="mo">(</span>
      <div class="mrow">
       <span class="mi">t</span>
      </div>
      <span class="mo">)</span>
     </div>
    </div>
    <span xlink:href="41467_2019_9246_Article_IEq15.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </div> (consisteny criterion).
 </p>
 <p id="Par32" xmlns="http://www.w3.org/1999/xhtml">We used algorithms that find the exact solutions provided that the resolutions are sufficiently fine. Specifically, to find the optimal solution numerically, our algorithm uses Stochastic Programming with backward induction (Supplementary Note 4)
  <span class="sup">
   <a ref-type="bibr" rid="CR43" href="#CR43">43</a>,
   <a ref-type="bibr" rid="CR44" href="#CR44">44</a>
  </span>. (Note that the model’s dynamics are deterministic but the general method is still called stochastic.) To find the market solution, our algorithm also uses Stochastic Programming to solve for a given value of 
  <span class="italic">X</span>. But it finds a solution multiple times, each time for a different value of 
  <span class="italic">X</span>, until it finds the solution that satisfies the consisteny criterion. These algorithms are coded in C/C++ and are described in detail in Supplementary Note 4.
 </p>
 <p id="Par33" xmlns="http://www.w3.org/1999/xhtml">In turn, in the results shown in Fig. 
  <a rid="Fig3" ref-type="fig" href="#Fig3">3</a>, system 2, as well as in Figs. 
  <a rid="Fig4" ref-type="fig" href="#Fig4">4</a> and 
  <a rid="Fig5" ref-type="fig" href="#Fig5">5</a> and in the graphical tool, we assume that the dynamics of 
  <span class="italic">c</span> and 
  <span class="italic">f</span> follow Eqs. 
  <a rid="Equ6" ref-type="" href="#Equ6">6</a>–
  <a rid="Equ10" ref-type="" href="#Equ10">9</a>, but we consider harvest functions that are not given by either the optimal solution or the market solution. In Fig. 
  <a rid="Fig3" ref-type="fig" href="#Fig3">3</a>, system 2, we consider harvest functions that follow the market solution until 
  <span class="italic">t</span> = 
  <span class="italic">t</span>
  <sub>1</sub> and after 
  <span class="italic">t</span> = 
  <span class="italic">t</span>
  <sub>1</sub> + 10, but between these times, the non-sustainable harvest decreases gradually from its maximal level to zero. In Fig. 
  <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>, we calculate Δ
  <sub>sus</sub>, which is the cumulative discount that emerges if the harvest is entirely sustainable, namely, 
  <span class="italic">H</span>
  <sub>n</sub> = 0 and 
  <span class="italic">H</span>
  <sub>s</sub> = 
  <span class="italic">x</span>
  <sub>1</sub> + 
  <span class="italic">x</span>
  <sub>2</sub> if 
  <span class="italic">t</span> &gt; 0. Also, in Fig. 
  <a rid="Fig4" ref-type="fig" href="#Fig4">4a</a>, we consider three scenarios in which the non-sustainable harvest is higher in the beginning but eventually approaches zero, while 
  <span class="italic">H</span>
  <sub>n</sub> + 
  <span class="italic">H</span>
  <sub>s</sub> = 
  <span class="italic">x</span>
  <sub>1</sub> + 
  <span class="italic">x</span>
  <sub>2</sub>.
 </p>
 <p id="Par34" xmlns="http://www.w3.org/1999/xhtml">After we determine the harvest functions, the functions 
  <span class="italic">c</span>(
  <span class="italic">t</span>) and 
  <span class="italic">f</span>(
  <span class="italic">t</span>) are calculated according to Eqs. 
  <a rid="Equ6" ref-type="" href="#Equ6">6</a> and 
  <a rid="Equ10" ref-type="" href="#Equ10">9</a>. In turn, we calculate the discount rate and the cumulative discount according to Eq. 
  <a rid="Equ5" ref-type="" href="#Equ5">5</a> (where the cumulative discount is the integral over time of the discount rate). Specifically, for the case in which only sustainable harvest is used (Δ
  <sub>sus</sub> in Fig. 
  <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>), the discount rates are calculated in Supplementary Note 2 and are given by Eqs.  
  <a rid="MOESM1" ref-type="media" href="#MOESM1">B5</a> and 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">B12</a>. The prices are given by Eq.  
  <a rid="MOESM1" ref-type="media" href="#MOESM1">A10</a>, and the total product is given by Eq.  
  <a rid="MOESM1" ref-type="media" href="#MOESM1">A11</a>. All of these equations are derived in Supplementary Notes 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>, 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">2</a>.
 </p>
</sec>
