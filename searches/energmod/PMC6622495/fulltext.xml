<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6622495</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0219326</article-id><article-id pub-id-type="publisher-id">PONE-D-19-04260</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Energy and Power</subject><subj-group><subject>Alternative Energy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Equipment</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical Mechanics</subject><subj-group><subject>Damage Mechanics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Energy and Power</subject><subj-group><subject>Alternative Energy</subject><subj-group><subject>Photovoltaic Power</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Electrical Engineering</subject><subj-group><subject>Electrical Circuits</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Electricity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and Places</subject><subj-group><subject>Geographical Locations</subject><subj-group><subject>Asia</subject><subj-group><subject>Malaysia</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Farms</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Lightning performance analysis of a rooftop grid-connected solar photovoltaic without external lightning protection system</article-title><alt-title alt-title-type="running-head">Lightning performance of a rooftop grid-connected solar PV</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6112-589X</contrib-id><name><surname>Nasir</surname><given-names>M. S. M.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Data curation</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Funding acquisition</role><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Project administration</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff002"><sup>2</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib><contrib contrib-type="author"><name><surname>Ab-Kadir</surname><given-names>M. Z. A.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Data curation</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Funding acquisition</role><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Project administration</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff003"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Radzi</surname><given-names>M. A. M.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff004"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Izadi</surname><given-names>M.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Data curation</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff003"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ahmad</surname><given-names>N. I.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff003"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zaini</surname><given-names>N. H.</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff003"><sup>3</sup></xref></contrib></contrib-group><aff id="aff001"><label>1</label>
<addr-line>Centre for Electromagnetic and Lightning Protection Research (CELP), Advanced Lightning, Power and Energy Research Centre, Faculty of Engineering, Universiti Putra Malaysia, UPM, Serdang, Selangor, Malaysia</addr-line></aff><aff id="aff002"><label>2</label>
<addr-line>Faculty of Engineering, Universiti Pertahanan Nasional Malaysia, UPNM, Kem Sungai Besi, Kuala Lumpur, Malaysia</addr-line></aff><aff id="aff003"><label>3</label>
<addr-line>Institute of Power Engineering, Universiti Tenaga Nasional, Kajang, Selangor, Malaysia</addr-line></aff><aff id="aff004"><label>4</label>
<addr-line>Centre for Advanced Power and Energy Research (CAPER), Advanced Lightning, Power and Energy Research Centre, Faculty of Engineering, Universiti Putra Malaysia, UPM, Serdang, Selangor, Malaysia</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Wang</surname><given-names>Long</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>University of Science and Technology Beijing, CHINA</addr-line></aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>solehin@upnm.edu.my</email></corresp></author-notes><pub-date pub-type="epub"><day>11</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>14</volume><issue>7</issue><elocation-id>e0219326</elocation-id><history><date date-type="received"><day>12</day><month>2</month><year>2019</year></date><date date-type="accepted"><day>20</day><month>6</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; 2019 Nasir et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Nasir et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0219326.pdf"/><abstract><p>The Sustainable Energy Development Authority of Malaysia (SEDA) regularly receives complaints about damaged components and distribution boards of PV systems due to lightning strikes. Permanent and momentary interruptions of distribution circuits may also occur from the disturbance. In this paper, a solar PV Rooftop system (3.91 kWp) provided by SEDA was modelled in the PSCAD/EMTDC. The Heidler function was used as a lightning current waveform model to analyse the transient current and voltage at two different points susceptible to the influence of lightning events such as different lightning current wave shape, standard lightning current and non-standard lightning current. This study examines the effect on the system components when lightning directly strikes at two different points of the installation. The two points lie between the inverter and the solar PV array and between inverter and grid. Exceptionally high current and voltage due to the direct lightning strike on a certain point of a PV Rooftop system was also studied. The result of this case study is observed with and without the inclusion of surge protective devices (SPDs). The parameters used were 31 kA of peak current, 10 metres cable length and lightning impulse current wave shape of 8/20&#x003bc;s. The high current and voltage at P1 striking point were 31 kA and 2397 kV, respectively. As for the AC part, the current and voltage values were found to be 5.97 kA and 5392 kV, respectively.Therefore, SPDs with suitable rating provided by SEDA were deployed. Results showed that high transient current voltage is expected to clamp sharply at the values of 1.915 kV and 0 A at the P1 striking point. As for the AC part, the current and voltage values were found to be 0 kA and 0.751 V, respectively. Varying lightning impulse current wave shapes at striking point P2 showed that the highest voltage was obtained at waveshape 10/350 &#x003bc;s at 11277 kV followed by wave shapes of 2/70 &#x003bc;s, 8/20 &#x003bc;s and 0.7/6 &#x003bc;s. The high value of transient voltage was clamped at a lower level of 2.029 kV. Different lightning amplitudes were also applied, ranging from 2&#x02013;200 kA selected based on the CIGRE distribution. It showed that the current and voltage at P1 and P2 were directly proportional. Therefore, the SPD will be designed at an acceptable rating and proper position of SPD installation at solar PV Rooftop will be proposed. The results obtained in this study can then be utilised to appropriately assign a SPD to protect the PV systems that are connected to the grid. Installing SPDs without considering the needs of lightning protection zones would expose the expensive equipment to potential damage even though the proper energy coordination of SPDs is in place. As such, the simulation results provide a basis for controlling the impacts of direct lightning strikes on electrical equipment and power grids and thus justify SPD coordination to ensure the reliability of the system.</p></abstract><funding-group><funding-statement>The authors received no specific funding for this work.</funding-statement></funding-group><counts><fig-count count="19"/><table-count count="12"/><page-count count="19"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All relevant data are within the paper and its Supporting Information files.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Rapid growth in energy developments and demands for renewable energy (RE) show that the implementation of renewable energy is vastly expanding. Compared to the other types of renewable energy, solar energy is prominent, as an infinite resource, natural, ecological, friendly, and economical [<xref rid="pone.0219326.ref001" ref-type="bibr">1</xref>]. The potential availability of solar energy is significantly greater than the current overall global energy demands. Solar energy has been developing more rapidly than the other RE sources for a few decades now. The photovoltaic (PV) systems are employed to convert the power of the sun from sunlight energy to electrical energy [<xref rid="pone.0219326.ref001" ref-type="bibr">1</xref>]. In the future, solar power generation will be crucial for a sustainable form of energy. Moreover, solar irradiation is generally in abundance so that the electricity demands of the world can be met to a large extent by solar power technologies alone. The experts predict that by the year 2050, renewable energy could be generating over 50% of all the supply and 80% of all electricity system would come from it [<xref rid="pone.0219326.ref002" ref-type="bibr">2</xref>]. No surprisingly, the Malaysian government is interested and committed to the development of solar energy in the country as one of the important sources of energy [<xref rid="pone.0219326.ref003" ref-type="bibr">3</xref>].</p><p>The Sustainable Energy Development Authority Malaysia (SEDA) is a statutory body that was formed under the Sustainable Energy Development Authority Act 2011. This body was formed to ensure the effective growth of the RE sector in Malaysia. SEDA has been tasked with the responsibility to manage the implementation of Fit-in tariff (Fit) mechanism. Moreover, SEDA must ensure that sustainable energy is managed properly and plays an important role in the development of the nation&#x02019;s economy. The plan of FiT initiated by the Malaysian government under National Renewable Energy Policy and Action Plan (2010) facilitates the efficiency of RE contribution and funds, besides ensuring the growth of the RE industry. Therefore, the Renewable Energy Act 2011 was gazette on 2<sup>nd</sup> June 2011 published for this purpose [<xref rid="pone.0219326.ref004" ref-type="bibr">4</xref>].</p><p>Lightning is a major issue faced by Tenaga Nasional Berhad (TNB) in Malaysia. Statistically in Malaysia, lightning causes over 70% of power failures. In Germany, statistical data show that 26% of the damages are caused by lightning. It may cause permanent or momentary interruptions on distribution circuits. With the rapid increase of sensitive loads, momentary interruptions are not acceptable and are a serious issue that has to be addressed. Lightning can cause damage or malfunctioning of the electrical, communication or automation systems that can cost more than 250 million [<xref rid="pone.0219326.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0219326.ref005" ref-type="bibr">5</xref>].</p><p>Photovoltaic (PV) systems are normally installed in wide open outdoor places such as on the rooftop or a solar farm. This leaves the electrical or electronic equipment exposed to lightning strikes nearby. The operation of the electrical or electronic equipment power system placed outside or inside the building can be interrupted with economic implications to the power system operation. Hence, a complete lightning protection system in a PV installation is very crucial and a practical requirement to avoid the interruption of the system, while destruction as well as faults leading to casualties will also be avoided [<xref rid="pone.0219326.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0219326.ref006" ref-type="bibr">6</xref>].</p><p>Direct and indirect lightning strikes have great potential in affecting the whole of a PV Rooftop system. The nature of its installation on rooftops easily exposes s the panels to a direct hit. The situation is made even worse if the installation is made in a high lightning density area. This will result in malfunction or destruction of the PV Rooftop system if it is drastically affected by lightning. Direct strikes can destroy PV panels, inverters, cables, and fuses due to the high current. On the other hand, indirect strikes would induce high voltages into the system and consequently, the conductors, PV panels and other components would be affected. This will eventually emit sparks that could cause fire and explosion to the inflammable materials of the system.</p><p>A sensitivity analysis is necessary for the development of lightning overvoltage in a Rooftop PV system, bearing in mind the impact of lightning striking spot, the lightning current amplitude, the building height, the soil resistivity and the distance between the solar arrays and the external protection system. The PV Rooftop system is commonly located in high-rise buildings which makes it very prone to lightning strikes [<xref rid="pone.0219326.ref007" ref-type="bibr">7</xref>].As far as Malaysia is concerned, no standards exist on lightning protection for PV systems, except for MS 1837:2010 which focuses on the PV installation. Thus; there were no previous studies that dealt with lightning surge analysis prior to the solar PV installation for residential and commercial buildings or solar farms.</p><p>There is no circuit model or test for the PV Rooftop system dedicated to lightning surge studies, especially in aspects of SPD placement, selection of suitable ratings, cable length, and sizing, and number of SPDs required. Direct strikes may trigger fires and even explosions to the PV Rooftop installation. In the case of indirect strikes, induced overvoltages may result in outages of the electrical and electronic components inside the building.</p><p>Most PV Rooftop systems installations are not properly or adequately protected from lightning. especially when it comes to SPD installation, where no mandatory requirements are imposed. Thus, many concerns are raised on the safety and protection of the inverter. On the other hand, PV Rooftop systems may suffer from severe damage that comes from failure of the electrical and electronic parts in a PV Rooftop system, interrupting their normal operational functionality. Therefore, it is clear that lightning protection system installation is crucial in determining the life span of a PV Rooftop system [<xref rid="pone.0219326.ref006" ref-type="bibr">6</xref>].</p><p>According to Naxakis et al.[<xref rid="pone.0219326.ref008" ref-type="bibr">8</xref>], the single-crystalline silicon PV module was tested under lightning impulse voltage to evaluate its performance. It was found that PV module was completely damaged and electrically degraded when testing under lightning impulse voltage up to 144 kV. Then, tests according to IEC 61730&#x02013;2 for 12 kV and up to 35 kV, PV module did not show any indication of mechanical damage and no obvious electrical degradation.</p><p>Based on the work of Jiang and Gryzbowski [<xref rid="pone.0219326.ref009" ref-type="bibr">9</xref>], it was found that highest possible power output of PV module would degrade exponentially with lightning impulse voltages. There are five testing voltage levels which are: 15 V, 30 V, 90 V, 400 V and 1000 V. Even with low level of lightning impulse voltage, the results showed the PV module was electrically degraded but did not have any abnormal damage even for 1000V.</p><p>Previous work by Sekioka [<xref rid="pone.0219326.ref010" ref-type="bibr">10</xref>] indicated that direct lightning strike will cause surface discharge to occur in grounded frame PV panel and recommended that the protection for PV panel should be considered.</p><p>Both Belik [<xref rid="pone.0219326.ref011" ref-type="bibr">11</xref>] and Abdul Rahim et al. [<xref rid="pone.0219326.ref012" ref-type="bibr">12</xref>] highlighted that the induced voltage occurrence was due to indirect lightning and caused a high voltage spark between the cables and PV modules and thus severely damaging the PV panel. The extent of damage is proportional to the distance of the spark discharge from the PV panels where the closer the distance between PV panel and spark discharge, the more severe the damage caused by the induced overvoltage.</p><p>This paper focuses on lightning surge analysis to rooftop solar PV installation under direct strike at two different locations, taking into account the variation of current waveforms (both standard and non-standard waveforms). However, this paper will only considered the lightning surge analysis on the rooftop installation without any external lightning protection and without considering any protection devices.</p></sec><sec sec-type="materials|methods" id="sec002"><title>Methodology</title><sec id="sec003"><title>Solar PV array modelling</title><p><xref ref-type="fig" rid="pone.0219326.g001">Fig 1</xref> shows an equivalent circuit model of single PV cell which consists of output voltage, V and the current of the PV cell, I [<xref rid="pone.0219326.ref013" ref-type="bibr">13</xref>]. Additionally, a current source anti-parallel with a diode, a shunt resistance, Rsh and a series resistance, Rsr as shown in <xref ref-type="fig" rid="pone.0219326.g001">Fig 1</xref> is present with the PV Cell. Furthermore, to produce the nonlinear I-V characteristics of the PV cell, current,I<sub>d</sub> that flows through the anti-parallel diode plays an important role, [<xref rid="pone.0219326.ref013" ref-type="bibr">13</xref>,<xref rid="pone.0219326.ref014" ref-type="bibr">14</xref>].</p><fig id="pone.0219326.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g001</object-id><label>Fig 1</label><caption><title>PV cell equivalent circuit.</title></caption><graphic xlink:href="pone.0219326.g001"/></fig></sec><sec id="sec004"><title>Maximum Power Point Tracking (MPPT)</title><p>The MPPT algorithm is used to track the operating point to get the maximum power [<xref rid="pone.0219326.ref015" ref-type="bibr">15</xref>]. MPPT algorithm is required for tracking the maximum power point due to the continuous change of ambient temperature and irradiance of the solar source. There are two well-known MPPT algorithms which are: perturb and observe method, and incremental conductance method, [<xref rid="pone.0219326.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0219326.ref017" ref-type="bibr">17</xref>].</p></sec><sec id="sec005"><title>Inverter single-phase modelling</title><p>The inverter is an interface of the DC source to the grid. As shown in <xref ref-type="fig" rid="pone.0219326.g002">Fig 2</xref>, there is a single phase H-bridge inverter in this study. H-bridge inverter was chosen for its efficiency [<xref rid="pone.0219326.ref018" ref-type="bibr">18</xref>].</p><fig id="pone.0219326.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g002</object-id><label>Fig 2</label><caption><title>Single-phase H-bridge inverter.</title></caption><graphic xlink:href="pone.0219326.g002"/></fig><p>LCL filter is the main interface between the power grid and the inverter in the grid connected [<xref rid="pone.0219326.ref019" ref-type="bibr">19</xref>].<xref ref-type="fig" rid="pone.0219326.g003">Fig 3</xref> shows the LCL filter that must be modelled properly to avoid distortions. Its function must also be enhanced to reduce harmonics on the output [<xref rid="pone.0219326.ref020" ref-type="bibr">20</xref>].</p><fig id="pone.0219326.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g003</object-id><label>Fig 3</label><caption><title>LCL filter model.</title></caption><graphic xlink:href="pone.0219326.g003"/></fig></sec><sec id="sec006"><title>Cable configuration</title><p>Cable configuration and modelling were carried out in PSCAD/EMTDC. As per manufacturer&#x02019;s datasheet, the PV Rooftop uses cable sizes of 4 mm<sup>2</sup>at the DC part and 10 mm<sup>2</sup> at the AC part, respectively.</p></sec><sec id="sec007"><title>Lightning current model</title><p>There are several mathematical expressions that previous researchers have used to represent lightning current waveforms in lightning protection study. The two mathematical expressions for lightning current wave shapes are Heidler function and Double exponential that are frequently used in the lightning protection study. The double exponential shown in <xref ref-type="disp-formula" rid="pone.0219326.e001">Eq 1</xref> was applied to calculate <italic>i(t)</italic>, with <italic>I</italic><sub><italic>p</italic></sub> is as the peak current; and &#x003b1; and &#x003b2; are formula constants for obtaining lightning current waveform, [<xref rid="pone.0219326.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0219326.ref022" ref-type="bibr">22</xref>].</p><disp-formula id="pone.0219326.e001"><alternatives><graphic xlink:href="pone.0219326.e001.jpg" id="pone.0219326.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula><p>The Heidler function that was used in this study is frequently used in several standards and defined in Eqs <xref ref-type="disp-formula" rid="pone.0219326.e002">2</xref> and <xref ref-type="disp-formula" rid="pone.0219326.e003">3</xref>[<xref rid="pone.0219326.ref021" ref-type="bibr">21</xref>]:
<disp-formula id="pone.0219326.e002"><alternatives><graphic xlink:href="pone.0219326.e002.jpg" id="pone.0219326.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mi>i</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where
<disp-formula id="pone.0219326.e003"><alternatives><graphic xlink:href="pone.0219326.e003.jpg" id="pone.0219326.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>&#x003b7;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
with <italic>Ip</italic> is the maximum current value, <italic>&#x003b7;</italic> is the peak current correction factor, <italic>&#x003c4;</italic><sub>1</sub> and <italic>&#x003c4;</italic><sub>2</sub> are the time constants to determine current rising and current decaying time, respectively and also the maximum of the current steepness. The Heidler function is used to model the lightning current waveshapes shown in <xref ref-type="fig" rid="pone.0219326.g004">Fig 4</xref> [<xref rid="pone.0219326.ref023" ref-type="bibr">23</xref>].</p><fig id="pone.0219326.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g004</object-id><label>Fig 4</label><caption><title>Modelling of lightning current wave shape (Heidler function).</title></caption><graphic xlink:href="pone.0219326.g004"/></fig><p>The design and model of the PSCAD of the four lightning current wave shapes based on the Heidler function are according to the standard current wave shapes (10/350 &#x003bc;s and 8/20&#x003bc;s) and non-standard wave shape (0.7/6 &#x003bc;s and 2/70 &#x003bc;s). Lightning impulse current wave shapes with different front time and tail time are applied to determine the effect of voltage and current. For standard current wave shape (10/350 &#x003bc;s), it has longer tail time. Then for non-standard current wave shape (0.7/6 &#x003bc;s), it has short front time and tail time but for current wave shape (2/70 &#x003bc;s), it has long tail time. From <xref rid="pone.0219326.t001" ref-type="table">Table 1</xref> shows the parameters of the lightning current wave shape that was modelled in the PSCAD.</p><table-wrap id="pone.0219326.t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t001</object-id><label>Table 1</label><caption><title>Lightning current wave shape parameters.</title></caption><alternatives><graphic id="pone.0219326.t001g" xlink:href="pone.0219326.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Lightning Current Wave shapes, &#x003bc;s</th><th align="center" rowspan="1" colspan="1"><italic>&#x003c4;</italic><sub>1</sub>, &#x003bc;s</th><th align="center" rowspan="1" colspan="1"><italic>&#x003c4;</italic><sub>2</sub>, &#x003bc;s</th><th align="center" rowspan="1" colspan="1"><italic>n</italic></th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">8/20</td><td align="center" rowspan="1" colspan="1">5.9</td><td align="center" rowspan="1" colspan="1">11.645</td><td align="center" rowspan="1" colspan="1">2</td></tr><tr><td align="center" rowspan="1" colspan="1">10/350</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">475</td><td align="center" rowspan="1" colspan="1">2</td></tr><tr><td align="center" rowspan="1" colspan="1">0.7/6</td><td align="center" rowspan="1" colspan="1">0.177</td><td align="center" rowspan="1" colspan="1">7</td><td align="center" rowspan="1" colspan="1">2</td></tr><tr><td align="center" rowspan="1" colspan="1">2/70</td><td align="center" rowspan="1" colspan="1">0.28</td><td align="center" rowspan="1" colspan="1">95</td><td align="center" rowspan="1" colspan="1">2</td></tr></tbody></table></alternatives></table-wrap><p>The parameters for lightning current wave shape modelled in the PSCAD are shown in <xref rid="pone.0219326.t001" ref-type="table">Table 1</xref> and presented in Figs <xref ref-type="fig" rid="pone.0219326.g005">5</xref>&#x02013;<xref ref-type="fig" rid="pone.0219326.g008">8</xref>.</p><fig id="pone.0219326.g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g005</object-id><label>Fig 5</label><caption><title>Lightning current wave shape (8/20 &#x003bc;s).</title></caption><graphic xlink:href="pone.0219326.g005"/></fig><fig id="pone.0219326.g006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g006</object-id><label>Fig 6</label><caption><title>Lightning current wave shape (10/350 &#x003bc;s).</title></caption><graphic xlink:href="pone.0219326.g006"/></fig><fig id="pone.0219326.g007" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g007</object-id><label>Fig 7</label><caption><title>Lightning current wave shape (2/70&#x003bc;s).</title></caption><graphic xlink:href="pone.0219326.g007"/></fig><fig id="pone.0219326.g008" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g008</object-id><label>Fig 8</label><caption><title>Lightning current wave shape (0.7/6&#x003bc;s).</title></caption><graphic xlink:href="pone.0219326.g008"/></fig></sec><sec id="sec008"><title>Validation for solar PV rooftop system</title><p>The solar PV Rooftop system with PV array, inverter and grid was modelled in the PSCAD/EMTDC software as presented in <xref ref-type="fig" rid="pone.0219326.g009">Fig 9</xref>.</p><fig id="pone.0219326.g009" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g009</object-id><label>Fig 9</label><caption><title>Solar PV rooftop system.</title></caption><graphic xlink:href="pone.0219326.g009"/></fig><p>From <xref rid="pone.0219326.t002" ref-type="table">Table 2</xref>, the parameters for Solar PV Rooftop system are constructed from 2 PV arrays, which include a total of 17 modules. The total input power from this system is 3.91 kW at 1000 W/m2 irradiance and a temperature of 25&#x000b0;C at standard test conditions. However, the results in the simulation indicate that the system generates 3.87 kW of energy as shown in <xref ref-type="fig" rid="pone.0219326.g010">Fig 10</xref>, and has 98% efficiency. The other 2% of the efficiency is lost due to power losses of the system.</p><fig id="pone.0219326.g010" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g010</object-id><label>Fig 10</label><caption><title>DC input power for solar PV rooftop.</title></caption><graphic xlink:href="pone.0219326.g010"/></fig><table-wrap id="pone.0219326.t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t002</object-id><label>Table 2</label><caption><title>Parameters for modelling in the PSCAD/EMTDC.</title></caption><alternatives><graphic id="pone.0219326.t002g" xlink:href="pone.0219326.t002"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Components</th><th align="center" rowspan="1" colspan="1">Quantities</th><th align="center" rowspan="1" colspan="1">Specifications</th></tr></thead><tbody><tr><td align="center" rowspan="5" colspan="1">Solar Modules</td><td align="center" rowspan="5" colspan="1">17 modules</td><td align="center" rowspan="1" colspan="1">Power solar PV modules = 3.91 kW</td></tr><tr><td align="center" rowspan="1" colspan="1">Voltage of string 1 (8 modules) = 338.4 V</td></tr><tr><td align="center" rowspan="1" colspan="1">Current of string 1 = 5.45 A</td></tr><tr><td align="center" rowspan="1" colspan="1">Voltage of string 2 (9 modules) = 380.7 V</td></tr><tr><td align="center" rowspan="1" colspan="1">Current of string 2 = 5.45 A</td></tr><tr><td align="center" rowspan="1" colspan="1">Inverter</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">Nominal AC Power = 4 kW</td></tr><tr><td align="center" rowspan="1" colspan="1">Grid</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">Power Output = 3.91 kW</td></tr></tbody></table></alternatives></table-wrap><p>The results of the simulation of Solar PV Rooftop indicate that the DC voltage is 380.1 V as shown in <xref ref-type="fig" rid="pone.0219326.g011">Fig 11</xref>, while the DC current is 9.95 A as shown in <xref ref-type="fig" rid="pone.0219326.g012">Fig 12</xref>. The AC output power is 3.84 kW as shown in <xref ref-type="fig" rid="pone.0219326.g013">Fig 13</xref>.</p><fig id="pone.0219326.g011" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g011</object-id><label>Fig 11</label><caption><title>DC voltage for solar PV rooftop.</title></caption><graphic xlink:href="pone.0219326.g011"/></fig><fig id="pone.0219326.g012" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g012</object-id><label>Fig 12</label><caption><title>DC current for solar PV rooftop.</title></caption><graphic xlink:href="pone.0219326.g012"/></fig><fig id="pone.0219326.g013" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g013</object-id><label>Fig 13</label><caption><title>AC output power for solar PV rooftop.</title></caption><graphic xlink:href="pone.0219326.g013"/></fig></sec><sec id="sec009"><title>Validation of surge protection devices</title><p>The Metal oxide surge arrestor in PSCAD/EMTDC is validated with manufacturer&#x02019;s data. Two types of SPDs type II were validated. namely 500VDC; and 385 VAC. Then, these SPDs were tested using Heidler function with lightning current wave shape of 8/20 &#x003bc;s, which is commonly stated in manufacturer&#x02019;s technical datasheet.</p><sec id="sec010"><title>SPD type II 500VDC</title><p>From <xref rid="pone.0219326.t003" ref-type="table">Table 3</xref>, manufacturer&#x02019;s technical data were used to define I-V characteristic to model Metal oxide surge arrestor [<xref rid="pone.0219326.ref024" ref-type="bibr">24</xref>].</p><table-wrap id="pone.0219326.t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t003</object-id><label>Table 3</label><caption><title>Technical data.</title></caption><alternatives><graphic id="pone.0219326.t003g" xlink:href="pone.0219326.t003"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Parameter</th><th align="center" rowspan="1" colspan="1">Value</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1"><italic>U</italic><sub><italic>p</italic></sub></td><td align="center" rowspan="1" colspan="1">20 kA</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>I</italic><sub><italic>n</italic></sub></td><td align="center" rowspan="1" colspan="1">1.75 kV</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>U</italic><sub><italic>c</italic></sub></td><td align="center" rowspan="1" colspan="1">500 V</td></tr></tbody></table></alternatives></table-wrap><p>To verify the results, the Heidler function waveform of 8/20 &#x003bc;s was generated and applied to the AC SPD Type II 500 VDC model arrester to acquire satisfactory matching of the discharge voltage. It was tuned based on the data of the manufacturer until the test circuit provided good matches which were: 20 kA produces 1.75 kV for discharge voltage as shown in <xref ref-type="fig" rid="pone.0219326.g014">Fig 14</xref>.</p><fig id="pone.0219326.g014" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g014</object-id><label>Fig 14</label><caption><title>Arrester discharge voltage at <italic>I</italic><sub><italic>n</italic></sub>, 20 kA.</title></caption><graphic xlink:href="pone.0219326.g014"/></fig></sec><sec id="sec011"><title>SPD type II 385 VAC</title><p>Likewise for this type of SPD, the technical data as per <xref rid="pone.0219326.t004" ref-type="table">Table 4</xref> were considered for modelling.</p><table-wrap id="pone.0219326.t004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t004</object-id><label>Table 4</label><caption><title>Technical data.</title></caption><alternatives><graphic id="pone.0219326.t004g" xlink:href="pone.0219326.t004"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Parameter</th><th align="center" rowspan="1" colspan="1">Value</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1"><italic>U</italic><sub><italic>p</italic></sub></td><td align="center" rowspan="1" colspan="1">20 kA</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>I</italic><sub><italic>n</italic></sub></td><td align="center" rowspan="1" colspan="1">1.8 kV</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>U</italic><sub><italic>c</italic></sub></td><td align="center" rowspan="1" colspan="1">385 V</td></tr></tbody></table></alternatives></table-wrap><p>In verifying the results, the Heidler function waveform of 8/20 &#x003bc;s was generated and applied to the AC SPD Type II 385 VACs model arrester to acquire satisfactory matching of the discharge voltage. It was tuned until the test circuit provided good matches based on the data of the manufacturer which were: 20 kA producing 1.8 kV for discharge voltage as shown in <xref ref-type="fig" rid="pone.0219326.g015">Fig 15</xref>.</p><fig id="pone.0219326.g015" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g015</object-id><label>Fig 15</label><caption><title>Arrester discharge voltage at <italic>I</italic><sub><italic>n</italic></sub>, 20 kA.</title></caption><graphic xlink:href="pone.0219326.g015"/></fig></sec></sec></sec><sec sec-type="results" id="sec012"><title>Results</title><p>This section discusses the effects of the solar PV Rooftop system installation with the inclusion SPD and without the inclusion of SPD as there are no specific practices that focus on it. Lightning strike with different striking points, different lightning impulse current wave shapes, and variation of amplitude of currents, different cable lengths and sizes are considered in this section of the work. The two points are seen between: the inverter and the solar PV; array (P1); and the inverter and grid (P2) as presented in <xref ref-type="fig" rid="pone.0219326.g016">Fig 16</xref>.</p><fig id="pone.0219326.g016" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g016</object-id><label>Fig 16</label><caption><title>Lightning strikes at the two points of the solar PV rooftop.</title></caption><graphic xlink:href="pone.0219326.g016"/></fig><p>SPD is an essential part that is most commonly used for overvoltage protection at solar PV Rooftop or PV farm system due to its efficiency. Therefore, all the SPD installations at the DC or AC part must meet the requirement or practice from the standard. Figs <xref ref-type="fig" rid="pone.0219326.g017">17</xref> and <xref ref-type="fig" rid="pone.0219326.g018">18</xref>; indicate that lightning will strike at P1 and P2 of the solar PV Rooftop system.</p><fig id="pone.0219326.g017" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g017</object-id><label>Fig 17</label><caption><title>Lightning strike at point 1 between PV array and inverter.</title></caption><graphic xlink:href="pone.0219326.g017"/></fig><fig id="pone.0219326.g018" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g018</object-id><label>Fig 18</label><caption><title>Lightning strike at point 2 after inverter.</title></caption><graphic xlink:href="pone.0219326.g018"/></fig><p>As per the standard, SPD Type II installation uses the lightning impulse current waveshape of 8/20&#x003bc;s. Due to direct lightning strike on certain points of the PV Rooftop system, extremely high current and voltage propagated as travelling waves are produced. Therefore, several case studies need to be considered to minimise the transient current and voltage to avoid the damage or decaying of electronic and electrical equipment. Furthermore, this section will consider the SPD rating and placement. Then, the SPD model applied in this simulation is validated accordingly to follow the manufacturer&#x02019;s datasheet. The significance of the simulation outcomes of the solar PV Rooftop system under the influence of lightning is seen in this study.</p><sec id="sec013"><title>Impact of different points of strikes</title><p>This study investigates the effect on the components when lightning strikes at two different points of the installation. These two points can be seen between the inverter and the solar PV array (<bold>P1</bold>) and between inverter and grid (P2) as shown in <xref ref-type="fig" rid="pone.0219326.g016">Fig 16</xref>. The findings of the lightning strike at P1 and P2 are then observed. The parameters used are: 31 kA peak current; 10 metre-length of cable; and the lightning impulse current waveshape, 8/20&#x003bc;s. Results of these cases, are tabulated in Tables <xref rid="pone.0219326.t005" ref-type="table">5</xref> and <xref rid="pone.0219326.t006" ref-type="table">6</xref>.</p><table-wrap id="pone.0219326.t005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t005</object-id><label>Table 5</label><caption><title>Measured Vinv and Iinv at striking point.</title></caption><alternatives><graphic id="pone.0219326.t005g" xlink:href="pone.0219326.t005"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device<break/>(SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1"><break/>Lightning Amplitude (kA)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">V</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">2397</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">5392</td><td align="center" rowspan="1" colspan="1">5.97</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">0.751</td><td align="center" rowspan="1" colspan="1">0</td></tr></tbody></table></alternatives></table-wrap><table-wrap id="pone.0219326.t006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t006</object-id><label>Table 6</label><caption><title>Measured Vinv and Iinv at P2 striking point.</title></caption><alternatives><graphic id="pone.0219326.t006g" xlink:href="pone.0219326.t006"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device<break/>(SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1"><break/>Lightning Amplitude (kA)</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">mV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">0.153</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">4283</td><td align="center" rowspan="1" colspan="1">25.353</td><td align="center" rowspan="1" colspan="1">0.01116</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.292</td></tr></tbody></table></alternatives></table-wrap><p>Extremely high current and voltage which are propagated as travelling waves are produced due to the direct lightning strike on certain points of the PV Rooftop system. Modules of solar PV tend to be damaged and degrade due to the lightning strikes at P1 and P2. Referring to the data, the findings suggest that electrical and electronic equipment is most susceptible to damage.</p><p>From the data in <xref rid="pone.0219326.t004" ref-type="table">Table 4</xref>, it is apparent that the high current and voltage at P1 striking point are 31 kA and 2397 kV, respectively. As for the AC part the current and voltage values were found to be 5.97 kA and 5392 kV, respectively. From Tables <xref rid="pone.0219326.t005" ref-type="table">5</xref> and <xref rid="pone.0219326.t006" ref-type="table">6</xref>, the lightning waveshape 8/20 &#x003bc;s will strike at P1 and P2. Then, from Tables <xref rid="pone.0219326.t005" ref-type="table">5</xref> and <xref rid="pone.0219326.t006" ref-type="table">6</xref>, the results show that high transient current voltage can be expected to clamp sharply at the values in kV and mA.</p></sec><sec id="sec014"><title>Impact of lightning impulse current waveshapes</title><p>Four variations of lightning impulse current wave shapes: 10/350&#x003bc;s; 8/20&#x003bc;s;0.7/6&#x003bc;s;and 2/70&#x003bc;s are discussed with regard to their impacts in this section. Variations of lightning impulse current wave shapes are applied at P1 and P2 to study their effects on the solar PV Rooftop. From Tables <xref rid="pone.0219326.t006" ref-type="table">6</xref> and <xref rid="pone.0219326.t007" ref-type="table">7</xref>, all the data were measured by applying the four different lightning impulse current wave shapes at P1 and P2 with the same peak of lightning amplitude of 31 kA as shown in <xref ref-type="fig" rid="pone.0219326.g019">Fig 19</xref>.</p><fig id="pone.0219326.g019" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.g019</object-id><label>Fig 19</label><caption><title>Variation of lightning impulse current wave shape.</title></caption><graphic xlink:href="pone.0219326.g019"/></fig><table-wrap id="pone.0219326.t007" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t007</object-id><label>Table 7</label><caption><title>Variation of lightning impulse current wave shape at P1 striking point.</title></caption><alternatives><graphic id="pone.0219326.t007g" xlink:href="pone.0219326.t007"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1"><break/>Lightning Impulse Current Wave shape at, &#x003bc;s</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">mA</th><th align="center" rowspan="1" colspan="1">V</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">8/20</td><td align="center" rowspan="1" colspan="1">1915</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">5392</td><td align="center" rowspan="1" colspan="1">5.97</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">21.10</td><td align="center" rowspan="1" colspan="1">0.751</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">10/350</td><td align="center" rowspan="1" colspan="1">2479</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">11865</td><td align="center" rowspan="1" colspan="1">6.618</td><td align="center" rowspan="1" colspan="1">1.913</td><td align="center" rowspan="1" colspan="1">33.58</td><td align="center" rowspan="1" colspan="1">0.897</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">0.7/6</td><td align="center" rowspan="1" colspan="1">2392</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">3053</td><td align="center" rowspan="1" colspan="1">10.987</td><td align="center" rowspan="1" colspan="1">1.914</td><td align="center" rowspan="1" colspan="1">15.53</td><td align="center" rowspan="1" colspan="1">0.614</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">2/70</td><td align="center" rowspan="1" colspan="1">2391</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">9887</td><td align="center" rowspan="1" colspan="1">9.885</td><td align="center" rowspan="1" colspan="1">2.391</td><td align="center" rowspan="1" colspan="1">31.53</td><td align="center" rowspan="1" colspan="1">0.867</td><td align="center" rowspan="1" colspan="1">0</td></tr></tbody></table></alternatives></table-wrap><p>Further analysis in Tables <xref rid="pone.0219326.t007" ref-type="table">7</xref> and <xref rid="pone.0219326.t008" ref-type="table">8</xref> shows that when lightning strikes at P1 and P2, the highest voltage is obtained at wave shape of 10/350 &#x003bc;s, followed by 2/70 &#x003bc;s, 8/20 &#x003bc;s and 0.7/6 &#x003bc;s. Therefore, the solar PV Rooftop modules and inverter have a tendency to decay and be damaged due to the current waveshape applied.</p><table-wrap id="pone.0219326.t008" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t008</object-id><label>Table 8</label><caption><title>Variation of lightning impulse current wave shape at P2 striking point.</title></caption><alternatives><graphic id="pone.0219326.t008g" xlink:href="pone.0219326.t008"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1"><break/>Lightning Impulse Current Wave shape at, &#x003bc;s</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">mV</th><th align="center" rowspan="1" colspan="1">A</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">8/20</td><td align="center" rowspan="1" colspan="1">0.153</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">4283</td><td align="center" rowspan="1" colspan="1">25.353</td><td align="center" rowspan="1" colspan="1">0.01116</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.292</td></tr><tr><td align="center" rowspan="1" colspan="1">10/350</td><td align="center" rowspan="1" colspan="1">0.203</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">11277</td><td align="center" rowspan="1" colspan="1">26.003</td><td align="center" rowspan="1" colspan="1">0.01289</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.029</td><td align="center" rowspan="1" colspan="1">0.592</td></tr><tr><td align="center" rowspan="1" colspan="1">0.7/6</td><td align="center" rowspan="1" colspan="1">0.0911</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1924</td><td align="center" rowspan="1" colspan="1">26.309</td><td align="center" rowspan="1" colspan="1">0.01074</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.144</td></tr><tr><td align="center" rowspan="1" colspan="1">2/70</td><td align="center" rowspan="1" colspan="1">0.193</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">8773</td><td align="center" rowspan="1" colspan="1">26.305</td><td align="center" rowspan="1" colspan="1">0.01337</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.032</td><td align="center" rowspan="1" colspan="1">0.537</td></tr></tbody></table></alternatives></table-wrap><p>Another important finding as shown in <xref rid="pone.0219326.t007" ref-type="table">Table 7</xref> is that transient voltage becomes slightly different. However, among the four lightning impulse current wave shapes, the 10/350&#x003bc;s shows high value of transient current of 33.58 mA was clamped. The table shows that 2/70&#x003bc;s impulse current wave shape has high value of transient voltage that was also clamped at 2.391 kV for lightning strike at P1. At high transient current, 0.592 kA, P2 was clamped for lightning impulse current wave shape at 10/350&#x003bc;s.</p></sec><sec id="sec015"><title>Impact of lightning current amplitude</title><p>Impact of different lightning amplitude current is described in this section. The parameters that are used in this case study include: the 31 kA peak current; 10 metres length of cable; and the lightning impulse current waveshape,8/20&#x003bc;s. Different lightning amplitudes were also applied, ranging from 2&#x02013;200 kA selected based on the CIGRE distribution. The currents were injected at P1 and P2 at the solar PV Rooftop system and data were measured as shown in Tables <xref rid="pone.0219326.t009" ref-type="table">9</xref> and <xref rid="pone.0219326.t010" ref-type="table">10</xref>.</p><table-wrap id="pone.0219326.t009" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t009</object-id><label>Table 9</label><caption><title>Impact of variation lightning amplitude current at P1 striking point.</title></caption><alternatives><graphic id="pone.0219326.t009g" xlink:href="pone.0219326.t009"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1">Lightning Amplitude (kA)</th><th align="center" colspan="2" rowspan="1">P1(before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">mA</th><th align="center" rowspan="1" colspan="1">V</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">2</td><td align="center" rowspan="1" colspan="1">154</td><td align="center" rowspan="1" colspan="1">2</td><td align="center" rowspan="1" colspan="1">348</td><td align="center" rowspan="1" colspan="1">0.385</td><td align="center" rowspan="1" colspan="1">1.185</td><td align="center" rowspan="1" colspan="1">13.42</td><td align="center" rowspan="1" colspan="1">0.596</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">386</td><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">869</td><td align="center" rowspan="1" colspan="1">0.964</td><td align="center" rowspan="1" colspan="1">1.3999</td><td align="center" rowspan="1" colspan="1">15.40</td><td align="center" rowspan="1" colspan="1">0.645</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">773</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">1740</td><td align="center" rowspan="1" colspan="1">1.929</td><td align="center" rowspan="1" colspan="1">1.571</td><td align="center" rowspan="1" colspan="1">17.62</td><td align="center" rowspan="1" colspan="1">0.679</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">1549</td><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">3487</td><td align="center" rowspan="1" colspan="1">3.866</td><td align="center" rowspan="1" colspan="1">1.751</td><td align="center" rowspan="1" colspan="1">19.88</td><td align="center" rowspan="1" colspan="1">0.719</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">30</td><td align="center" rowspan="1" colspan="1">2326</td><td align="center" rowspan="1" colspan="1">30</td><td align="center" rowspan="1" colspan="1">5235</td><td align="center" rowspan="1" colspan="1">5.803</td><td align="center" rowspan="1" colspan="1">1.902</td><td align="center" rowspan="1" colspan="1">21.02</td><td align="center" rowspan="1" colspan="1">0.748</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">40</td><td align="center" rowspan="1" colspan="1">3085</td><td align="center" rowspan="1" colspan="1">40</td><td align="center" rowspan="1" colspan="1">6943</td><td align="center" rowspan="1" colspan="1">7.697</td><td align="center" rowspan="1" colspan="1">2.049</td><td align="center" rowspan="1" colspan="1">22.03</td><td align="center" rowspan="1" colspan="1">0.774</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">50</td><td align="center" rowspan="1" colspan="1">3863</td><td align="center" rowspan="1" colspan="1">50</td><td align="center" rowspan="1" colspan="1">8695</td><td align="center" rowspan="1" colspan="1">9.639</td><td align="center" rowspan="1" colspan="1">2.199</td><td align="center" rowspan="1" colspan="1">23.01</td><td align="center" rowspan="1" colspan="1">0.796</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">100</td><td align="center" rowspan="1" colspan="1">7719</td><td align="center" rowspan="1" colspan="1">100</td><td align="center" rowspan="1" colspan="1">17373</td><td align="center" rowspan="1" colspan="1">19.260</td><td align="center" rowspan="1" colspan="1">2.948</td><td align="center" rowspan="1" colspan="1">27.36</td><td align="center" rowspan="1" colspan="1">0.897</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">150</td><td align="center" rowspan="1" colspan="1">11570</td><td align="center" rowspan="1" colspan="1">150</td><td align="center" rowspan="1" colspan="1">26041</td><td align="center" rowspan="1" colspan="1">28.869</td><td align="center" rowspan="1" colspan="1">3.694</td><td align="center" rowspan="1" colspan="1">31.15</td><td align="center" rowspan="1" colspan="1">0.989</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">200</td><td align="center" rowspan="1" colspan="1">15428</td><td align="center" rowspan="1" colspan="1">200</td><td align="center" rowspan="1" colspan="1">34723</td><td align="center" rowspan="1" colspan="1">38.495</td><td align="center" rowspan="1" colspan="1">4.443</td><td align="center" rowspan="1" colspan="1">36.03</td><td align="center" rowspan="1" colspan="1">1.08</td><td align="center" rowspan="1" colspan="1">0</td></tr></tbody></table></alternatives></table-wrap><table-wrap id="pone.0219326.t010" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t010</object-id><label>Table 10</label><caption><title>Impact of variation lightning amplitude current at P2 striking point.</title></caption><alternatives><graphic id="pone.0219326.t010g" xlink:href="pone.0219326.t010"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1">Lightning Amplitude (kA)</th><th align="center" colspan="2" rowspan="1">P2(before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">mV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">2</td><td align="center" rowspan="1" colspan="1">0.00988</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">276</td><td align="center" rowspan="1" colspan="1">1.634</td><td align="center" rowspan="1" colspan="1">0.004431</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1.015</td><td align="center" rowspan="1" colspan="1">0.0823</td></tr><tr><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">0.0247</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">691</td><td align="center" rowspan="1" colspan="1">4.089</td><td align="center" rowspan="1" colspan="1">0.006211</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1.297</td><td align="center" rowspan="1" colspan="1">0.131</td></tr><tr><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">0.0495</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1381</td><td align="center" rowspan="1" colspan="1">8.178</td><td align="center" rowspan="1" colspan="1">0.007772</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1.528</td><td align="center" rowspan="1" colspan="1">0.181</td></tr><tr><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">0.0991</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2769</td><td align="center" rowspan="1" colspan="1">16.392</td><td align="center" rowspan="1" colspan="1">0.009703</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1.802</td><td align="center" rowspan="1" colspan="1">0.244</td></tr><tr><td align="center" rowspan="1" colspan="1">30</td><td align="center" rowspan="1" colspan="1">0.149</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">4156</td><td align="center" rowspan="1" colspan="1">24.607</td><td align="center" rowspan="1" colspan="1">0.01105</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.013</td><td align="center" rowspan="1" colspan="1">0.288</td></tr><tr><td align="center" rowspan="1" colspan="1">40</td><td align="center" rowspan="1" colspan="1">0.198</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">5522</td><td align="center" rowspan="1" colspan="1">32.697</td><td align="center" rowspan="1" colspan="1">0.01228</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.222</td><td align="center" rowspan="1" colspan="1">0.325</td></tr><tr><td align="center" rowspan="1" colspan="1">50</td><td align="center" rowspan="1" colspan="1">0.247</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">6904</td><td align="center" rowspan="1" colspan="1">40.875</td><td align="center" rowspan="1" colspan="1">0.01348</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.432</td><td align="center" rowspan="1" colspan="1">0.359</td></tr><tr><td align="center" rowspan="1" colspan="1">100</td><td align="center" rowspan="1" colspan="1">0.494</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">13794</td><td align="center" rowspan="1" colspan="1">81.670</td><td align="center" rowspan="1" colspan="1">0.01934</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">3.483</td><td align="center" rowspan="1" colspan="1">0.502</td></tr><tr><td align="center" rowspan="1" colspan="1">150</td><td align="center" rowspan="1" colspan="1">0.740</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">26675</td><td align="center" rowspan="1" colspan="1">122.414</td><td align="center" rowspan="1" colspan="1">0.02512</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">4.532</td><td align="center" rowspan="1" colspan="1">0.629</td></tr><tr><td align="center" rowspan="1" colspan="1">200</td><td align="center" rowspan="1" colspan="1">0.987</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">27569</td><td align="center" rowspan="1" colspan="1">163.231</td><td align="center" rowspan="1" colspan="1">0.03089</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">5.583</td><td align="center" rowspan="1" colspan="1">0.750</td></tr></tbody></table></alternatives></table-wrap><p>The electrical and electronic equipment has the highest tendency to be damaged or to decay even at 2 kA of lightning amplitude current strike at P1 and P2. The current at 2 kA lightning amplitude strike is considered high while having voltage values of 154 kV at P1 and 276 kV at P2.</p><p>Tables <xref rid="pone.0219326.t009" ref-type="table">9</xref> and <xref rid="pone.0219326.t010" ref-type="table">10</xref> show the case of Variation Lightning Amplitude Current, 2 kA to 200 kA with type II SPD Installation at DC and AC side. The tables show that there is a slight increase in the value of transient current and voltage clamped based on the observation done from the table. There is a high possibility that the highest transient current and voltage at lightning amplitude current of 200 kA would be clamped from 15.428 MV to 4.443 kV for lightning strikes at P1 and 34.723 MV to 1.08 V for lightning strike at P2.</p></sec><sec id="sec016"><title>Impact of cable lengths</title><p>The impact of lightning on varying cable lengths at P1 and P2 are discussed in this section. The parameters used in this part of the study are: 31 kA peak current; and lightning impulse current waveshape, 8/20&#x003bc;s. Different cable lengths from 5 metres to 20 metres are applied to the parametres accordingly at point 1 and point 2. From Tables <xref rid="pone.0219326.t011" ref-type="table">11</xref> and <xref rid="pone.0219326.t012" ref-type="table">12</xref>, all the data measured will be discussed in relation to the impact of cable length variation on the PV Rooftop system.</p><table-wrap id="pone.0219326.t011" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t011</object-id><label>Table 11</label><caption><title>Variation of cable length at P1.</title></caption><alternatives><graphic id="pone.0219326.t011g" xlink:href="pone.0219326.t011"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1">Cable Distance (m)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P1 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">mA</th><th align="center" rowspan="1" colspan="1">V</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">2397</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">7579</td><td align="center" rowspan="1" colspan="1">4.005</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">56.24</td><td align="center" rowspan="1" colspan="1">1.17</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">2397</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">5392</td><td align="center" rowspan="1" colspan="1">5.97</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">21.10</td><td align="center" rowspan="1" colspan="1">0.751</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">15</td><td align="center" rowspan="1" colspan="1">2397</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">4447</td><td align="center" rowspan="1" colspan="1">7.444</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">16.75</td><td align="center" rowspan="1" colspan="1">0.603</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">2397</td><td align="center" rowspan="1" colspan="1">31</td><td align="center" rowspan="1" colspan="1">3834</td><td align="center" rowspan="1" colspan="1">8.672</td><td align="center" rowspan="1" colspan="1">1.915</td><td align="center" rowspan="1" colspan="1">15.53</td><td align="center" rowspan="1" colspan="1">0.566</td><td align="center" rowspan="1" colspan="1">0</td></tr></tbody></table></alternatives></table-wrap><table-wrap id="pone.0219326.t012" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0219326.t012</object-id><label>Table 12</label><caption><title>Variation of cable length at P2.</title></caption><alternatives><graphic id="pone.0219326.t012g" xlink:href="pone.0219326.t012"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="center" colspan="4" rowspan="1">Without Surge Protection Device (SPD)</th><th align="center" colspan="4" rowspan="1">With Surge Protection Device (SPD)</th></tr><tr><th align="center" rowspan="3" colspan="1">Cable Distance (m)</th><th align="center" colspan="2" rowspan="1">P2(before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (before Inverter)</th><th align="center" colspan="2" rowspan="1">P2 (After Inverter)</th></tr><tr><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th><th align="center" rowspan="1" colspan="1">Vinv DC</th><th align="center" rowspan="1" colspan="1">Iinv DC</th><th align="center" rowspan="1" colspan="1">Vinv AC</th><th align="center" rowspan="1" colspan="1">Iinv AC</th></tr><tr><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">mV</th><th align="center" rowspan="1" colspan="1">kA</th><th align="center" rowspan="1" colspan="1">kV</th><th align="center" rowspan="1" colspan="1">kA</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">0.169</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">6448</td><td align="center" rowspan="1" colspan="1">25.357</td><td align="center" rowspan="1" colspan="1">0.07406</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.032</td><td align="center" rowspan="1" colspan="1">0.348</td></tr><tr><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">0.153</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">4283</td><td align="center" rowspan="1" colspan="1">25.353</td><td align="center" rowspan="1" colspan="1">0.01116</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.292</td></tr><tr><td align="center" rowspan="1" colspan="1">15</td><td align="center" rowspan="1" colspan="1">0.00237</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">3152</td><td align="center" rowspan="1" colspan="1">25.103</td><td align="center" rowspan="1" colspan="1">0.0000308</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.251</td></tr><tr><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2286</td><td align="center" rowspan="1" colspan="1">24.786</td><td align="center" rowspan="1" colspan="1">0.000002933</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.033</td><td align="center" rowspan="1" colspan="1">0.221</td></tr></tbody></table></alternatives></table-wrap><p>In summary, the results in <xref rid="pone.0219326.t011" ref-type="table">Table 11</xref> show that the current and voltage at DC part are the same when lightning strikes at P1 and at AC part the results indicate that the highest voltage and current is at the 5-metre cable length. When lightning strikes at P2 the results indicate that the highest voltage and current is at the 5-metre cable length.</p><p>The next section of the results pertains to different cable lengths as shown in <xref rid="pone.0219326.t011" ref-type="table">Table 11</xref>. The transient current at P1 before the inverter for a 5-metre cable length is high compared to the other lengths of 56.24 mA. The transient current decreases as the cable length increases until the length of 20 metres. However, the transient current and voltage clamped among the four cable lengths at P1 and P2 are almost the same.</p></sec></sec><sec sec-type="conclusions" id="sec017"><title>Discussion</title><p>The investigations of lightning strikes in several case studies were conducted and their outcomes discussed. When lightning directly strikes at certain points of the PV Rooftop system, extremely high voltage and current that exceed the acceptance level of voltage are produced. In this section, according to the lightning amplitude at 31 kA peak with 8/20 &#x003bc;s lightning impulse current, the high current and voltage at P1 striking point were 31 kA and 2397 kV, respectively. As for the AC part of this section, the current and voltage values were found to be 5.97 kA and 5392 kV, respectively. Without suitable protection, equipment is susceptible to failure and damage from the high voltages and currents. Therefore, SPDs with suitable ratings provided by SEDA were deployed. Results also show that high transient current voltage is expected to clamp sharply at the values of 1.915 kV and 0 ampere at the P1 striking point. The AC part shows that the current and voltage values were 0 kA and 0.751 V, respectively. The rising time and decaying time of lightning current wave shape will affect the transient voltage as shown. Moreover, if rise time and decay time are increased, the transient voltage increases too.</p><p>Direct lightning strikes by lightning current impulse wave shape of 10/350 &#x003bc;s with a fast rise time and long decaying time produce high energy. The high current and voltage that were produced at the P1 striking point were 31 kA and 2479 kV for this impulse wave shape. In the AC part the current and voltage values were found to be 6.618 kA and 11865 kV, respectively. High values of transient current and voltage were clamped at a lower level at values of 33.58 mA and 1.913 kV. The AC part shows that the current and voltage were 0 ampere and 0.897 volt. In this section, the impact of varying cable lengths on the PV Rooftop system shows that for the AC part, the highest voltage and current was at the 5-metre cable length. Consequently, according to the results, there is still the need to deploy SPD at points 1 and 2 as opposed to the standard at the 5-metre length of cable.</p><p>To ensure that there is effective protection of the equipment, the value of Voltage protection level, U<sub>p</sub> should be lower than the value of voltage withstand of the equipment to be protected. A safety margin of at least 20% between the voltage withstand of the equipment and U<sub>p</sub> should be maintained. Results obtained have given some indicators on the proper ratings to be made depending on the local data available at the site. Parameters like MCOV, Up, Imax and Iimp play an important role when selecting the right SPD to be installed. This does not only help in protecting the system from damage but will increase the life span of the components in the long run.</p></sec><sec sec-type="conclusions" id="sec018"><title>Conclusion</title><p>Due to its spacious structure and is full exposure outdoors, PV Rooftop systems are highly prone to direct and indirect lightning strikes and other surge overvoltages. These disruptions may cause destruction and malfunction of part of the whole PV Rooftop system. Direct strikes lead to severe damage to the PV Rooftop system. A lightning strike nearby induces voltages into the system. These strikes can also destroy PV panels, inverters, cables, and fuses that consequently disrupt the operation of the system. The Lightning Protection technique for PV Rooftop system should be designed properly and implemented for economic reasons and ensure return of investment. Therefore, rather than incurring the high cost of repair and replacement due to damage from lightning strikes, it is prudent to provide a safe location to install and optimise the lightning protection of the PV Rooftop System.</p><p>From the analyses done without the inclusion of SPDs, modules of solar PV would be damaged and degraded if they exceed their withstanding capabilities. The extremely high current and voltage that are propagated as travelling waves produced by a direct lightning strike on certain points of the PV Rooftop system are responsible for this. In the long run, lightning tends to damage or degrade the electronic equipment of the PV Rooftop system. Regardless of any point of strike, there is a need for SPD to be installed. Results obtained have given some indications of the proper ratings to be made, depending on the local data available on site. The criteria when selecting the right SPD to be installed are also important. This does not only assist in protecting the system from severe damage but will increase the life span of the components and generally ensure the smooth and efficient operation of the PV Rooftop system.</p></sec></body><back><ack><p>The authors would like to thank the Centre for Electromagnetic and Lightning Protection Research (CELP) of Universiti Putra Malaysia for providing their facilities and valuable assistance in conducting the experiments.</p></ack><ref-list><title>References</title><ref id="pone.0219326.ref001"><label>1</label><mixed-citation publication-type="journal"><name><surname>Akikur</surname><given-names>R. K.</given-names></name>, <name><surname>Saidur</surname><given-names>R.</given-names></name>, <name><surname>Ping</surname><given-names>H. W.</given-names></name>, and <name><surname>Ullah</surname><given-names>K. R.</given-names></name>, &#x0201c;<article-title>Comparative Study of Stand-Alone and Hybrid Solar Energy Systems Suitable for off-grid Rural Electrification: A Review</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Sustainable Energy Review</italic></source>, vol. <volume>27</volume>, pp. <fpage>738</fpage>&#x02013;<lpage>752</lpage>, <year>2013</year>.</mixed-citation></ref><ref id="pone.0219326.ref002"><label>2</label><mixed-citation publication-type="journal"><name><surname>Ab Kadir</surname><given-names>M. Z. A.</given-names></name>, <name><surname>Rafeeu</surname><given-names>Y.</given-names></name>, and <name><surname>Adam</surname><given-names>N. M.</given-names></name>, &#x0201c;<article-title>Prospective Scenarios for the Full Solar Energy Development in Malaysia</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Sustainable Energy Review</italic></source>, vol. <volume>14</volume>, no. <issue>9</issue>, pp. <fpage>3023</fpage>&#x02013;<lpage>3031</lpage>, <year>2010</year>.</mixed-citation></ref><ref id="pone.0219326.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>Mekhilef</surname><given-names>S.</given-names></name>, <name><surname>Safari</surname><given-names>A.</given-names></name>, <name><surname>Mustaffa</surname><given-names>W. E. S.</given-names></name>, <name><surname>Saidur</surname><given-names>R.</given-names></name>, <name><surname>Omar</surname><given-names>R.</given-names></name>, and <name><surname>Younis</surname><given-names>M. A. A.</given-names></name>, &#x0201c;<article-title>Solar energy in Malaysia: Current State and Prospects</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Sustainable Energy Review</italic></source>, vol. <volume>16</volume>, no. <issue>1</issue>, pp. <fpage>386</fpage>&#x02013;<lpage>396</lpage>, <year>2012</year>.</mixed-citation></ref><ref id="pone.0219326.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>S. L.</given-names></name>, <name><surname>Ngadi</surname><given-names>N.</given-names></name>, <name><surname>Abdullah</surname><given-names>T. A. T.</given-names></name>, and <name><surname>Inuwa</surname><given-names>I. M.</given-names></name>, &#x0201c;<article-title>Recent Advances of Feed-in Tariff in Malaysia</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Sustainable Energy Review</italic></source>, vol. <volume>41</volume>, pp. <fpage>42</fpage>&#x02013;<lpage>52</lpage>, <year>2015</year>.</mixed-citation></ref><ref id="pone.0219326.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Asuhaimi</surname><given-names>A.</given-names></name>, <name><surname>Zinand</surname><given-names>M.</given-names></name>
<name><surname>Karim</surname><given-names>S. P. A.</given-names></name>, &#x0201c;<article-title>The Application of Fault Signature Analysis in Tenaga Nasional Berhad Malaysia</article-title>,&#x0201d; vol. <volume>22</volume>, no. <issue>4</issue>, pp. <fpage>2047</fpage>&#x02013;<lpage>2056</lpage>, <year>2007</year>.</mixed-citation></ref><ref id="pone.0219326.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>Ahmad</surname><given-names>N. I.</given-names></name>, <name><surname>Ab-Kadir</surname><given-names>M. Z. A.</given-names></name>, <name><surname>Izadi</surname><given-names>M.</given-names></name>, <name><surname>Azis</surname><given-names>N.</given-names></name>, <name><surname>Radzi</surname><given-names>M. A. M.</given-names></name>, <name><surname>Zaini</surname><given-names>N. H.</given-names></name>
<etal>et.al</etal> &#x0201c;<article-title>Lightning Protection on Photovoltaic Systems: A review on Current and Recommended Practices</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Sustainable Energy Review</italic></source>, no. <month>3</month>, <year>2017</year>.</mixed-citation></ref><ref id="pone.0219326.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>Tu</surname><given-names>Y.</given-names></name>, <name><surname>Zhang</surname><given-names>C.</given-names></name>, <name><surname>Hu</surname><given-names>J.</given-names></name>, <name><surname>Wang</surname><given-names>S.</given-names></name>, <name><surname>Sun</surname><given-names>W.</given-names></name>, and <name><surname>Li</surname><given-names>H.</given-names></name>, &#x0201c;<article-title>Research on lightning overvoltages of solar arrays in a rooftop photovoltaic power system</article-title>,&#x0201d; <source><italic toggle="yes">Electric Power System Research</italic></source>, vol. <volume>94</volume>, pp. <fpage>10</fpage>&#x02013;<lpage>15</lpage>, <year>2013</year>.</mixed-citation></ref><ref id="pone.0219326.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Naxakis</surname><given-names>I.</given-names></name>, <name><surname>Pyrgioti</surname><given-names>E.</given-names></name>, <name><surname>Perraki</surname><given-names>V.</given-names></name>, and <name><surname>Tselepis</surname><given-names>E.</given-names></name>, &#x0201c;<article-title>Studying the effect of the impulse voltage application on sc-Si PV modules</article-title>,&#x0201d; <source><italic toggle="yes">Solar Energy</italic></source>, vol. <volume>144</volume>, pp. <fpage>721</fpage>&#x02013;<lpage>728</lpage>, <year>2017</year>.</mixed-citation></ref><ref id="pone.0219326.ref009"><label>9</label><mixed-citation publication-type="other">T. Jiang and S. Grzybowski, &#x0201c;Influence of lightning impulse voltages on power output characteristics of Photovoltaic modules,&#x0201d; <italic>ICHVE 2014&#x02013;2014 International Conference on High Voltage Engineering and Application</italic>, no. 4, 2014.</mixed-citation></ref><ref id="pone.0219326.ref010"><label>10</label><mixed-citation publication-type="other">S. Sekioka, &#x0201c;An experimental study of sparkover between a rod and a photovoltaic panel,&#x0201d; <italic>2012 31st International Conference on Lightning Protection ICLP 2012</italic>, 2012.</mixed-citation></ref><ref id="pone.0219326.ref011"><label>11</label><mixed-citation publication-type="other">M. Belik, &#x0201c;PV panels under lightning conditions,&#x0201d; <italic>Proc. 2014 15th Internation Scientific Conference on Electric Power Engineering. EPE 2014</italic>, pp. 367&#x02013;370, 2014.</mixed-citation></ref><ref id="pone.0219326.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Hidayu</surname><given-names>N.</given-names></name>, <name><surname>Rahim</surname><given-names>A.</given-names></name>, <name><surname>Baharudin</surname><given-names>Z. A.</given-names></name>, <name><surname>Othman</surname><given-names>N.</given-names></name>, and <name><surname>Zakaria</surname><given-names>Z.</given-names></name>, &#x0201c;<article-title>Investigation of Wave Propagation to PV-Solar Panel Due to Lightning Induced Overvoltage</article-title>,&#x0201d; vol. <volume>12</volume>, no. <issue>1</issue>, pp. <fpage>47</fpage>&#x02013;<lpage>52</lpage>, <year>2014</year>.</mixed-citation></ref><ref id="pone.0219326.ref013"><label>13</label><mixed-citation publication-type="other">J. Xue, Z. Yin, B. Wu, and J. Peng, &#x0201c;Design of PV array model based on EMTDC/PSCAD,&#x0201d; <italic>Asia-Pacific Power Energy Engineering Conference APPEEC</italic>, vol. 102206, 2009.</mixed-citation></ref><ref id="pone.0219326.ref014"><label>14</label><mixed-citation publication-type="other">A. D. Rajapakse and D. Muthumuni, &#x0201c;Simulation tools for photovoltaic system grid integration studies,&#x0201d; <italic>2009 IEEE Electrical Power Energy Conference EPEC 2009</italic>, pp. 1&#x02013;5, 2009.</mixed-citation></ref><ref id="pone.0219326.ref015"><label>15</label><mixed-citation publication-type="journal"><name><surname>Mastromauro</surname><given-names>R. A.</given-names></name>, <name><surname>Liserre</surname><given-names>M.</given-names></name>, and <name><surname>Dell&#x02019;Aquila</surname><given-names>A.</given-names></name>, &#x0201c;<article-title>Control issues in single-stage photovoltaic systems: MPPT, current and voltage control</article-title>,&#x0201d; <source><italic toggle="yes">IEEE Transaction Industrial Informatics</italic></source>, vol. <volume>8</volume>, no. <issue>2</issue>, pp. <fpage>241</fpage>&#x02013;<lpage>254</lpage>, <year>2012</year>.</mixed-citation></ref><ref id="pone.0219326.ref016"><label>16</label><mixed-citation publication-type="other">B. K. Perera, S. R. Pulikanti, P. Ciufo, and S. Perera, &#x0201c;Simulation Model of a Grid-Connected Single-Phase Photovoltaic System in PSCAD/EMTDC,&#x0201d; <italic>2012 IEEE International Conference Power System Technologies POWERCON 2012</italic>, pp. 1&#x02013;6, 2012.</mixed-citation></ref><ref id="pone.0219326.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Riyadi</surname><given-names>S.</given-names></name>, &#x0201c;<article-title>Single-phase single-stage PV-grid system using VSI based on simple control circuit</article-title>,&#x0201d; <source><italic toggle="yes">International Journal Power Electronic</italic>. <italic toggle="yes">Drive System</italic></source>, vol. <volume>3</volume>, no. <issue>1</issue>, pp. <fpage>9</fpage>&#x02013;<lpage>16</lpage>, <year>2013</year>.</mixed-citation></ref><ref id="pone.0219326.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>Sastry</surname><given-names>J.</given-names></name>, <name><surname>Bakas</surname><given-names>P.</given-names></name>, <name><surname>Kim</surname><given-names>H.</given-names></name>, <name><surname>Wang</surname><given-names>L.</given-names></name>, and <name><surname>Marinopoulos</surname><given-names>A.</given-names></name>, &#x0201c;<article-title>Evaluation of cascaded H-bridge inverter for utility-scale photovoltaic systems</article-title>,&#x0201d; <source><italic toggle="yes">Renewable Energy</italic></source>, vol. <volume>69</volume>, pp. <fpage>208</fpage>&#x02013;<lpage>218</lpage>, <year>2014</year>.</mixed-citation></ref><ref id="pone.0219326.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>Ruan</surname><given-names>X.</given-names></name>, <name><surname>Wang</surname><given-names>X.</given-names></name>, <name><surname>Pan</surname><given-names>D.</given-names></name>, <name><surname>Yang</surname><given-names>D.</given-names></name>, <name><surname>Li</surname><given-names>W.</given-names></name>, and <name><surname>Bao</surname><given-names>C.</given-names></name>, <source><italic toggle="yes">Control techniques for LCL-type grid-connected inverters</italic></source>. <year>2018</year>.</mixed-citation></ref><ref id="pone.0219326.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Kahlane</surname><given-names>A. E. W. H.</given-names></name>, <name><surname>Hassaine</surname><given-names>L.</given-names></name>, and <name><surname>Kherchi</surname><given-names>M.</given-names></name>, &#x0201c;<article-title>LCL filter design for photovoltaic grid connected systems</article-title>,&#x0201d; pp. <fpage>227</fpage>&#x02013;<lpage>232</lpage>, <year>2014</year>.</mixed-citation></ref><ref id="pone.0219326.ref021"><label>21</label><mixed-citation publication-type="other">J. Wang and X. Zhang, &#x0201c;Double-exponential expression of lightning current waveforms,&#x0201d; in <italic>Proceedings&#x02014;Fourth Asia-Pacific Conference on Environmental Electromagnetics, CEEM&#x02019;2006</italic>, 2006, pp. 320&#x02013;323.</mixed-citation></ref><ref id="pone.0219326.ref022"><label>22</label><mixed-citation publication-type="journal"><name><surname>Delfino</surname><given-names>F.</given-names></name>, <name><surname>Procopio</surname><given-names>R.</given-names></name>, <name><surname>Rossi</surname><given-names>M.</given-names></name>, and <name><surname>Rachidi</surname><given-names>F.</given-names></name>, &#x0201c;<article-title>Prony series representation for the lightning channel base current</article-title>,&#x0201d; <source><italic toggle="yes">IEEE Transaction Electromagnetic</italic>. <italic toggle="yes">Compatibility</italic></source>, vol. <volume>54</volume>, no. <issue>2</issue>, pp. <fpage>308</fpage>&#x02013;<lpage>315</lpage>, <year>2012</year>.</mixed-citation></ref><ref id="pone.0219326.ref023"><label>23</label><mixed-citation publication-type="journal"><name><surname>Heidler</surname><given-names>F.</given-names></name>, <name><surname>Cvetic</surname><given-names>J. M.</given-names></name>, and <name><surname>Stanic</surname><given-names>B. V.</given-names></name>, &#x0201c;<article-title>Calculation of lightning current parameters</article-title>,&#x0201d; <source><italic toggle="yes">IEEE Transaction Power Delivery</italic></source>, vol. <volume>14</volume>, no. <issue>2</issue>, pp. <fpage>399</fpage>&#x02013;<lpage>404</lpage>, <year>1999</year>.</mixed-citation></ref><ref id="pone.0219326.ref024"><label>24</label><mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>R. A.</given-names></name>, <name><surname>Clifton</surname><given-names>P. R.</given-names></name>, <name><surname>Grotz</surname><given-names>G.</given-names></name>, <name><surname>Lat</surname><given-names>M.</given-names></name>, <name><surname>Lembo</surname><given-names>F.</given-names></name>, <name><surname>Melvold</surname><given-names>D. J.</given-names></name>, <etal>et. al</etal>, &#x0201c;<article-title>Modeling of Metal Oxide Surge Arresters</article-title>,&#x0201d; <source><italic toggle="yes">IEEE Transaction</italic>. <italic toggle="yes">Power Delivery</italic></source>, vol. <volume>7</volume>, no. <issue>1</issue>, pp. <fpage>302</fpage>&#x02013;<lpage>309</lpage>, <year>1992</year>.</mixed-citation></ref></ref-list></back></article>