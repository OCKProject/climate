<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Philos Trans A Math Phys Eng Sci</journal-id><journal-id journal-id-type="iso-abbrev">Philos Trans A Math Phys Eng Sci</journal-id><journal-id journal-id-type="publisher-id">RSTA</journal-id><journal-id journal-id-type="hwp">roypta</journal-id><journal-title-group><journal-title>Philosophical transactions. Series A, Mathematical, physical, and engineering sciences</journal-title></journal-title-group><issn pub-type="ppub">1364-503X</issn><issn pub-type="epub">1471-2962</issn><publisher><publisher-name>The Royal Society Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6388013</article-id><article-id pub-id-type="doi">10.1098/rsta.2018.0148</article-id><article-id pub-id-type="publisher-id">rsta20180148</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>1005</subject><subject>12</subject><subject>127</subject><subject>41</subject><subject>1003</subject><subject>184</subject></subj-group><subj-group subj-group-type="heading"><subject>Articles</subject></subj-group><subj-group subj-group-type="leader"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Assessing the scales in numerical weather and climate predictions: will exascale be the rescue?</article-title><alt-title alt-title-type="short">Hi-Res Weather and Climate Modelling</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8604-8846</contrib-id><name><surname>Neumann</surname><given-names>Philipp</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="corresp" rid="cor1"/></contrib><contrib contrib-type="author"><name><surname>D&#x000fc;ben</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><name><surname>Adamidis</surname><given-names>Panagiotis</given-names></name><xref ref-type="aff" rid="af1">1</xref></contrib><contrib contrib-type="author"><name><surname>Bauer</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8830-8506</contrib-id><name><surname>Br&#x000fc;ck</surname><given-names>Matthias</given-names></name><xref ref-type="aff" rid="af3">3</xref></contrib><contrib contrib-type="author"><name><surname>Kornblueh</surname><given-names>Luis</given-names></name><xref ref-type="aff" rid="af3">3</xref></contrib><contrib contrib-type="author"><name><surname>Klocke</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="af4">4</xref></contrib><contrib contrib-type="author"><name><surname>Stevens</surname><given-names>Bjorn</given-names></name><xref ref-type="aff" rid="af3">3</xref></contrib><contrib contrib-type="author"><name><surname>Wedi</surname><given-names>Nils</given-names></name><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><name><surname>Biercamp</surname><given-names>Joachim</given-names></name><xref ref-type="aff" rid="af1">1</xref></contrib></contrib-group><aff id="af1"><label>1</label><institution>Deutsches Klimarechenzentrum</institution>, <addr-line>Bundesstr. 45a, 20146 Hamburg</addr-line>, <country>Germany</country></aff><aff id="af2"><label>2</label><institution>European Centre for Medium-Range Weather Forecasts</institution>, <addr-line>Shinfield Park, Reading RG2 9AX</addr-line>, <country>UK</country></aff><aff id="af3"><label>3</label><institution>Max-Planck-Institut f&#x000fc;r Meteorologie</institution>, <addr-line>Bundesstr. 53, 20146 Hamburg</addr-line>, <country>Germany</country></aff><aff id="af4"><label>4</label><institution>Deutscher Wetterdienst</institution>, <addr-line>Frankfurter Str. 135, 63067 Offenbach</addr-line>, <country>Germany</country></aff><author-notes><corresp id="cor1">e-mail: <email>neumann@dkrz.de</email></corresp><fn fn-type="other"><p>One contribution of 11 to a theme issue &#x02018;<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsta/377/2142">Multiscale modelling, simulation and computing: from the desktop to the exascale</ext-link>&#x02019;.</p></fn></author-notes><pub-date pub-type="ppub"><day>8</day><month>4</month><year>2019</year></pub-date><pub-date pub-type="epub"><day>18</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>18</day><month>2</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>377</volume><issue>2142</issue><issue-title>Theme issue &#x02018;Multiscale modelling, simulation and computing: from the desktop to the exascale&#x02019; compiled and edited by Alfons G. Hoekstra, Simon Portegies Zwart and Peter Coveney</issue-title><elocation-id>20180148</elocation-id><history><date date-type="accepted"><day>12</day><month>12</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2019 The Authors.</copyright-statement><copyright-year>2019</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>Published by the Royal Society under the terms of the Creative Commons Attribution License <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>, which permits unrestricted use, provided the original author and source are credited.</license-p></license><?release-delay 0|0?></permissions><self-uri content-type="pdf" xlink:href="rsta20180148.pdf"/><abstract><p>We discuss scientific features and computational performance of kilometre-scale global weather and climate simulations, considering the Icosahedral Non-hydrostatic (ICON) model and the Integrated Forecast System (IFS). Scalability measurements and a performance modelling approach are used to derive performance estimates for these models on upcoming exascale supercomputers. This is complemented by preliminary analyses of the model data that illustrate the importance of high-resolution models to gain improvements in the accuracy of convective processes, a better understanding of physics dynamics interactions and poorly resolved or parametrized processes, such as gravity waves, convection and boundary layer.</p><p>This article is part of the theme issue &#x02018;Multiscale modelling, simulation and computing: from the desktop to the exascale&#x02019;.</p></abstract><kwd-group><kwd>global high-resolution modelling</kwd><kwd>ICON</kwd><kwd>IFS</kwd><kwd>scalability</kwd><kwd>exascale computing</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>European Union's Horizon 2020 Research and Innovation Programme</institution></institution-wrap></funding-source><award-id>675191</award-id></award-group><award-group><funding-source><institution-wrap><institution>Royal Society for his University Research Fellowship</institution></institution-wrap></funding-source></award-group><award-group><funding-source><institution-wrap><institution>Max-Planck-Institute for Meteorology</institution></institution-wrap></funding-source><award-id>01LK1501B</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>April 8, 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><label>1.</label><title>Introduction</title><p>Weather predictions and climate projections are of vital importance for society and for the creation and preservation of prosperity. One important component of these predictions is numerical models that simulate the dynamics of several parts of the Earth System (including atmosphere, ocean, sea ice, land ice and vegetation), and their interactions. Owing to the number of relevant physical processes, their complexity and the high dimensionality of the Earth System, weather and climate models are supercomputing applications, consisting of millions of lines of code, and model resolution is limited by available computational power.</p><p><italic>Operational weather forecasts</italic> run several times per day under very tight schedules that include the collection and processing of observational data, data assimilation to create initial conditions for forecasts, the integration of the forecast model, data post-processing and dissemination of forecast products to users. This complex schedule imposes timing requirements on forecast runs to complete within about 1&#x02009;hour. This translates to execution rates of about 200&#x02013;300 forecast days per wall clock day, which is close to one simulated year per day (SYPD), using several hundreds of compute nodes for deterministic runs and about a thousand nodes for ensembles, resembling tens of thousands of compute cores. For weather forecast models, different model configurations are used for different predictions. Predictions into the medium-range (e.g. forecast days 3&#x02013;15) require global models to cover scale interactions and interactions between different physical processes all over the planet. Current forecasts run at about 10&#x02009;km spatial resolution for single deterministic predictions and at about 20&#x02009;km resolution for ensembles. For short forecasts of several days, global scale interactions are less important and forecasts with limited-area models are performed at about one order of magnitude higher spatial resolution. However, high-resolution limited-area models also rely on global predictions because they require boundary and initial conditions.</p><p><italic>Models for climate projections</italic> are run in a different set-up as long integrations designed to explore factors influencing energy exchanges. Traditionally, fluid-dynamical processes, which dominate the evolution of the weather on short time scales, are just one among many processes that influence the evolution of the system, mostly by shaping distributions of water vapour and clouds. Other important processes evolve on significantly longer time scales. For instance, ocean equilibration under specified conditions (i.e. concentrations of greenhouse gases, aerosols or insolation) takes thousands of years [<xref rid="RSTA20180148C1" ref-type="bibr">1</xref>]. Moreover, the climate response to changes in these boundary conditions involves processes that interact over many different time scales, so that the length of simulations useful for understanding essential questions on the climate system typically range from a few decades to a few millennia. Thus, a throughput of less than about 1 SYPD is insufficient for many applications. Workhorse climate models with a throughput of 10 SYPD are desirable, also in consideration of running large ensembles which is necessary to distinguished forced changes from natural variability [<xref rid="RSTA20180148C2" ref-type="bibr">2</xref>]. The computational throughput of climate models is usually limited by their atmospheric component, which thus means that the computational requirements for numerical weather prediction and the highest-resolution general purpose climate are not that disparate.</p><p>In the Earth System, <italic>scale interactions</italic> are very important and scales at very different magnitude (from molecular all the way to the planetary scale) interact with each other. Numerical resolution dictates which scales and physical processes can be represented explicitly within model simulations. Processes that are not resolved explicitly need to be parametrized by adding terms to the right-hand-side of the dynamic equations, expressing the behaviour of sub-grid-scale processes on the resolved scales.</p><p><italic>Advances in HPC</italic> have brought the global weather and climate prediction communities to the point where it is possible to replace various parametrizations of crucial physical processes by fluid-dynamical representations based on fundamental principles. A particular leap in this regard is the increase in global resolution and pushing the corresponding horizontal resolution to O(1&#x02009;km). <italic>Kilometre-scale global simulations</italic> are expected to explicitly represent the transient dynamics of the largest convective clouds, gravity waves, interactions of the flow with the major orographic features [<xref rid="RSTA20180148C3" ref-type="bibr">3</xref>], the evolution of fine-scale disturbances on the tropopause, important scales of surface-atmosphere interactions over both the ocean and land, as well as the scales on which weather extremes are most impactful. Simulations at this scale, with the required throughput, are becoming imaginable, given radically new algorithmic approaches and dedicated software optimization of in-production-use weather and climate models and the rise of actual exascale supercomputers. The need for these simulations is similar for weather predictions and climate projections [<xref rid="RSTA20180148C4" ref-type="bibr">4</xref>] as are associated computing and data handling challenges. Moreover, &#x02018;regional manifestations of climate change are mainly through changes in the statistics of regional weather variations&#x02019;, yielding strong cross-links between weather and climate simulation and resulting&#x02014;due to the required high model resolution&#x02014;in an increased need for extreme HPC capacity [<xref rid="RSTA20180148C5" ref-type="bibr">5</xref>]. Yet, only few scientific studies of global kilometre-scale simulations and their computational performance are available. For example, a 7&#x02009;km resolution run using the NICAM model successfully simulated and reproduced life cycles of tropical cyclones, in terms of timing, motion and mesoscale structures, pointing at the prediction capabilities of global high-resolution models [<xref rid="RSTA20180148C6" ref-type="bibr">6</xref>]. Concerning performance analysis, a generic performance analysis for global kilometre-scale atmospheric general circulation models was presented in [<xref rid="RSTA20180148C7" ref-type="bibr">7</xref>], followed by a refined study on the matter [<xref rid="RSTA20180148C8" ref-type="bibr">8</xref>], with the latter concluding that a hardware/software co-designed 28 PetaFLOP supercomputer with more than 20 million processing elements could pave the way for kilometre-scale atmospheric simulations. Subsequently, several model-specific investigations complemented the generic analysis. An idealized near-global kilometre-scale climate simulation based on the COSMO model performed at 0.043 SYPD [<xref rid="RSTA20180148C9" ref-type="bibr">9</xref>] using 4888 GPU compute nodes. Further works have exploited the models NICAM (0.9&#x02009;km resolution [<xref rid="RSTA20180148C10" ref-type="bibr">10</xref>]), MPAS (3&#x02009;km resolution, 0.16 SYPD throughput on full NERSC Edison system [<xref rid="RSTA20180148C11" ref-type="bibr">11</xref>]) and SAM (4&#x02009;km resolution [<xref rid="RSTA20180148C12" ref-type="bibr">12</xref>]).</p><p>Yet, exascale supercomputers bring up several challenges. These include fundamental changes in node-level design, increased need for resilience methods to handle system software and hardware failures at scale, and efficient programming strategies to cope with, among others, aforementioned aspects. Concerning node-level design, due to energy limitations and further design criteria, nodes are expected to be equipped with hundreds of compute cores or accelerator architectures such as GPUs. Although it is not clear yet, how this will finally affect the design and implementation of future weather and climate models, it inevitably brings up the need to fundamentally understand the performance of weather and climate models on current architectures and to predict their performance on new architectures, as well as on ever-increasing compute resources.</p><p>The Centre of Excellence in Simulation of Weather and Climate in Europe (ESiWACE) sets up and evaluates global kilometre-scale weather and climate demonstrator simulations. These demonstrators, built on top of weather and climate models that are heavily employed in forecast production schedules and science, explore the models' computational potential and limits on current petascale supercomputers and enable insight into expected performance on upcoming exascale systems. First steps towards model intercomparison with regard to computational and scientific performance are currently being taken in the scope of the international project DYnamics of the Atmospheric general circulation Modeled On Non-hydrostatic Domains (DYAMOND, see <uri xlink:href="https://www.esiwace.eu/services/dyamond">https://www.esiwace.eu/services/dyamond</uri> for details).</p><p><italic>This paper</italic> provides insights into the computational performance of two models at global near-kilometre scale: the Integrated Forecast System (IFS), and the ICOsahedral Non-hydrostatic (ICON) model; we focus on atmosphere-only simulations in the following. Both ICON and the IFS are at the heart of production schedules, with the IFS being used at the European Centre for Medium-Range Weather Forecasts and ICON at the Deutscher Wetterdienst. ICON and the IFS (the latter in the context of EC-Earth) are also used for climate projections, and both models are subject to ESiWACE investigations; ICON further participates in DYAMOND runs. We provide performance numbers (in terms of SYPD), discuss comparisons with performance models and give extrapolations towards expected performance at exascale. The discussion of model performance will be based on the target to reach at least 1 SYPD throughput in cloud-resolving simulations. This target will hardly be sufficient to fulfil the needs of <italic>all</italic> applications of weather and climate simulations. Long integrations over several millennia will certainly not be possible at this throughput rate. It will also not be sufficient for global ensemble simulations if a large fraction of the machine will be required to perform a single simulation. One SYPD will, however, be sufficient for <italic>some</italic> useful applications in operational weather or climate predictions such as deterministic global weather forecasts or climate simulations up to a length of a couple of decades. One SYPD would also allow model tuning as well as a proper quality evaluation in research experiments. The goal of 1 SYPD should therefore not be considered as the final goal for scalability but rather as a benchmark for useful model configurations.</p><p>After a review of scales relevant to weather prediction and climate projections and a detailed discussion on the great relevance of kilometre-scale global simulations (&#x000a7;2), challenges from computational and modelling perspectives are presented (&#x000a7;3). Computational performance results for the IFS and ICON high-resolution demonstrator simulations as well as first DYAMOND runs are presented and analysed in &#x000a7;4. We discuss performance model approaches and arising performance extrapolations for numerical weather and climate simulations at exascale in the same section. In particular, we construct simple, yet effective performance models for ICON, which on the one hand allow to predict the performance of ICON at larger node counts and, on the other hand, will be advantageous to explore ICON performance and scalability on new, exascale-relevant hardware architectures in the future. Given the importance of achieving true kilometre-scale simulation capability for a qualitative leap in weather and climate modelling, these estimates yield insights into what can be expected from these simulations at exascale on the one side and for strategic planning in Earth system model development, scientific code development and HPC system configuration on the other side. This is complemented by demonstrating the expected benefits of high-resolution simulations on science cases by a preliminary analysis of the impact of convection-resolving versus parametrized configurations.</p></sec><sec id="s2"><label>2.</label><title>Why the kilometre scale matters</title><p>The atmosphere and ocean encompass fluid-dynamical motions on scales that span more than 10 orders of magnitude, from millimetre scales where motion is randomized into thermal energy, to planetary scales where flows are influenced by the shape of the Earth itself. But not all scales matter to the same degree, as specific processes arise at specific scales; see <xref ref-type="fig" rid="RSTA20180148F1">figure 1</xref> for an overview of 100&#x02009;m&#x02013;250&#x02009;km scales and related processes. Modern numerical weather prediction and climate modelling, for instance, were both founded on the realization that the transient dynamics of baroclinic storms in the mid-latitude could be computed, rather than represented statistically, given a relatively coarse computational mesh [<xref rid="RSTA20180148C13" ref-type="bibr">13</xref>,<xref rid="RSTA20180148C14" ref-type="bibr">14</xref>]. The ability of computing machines capable of resolving processes on these scales enabled an explicit representation of the storms that are important to the weather of the mid-latitudes, as well as equator to pole energy transport which is crucial for the climate. The idea of computing weather and climate on the kilometre scales offers similar breakthroughs, as outlined below.
<fig id="RSTA20180148F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Scales in weather and climate prediction versus computational resources required to resolve them. (Online version in colour.)</p></caption><graphic xlink:href="rsta20180148-g1"/></fig></p><p>In the tropics, the dominant mode of energy transport is in the vertical, through deep moist convection&#x02014;&#x02018;hot-towers&#x02019; [<xref rid="RSTA20180148C15" ref-type="bibr">15</xref>]. These circulations, whose scale is determined by the depth of the tropical troposphere (15&#x02013;20&#x02009;km) transport energy from the surface to the atmosphere, where it is either then lost through radiation or exported to the extra-tropics. How this transport transpires shapes weather and major features of the climate system. By virtue of being much smaller than the depth of the troposphere, kilometre-scale simulations can represent their transient dynamics, and thereby break the deadlock that global models have since the very first days of their development. Likewise in the ocean, at the kilometre scale, ocean eddies become explicitly resolved. The effect of eddies on the climate is less researched, but may be of similar importance as is the representation of moist convection for the atmosphere, because these eddies strongly influence the stratification of the southern ocean, which then determines how much carbon and energy it takes out of the atmosphere.</p><p>Resolving major topographic or bathymetric features also means that how the mean flow interacts with the surface, and the effect of this interaction on the properties of the mean flow in the atmosphere, or on water mass formation in the ocean, becomes resolved and constrained by the laws of fluid dynamics. Being able to do away with not only convective and eddy parametrizations, but also artificial representations of ocean surface properties, or parametrizations of orographic influenced mixing and drag, thus brings simulations much closer to first principles.</p><p>No longer needing to parametrize processes important for tropical weather and global climate would certainly represent a breakthrough. Nonetheless, some might be tempted to argue that remaining parametrizations, like those of turbulent mixing processes, or cloud microphysical processes will remain, and limit the fidelity also of kilometre-scale models. What this argument fails to appreciate is that even for these parametrizations, the kilometre scale is a game changer, as it addresses the under-determination problem that limits existing parametrizations of these processes. This is the problem whereby even if a process is in principle parametrizable if the quantities that the parametrization depends on are not available, but rather the output of other parametrizations, then it compounds the difficulty of what is already a very difficult problem. As an example, trying to parametrize cloud formation processes without knowledge of the magnitude or size of the updraft in which the cloud forms is manifestly more difficult than in the case where this information is at hand, which it would be (albeit, for smaller scales, in distorted form) in kilometre-scale models. Yet, the parametrization of remaining (i.e. still unresolved) processes (such as cloud microphysics) will rise in importance, respectively, in kilometre-scale simulations.</p><p>Finally, kilometre-scale models allow an explicit representation of those processes whose impact communities are so interested in. Examples include damages from wind gusts, or hail formation or orographically influenced deluges. Such scales also begin to capture the interaction of weather and climate with urban landscapes or water ways with its sea-walls or levies.</p><p>Fundamentally, there is nothing inherently magic about models running on grid meshes of exactly 1&#x02009;km. Many of the processes mentioned above begin to be represented in so far as the model mesh is considerably smaller than the process in question. This means that, e.g. a 3&#x02009;km model substantially differs from a 10&#x02009;km model, even at a qualitative level. Similarly, 1&#x02009;km simulations show significant differences from 3&#x02009;km runs. Yet, 3&#x02009;km simulations resolve many of the important processes already: ironically, this also gives a particular meaning to the 1&#x02009;km model, as coarser resolution versions such as the 3&#x02009;km case are expected to yield new insights and will be&#x02014;once the 1&#x02009;km case can execute at acceptable throughput rates&#x02014;ready for data assimilation and ensemble predictions.</p><p>Reaching the kilometre scale also brings the 100&#x02009;m scale into view, at which it becomes possible to dispense of all parametrizations of convection, including those used to represent the large-eddies in the convective boundary layer or the shallow clouds that are a bane for those interested in Earth's climate sensitivity.</p></sec><sec id="s3"><label>3.</label><title>High-resolution weather and climate modelling: scalability, modelling, resolution</title><sec id="s3a"><label>(a)</label><title>Scalability challenges</title><p>Since the early work of Smagorinsky, one could argue that global climate models have made incremental progress, as they have laboured to increase their resolution from 500&#x02009;km to 5&#x02009;km. This hundred-fold increase in scale necessitated a roughly million-fold increase in computational power (see e.g. [<xref rid="RSTA20180148C16" ref-type="bibr">16</xref>] for details), a huge investment with incremental benefits as with increasing resolution not a single parametrization could be eliminated. These improvements have placed us at a threshold whereby a further jump in scales from 10 to 1&#x02009;km makes it possible to dispense with parametrizations (see &#x000a7;2).</p><p>Part of the challenge of increasing resolution is that for explicit numerical methods, it necessitates computing smaller time steps, resolving smaller time scales and satisfying numerical stability criteria. Besides, scaling out a model at fixed resolution (often referred to as strong scaling, that is using more computational cores at a fixed number of grid points) is limited at some point: you will not get your result faster by adding further compute cores beyond that point, simply because there is not enough work per compute core left, communication between cores dominates and load imbalances between cores become more expressed.</p><p>Hence, given a (bigger, yet) fixed number of grid cells at prescribed high resolution and significantly more time steps to be calculated on each grid point, the wall clock time needed per model run increases as soon as the strong scaling limit is reached, and the result of a numerical experiment takes longer. In conclusion, if we specify the number of simulated years per wall clock day which we need to achieve to do useful science with sufficient throughput, this limits the number of grid cells that we can afford and thus the number of compute cores we can use efficiently. Of course, we can try to remedy this through performance optimization of the model per grid cell. But naturally, this approach is limited and does not mitigate the existence of a fundamental limit in resolution. This issue has recently been further elaborated in [<xref rid="RSTA20180148C17" ref-type="bibr">17</xref>], motivating the application of multi-scale computing and corresponding (hybrid) simulation approaches. Owing to the strong impact of various modelling assumptions and corresponding physical processes (see &#x000a7;2), this seems, however, out of scope for many climatological questions. Another option to speed up high-resolution simulations on extreme scale platforms is given by parallel-in-time approaches. Despite analysis and first studies on instability problems that some parallel-in-time algorithms such as Parareal encounter for hyperbolic problems [<xref rid="RSTA20180148C18" ref-type="bibr">18</xref>], an immediate use of these methods is not expected to be realizable soon for entire Earth system models.</p></sec><sec id="s3b"><label>(b)</label><title>Modelling challenges</title><p>Improving and optimizing model configurations to run as efficiently as possible on emerging supercomputers is a challenge&#x02014;in particular, given the parallel use of an ever-increasing number of processing units within a single million lines-of-code simulation. The use of scalable algorithms that run efficiently on hundreds of thousands of processing units is imperative throughout the entire model configuration and global communication between processors needs to be avoided wherever possible. This is particularly difficult to realize for the development of efficient time-stepping schemes. Explicit time-stepping schemes that act locally and avoid global communication require the use of very short time steps. On the other hand, implicit or semi-implicit schemes require global communication for linear solvers but allow much longer time steps (often a factor 10 in comparison to explicit methods), see [<xref rid="RSTA20180148C19" ref-type="bibr">19</xref>] for a detailed discussion.</p><p>Numerical methods that are used in weather and climate models also need to be stable and are required to work efficiently on the sphere while topography should be resolved at a resolution as high as possible on a given grid. There are several methods that compete for spatial discretization (finite differences, finite volume, finite elements, spectral element models) and different shapes of grids that are used (icosahedral, Gaussian, cubed sphere, yin yang, fully unstructured), see for example [<xref rid="RSTA20180148C20" ref-type="bibr">20</xref>].</p><p>Atmosphere models are not isotropic in three dimensions. The vertical dimension is special due to stratification, lower velocities and the main direction of physical processes such as radiation and cloud dynamics. As horizontal resolution is increased, a use of higher resolution in the vertical is also required and the limit of very high resolution will require a better representation of three-dimensional effects. While physical parametrization schemes are calculated within independent vertical columns of grid cells today, more communication between columns may be required in the future; for example, if the three-dimensional shape and reflection of clouds or the angle of the sun compared to the heating on the ground needs to be taken into account in three-dimensional radiation. For simulations at very high resolution, the hydrostatic approximation, which is still used in many global weather and climate models, will break down. However, there is still discussion about the exact level of resolution at which non-hydrostatic equations are mandatory.</p><p>It is also a challenge to understand and improve the coupling between different model components (such as atmosphere, ocean, sea ice and land surface) as well as the coupling between the dynamical core and physical parametrization schemes. There is hope that an increase of resolution to kilometre-scale will improve the coupling between topography and convection, and medium and large-scale dynamics. However, the use of grids that are only able to represent deep convection explicitly may cause an incorrect energy distribution in the vertical during the transition towards cloud-resolving models. Additionally, scalability needs to be achieved for all components, in particular, also for the wave model and the ocean component&#x02014;which can generate a significant ratio of the cost for weather and climate simulations&#x02014;as well as the advection of tracers if a complex representation of atmospheric chemistry is used.</p></sec><sec id="s3c"><label>(c)</label><title>Remark on nominal and effective resolution</title><p>While the grid spacing is typically used to define the &#x02018;model resolution&#x02019; (as also done in this work), the scale of the smallest processes that are fully resolved within a simulation&#x02014;the effective resolution&#x02014;is significantly larger. The effective resolution can be derived, for example, from comparing kinetic energy spectra between models and observations (e.g. [<xref rid="RSTA20180148C21" ref-type="bibr">21</xref>,<xref rid="RSTA20180148C22" ref-type="bibr">22</xref>] and references therein). The point where the modelled spectrum starts deviating from the observations indicates a lack of representation of processes at smaller scales. This is the result of a range of mechanisms such as the choice of spatial discretization and time steps, a smoothing of the orography to improve numerical stability, the effect of physical parametrizations [<xref rid="RSTA20180148C23" ref-type="bibr">23</xref>] and other diffusion mechanisms. For spectral models like the IFS also the difference between the spectral resolution for the governing equations and grid-point resolution for advection and physics parametrizations needs to be considered [<xref rid="RSTA20180148C24" ref-type="bibr">24</xref>]. The nominal-effective resolution difference of the IFS is about a factor of 6 and for ICON about a factor of 7 [<xref rid="RSTA20180148C25" ref-type="bibr">25</xref>]. Similar factors have been derived from an assessment of mesoscale models [<xref rid="RSTA20180148C26" ref-type="bibr">26</xref>].</p><p>Achieving an effective resolution of 1&#x02009;km may therefore require a nominal resolution of 150&#x02009;m or so. A factor of 6&#x02013;7 in resolution roughly translates to a factor of 300 in computing cost counting the change in the number of grid points and time-step size. Only judging computing cost figures based on nominal resolution can therefore be misleading. To avoid merging these approximate factors with exact runtime measurements for the IFS and ICON, the following assessment is based on nominal resolution set-ups.</p></sec></sec><sec id="s4"><label>4.</label><title>State of ICON and IFS global high-resolution models: model features and computational performance</title><sec id="s4a"><label>(a)</label><title>ICON</title><p>ICON uses a finite difference approximation of the non-hydrostatic equations of atmospheric motion [<xref rid="RSTA20180148C25" ref-type="bibr">25</xref>,<xref rid="RSTA20180148C27" ref-type="bibr">27</xref>]. For global simulations, Earth is discretized via refinement of an initial globe-covering icosahedron. This refinement results in <italic>ca</italic> 21 million horizontal cells (triangles) to reach a global resolution of <italic>ca</italic> 5&#x02009;km and a time step of 45&#x02009;s. The number of vertical levels has been varied, with performance numbers reported in this paper using 62, 137 or 90 levels. The latter corresponds to the operational weather forecast configuration at Deutscher Wetterdienst and to the DYAMOND configuration which is being used for intercomparison with other European and international models in the near future. The sub-grid physical processes for clouds, boundary-layer mixing, radiation and the surface are described using the parametrizations of the limited-area kilometre-scale numerical weather prediction with the COSMO model [<xref rid="RSTA20180148C28" ref-type="bibr">28</xref>]. The grid resolution allows to resolve convection and gravity waves, which usually are sub-grid in global weather and climate simulations. The configuration is comparable to the one described in [<xref rid="RSTA20180148C29" ref-type="bibr">29</xref>] for regional simulations with the same model. In the DYAMOND set-up, data output has been enabled, providing insight into the challenges and performance limits of the high-resolution data avalanche. Three-dimensional state variables (velocities, temperature, pressure, specific humidity, cloud water, ice) are collected every hour, selected horizontal quantities (2D) every 15&#x02009;min; GRIB files are written per simulated day, resulting in <italic>ca</italic> 164&#x02009;GB output per day in the 5&#x02009;km case. A detailed description of the I/O configuration, the placement of the vertical levels used in the DYAMOND run, etc. is provided online (<uri xlink:href="https://www.esiwace.eu/services/dyamond-specific-pages-and-material/icon-vertical-grid">https://www.esiwace.eu/services/dyamond-specific-pages-and-material/icon-vertical-grid</uri>). The other simulations were conducted excluding I/O. Simulations were performed on the supercomputer Mistral, partition compute2, hosted at DKRZ. Each dual-socket node of the partition features two Broadwell CPUs with 18 compute cores and a minimum of 64&#x02009;GB main memory. Hyperthreading was enabled and 6 OpenMP threads per MPI process were employed.</p></sec><sec id="s4b"><label>(b)</label><title>IFS</title><p>IFS is a global, spectral model for which some of the prognostic fields are represented in a set of global basis functions (so-called spherical harmonics). The standard configuration of IFS is solving the hydrostatic equations. However, a non-hydrostatic version of IFS is also available. Typical numbers for vertical levels are 60, 91 and 137. For operational weather forecasts at ECMWF, IFS is using a TCo1279 grid (approx. 9&#x02009;km horizontal resolution) with 137 vertical levels for a 10-day deterministic forecast and a TCo639 grid (approx. 18&#x02009;km horizontal resolution) with 91 vertical levels for ensemble forecasts with 50 ensemble members plus one control forecast for 15 days. Atmosphere-only simulations use time steps of 450/240/180/120&#x02009;s at 9/5/2.5/1.25&#x02009;km resolution.</p></sec><sec id="s4c"><label>(c)</label><title>Model feature: resolving convection</title><p>Moist deep convection and gravity waves change from being sub-grid at about 10&#x02009;km grid spacing to being resolved (at least in a later development phase) at about 1&#x02009;km grid spacing. The intermediate range from 1 to 10&#x02009;km in resolution is often referred to as the &#x02018;convective gray-zone&#x02019;, where bulk formulae for convective parametrization schemes break down because an insufficient number of cells are present within a single grid cell, while resolution does not suffice to properly represent convection explicitly. This is demonstrated in the energy spectra of horizontal kinetic energy at 500&#x02009;hPa for simulations with and without a representation of sub-grid convection for two models in <xref ref-type="fig" rid="RSTA20180148F2">figure 2</xref>. While the simulations with a convection parametrization have too little energy on scales between 20 and 200&#x02009;km, the simulations without a parametrization have too much energy on the same scales relative to a 1&#x02009;km simulation. This is due to the still under-resolved processes at 5&#x02009;km grid spacing, which leads to an accumulation of energy on scales predetermined by the chosen grid size. While the effective resolution of the parametrized 5&#x02009;km models is lower by a factor 4&#x02013;8 (deviation from &#x02212;5/3 spectra at lower wave numbers), the incorrect spectral energy redistribution can negatively feedback on the synoptic scales and subsequently impact on the predictability [<xref rid="RSTA20180148C23" ref-type="bibr">23</xref>]. The energy spectra indicate that an even higher resolution than 5&#x02009;km is necessary to properly resolve deep convection.
<fig id="RSTA20180148F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>Energy spectra in 1&#x02009;km and 5&#x02009;km scale global IFS and ICON simulations. For the 5&#x02009;km cases, simulations with and without convection parametrization are reported.
</p></caption><graphic xlink:href="rsta20180148-g2"/></fig></p><p>Other aspects already improve when the sub-grid representation of convection is disabled. Interactions of the dynamic process with its environment are explicitly modelled which leads to the emergence of the full dynamic structure of convection. One example can be observed in <xref ref-type="fig" rid="RSTA20180148F3">figure 3</xref> which shows the space&#x02013;time variability of tropical convection from 15S to 25N (centring on the inter-tropical convergence zone). The precipitation rate is derived from 15&#x02009;min increments of accumulated precipitation of the ICON-DYAMOND simulations. The data have first been coarsened to 0.1&#x000b0; and then meridionally averaged. Mesoscale convective systems, which parametrized models struggle to simulate, are visible in <xref ref-type="fig" rid="RSTA20180148F3">figure 3</xref> as the rain bands in the time-longitude representation of precipitation. Long standing problems, like the diurnal cycle of convection over land, or parts of the large-scale structure of the general circulation improve significantly when convection is resolved.
<fig id="RSTA20180148F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Tropical precipitation resulting from explicit convection in the ICON-DYAMOND simulations. (<italic>a</italic>) Temporal mean precipitation rate. (<italic>b</italic>) Hovmoeller diagram of meridionally averaged precipitation (longitude (<italic>x</italic>), time in days (<italic>y</italic>)). The emerging dynamic character of propagating connective clusters manifests in slated lines of precipitation.
</p></caption><graphic xlink:href="rsta20180148-g3"/></fig></p></sec><sec id="s4d"><label>(d)</label><title>Performance measurement and extrapolation</title><p>Strong scalability of ICON and IFS are provided in <xref ref-type="fig" rid="RSTA20180148F4">figure 4</xref> for global configurations ranging from 10&#x02009;km to 2.5&#x02009;km resolution. All performance numbers that are reported within this section relate to the throughput of the entire atmosphere-only global simulation, including dynamical core, radiation and physics components, but excluding I/O. The performance difference between the models can be explained by mainly three (partly multiplicative) factors: IFS makes use of the hydrostatic model formulation instead of the non-hydrostatic model option, which in the IFS approximately halves the performance at the moment (approx. 2&#x000d7;), IFS runs at single-precision (approx. 1.6&#x000d7;) [<xref rid="RSTA20180148C30" ref-type="bibr">30</xref>] and most importantly employs a significantly longer time step due to its semi-implicit time integration (IFS/ICON: 240 s/45 s&#x02009;=&#x02009;5&#x000d7; in the 5&#x02009;km case). All these accumulate to a factor 16 and the figure implies about a factor 10, which is likely due to the fact that in ICON, there are different time steps used in the coupling to the physics compared to the dynamics part (the same in IFS).
<fig id="RSTA20180148F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Strong scalability of IFS and ICON models in global high-resolution simulations.
</p></caption><graphic xlink:href="rsta20180148-g4"/></fig></p><p><xref ref-type="fig" rid="RSTA20180148F4">Figure 4</xref> suggests that a throughput of 1 SYPD is achievable on today's supercomputers for a 5&#x02009;km resolution case (IFS, single-precision, hydrostatic, 960 nodes). Referring to the double-precision, non-hydrostatic, full I/O performance of the DYAMOND 5&#x02009;km run using ICON and restricting considerations to atmosphere-only simulations, a throughput of <italic>ca</italic> 0.17 SYPD is reached on 900 compute nodes. A straight-forward extrapolation of the performance of the DYAMOND 5&#x02009;km runs to the 1&#x02009;km case corresponds to multiplicative factors in compute time of 25 in terms of horizontal resolution, 2 in vertical resolution to target for 180 vertical levels (the exact number of levels will in the end also depend on the application and adjustments of the model top) and 5 in terms of required time steps, resulting in a shortfall of 1500 to reach the target of 1SYPD (assuming sufficient memory)&#x02014;of which the horizontal and vertical resolution factors 25&#x02009;&#x000d7;&#x02009;2 can potentially be directly compensated for through more computational resources in the weak scaling sense. Similar estimates for atmosphere-only simulations have recently been derived for the COSMO model and the IFS [<xref rid="RSTA20180148C16" ref-type="bibr">16</xref>]. At this stage, the exact complexity of a model simulation at 1&#x02009;km horizontal resolution is still not settled in terms of the complexity of model components such as the land surface, the sea ice or atmospheric chemistry or in terms of the number of model levels and the exact time-step length. The choices in this paper may therefore appear rather arbitrary. However, we have based our choices, such as 180 vertical levels, on experience from state-of-the-art models for both global and limited-area simulations [<xref rid="RSTA20180148C31" ref-type="bibr">31</xref>] and are confident that the suggested complexity would result in simulations at 1&#x02009;km resolution with high fidelity.</p><p>The compensation through more compute resources results in a shortfall of 30 using 25&#x02009;&#x000d7;&#x02009;2&#x02009;&#x000d7;&#x02009;900&#x02009;=&#x02009;45&#x02009;000 compute nodes of the models, as long as I/O can be distributed correspondingly, which is far from trivial, considering the widening gap between memory/storage performance and compute power.</p></sec><sec id="s4e"><label>(e)</label><title>Performance modelling</title><p>Given the need for higher effective and, thus, nominal resolution, the scalability studies for global high-resolution cases (cf. <xref ref-type="fig" rid="RSTA20180148F4">figure 4</xref>) and the need to estimate performance on varying hardware architectures in view of the upcoming, yet unknown, exascale systems, we developed a hardware-aware performance model [<xref rid="RSTA20180148C32" ref-type="bibr">32</xref>,<xref rid="RSTA20180148C33" ref-type="bibr">33</xref>] for ICON and evaluated it on the supercomputer Mistral. The model takes into account data transfer in terms of cell, vertex, edge exchange between neighbouring domains, network latency and bandwidth. Owing to the explicit time-stepping scheme and the used spatial discretization, it is sufficient to restrict considerations to ICON's nearest neighbour communication. Let
<disp-formula id="RSTA20180148UM1"><mml:math id="DM1"><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comput</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">commun</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
represent a decomposition of the total simulation time <italic>t</italic> into communication and computation phase, using <italic>N</italic> processes. Within a time step, every ICON process communicates with all of its neighbours <italic>P</italic> times, sending and receiving messages of size <italic>s<sub>p</sub></italic> in communication step <italic>p</italic>. Assuming the simulation to be limited by the slowest process, a single send/receive command in communication step <italic>p</italic> can be approximated as
<disp-formula id="RSTA20180148UM2"><mml:math id="DM2"><mml:mfrac><mml:mrow><mml:mtext>ma</mml:mtext><mml:mrow><mml:msub><mml:mtext>x</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
with incremental bandwidth <italic>b</italic>(<italic>s<sub>p</sub></italic>), Mistral's latency <italic>t<sub>l</sub></italic>&#x02009;=&#x02009;2.7<italic>e</italic>&#x02009;&#x02212;&#x02009;6<italic>s</italic>, and the maximum message size computed over all processes <italic>n</italic>&#x02009;=&#x02009;1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>N</italic>. Note that the bandwidth typically depends on the size of messages (the bigger the messages, the higher the bandwidth) and that the incremental bandwidth needs to be computed from the actual, measured bandwidth values by taking into consideration <italic>t<sub>l</sub></italic> (<xref rid="RSTA20180148TB1" ref-type="table">table 1</xref>). To determine the actual bandwidth per message size, we employ a quasi-linear regression on measured bandwidth data, assuming a dependence of the form <italic>a</italic><sub>0</sub>&#x02009;&#x000b7;&#x02009;log(<italic>s</italic>)&#x02009;+&#x02009;<italic>a</italic><sub>1</sub>.
<table-wrap id="RSTA20180148TB1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Measured transfer times and bandwidths on supercomputer Mistral, and derived incremental bandwidth <italic>b</italic>(<italic>s</italic>)<italic>.</italic></p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" rowspan="1" colspan="1">message size <italic>s</italic> (MB)</th><th align="left" rowspan="1" colspan="1">transfer time (s)</th><th align="left" rowspan="1" colspan="1">bandwidth (MB&#x02009;s<sup>&#x02212;1</sup>)</th><th align="left" rowspan="1" colspan="1"><italic>b</italic>(<italic>s</italic>)&#x02009;=&#x02009;<italic>s</italic>/((1/<italic>B</italic>(<italic>s</italic>))<italic>s</italic>&#x02009;&#x02212;&#x02009;<italic>t</italic><sub>l</sub>) (MB&#x02009;s<sup>&#x02212;1</sup>)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">0.032768</td><td rowspan="1" colspan="1">1.42&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;5</sup></td><td rowspan="1" colspan="1">2308</td><td rowspan="1" colspan="1">2850</td></tr><tr><td rowspan="1" colspan="1">1.048576</td><td rowspan="1" colspan="1">2.10&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;4</sup></td><td rowspan="1" colspan="1">4984</td><td rowspan="1" colspan="1">5049</td></tr></tbody></table></table-wrap></p><p>A simple model to predict the total communication time arises as
<disp-formula id="RSTA20180148UM3"><mml:math id="DM3"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comm</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover><mml:mo>&#x02061;</mml:mo><mml:mtext>mx</mml:mtext><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>ma</mml:mtext><mml:mrow><mml:msub><mml:mtext>x</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
with the number of executed time steps <italic>m</italic> and mx<italic>nb<sub>p</sub></italic>(<italic>N</italic>) denoting the maximum number of neighbours that at least one of the <italic>N</italic> processes features. The computation time might be expected to scale perfectly, yielding
<disp-formula id="RSTA20180148UM4"><mml:math id="DM4"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comput</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comput</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>However, load imbalances per process may occur due to irregular domains and corresponding decompositions. In particular, the computational load varies significantly, for example, between cloudy and cloud-free areas. In this case, it makes sense to model
<disp-formula id="RSTA20180148UM5"><mml:math id="DM5"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comput</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">comput</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">imbalance</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">imbalance</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
with temporal evolution <italic>t</italic><sub>imbalance</sub>(<italic>N</italic>) for the imbalanced compute part. The latter is, however, very complex to deduce analytically, due to the aforementioned state-dependency argument on cloudy areas and the fact that simulation models comprise up to millions of lines-of-code.</p><p>Given a new piece of hardware and its hardware specifications, <italic>b</italic>(<italic>s<sub>p</sub></italic>) and <italic>t<sub>l</sub></italic> are fixed. Measuring performance of ICON on one node of the new hardware fixes <italic>t</italic><sub>comput</sub>(1) and is already sufficient to evaluate scalability via the first performance model. Measuring ICON in few configurations allows to approximate <italic>t</italic><sub>imbalance</sub>(<italic>N</italic>), as detailed in the following, and closes the second performance model. Thus, the models described above are simple, yet effective means to investigate performance portability&#x02014;an urgent need for complex weather and climate models in the dawning of the exascale era. Since the ICON-DYAMOND 5&#x02009;km configuration needs to be executed on at least 100 nodes due to memory requirements, we use the compute time on 100 nodes as a baseline instead of <italic>t</italic><sub>comput</sub>(1) as described above. The ICON-DYAMOND configuration features 39 communication steps per time step, exchanging halo layers of cells, vertices and edges between the processes. It is further differentiated between halo1 and halo2 cell transfers, corresponding to the transfer of one or two halo cell layers. We investigated the performance of ICON-DYAMOND using 4 OpenMP threads per process. To determine <italic>t</italic><sub>imbalance</sub>(<italic>N</italic>), MPI barriers and time measurements on up to 900 nodes were used. For bigger node counts, an extrapolation rule was employed.</p><p>Actual execution times (measured) are compared with the two performance model predictions (model and model&#x02009;+&#x02009;est. load imbalance) in <xref ref-type="fig" rid="RSTA20180148F5">figure 5</xref>. The simplistic &#x02018;model&#x02019; shows agreement with errors less than 13% on up to 900 nodes and predicts better scalability than featured by the actual ICON model. The &#x02018;model&#x02009;+&#x02009;est. load imbalance&#x02019; shows slightly smaller errors (up to 10%) and predicts slightly worse scalability for ICON. Still, process-local load imbalance can be seen to be an essential component to describe a more realistic scalability behaviour on large node counts, resulting in predicted run time differences of up to 2.4&#x000d7; in the considered extrapolation range between the two performance models.
<fig id="RSTA20180148F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Measured (measured) and modelled performance (model, model&#x02009;+&#x02009;est. load imbalance) for the 5<bold>&#x02009;</bold>km ICON-DYAMOND configuration. Ideal scaling assumes perfect scalability of the ICON-DYAMOND 5&#x02009;km simulation, taking the 100 node configuration as baseline. (Online version in colour.)
</p></caption><graphic xlink:href="rsta20180148-g5"/></fig></p><p>Considering the trends of the performance models, in particular, the &#x02018;model&#x02009;+&#x02009;est. load imbalance&#x02019;, and the measurements in <xref ref-type="fig" rid="RSTA20180148F5">figure 5</xref>, scalability tends to completely stagnate at O(4000) nodes at a performance of <italic>ca</italic> 0.3 SYPD. Note that this estimate corresponds to the point in the scalability curve at which a minimum time-to-solution and no more speedup is reached; typical model employments would run at lower node counts to achieve a higher parallel efficiency of, e.g. &#x02265;&#x02009;50%. The point in <xref ref-type="fig" rid="RSTA20180148F5">figure 5</xref> thus yields an upper bound with regard to parallelism in the model: in the present case, the arising configuration corresponds to <italic>ca</italic> 292 vertical columns per MPI process, or 146 columns per compute core. This is similar to previous local-area ICON simulations (<italic>ca</italic> 91 columns per core at a higher vertical resolution of 160 levels, using 458&#x02009;752 cores see [<xref rid="RSTA20180148C31" ref-type="bibr">31</xref>]). Taking up the 5-to-1&#x02009;km extrapolation approach, this indicates that a 1&#x02009;km ICON simulation is expected to scale up to 200&#x02009;000 compute nodes&#x02014;which would correspond to a pre-exascale system running at <italic>ca</italic> 0.22 ExaFLOP/s (extrapolated from Mistral performance, see for example, the TOP500 list entries of partitions compute1 (November 2016) and compute1&#x02009;+&#x02009;compute2 (June 2018), <uri xlink:href="www.top500.org">www.top500.org</uri>)&#x02014;and run at 0.06 SYPD (due to decreasing time-step size; assuming 180 vertical levels as sketched before).</p></sec></sec><sec id="s5"><label>5.</label><title>Conclusion</title><p>Concluding, we have outlined the case for running weather and climate models on a 1&#x02009;km global mesh and performed performance studies for such configurations. Our studies suggest that further performance improvements are essential to arrive at a throughput of 1 SYPD for 1&#x02009;km atmosphere-only simulations at exascale. Shortfall factors have been lately reported for different models, with ICON numbers (1500&#x000d7;) reported in this work; for ICON, we could, based on measurements and performance models, estimate that a model performance improvement of 1SYPD/0.06SYPD&#x02009;&#x02248;&#x02009;17 is necessary to arrive at the required throughput rate of 1SYPD on next-generation supercomputers, taking into account the scalability limits of the model, time step decrease with increasing resolution, etc. Achieving this in the future is further complicated through even more complex supercomputer architectures. This challenge has to be faced to understand fundamental principles in general circulation models (see &#x000a7;2) and, thus, to address current and future research questions, which will help to improve current forecast methodology (cf. our discussion on high-resolution model features in &#x000a7;4).</p><p>Many components need to be integrated to achieve the goal&#x02014;new algorithms for enhanced model performance and scalability, performance optimization at all levels, increased hardware&#x02013;software co-design to make sure that future architectures can be exploited by weather and climate models, etc. In this contribution, we have provided scalability studies of the IFS and the ICON model, and we have presented a simple, yet effective approach to performance modelling to quantify model shortfalls, demonstrating the model's feasibility at the ICON-DYAMOND case. The performance models are further expected to be beneficial when porting the weather and climate models to new hardware architectures: based on hardware characteristics and only a few additional performance measurements, the performance models enable scalability predictions for full model runs. Yet, improved models to describe load imbalances within the models would be highly desirable. We expect our performance models and related analysis to be helpful for other groups, who face the same scalability challenges. Depending on the weather and climate models and their communication patterns, one or the other part of the performance models may require further refinement; for example, in the case of the IFS, the term <italic>t</italic><sub>commun</sub>(<italic>N</italic>) would require additional modelling to account for the transformations between spectral and grid-point space. Doing the performance modelling exercise for more weather and climate models or their sub-components that typically add complexity (such as chemistry, aerosol, carbon cycle, etc.) will be highly beneficial to develop a community plan towards global high-resolution modelling at exascale. In the case of the ICON-DYAMOND configuration, time spent in I/O amounted to up to 39% (on 900 nodes of Mistral). This will become even worse for simulations at higher resolutions. Thus, incorporating I/O in the performance models constitutes another requirement to successfully predict the performance of the weather and climate models in production mode at exascale. Future work will further focus on extending considerations to 2.5&#x02009;km and 1&#x02009;km runs and towards coupled atmosphere-ocean simulations.</p></sec></body><back><ack><title>Acknowledgements</title><p>Parts of this work have been carried out under the umbrella of the Centre of Excellence in Simulation of Weather and Climate in Europe (ESiWACE). This project has received funding from the European Union's Horizon 2020 research and innovation programme under grant agreement no. 675191. This material reflects only the author's view and the European Commission is not responsible for any use that may be made of the information it contains. Compute time in the scope of compute project bk1040 (ESiWACE) at the German Climate Computing Center is acknowledged. M.B. acknowledges funding from the High Definition Clouds and Precipitation for advancing Climate Prediction (HD(CP)<sup>2</sup>) project under the grant no. 01LK1501B, funded within the framework programme &#x02018;Research for Sustainable Development&#x02019; by the German Ministry for Education and Research. N.W. and P.B. gratefully acknowledge part funding under the ESCAPE project from the European Union's Horizon 2020 research and innovation programme under grant agreement no. 671627.</p></ack><sec id="s6"><title>Data accessibility</title><p>Research data from ECMWF can be obtained on request through accessing ECMWF's meteorological data archive and retrieval system (MARS).</p></sec><sec id="s7"><title>Authors' contributions</title><p>P.N. has coordinated the writing of the manuscript. He has evaluated and run ICON scalability experiments in both ESiWACE demonstrator set-ups and DYAMOND experiments. He further contributed to the development of the performance models. P.D. and N.W. have delivered inputs on the IFS, including scalability experiments and evaluation of energy spectra. B.S. is the initiator and leader of the DYAMOND project, and he is responsible (together with other groups) for the corresponding experimental set-up agreements. He has contributed the section on why the kilometre scale matters in global high-resolution simulations. L.K. has made substantial efforts with regard to setting up, programming and evaluating the ICON configuration in global high-resolution mode. D.K. has contributed to these efforts. D.K. and M.B. have evaluated the DYAMOND runs (figures <xref ref-type="fig" rid="RSTA20180148F2">2</xref> and <xref ref-type="fig" rid="RSTA20180148F3">3</xref>). P.B. wrote the section on effective versus nominal resolution and made contributions to the IFS global set-up. P.A. and J.B. contributed to the establishment of the performance models. J.B. further contributed to the section on scalability challenges.</p><p>All authors have made contributions to the overall draft such as revisions and critical feedback.</p></sec><sec id="s8" sec-type="COI-statement"><title>Competing interests</title><p>We have no competing interests.</p></sec><sec id="s9"><title>Funding</title><p>P.N. is employed at the German Climate Computing Center. He is funded through the European Union's Horizon 2020 research and innovation programme, grant agreement no. 675191 (ESiWACE). P.D. gratefully acknowledges funding from the Royal Society for his University Research Fellowship as well as funding from the ESiWACE project. N.W. and P.B. are core staff at the European Centre for Medium-Range Weather Forecasts. L.K. and B.S. are permanent staff at the Max-Planck-Institute for Meteorology. M. Brueck is a member of the Max-Planck-Institute for Meteorology, funded through the project HD(CP)<sup>2</sup>, grant no. 01LK1501B. D.K. is supported by the Hans Ertel Center for Weather Research (HErZ). This German research network of universities, research institutes and Deutscher Wetterdienst is funded by the BMVI (Federal Ministry of Transport and Digital Infrastructure). P.A. and J.B. are permanently employed at the German Climate Computing Center.</p></sec><ref-list><title>References</title><ref id="RSTA20180148C1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Storch</surname><given-names>J-S</given-names></name>, <name name-style="western"><surname>Marotzke</surname><given-names>J</given-names></name></person-group>
<year>2013</year>
<article-title>Deep-ocean heat uptake and equilibrium climate response</article-title>. <source>Clim. Dyn.</source>
<volume>40</volume>, <fpage>1071</fpage>&#x02013;<lpage>1086</lpage>. (<pub-id pub-id-type="doi">10.1007/s00382-012-1350-z</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kay</surname><given-names>J</given-names></name><etal>et al.</etal></person-group>
<year>2015</year>
<article-title>The community earth system model (CESM) large ensemble project: a community resource for studying climate change in the presence of internal climate variability</article-title>. <source>Q. J. R. Meteorol. Soc.</source>
<volume>96</volume>, <fpage>1333</fpage>&#x02013;<lpage>1349</lpage>. (<pub-id pub-id-type="doi">10.1175/BAMS-D-13-00255.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weusthoff</surname><given-names>T</given-names></name></person-group>
<year>2010</year>
<article-title>Assessing the benefits of convection-permitting models by neighborhood verification: examples from MAP D-PHASE</article-title>. <source>Mon. Weather Rev.</source>
<volume>138</volume>, <fpage>3418</fpage>&#x02013;<lpage>3433</lpage>. (<pub-id pub-id-type="doi">10.1175/2010MWR3380.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bauer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Thorpe</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Brunet</surname><given-names>G</given-names></name></person-group>
<year>2015</year>
<article-title>The quiet revolution of numerical weather prediction</article-title>. <source>Nature</source>
<volume>525</volume>, <fpage>47</fpage>&#x02013;<lpage>55</lpage>. (<pub-id pub-id-type="doi">10.1038/nature14956</pub-id>)<pub-id pub-id-type="pmid">26333465</pub-id></mixed-citation></ref><ref id="RSTA20180148C5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shukla</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Palmer</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hagedorn</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hoskins</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Kinter</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Marotzke</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Slingo</surname><given-names>J</given-names></name></person-group>
<year>2010</year>
<article-title>Toward a new generation of world climate research and computing facilities</article-title>. <source>Bull. Am. Meteorol. Soc.</source>
<volume>91</volume>, <fpage>1407</fpage>&#x02013;<lpage>1412</lpage>. (<pub-id pub-id-type="doi">10.1175/2010BAMS2900.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fudeyasu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Satoh</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nasuno</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Miura</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yanase</surname><given-names>W</given-names></name></person-group>
<year>2008</year>
<article-title>Global cloud-system-resolving model NICAM successfully simulated the lifecycles of two real tropical cyclones</article-title>. <source>Geophys. Res. Lett.</source>
<volume>35</volume>, <fpage>L22808</fpage> (<pub-id pub-id-type="doi">10.1029/2008GL036003</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wehner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Oliker</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Shalf</surname><given-names>J</given-names></name></person-group>
<year>2008</year>
<article-title>Towards Ultra-High Resolution Models of Climate and Weather</article-title>. <source>Int. J. High Perform. Comput. Appl.</source>
<volume>22</volume>, <fpage>149</fpage>&#x02013;<lpage>165</lpage>. (<pub-id pub-id-type="doi">10.1177/1094342007085023</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wehner</surname><given-names>M</given-names></name><etal>et al.</etal></person-group>
<year>2011</year>
<article-title>Hardware/software co-design of global cloud system resolving models</article-title>. <source>J. Adv. Model. Earth Syst.</source>
<volume>3</volume>, <fpage>M10003</fpage> (<pub-id pub-id-type="doi">10.1029/2011MS000073</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fuhrer</surname><given-names>O</given-names></name><etal>et al.</etal></person-group>
<year>2018</year>
<article-title>Near-global climate simulation at 1&#x02009;km resolution: establishing a performance baseline on 4888 GPUs with COSMO 5.0</article-title>. <source>Geosci. Model Dev.</source>
<volume>11</volume>, <fpage>1665</fpage>&#x02013;<lpage>1681</lpage>. (<pub-id pub-id-type="doi">10.5194/gmd-11-1665-2018</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miyamoto</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kajikawa</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yoshida</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Yamaura</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yashiro</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Tomita</surname><given-names>H</given-names></name></person-group>
<year>2013</year>
<article-title>Deep moist atmospheric convection in a subkilometer global simulation</article-title>. <source>Geophys. Res. Lett.</source>
<volume>40</volume>, <fpage>4922</fpage>&#x02013;<lpage>4926</lpage>. (<pub-id pub-id-type="doi">10.1002/grl.50944</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C11"><label>11</label><mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Michalakes</surname><given-names>J</given-names></name><etal>et al.</etal></person-group>
<year>2015</year>
<comment><italic>AVEC report: NGGPS level-1 benchmarks and software evaluation</italic>. Technical Report, NGGPS Dynamical Core Test Group</comment>.</mixed-citation></ref><ref id="RSTA20180148C12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bretherton</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Khairoutdinov</surname><given-names>M</given-names></name></person-group>
<year>2015</year>
<article-title>Convective self-aggregation feedbacks in near-global cloud-resolving simulations of an aquaplanet</article-title>. <source>J. Adv. Model. Earth Syst.</source>
<volume>7</volume>, <fpage>1765</fpage>&#x02013;<lpage>1787</lpage>. (<pub-id pub-id-type="doi">10.1002/2015MS000499</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smagorinsky</surname><given-names>J</given-names></name></person-group>
<year>1958</year>
<article-title>On the numerical integration of primitive equations of motion for baroclinic flow in a closed region</article-title>. <source>Mon. Weather Rev.</source>
<volume>86</volume>, <fpage>457</fpage>&#x02013;<lpage>466</lpage>. (<pub-id pub-id-type="doi">10.1175/1520-0493(1958)086&#x0003c;0457:OTNIOT&#x0003e;2.0.CO;2</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smagorinsky</surname><given-names>J</given-names></name></person-group>
<year>1963</year>
<article-title>General circulation experiments with the primitive equations</article-title>. <source>Mon. Weather Rev.</source>
<volume>91</volume>, <fpage>99</fpage>&#x02013;<lpage>164</lpage>. (<pub-id pub-id-type="doi">10.1175/1520-0493(1963)091&#x0003c;0099:GCEWTP&#x0003e;2.3.CO;2</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Riehl</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Malkus</surname><given-names>J</given-names></name></person-group>
<year>1958</year>
<article-title>On the heat balance in the equatorial trough zone</article-title>. <source>Geophysica</source>
<volume>6</volume>, <fpage>503</fpage>&#x02013;<lpage>538</lpage>.</mixed-citation></ref><ref id="RSTA20180148C16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schulthess</surname><given-names>TB</given-names></name></person-group>
<year>2018</year>
<article-title>Reflecting on the goal and baseline for &#x02018;Exascale Computing:&#x02019; a roadmap based on weather and climate simulations</article-title>. <source>Comput. Sci. Eng.</source> (<pub-id pub-id-type="doi">10.1109/MCSE.2018.2888788</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alowayyed</surname><given-names>SG</given-names></name></person-group>
<year>2017</year>
<article-title>Multiscale computing in the exascale era</article-title>. <source>J. Comput. Sci.</source>
<volume>22</volume>, <fpage>15</fpage>&#x02013;<lpage>25</lpage>. (<pub-id pub-id-type="doi">10.1016/j.jocs.2017.07.004</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rupprecht</surname><given-names>D</given-names></name></person-group>
<year>2018</year>
<article-title>Wave propagation characteristics of Parareal</article-title>. <source>Comput. Visual. Sci.</source>
<volume>19</volume>, <fpage>1</fpage>&#x02013;<lpage>17</lpage>. (<pub-id pub-id-type="doi">10.1007/s00791-018-0296-z</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C19"><label>19</label><mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Mengaldo</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Wyszogrodzki</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Diamantakis</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lock</surname><given-names>S-J</given-names></name>, <name name-style="western"><surname>Giraldo</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Wedi</surname><given-names>N</given-names></name></person-group>
<year>2018</year>
<article-title>Current and emerging time-integration strategies in global numerical weather and climate prediction</article-title>. <source>Arch. Comput. Methods Eng</source>.</mixed-citation></ref><ref id="RSTA20180148C20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ullrich</surname><given-names>P</given-names></name><etal>et al.</etal></person-group>
<year>2017</year>
<article-title>DCMIP2016: a review of non-hydrostatic dynamical core design and intercomparison of participating models</article-title>. <source>Geosci. Model Dev.</source>
<volume>10</volume>, <fpage>4477</fpage>&#x02013;<lpage>4509</lpage>. (<pub-id pub-id-type="doi">10.5194/gmd-10-4477-2017</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C21"><label>21</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hamilton</surname><given-names>K</given-names></name></person-group>
<year>2008</year>
<article-title>Numerical resolution and modeling of the global atmospheric circulation: a review of our current understanding and outstanding issues</article-title>. In <source>High resolution numerical modelling of the atmosphere and ocean</source> (eds <person-group person-group-type="editor"><name name-style="western"><surname>Hamilton</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ohfuchi</surname><given-names>W</given-names></name></person-group>), pp. <fpage>7</fpage>&#x02013;<lpage>27</lpage>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name> (<pub-id pub-id-type="doi">10.1007/978-0-387-49791-4_1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C22"><label>22</label><mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Istvan</surname><given-names>S</given-names></name></person-group>
<year>2014</year>
<comment><italic>Applicable atmospheric dynamics: techniques for the exploration of atmospheric dynamics</italic></comment>.</mixed-citation></ref><ref id="RSTA20180148C23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malardel</surname><given-names>SA</given-names></name></person-group>
<year>2016</year>
<article-title>How does subgrid-scale parametrization influence nonlinear spectral energy fluxes in global NWP models?</article-title>
<source>J. Geophys. Res. Atmos.</source>
<volume>121</volume>, <fpage>5395</fpage>&#x02013;<lpage>5410</lpage>. (<pub-id pub-id-type="doi">10.1002/2015JD023970</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wedi</surname><given-names>N</given-names></name></person-group>
<year>2014</year>
<article-title>Increasing horizontal resolution in numerical weather prediction and climate simulations: illusion or panacea?</article-title>
<source>Phil. Trans. R. Soc. A Math. Phys. Eng. Sci.</source>
<volume>372</volume>, <fpage>20130289</fpage> (<pub-id pub-id-type="doi">10.1098/rsta.2013.0289</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Z&#x000e4;ngl</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Reinert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>R&#x000ed;podas</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Baldauf</surname><given-names>M</given-names></name></person-group>
<year>2014</year>
<article-title>The ICON (ICOsahedral Non-hydrostatic) modelling framework of DWD and MPI-M: description of the non-hydrostatic dynamical core</article-title>. <source>Q. J. R. Meteorol. Soc.</source>
<volume>141</volume>, <fpage>563</fpage>&#x02013;<lpage>579</lpage>. (<pub-id pub-id-type="doi">10.1002/qj.2378</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Skamarock</surname><given-names>W</given-names></name></person-group>
<year>2004</year>
<article-title>Evaluating mesoscale NWP models using kinetic energy spectra</article-title>. <source>Mon. Weather Rev.</source>
<volume>132</volume>, <fpage>3019</fpage>&#x02013;<lpage>3032</lpage>. (<pub-id pub-id-type="doi">10.1175/MWR2830.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dipankar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Stevens</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Heinze</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Moseley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Z&#x000e4;ngl</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Giorgetta</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Brdar</surname><given-names>S</given-names></name></person-group>
<year>2015</year>
<article-title>Large eddy simulation using the general circulation model ICON</article-title>. <source>J. Adv. Model. Earth Syst.</source>
<volume>7</volume>, <fpage>963</fpage>&#x02013;<lpage>986</lpage>. (<pub-id pub-id-type="doi">10.1002/2015MS000431</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baldauf</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Seifert</surname><given-names>A</given-names></name>, <name name-style="western"><surname>F&#x000f6;rstner</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Majewski</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Raschendorfer</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Reinhardt</surname><given-names>T</given-names></name></person-group>
<year>2011</year>
<article-title>Operational convective-scale numerical weather prediction with the COSMO model: description and sensitivities</article-title>. <source>Mon. Weather Rev.</source>
<volume>139</volume>, <fpage>3887</fpage>&#x02013;<lpage>3905</lpage>. (<pub-id pub-id-type="doi">10.1175/MWR-D-10-05013.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Klocke</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Brueck</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hohenegger</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Stevens</surname><given-names>B</given-names></name></person-group>
<year>2017</year>
<article-title>Rediscovery of the doldrums in storm-resolving simulations over the tropical Atlantic</article-title>. <source>Nat. Geosci.</source>
<volume>10</volume>, <fpage>891</fpage>&#x02013;<lpage>896</lpage>. (<pub-id pub-id-type="doi">10.1038/s41561-017-0005-4</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>V&#x000e1;&#x00148;a</surname><given-names>F</given-names></name></person-group>
<year>2017</year>
<article-title>Single precision in weather forecasting models: an evaluation with the IFS</article-title>. <source>Mon. Weather Rev.</source>
<volume>145</volume>, <fpage>495</fpage>&#x02013;<lpage>502</lpage>. (<pub-id pub-id-type="doi">10.1175/MWR-D-16-0228.1</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heinze</surname><given-names>R</given-names></name><etal>et al.</etal></person-group>
<year>2017</year>
<article-title>Large-eddy simulations over Germany using ICON: a comprehensive evaluation</article-title>. <source>Q. J. R. Meteorol. Soc.</source>
<volume>143</volume>, <fpage>69</fpage>&#x02013;<lpage>100</lpage>. (<pub-id pub-id-type="doi">10.1002/qj.2947</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Valiant</surname><given-names>L</given-names></name></person-group>
<year>1990</year>
<article-title>A bridging model for parallel computation</article-title>. <source>Commun. ACM</source>
<volume>33</volume>, <fpage>103</fpage>&#x02013;<lpage>111</lpage>. (<pub-id pub-id-type="doi">10.1145/79173.79181</pub-id>)</mixed-citation></ref><ref id="RSTA20180148C33"><label>33</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Culler</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Karp</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Patterson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Sahay</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Schauser</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Santos</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Subramonian</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Von Eicken</surname><given-names>T</given-names></name></person-group>
<year>1993</year>
<article-title>LogP: towards a realistic model of parallel computation</article-title>. <source>ACM SIGPLAN Notices</source>
<volume>28</volume>, <fpage>1</fpage>&#x02013;<lpage>12</lpage>. (<pub-id pub-id-type="doi">10.1145/173284.155333</pub-id>)</mixed-citation></ref></ref-list></back></article>