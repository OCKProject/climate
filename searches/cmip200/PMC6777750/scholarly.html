<html xmlns="http://www.w3.org/1999/xhtml"><head> <style type="text/css">
         	     		 
         	    a                          {background : #ffffff; }
         	    article                    {border-style : dotted; border-width : 2px; }
         		 	
         		 	div                        {background : #ffffcc;}
         		 	div.abstract-title         {font-weight : bold ; font-size : 16pt;}
         		 	div.ack                    {border-style : solid ; border-color : red; margin
         : 2em; }
         		 	div.article-meta           {border-style : solid; border-width : 1 pt; margin
         1em;}
         		 	div.boxed-text             {margin : 5em; border-style : solid;}
         		 	div.contrib-group          {margin : 1em; }
         		 	div.fig                    {border-style : solid; border-width : 2px; margin :
         2em; }
         		 	div.funding                {font-weight : bold ; font-size : 16pt;}
         		 	div.given-names            {font-style : italic;}
         		 	div.intro                  {border-style : inset; margin : 5px;}
         		 	div.introduction           {border-style : inset; margin : 5px;}
         		 	div.journal-meta           {border-style : solid; border-width : 1 pt; margin
         1em;}
         		 	div.journal-title-group    {background : #ffeeee;}
         		 	div.article-title          {font-weight : bold ; font-size : 18pt;}
         		 	div.kwd                    {font-style : italic}
         		 	div.meta-name              {font-weight : bold ; font-size : 16pt;}
         		 	div.name                   {font-weight : bold;}
         		 	div.alt-title              {font-style : italic; font-size : 12px;}
         		 	
         		 	div.sec                    {border : 2px; margin 5px; padding 2px;}
         		 	div.title                  {font-family : courier; font-weight : bold;
         		 	                            font-size : 16pt; margin : 5px;}
         		 	
         		 	div.materials_methods      {border-style : double; margin : 5px; }
         		 	div.methods                {border-style : double; margin : 5px; }
         		 	
         		 	div.results                {border-style : solid; margin : 5px;}
         		 	div.background             {border-style : dotted; margin : 5px;}
         		 	
         		 	div.discussion             {border-style : groove; margin : 5px;}
         		 	div.conclusion             {border-style : ridge; margin : 5px;}
         		 	div.conclusions             {border-style : ridge; margin : 5px;}
         		 	div.supplementary-material {border-style : inset; margin : 5px;}
         		 	div.abbreviations          {border-style : double; border-color : red; margin
         : 5px;}
         		 	div.competinginterests     {border-style : double; border-color : blue; margin
         : 5px;}
         		 	div.acknowledgements       {border-style : double; border-color : green; margin
         : 5px;}
         		 	div.authors_contributions   {border-style : double; border-color : purple; margin
         : 5px;}
         		 	
         		 	div.publisher              {border-style : outset; margin : 5px;}
         		 	div.fn-type-conflict       {background : #f88; }
         		 	div.fn-type-con            {background : #ddf; }
         		 	div.fn-type-other          {background : #ddd; }
         		 	
         		 	div.unknown                {background : #ffd;
         									 	  border-style : solid;
         									 	  border-width : 1px;
         									 	  padding : 2 px;}
         		 	  
         	    table                      {background : #ffffdd;}
         		 	tr                         {background : #ddddff; padding : 1px;}
         		 	
         		 	span                       {background : #ffcccc;}
         		 	
         		 	span.citation-author       {font-family : helvetica; background : #ffeeee;}
         		 	span.collab                {background : #ddffff; }
         		 	span.comment               {font-family : courier; font-size : 6px; background
         : #ffaaff;}
         		 	span.contrib               {background : #ffffff;}
         		 	span.corresp               {background : #ddffdd; }
         		 	span.doi                   {background : #ffffff;}
         		 	span.email                 {font-family : courier; }
         		 	span.etal                  {font-style : italic;}
         		 	span.fpage                 {font-family : courier;}
         		 	span.given-names           {background : #ffffff;}
         		 	span.iso-abbrev            {background : #ffffff;}
         		 	span.issn-epub             {background : #ffffff;}
         		 	span.issn-ppub             {background : #ffffff;}
         		 	span.journal-title         {background : #ffffff;}
         		 	span.lpage                 {font-family : courier;}
         		 	span.mixed-article-title   {font-style : italic ;}
         		 	span.nlm-ta                {background : #ffffff;}
         		 	span.pmc                   {background : #ffffff;}
         		 	span.pmcid                 {background : #ffffff;}
         		 	span.pmid                  {background : #ffffff;}
         		 	span.publisher             {background : #ffffff;}
         		 	span.publisher-id          {background : #ffffff;}
         		 	span.publisher-name        {background : #ffffff;}
         		 	span.source                {background : #ffffff;}
         		 	span.subject               {background : #ffffff;}
         		 	span.surname               {background : #ffffff;}
         		 	span.volume                {font-family : courier; font-weight : bold;}
         		 	span.year                  {font-family : courier ; font-style : italic;}
         			
      </style> </head> <body> <div class="front" title="front"> <div class="journal-meta" tagx="journal-meta" title="journal-meta"> <span class="nlm-ta" title="nlm-ta">PLoS One</span> <span class="iso-abbrev" title="iso-abbrev">PLoS ONE</span> <span class="publisher-id" title="publisher-id">plos</span> <span class="pmc" title="pmc">plosone</span> <div class="journal-title-group" tagx="journal-title-group" title="journal-title-group"> <span class="journal-title" tagx="journal-title" title="journal-title">PLoS ONE</span> </div> <span class="issn-epub" tagx="issn" title="issn-epub">1932-6203</span> <div class="publisher" tagx="publisher" title="publisher"> <span class="publisher-name" tagx="publisher-name" title="publisher-name">Public Library of Science</span> <span class="publisher-loc" tagx="publisher-loc" title="publisher-loc">San Francisco, CA USA</span> </div> </div> <div class="article-meta" tagx="article-meta" title="article-meta"> <span class="pmcid" title="pmcid"> pmcid: <a href="http://www.ncbi.nlm.nih.gov/pubmed/6777750">6777750</a> </span> <span class="publisher-id" title="publisher-id">PONE-D-19-08533</span> <span class="doi" title="doi"> doi: <a href="https://dx.doi.org/10.1371/journal.pone.0223542">10.1371/journal.pone.0223542</a> </span> <div class="article-categories" title="article-categories">
: <span class="subject" title="subject">Research Article</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Physical Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Mathematics</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Probability Theory</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Probability Distribution</span>: <span class="subject" title="subject">Normal Distribution</span> </div> </div> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Research and Analysis Methods</span>: <span class="subject" title="subject">Precipitation Techniques</span> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Physical Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Mathematics</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Probability Theory</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Random Variables</span>: <span class="subject" title="subject">Covariance</span> </div> </div> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Earth Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Atmospheric Science</span>: <span class="subject" title="subject">Meteorology</span> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Earth Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Atmospheric Science</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Climatology</span>: <span class="subject" title="subject">Climate Change</span> </div> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Physical Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Mathematics</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Statistics</span>: <span class="subject" title="subject">Statistical Data</span> </div> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Earth Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Geography</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Physical Geography</span>: <span class="subject" title="subject">Earth Systems</span> </div> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Research and Analysis Methods</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Simulation and Modeling</span>: <span class="subject" title="subject">Climate Modeling</span> </div> </div> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Earth Sciences</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Atmospheric Science</span> <div class="sub-group" title="subj-group">
: <span class="subject" title="subject">Climatology</span>: <span class="subject" title="subject">Climate Modeling</span> </div> </div> </div> </div> <div class="title-group"> <div class="article-title" title="article-title">
Joint emulation of Earth System Model temperature-precipitation realizations with internal variability and space-time and cross-variable correlation: fldgen v2.0 software description </div> <div class="alt-title" title="alt-title">
fldgen v2.0</div> </div> <div class="contrib-group" title="contrib-group"> <span class="contrib" title="contrib"> <span class="contrib-id" tagx="contrib-id" title="contrib-id">http://orcid.org/0000-0002-9034-9948</span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Snyder</span> <span class="given-names" tagx="given-names" title="given-names">Abigail</span> </span> <span class="role" tagx="role" title="role">Conceptualization</span> <span class="role" tagx="role" title="role">Formal analysis</span> <span class="role" tagx="role" title="role">Funding acquisition</span> <span class="role" tagx="role" title="role">Methodology</span> <span class="role" tagx="role" title="role">Project administration</span> <span class="role" tagx="role" title="role">Resources</span> <span class="role" tagx="role" title="role">Software</span> <span class="role" tagx="role" title="role">Supervision</span> <span class="role" tagx="role" title="role">Validation</span> <span class="role" tagx="role" title="role">Writing – original draft</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff001"> <sup>1</sup> </a> <a href="#cor001">*</a> </span> <span class="contrib" title="contrib"> <span class="contrib-id" tagx="contrib-id" title="contrib-id">http://orcid.org/0000-0002-7071-248X</span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Link</span> <span class="given-names" tagx="given-names" title="given-names">Robert</span> </span> <span class="role" tagx="role" title="role">Conceptualization</span> <span class="role" tagx="role" title="role">Formal analysis</span> <span class="role" tagx="role" title="role">Methodology</span> <span class="role" tagx="role" title="role">Software</span> <span class="role" tagx="role" title="role">Supervision</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff001"> <sup>1</sup> </a> </span> <span class="contrib" title="contrib"> <span class="contrib-id" tagx="contrib-id" title="contrib-id">http://orcid.org/0000-0001-8093-8397</span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Dorheim</span> <span class="given-names" tagx="given-names" title="given-names">Kalyn</span> </span> <span class="role" tagx="role" title="role">Software</span> <span class="role" tagx="role" title="role">Validation</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff001"> <sup>1</sup> </a> <a href="#econtrib001"> <sup>‡</sup> </a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kravitz</span> <span class="given-names" tagx="given-names" title="given-names">Ben</span> </span> <span class="role" tagx="role" title="role">Conceptualization</span> <span class="role" tagx="role" title="role">Formal analysis</span> <span class="role" tagx="role" title="role">Methodology</span> <span class="role" tagx="role" title="role">Validation</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff002"> <sup>2</sup> </a> <a href="#aff003"> <sup>3</sup> </a> <a href="#econtrib001"> <sup>‡</sup> </a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Bond-Lamberty</span> <span class="given-names" tagx="given-names" title="given-names">Ben</span> </span> <span class="role" tagx="role" title="role">Conceptualization</span> <span class="role" tagx="role" title="role">Validation</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff001"> <sup>1</sup> </a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hartin</span> <span class="given-names" tagx="given-names" title="given-names">Corinne</span> </span> <span class="role" tagx="role" title="role">Conceptualization</span> <span class="role" tagx="role" title="role">Funding acquisition</span> <span class="role" tagx="role" title="role">Validation</span> <span class="role" tagx="role" title="role">Writing – review &amp;amp; editing</span> <a href="#aff001"> <sup>1</sup> </a> </span> </div> <span class="citation_author_institution" id="aff001">[1], <span class="addr-line" title="addr-line">Joint Global Change Research Institute, Pacific Northwest National Laboratory, College Park, MD, United States of America </span> </span> <span class="citation_author_institution" id="aff002">[2], <span class="addr-line" title="addr-line">Department of Earth and Atmospheric Sciences, Indiana University, Bloomington, IN, United States of America </span> </span> <span class="citation_author_institution" id="aff003">[3], <span class="addr-line" title="addr-line">Atmospheric Sciences and Global Change Division, Pacific Northwest National Laboratory, Richland, WA, United States of America </span> </span> <div class="contrib-group" title="contrib-group"> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Xu</span> <span class="given-names" tagx="given-names" title="given-names">Yangyang</span> </span> <span class="role" tagx="role" title="role">Editor</span> <a href="#edit1" /> </span> </div> <span class="citation_author_institution" id="edit1">[], <span class="addr-line" title="addr-line">Texas A&amp;amp;M University, UNITED STATES</span> </span> <div class="author-notes" title="author-notes"> <div class="fn-type-COI-statement" title="COI-statement"> <p> <b>Competing Interests: </b>The authors have declared that no competing interests exist. </p> </div> <div class="fn-type-other" title="other"> <p>‡ These authors also contributed equally to this work.</p> </div> <div class="corresp" title="corresp">
* E-mail: <span class="email" tagx="email" title="email">abigail.snyder@pnnl.gov</span> </div> </div> <span class="pub-date-collection" title="pub-date-collection">collection: <span>2019</span> </span> <span class="pub-date-epub" title="pub-date-epub">epub: <span>2019-10-10</span> </span> <span class="volume" tagx="volume" title="volume">14</span> <span class="issue" tagx="issue" title="issue">10</span> <span class="elocation-id" tagx="elocation-id" title="elocation-id">e0223542</span> <span class="history" title="history"> <span class="received" title="received">received: 2019-3-25</span> <span class="accepted" title="accepted">accepted: 2019-9-23</span> </span> <div class="permissions"> <span class="copyright" title="copyright">(C) <span class="copyright-holder" tagx="copyright-holder" title="copyright-holder">Snyder et al</span>, <span class="copyright-year" tagx="copyright-year" title="copyright-year">2019</span> </span> <span class="license" title="license"> <span class="license-p" title="license-p">This is an open access article distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited. </span> </span> </div> <a class="self-uri" href="pone.0223542.pdf" title="self-uri">pone.0223542.pdf</a> <div class="abstract" title="abstract"> <div class="abstract-title" title="abstract-title">
Abstract</div> <p>Earth System Models (ESMs) are excellent tools for quantifying many aspects of future climate dynamics but are too computationally expensive to produce large collections of scenarios for downstream users of ESM data. In particular, many researchers focused on the impacts of climate change require large collections of ESM runs to rigorously study the impacts to both human and natural systems of low-frequency high-importance events, such as multi-year droughts. Climate model emulators provide an effective mechanism for filling this gap, reproducing many aspects of ESMs rapidly but with lower precision. The <tt>fldgen v1.0</tt> R package quickly generates thousands of realizations of gridded temperature fields by randomizing the residuals of pattern scaling temperature output from any single ESM, retaining the spatial and temporal variance and covariance structures of the input data at a low computational cost. The <tt>fldgen v2.0</tt> R package described here extends this capability to produce joint realizations of multiple variables, with a focus on temperature and precipitation in an open source software package available for community use ( <a href="https://github.com/jgcri/fldgen">https://github.com/jgcri/fldgen</a>). This substantially improves the <tt>fldgen</tt> package by removing the requirement that the ESM variables be normally distributed, and will enable researchers to quickly generate covarying temperature and precipitation data that are synthetic but faithful to the characteristics of the original ESM. </p> </div> <div class="funding-group" title="funding-group"> <div class="funding" title="funding">
Funding</div> <div class="funding-statement" title="funding-statement">
Primary funding was provided by Pacific Northwest National Laboratory through the Laboratory Directed Research and Development program (supported AS, RL, KD, BK, BBL, CH). Research was additionally funded with support provided by the U.S. Department of Energy, Office of Science, as part of research in Multi-Sector Dynamics, Earth and Environmental System Modeling Program (AS, RL, KD, BK, BBL, CH). Research was also supported in part by the Indiana University Environmental Resilience Institute and the Prepared for Environmental Change grand challenge initiative (BK). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. </div> </div> <div class="counts" title="counts"> <span class="fig-count" title="fig-count">fig-count: </span> <span class="table-count" title="table-count">table-count: </span> <span class="page-count" title="page-count">page-count: </span> </div> <div class="custom-meta-group" title="custom-meta-group"> <meta name="Data Availability" value="The software described in this paper, including test data, is available via prerelease on GitHub: https://github.com/JGCRI/fldgen/tree/v2.0.0-rc.1. The prerelease is archived with a permanent DOI via Zenodo: http://doi.org/10.5281/zenodo.2605386." /> </div> </div> <div class="title" tagx="title" title="title">
Data Availability</div> <p>The software described in this paper, including test data, is available via prerelease on GitHub: <a href="https://github.com/JGCRI/fldgen/tree/v2.0.0-rc.1">https://github.com/JGCRI/fldgen/tree/v2.0.0-rc.1</a>. The prerelease is archived with a permanent DOI via Zenodo: <a href="http://doi.org/10.5281/zenodo.2605386">http://doi.org/10.5281/zenodo.2605386</a>. </p> </div> <div class="body" title="body"> <div class="intro" title="intro"> <div class="title" tagx="title" title="title">
Introduction</div> <p>Two important topics to researchers in earth sciences, future climate dynamics, and joint human-Earth system modeling are the effects of extreme events and uncertainty in climate impacts [ <a href="#pone.0223542.ref001">1</a>, <a href="#pone.0223542.ref002">2</a>]. Understanding the uncertainty around extreme events also has direct relevance for decision makers, the U.S. energy grid, and other stakeholders. Generally, high-resolution future climate scenarios can be used as input for different process-based or economic models to assess impacts of future climate on economic, land, energy, and other systems; however, thousands of such high-resolution future scenarios may be needed for a full and robust analysis of the impacts of low-frequency high-importance extreme events and associated uncertainties [ <a href="#pone.0223542.ref003">3</a>– <a href="#pone.0223542.ref005">5</a>]. </p> <p>Process-rich Earth System Models (ESMs) are capable of providing the high-resolution future climate scenarios for impacts studies, but are too computationally expensive to directly produce hundreds or thousands of realizations needed to understand the impacts of extreme events. Climate model emulators attempt to solve this problem by approximating the output a climate model would have produced had it been run repeatedly for a specified scenario [ <a href="#pone.0223542.ref006">6</a>]. These emulators are computationally cheap to run, but typically capture only the mean response of the climate and little to none of the variability that would be present in a real ESM output. Attempts to add variability to such emulations often lose important spatial and temporal correlations that fundamentally define ESM patterns (such as the El Niño Southern Oscillation), or else cannot produce the number of realizations necessary for extreme event or uncertainty studies. </p> <p>In <tt>fldgen v1.0</tt>, Link et al. [ <a href="#pone.0223542.ref007">7</a>] (Paper LS1 hereafter) have solved many of these problems for the case of global temperature. This method generates random realizations of temperature global gridded time series that retain the spatial and temporal variance and covariance structures of the input ESM data at a much lower computational cost compared to the ESMs being emulated. Crucially, <tt>fldgen v1.0</tt> does so without placing <i>a priori</i> limits on the form of the correlation function and without using bootstrap resampling of existing ESM output [ <a href="#pone.0223542.ref008">8</a>– <a href="#pone.0223542.ref010">10</a>]. </p> <p>Nevertheless, temperature is not the only important variable for quantifying the effects of future climate on human systems. Precipitation, for example, is of interest because of the serious impacts of extreme precipitation events, as the distribution of precipitation over space and time is a primary driver of extreme events like droughts and floods [ <a href="#pone.0223542.ref011">11</a>]. Moreover, the water cycle is a key component of research focused on water cycle impact on agriculture and water consumption in energy production [ <a href="#pone.0223542.ref003">3</a>, <a href="#pone.0223542.ref005">5</a>, <a href="#pone.0223542.ref012">12</a>]. </p> <p>Recent research has shown that modeling temperature and precipitation extremes independently mischaracterizes drought hazards as the covariance between climate variables is missed [ <a href="#pone.0223542.ref013">13</a>]. Therefore, an effective emulator of temperature and precipitation must jointly produce temperature and precipitation realizations that capture such covariance. <tt>Fldgen v2.0</tt> is designed to add this capability, allowing researchers to jointly generate two-variable (e.g. joint temperature and precipitation) fields that not only retain the individual variables’ spatial and temporal variance and covariance structures, but also inter-variable covariance. This method is meant to be used on annual, global gridded temperature and precipitation data. While many interesting climatological and biological processes occur at daily or monthly scales, this annual timescale is often used by researchers in the impacts community focused on long-term effects. Many of these researchers also require global gridded realizations of ESM variables [ <a href="#pone.0223542.ref003">3</a>, <a href="#pone.0223542.ref005">5</a>, <a href="#pone.0223542.ref014">14</a>]. It is true that past modeling approaches such as the UKCP09 framework have provided a methodology for stochastically generating daily weather data for specific regions that does to some degree account for correlations between multiple variables and has accurate statistical structure to high order [ <a href="#pone.0223542.ref015">15</a>]. However, because the focus of that method is on weather in specific regions, it does not necessarily incorporate dynamics that govern larger spatiotemporal scales to be usable in a global gridded manner. </p> <p> <tt>Fldgen v2.0</tt> provides a tool for modelers to rigorously analyze the impacts of extreme events that previously could not be fully evaluated due to limited ESM realizations and region-to-region teleconnections that are not explicitly known globally, such as multi-year droughts across different regions. The objective of this paper is to describe the open-source and publicly available <tt>fldgen v2.0</tt> R package work-flow, capabilities, and accessibility for community use ( <a href="https://github.com/jgcri/fldgen">https://github.com/jgcri/fldgen</a>) in the context of joint generation of temperature and precipitation fields. This includes an overview of the updates to the <tt>fldgen</tt> algorithm from version 1.0 to version 2.0. The theory that supports this extension should be applicable to arbitrary pairs of ESM variables, though this has not been tested and is not a central claim of this work. </p> </div> <div class="extensionfromversion1.0to2.0andarchitecture" title="sec"> <div class="title" tagx="title" title="title">
Extension from version 1.0 to 2.0 and architecture</div> <p>The scientific details of generating new realizations of residuals from a training matrix of ESM residuals are detailed in the <tt>fldgen v1.0</tt> model description Paper LS1. One key feature of the version 1.0 process is that the generated time series of temperature residuals in any given grid cell is approximately normally distributed. This is true irrespective of the distributions of input residuals, due to the way the algorithm sums up contributions from a large number of random components. As a result, the method will preserve the distribution of input residuals only if they are normally distributed. </p> <p>When the training data features normally distributed residuals in every grid cell, the field generating process generates new realizations of time series that preserves three key statistical properties of the training residuals (arrow 3 in <a href="#pone.0223542.g001">Fig 1</a>, Paper LS1): </p> <ol> <div class="title" tagx="title" title="title">
Statistical properties of training residuals preserved by version 1.0</div> <li> <p>Distribution of values in a grid cell over time and between realizations. In other words, residuals in the grid cell are normally distributed with the same mean and variance as the training data in that grid cell. </p> </li> <li> <p>Correlation between values in different grid cells.</p> </li> <li> <p>Time autocorrelation of spatially correlated patterns of grid cells.</p> </li> </ol> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/10.1371/journal.pone.0223542.g001"> <span class="label" tagx="label" title="label">Fig 1</span> </a> </div>   <div class="title" tagx="title" title="title">
flgden v2.0 workflow.</div> <p>Workflow: Extending fldgen v1.0 (arrow 3) to fldgen v2.0 (arrows 1-4) for use with joint temperature and precipitation fields. </p>   </div> <p>For many ESMs, the temperature residuals in each grid cell are indeed approximately normally distributed. However, residuals for other variables, such as precipitation, in many grid cells may have a non-normal distribution (e.g. <a href="#pone.0223542.g002">Fig 2</a>). Thus, in addition to the joint emulation of variables such as temperature and precipitation, one major goal of <tt>fldgen v2.0</tt> is to make the field generation process more robust to non-normally distributed ESM variables. Even in cases where distributions are reasonably well approximated by normal distributions, this change removes the need for a user’s expert judgement as to whether an ESM variable’s residuals in each grid cell follow a distribution sufficiently close to normal to use the field generating method. </p> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/10.1371/journal.pone.0223542.g002"> <span class="label" tagx="label" title="label">Fig 2</span> </a> </div>   <div class="title" tagx="title" title="title">
Comparison of empirical CDF from precipitation data with normal distribution.</div> <p>The empirical CDF of precipitation residuals in a single grid cell (black) and the CDF of a normal distribution with the same mean and variance as the precipitation residuals (red). </p>   </div> <p>For the core field generating method, each ESM variable must effectively be able to accept residuals of between −∞ and ∞ for addition to its mean field. This is already the case for temperature and no transformation is needed. However, because precipitation values in an ESM cannot be negative, either the generated residuals have to be constrained to avoid negative precipitation while preserving the ESM spatiotemporal and intervariable statistics, or the method must operate on a transformation of precipitation that can accept residuals between −∞ and ∞. The latter is more straightforward, and so residuals are generated for log(precipitation) rather than precipitation. The transformation of generated full fields from log(precipitation) space back to precipitation space is trivial for log transformations. Indeed, any function that is continuous, invertible, strictly increasing, and results in a transformed ESM variable whose residuals are supported on (−∞, ∞) will preserve the ESM spatiotemporal statistical properties as desired. </p> <p>Producing joint temperature and log(precipitation) residual realizations therefore requires the development of an algorithm to handle non-normality in transformed ESM training data. This algorithm extension for <tt>fldgen v2.0</tt> involves additional transformations on the input to and output from the version 1.0 process ( <a href="#pone.0223542.t001">Table 1</a>, <a href="#pone.0223542.g001">Fig 1</a>) in order to return generated realizations of joint temperature and log(precipitation) residuals to the native temperature and log(precipitation) distribution in each grid cell. One additional benefit is that this extension removes an assumption necessary to use version 1.0: we previously were restricted to assuming temperature residuals followed a normal distribution in each grid cell. With version 2.0, it no longer matters if this is the case for ESM variables under consideration. </p> <div class="table-wrap_UNKNOWN"> <a href="https://dx.doi.org/10.1371/journal.pone.0223542.t001">10.1371/journal.pone.0223542.t001</a> <span class="label" tagx="label" title="label">Table 1</span>  <div class="title" tagx="title" title="title">
Summary of the fldgen v2.0 algorithm.</div> <p>Details of the steps shared with version 1.0 (denoted with <a href="#t001fn001">*</a>) are provided in Paper LS1 [ <a href="#pone.0223542.ref007">7</a>]. </p>  <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <table> <div class="colgroup_UNKNOWN"> <div class="col_UNKNOWN" /></div> <div class="colgroup_UNKNOWN"><div class="col_UNKNOWN" /></div>  <tbody> <tr> <td>1. <a href="#t001fn001">*</a> </td> <td>Select ESM runs for training the emulator.</td> </tr> <tr> <td>2. <a href="#t001fn001">*</a> </td> <td>Select and fit the mean response model relating local temperature ( <i>T</i>) and log-precipitation (log( <i>P</i>)) to global average temperature. </td> </tr> <tr> <td>3. <a href="#t001fn001">*</a> </td> <td>Calculate the residuals by subtracting mean response from ESM output.</td> </tr> <tr> <td>4. <a href="#t001fn001">*</a> </td> <td>Map the distribution of ( <i>T</i> or log( <i>P</i>)) residuals in each grid cell from the <i>native</i> distribution of the grid cell to the standard normal distribution ( <i>N</i>(0, 1)) via quantiles. </td> </tr> <tr> <td>5. <a href="#t001fn001">*</a> </td> <td>Form a joint matrix of state residuals (spatially flattened, concatenated, normally distributed <i>T</i> and log( <i>P</i>) residuals in each grid cell at each time, denoted by <i>x</i>( <i>t</i>)). </td> </tr> <tr> <td>6 <a href="#t001fn001">*</a>. </td> <td>Perform principal components analysis (PCA) on the joint <i>T</i>-log( <i>P</i>) residual field state: <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
x</div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="mo_UNKNOWN">
=</div> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
∑</div> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
=</div> <div class="mn_UNKNOWN">
1</div> </div> <div class="mi_UNKNOWN">
N</div> </div> <div class="msub_UNKNOWN"> <div class="mi_UNKNOWN">
ϕ</div> <div class="mi_UNKNOWN">
i</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="msub_UNKNOWN"> <div class="mover_UNKNOWN"> <div class="mi_UNKNOWN">
x</div> <div class="mo_UNKNOWN">
^</div> </div> <div class="mi_UNKNOWN">
i</div> </div> </div> </div> </div> </span>, where the <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="msub_UNKNOWN"> <div class="mover_UNKNOWN"> <div class="mi_UNKNOWN">
x</div> <div class="mo_UNKNOWN">
^</div> </div> <div class="mi_UNKNOWN">
i</div> </div> </div> </div> </span> are the principal components, and the <i>ϕ</i> <sub> <i>i</i> </sub>( <i>t</i>) are the projection coefficients. This step expresses the grid state as a linear combination of orthogonal basis vectors that diagonalize the covariance matrix of the system to capture spatial correlations. </td> </tr> <tr> <td>7. <a href="#t001fn001">*</a> </td> <td>Compute the discrete Fourier transform (DFT) [ <a href="#pone.0223542.ref016">16</a>] of the residual field’s projection coefficients onto the principal components: <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="msub_UNKNOWN"> <div class="mo_UNKNOWN">
Φ</div> <div class="mi_UNKNOWN">
i</div> </div> <div class="mo_UNKNOWN">
=</div> </div> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
F</div> <div class="mo_UNKNOWN">
(</div> <div class="msub_UNKNOWN"> <div class="mi_UNKNOWN">
ϕ</div> <div class="mi_UNKNOWN">
i</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="mo_UNKNOWN">
)</div> </div> </div> </div> </span>. </td> </tr> <tr> <td>8. <a href="#t001fn001">*</a> </td> <td>Choose new phases of Φ <sub> <i>i</i> </sub> randomly, uniformly on [0, 2 <i>π</i>) to create new frequency space coefficients <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
Φ</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
⋆</div> </div> </div> </div> </span> with <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
|</div> </div> <div class="msub_UNKNOWN"> <div class="mo_UNKNOWN">
Φ</div> <div class="mi_UNKNOWN">
i</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
|</div> <div class="mo_UNKNOWN">
=</div> <div class="mo_UNKNOWN">
|</div> </div> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
Φ</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
⋆</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
|</div> </div> </div> </div> </div> </span>. This preserves the time autocorrelation function of the ESM training data by the Wiener-Khinchin Theorem [ <a href="#pone.0223542.ref016">16</a>]. </td> </tr> <tr> <td>9. <a href="#t001fn001">*</a> </td> <td>Compute the projection coefficients <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="msubsup_UNKNOWN"> <div class="mi_UNKNOWN">
ϕ</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
⋆</div> </div> </div> </div> </span> of the new residual field as the inverse DFT of <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
Φ</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
⋆</div> </div> </div> </div> </span>. </td> </tr> <tr> <td>10. <a href="#t001fn001">*</a> </td> <td>Compute the generated, joint <i>T</i>-log( <i>P</i>) residual field as <span class="inline-formula" title="inline-formula"> <div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="msup_UNKNOWN"> <div class="mi_UNKNOWN">
x</div> <div class="mo_UNKNOWN">
⋆</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="mo_UNKNOWN">
=</div> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
∑</div> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
=</div> <div class="mn_UNKNOWN">
1</div> </div> <div class="mi_UNKNOWN">
N</div> </div> <div class="msubsup_UNKNOWN"> <div class="mi_UNKNOWN">
ϕ</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
⋆</div> </div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="msub_UNKNOWN"> <div class="mover_UNKNOWN"> <div class="mi_UNKNOWN">
x</div> <div class="mo_UNKNOWN">
^</div> </div> <div class="mi_UNKNOWN">
i</div> </div> </div> </div> </div> </span>. </td> </tr> <tr> <td>11.</td> <td>Map the generated ( <i>T</i> or log( <i>P</i>)) residuals in each grid cell back to the native ( <i>T</i> or log( <i>P</i>)) distribution of that grid cell. </td> </tr> <tr> <td>12. <a href="#t001fn001">*</a> </td> <td>Add to the respective <i>T</i> or log( <i>P</i>) mean field to create the generated full fields for <i>T</i> and log( <i>P</i>). </td> </tr> <tr> <td>13.</td> <td>Take the exponential of the generated log( <i>P</i>) full fields to produce generated full fields of precipitation. </td> </tr> </tbody> </table> </div> <div class="table-wrap-foot_UNKNOWN"> <div class="fn-type-" title=""> <p>* Denotes a step shared with <tt>fldgen v1.0</tt> and detailed in Paper LS1. The only differences in shared steps between version 1.0 and 2.0 are that the same step is applied to log( <i>P</i>) in addition to <i>T</i> in version 2.0. </p> </div> </div> </div> <p>The <tt>fldgen</tt> process, for both version 1.0 and 2.0, operates on a state vector, <b>x</b>( <b>t</b>). At any given time <i>t</i>, the state of the system is defined as the temperature residuals in every grid cell (flattened to one dimensional indices from the traditional latitude-longitude two dimensions), concatenated with the precipitation residuals in every grid cell if applicable (flattened to the same one dimensional spatial indices). Therefore, once the issues of non-normality are accounted for in the extension to version 1.0, cross-variable relationships are automatically captured and joint emulation is achieved. </p> <p>We have developed a continuous, invertible, and strictly increasing transformation method that allows us to map between the native distributions of residuals for each grid cell and a normal distribution of residuals for each grid cell. This transformation removes the need for user expertise as to whether residuals in every grid cell follow a distribution sufficiently close to a normal distribution for the field generating method outlined in Paper LS1 to work. </p> <p>For a given grid cell, the native distribution of residuals (temperature or precipitation) over time can be captured with an empirical cumulative distribution function (CDF), <i>F</i>( <i>x</i>) ( <a href="#pone.0223542.g003">Fig 3</a>, left), which can then be used to return the quantile values corresponding to sampled residuals, <i>F</i>( <i>residual</i> <sub> <i>i</i> </sub>) = <i>quantile</i> <sub> <i>i</i> </sub>. These sampled quantile values are used to calculate the corresponding values sampled from the standard normal distribution, <i>N</i>(0, 1) (step 4 of the <tt>fldgen v2.0</tt> algorithm summary in <a href="#pone.0223542.t001">Table 1</a>). Composing these steps leads to an increasing, continuous, invertible mapping between the native distribution of residuals in the grid cell and <i>N</i>(0, 1) ( <a href="#pone.0223542.g003">Fig 3</a>, right), represented by arrow 2 of <a href="#pone.0223542.g001">Fig 1</a>. </p> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/10.1371/journal.pone.0223542.g003"> <span class="label" tagx="label" title="label">Fig 3</span> </a> </div>   <div class="title" tagx="title" title="title">
The constructed transformation from data’s native distribution to a normal distribution.</div> <p>Left: The empirical CDF of log(precipitation) residuals in the same grid cell as <a href="#pone.0223542.g002">Fig 2</a> (black) and the CDF of a normal distribution with the same mean and variance as the log(precipitation) residuals (red). Right: The transformation between native and normally distributed residuals for this example grid cell. Note that this transformation is continuous, invertible, and strictly increasing. </p>   </div> <p>Given a set of generated residuals that follow <i>N</i>(0, 1) for a single grid cell, mapping to the native distribution of residuals in the grid cell is a straightforward reversal of this process (captured in arrow 4 in <a href="#pone.0223542.g001">Fig 1</a>). </p> <p>This mapping is applied to input, native residuals to create normally distributed residuals for emulator training (arrow 2 in <a href="#pone.0223542.g001">Fig 1</a>). The inverse of this mapping is applied to transform the generated, and therefore normally distributed, residuals for a grid cell back to the native, non-normal distribution initially sampled in <b>R</b> (arrow 4 in <a href="#pone.0223542.g001">Fig 1</a>). Further, because the mapping is continuous, invertible, and increasing, the rank-order correlation coefficient between residuals in two arbitrary grid cells is the same in the native distribution space as it is in the normal distribution. Combining this with the fact that the <tt>fldgen</tt> process generates new, normally distributed field of residuals (arrow 2 in <a href="#pone.0223542.g001">Fig 1</a>), we conclude that the rank-order correlation between input native values in different grid cells is the same as the rank-order correlation between between generated native values. </p> </div> <div class="conclusions" title="conclusions"> <div class="title" tagx="title" title="title">
Conclusions</div> <p> <tt>Fldgen v2.0</tt> provides a tool for climate change impacts modelers to rigorously analyze the impacts of extreme events that previously could not be fully evaluated due to limited ESM realizations and region-to-region teleconnections that are not explicitly known globally, such as multi-year droughts across different regions. With the mathematical construction described in the previous section and summarized in <a href="#pone.0223542.g003">Fig 3</a> (right), when the full workflow depicted in <a href="#pone.0223542.g001">Fig 1</a> is completed, the algorithm can be run on any input ESM residuals, provided their distribution in each grid cell is continuous and invertible. An emulator trained on these residuals can be used to generate new ESM residual time series that preserve all the same statistical properties preserved by version 1, with one small exception, viz. that in Property 2 the type of correlation preserved is the rank-order correlation, not necessarily the linear correlation coefficient. This change is a consequence of allowing arbitrary native distributions in the data. Additionally, the residual fields generated this way also preserve the inter-variable correlations present in the input data, a new property with no analog in version 1. </p> <p>These generated residual time series are added to the mean fields for temperature and log(precipitation) to generate new full field time series. The transformation of the full field log(precipitation) time series values to precipitation values does not undo any of these statistical properties of the residual fields. </p> </div> <div class="validation:exampledataandautomatedtesting" title="sec"> <div class="title" tagx="title" title="title">
Validation: Example data and automated testing</div> <p>Extensive integrated, automatic testing is provided in the <tt>fldgen v2.0</tt> R package to both check that the software performs as intended and to explicitly validate that the statistical properties of interest for included example ESM data ( <tt>fldgen/inst/extdata</tt>) are indeed preserved in generated realizations. This explicit validation supplements mathematical proofs that the method being implemented in <tt>fldgen v2.0</tt> has the described statistical preservation properties (further described and verified in Paper LS1). </p> <p>The testing is automatically run when a Pull Request is opened in the <tt>fldgen</tt> GitHub repository and must be passed before the pull request can be merged. All checks were passed for the version of <tt>fldgen</tt> presented in this paper. </p> <p>While it mathematically follows from the construction of this method that the rank-correlation coefficient is the same in generated data as it was in the training ESM data for every pairwise possibility of grid cell to grid cell comparison of temperature with temperature, precipitation with precipitation, and temperature with precipitation, we also performed an explicit check of of this using <tt>fldgen v2.0</tt> emulator training and realization generating capabilities. This explicit test is not included in the automated testing suite as it takes many hours of computer time. An example trained emulator with raw ESM data, R scripts performing this test and the results are archived on zenodo (DOI <a href="https://doi.org/10.5281/zenodo.3372579">10.5281/zenodo.3372579</a>) [ <a href="#pone.0223542.ref017">17</a>]. </p> </div> <div class="utilityandlimitations" title="sec"> <div class="title" tagx="title" title="title">
Utility and limitations</div> <p>The extension of <tt>fldgen</tt> from version 1.0 t0 version 2.0 has broadened the functionality from training using temperature data to joint training on temperature and precipitation by introducing a new algorithm for dealing with non-normality in the training data. Through this algorithm, any variable that scales with global mean temperature and whose residuals in each grid cell have a continuous, invertible, increasing empirical CDF could be jointly explored with temperature. Certainly this includes precipitation, but could easily be applied, as is, to variables such as relative humidity. Further, the version 1.0 requirement that input training data have approximately normally distributed residuals for the method to generate new residual fields with the correct spatiotemporal and cross-variable statistics has been removed. A user no longer has to judge whether their input training data is sufficiently close to normal to use <tt>fldgen</tt>. </p> <p>Perhaps the most significant current limitation of <tt>fldgen</tt> is that its training data and thus outputs are limited to the annual time scale, while many interesting climatological and biological processes occur at daily or monthly scales—e.g. with respect to human health [ <a href="#pone.0223542.ref018">18</a>]. An expansion to sub-annual timescales is planned in future work, but appropriately capturing sub-annual ESM internal variability while accounting for the inherent seasonal signals in sub-annual ESM data for many variables is highly non-trivial. </p> <p>A future extension to handle more than two variables jointly would also be straightforward by design. Thus there is wide potential for reuse of <tt>fldgen v2.0</tt> for users of ESM outputs who require a large number of ESM datasets for research. The open-source nature of the software makes it particularly adaptable to a community user’s needs in a wide variety of ways. </p> </div> <div class="installation" title="sec"> <div class="title" tagx="title" title="title">
Installation</div> <p> <tt>fldgen</tt> may be installed by using <tt>install_github</tt> from the <tt>devtools</tt> package. </p> <p>## install the package if needed</p> <p>devtools::install_github(‘JGCRI/fldgen’, ref = ‘v2.0.0 − rc.1’)</p> </div> <div class="trainingtheemulatorfromesmdata" title="sec"> <div class="title" tagx="title" title="title">
Training the emulator from ESM data</div> <p>As an open source R package, <tt>fldgen</tt> was implemented with a modular design so that different steps of the algorithm described in <a href="#pone.0223542.t001">Table 1</a> can easily have different implementations. Using the R packages <tt>devtools</tt> and <tt>roxygen2</tt>, extensive documentation for every function created in the package is included. More detail of each step in <a href="#pone.0223542.t001">Table 1</a> may be found in the tutorial vignettes included with the package ( <tt>fldgen/vignettes/</tt>) and as described in Paper LS1. This subsection briefly demonstrates the function calls required for training an emulator and generating new realizations. </p> <p>The user must select an ESM to emulate and provide annual, spatially disaggregated temperature and precipitation NetCDF files to be used for training. The <tt>fldgen</tt> package was designed with globally gridded data sets in mind, but would technically work with any spatial disaggregation. Currently, however, it is necessary that the training data be at an annual time scale. The training NetCDF files are most conveniently stored in some user-specified directory that can be passed directly to the <tt>fldgen</tt> training functions. Finally, all NetCDF files must follow CMIP5 naming conventions [ <a href="#pone.0223542.ref019">19</a>]. This is specified in the R manual and with informative error messages. <a href="#pone.0223542.t001">Table 1</a> (right column), Steps 1-7 are performed by the function <tt>trainTP()</tt> in <tt>/R/trainTP.R</tt>, which is called as follows: </p> <p>## load the package</p> <p>library(‘fldgen’)</p> <p>## specify the location of the training data</p> <p>datadir &amp;lt;- ‘training/data/directory’</p> <p>## train the emulator</p> <p>trainTP(dat = datadir,</p> <p>     tvarname = ‘tas’, tlatvar = ‘lat’, tlonvar = ‘lon’,</p> <p>     tvarconvert_fcn = NULL,</p> <p>     pvarname = ‘pr’, platvar = ‘lat’, plonvar = ‘on’,</p> <p>     pvarconvert_fcn = log) -&amp;gt;</p> <p>     emulator</p> <p>Full details of the functions used internally by <tt>trainTP()</tt> are provided in the <tt>fldgen</tt> package vignettes. </p> <div class="descriptionofinputs" title="sec"> <div class="title" tagx="title" title="title">
Description of inputs</div> <p>The inputs to <tt>fldgen</tt> function <tt>trainTP</tt> are as follows: </p> <ul> <li> <span class="label" tagx="label" title="label">dat</span> <p>A single directory name, or a list of NetCDF files. If a directory name is given, all NetCDF files in the directory will be used. The pairing of temperature and precipitation NetCDF files in the directory relies on the CMIP5 file naming conventions. Other naming conventions are not currently supported. </p> </li> <li> <span class="label" tagx="label" title="label">tvarname</span> <p>A string with the name of the temperature variable in the temperature NetCDF.</p> </li> <li> <span class="label" tagx="label" title="label">tlatvar</span> <p>A string with the name of the latitude coordinate variable in the temperature NetCDF files. Normally this is simply ‘lat’. </p> </li> <li> <span class="label" tagx="label" title="label">tlonvar</span> <p>A string with the name of the longitude coordinate variable in the temperature NetCDF files. Normally this is simply ‘lon’. </p> </li> <li> <span class="label" tagx="label" title="label">tvarconvert_fcn</span> <p>The function used to transform the temperature variable prior to training so that it has support on (−∞, ∞). Defaults to <tt>NULL</tt>, as temperature is effectively already supported on this range. </p> </li> <li> <span class="label" tagx="label" title="label">pvarname</span> <p>A string with the name of the temperature variable in the precipitation NetCDF.</p> </li> <li> <span class="label" tagx="label" title="label">platvar</span> <p>A string with the name of the latitude coordinate variable in the precipitation NetCDF files. Normally this is simply ‘lat’. </p> </li> <li> <span class="label" tagx="label" title="label">plonvar</span> <p>A string with the name of the longitude coordinate variable in the precipitation NetCDF files. Normally this is simply ‘lon’. </p> </li> <li> <span class="label" tagx="label" title="label">pvarconvert_fcn</span> <p>The function used to transform the precipitation variable prior to training so that it has support on (−∞, ∞). Defaults to <tt>log</tt>. </p> </li> </ul> </div> </div> <div class="structureofatrainedemulator" title="sec"> <div class="title" tagx="title" title="title">
Structure of a trained emulator</div> <p>A trained emulator can easily be stored as an R .rds object for later use. A trained emulator contains all information learned about the ESM, including components that are useful for downstream analysis, but not necessary for generating new fields of residuals: </p> <ul> <li> <p> <b>griddataT</b>: Input training temperature data, the contents of NetCDF files in <tt>datadir</tt> and an entry for the <tt>tvarconvert_fcn</tt>. If the temperature data has been transformed with the input argument <tt>tvarconvert_fcn</tt> to <tt>trainTP()</tt>, this also includes the transformed variable data in addition to the raw variable data in the NetCDF file. The default is not to transform the temperature data ( <tt>tvarconvert_fcn = NULL</tt>). </p> </li> <li> <p> <b>griddataP</b>: Input training precipitation data, the contents of NetCDF files in <tt>datadir</tt> and an entry for the <tt>pvarconvert_fcn</tt>. If the precipitation data has been transformed with the input argument <tt>pvarconvert_fcn</tt> to <tt>trainTP()</tt>, this also includes the transformed variable data in addition to the raw variable data in the NetCDF file. The default is to transform the precipitation data ( <tt>pvarconvert_fcn = log</tt>). </p> </li> <li> <p> <b>tgav</b>: Global mean temperature for the grids in griddataT. </p> </li> <li> <p> <b>meanfldT</b>: The mean field analysis for temperature (Steps 2-3). </p><ul> <li> <p> <b>r</b>: The matrix of input temperature residuals in each grid cell, in their native distribution. </p> </li> <li> <p> <b>b</b> and <b>w</b>: the mean field coefficients for use in reconstructing the full temperature data. </p> </li> </ul> <p /> </li> <li> <p> <b>meanfldP</b>: Analogous to meanfldT, for precipitation. </p> </li> <li> <p> <b>tfuns</b>: The empirical characterization of native distributions of temperature residuals for each grid cell. </p><ul> <li> <p> <b>cdf</b>: A list of the empirical CDFs in each grid cell used to transform temperature residuals from the native distribution of the grid cell to <i>N</i>(0, 1). </p> </li> <li> <p> <b>quants</b>: A list of the empirical quantile functions (inverse CDF) in each grid cell used to transform generated temperature residuals from <i>N</i>(0, 1) to the native distribution for temperature residuals in each grid cell. </p> </li> </ul> <p /> </li> <li> <p> <b>pfuns</b>: Analogous to tfuns, for precipitation. </p> </li> <li> <p> <b>reof</b>: Follows the same format as the structure returned by <tt>stats::princomp()</tt>. The most important fields are: </p><ul> <li> <p> <b>rotation</b>: A matrix [2 * Ngrid x NEOF] containing orthogonal basis vectors for the residuals. Each column is a basis vector. The number of basis vectors, NEOF, will be less than or equal to the number of time slices in the input, Ntime. </p> </li> <li> <p> <b>x</b>: A matrix [Ntime x NEOF] containing the coordinates of the residuals in the coordinate system defined by the basis vectors. Each row is a time slice. Thus <span class="inline-formula" title="inline-formula"> </span></p><div class="alternatives" title="alternatives"> <div class="graphic_UNKNOWN" /> <div class="math_UNKNOWN"> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
r</div> <div class="mi_UNKNOWN">
e</div> <div class="mi_UNKNOWN">
s</div> <div class="mi_UNKNOWN">
i</div> <div class="mi_UNKNOWN">
d</div> <div class="mi_UNKNOWN">
u</div> <div class="mi_UNKNOWN">
a</div> <div class="mi_UNKNOWN">
l</div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
(</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
)</div> </div> <div class="mo_UNKNOWN">
=</div> <div class="msubsup_UNKNOWN"> <div class="mo_UNKNOWN">
∑</div> <div class="mrow_UNKNOWN"> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
=</div> <div class="mn_UNKNOWN">
1</div> </div> <div class="mi_UNKNOWN">
N</div> </div> <div class="mi_UNKNOWN">
x</div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
[</div> <div class="mi_UNKNOWN">
t</div> <div class="mo_UNKNOWN">
,</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
]</div> </div> <div class="mo_UNKNOWN">
*</div> <div class="mi_UNKNOWN">
r</div> <div class="mi_UNKNOWN">
o</div> <div class="mi_UNKNOWN">
t</div> <div class="mi_UNKNOWN">
a</div> <div class="mi_UNKNOWN">
t</div> <div class="mi_UNKNOWN">
i</div> <div class="mi_UNKNOWN">
o</div> <div class="mi_UNKNOWN">
n</div> <div class="mrow_UNKNOWN"> <div class="mo_UNKNOWN">
[</div> <div class="mo_UNKNOWN">
:</div> <div class="mo_UNKNOWN">
,</div> <div class="mi_UNKNOWN">
i</div> <div class="mo_UNKNOWN">
]</div> </div> </div> </div> </div> . <p /> </li> </ul> <p /> </li> <li> <p> <b>fxmag</b>: The magnitude of the Fourier transform of the EOF projection coefficients. This should be a matrix [Ntime x NEOF] </p> </li> <li> <p> <b>fxphase</b>: List of matrices [Ntime x NEOF] of phases of the Fourier transform. There should be one element in the list for each input ESM run. </p> </li> <li> <p> <b>infiles</b>: Names of input files used to construct the data. </p> </li> </ul> </div> <div class="generatingnewrealizations" title="sec"> <div class="title" tagx="title" title="title">
Generating new realizations</div> <p>From a trained <tt>emulator</tt>, new residuals are generated ( <a href="#pone.0223542.t001">Table 1</a>, right column, Steps 9-11) by <tt>generate.TP.resids()</tt>, which calls the <tt>fldgen</tt> functions <tt>mkcorrts()</tt>, <tt>reconst_fields()</tt>, and <tt>unnormalize.resids()</tt>. </p> <p>## Set RNG seed if reproducible results desired:</p> <p>set.seed (11)</p> <p>## Generate new residuals</p> <p>residgrids &amp;lt;- generate.TP.resids (emulator, ngen = 5)</p> <p>The function <tt>generate.TP.resids()</tt> returns an R list of new residual matrices. Each of the <tt>ngen</tt> entries in the list is a new realization: a matrix that is [Ntime x 2 * Ngrid]. The first 1:Ngrid columns of each residual matrix are the temperature residuals and columns (Ngrid + 1):(2*Ngrid) are the precipitation residuals. These generated fields can be reshaped, plotted, analyzed, saved, etc. in whatever way a user desires. With the default inputs to <tt>trainTP()</tt> of <tt>tvarconvert_fcn = NULL</tt> and <tt>pvarconvert_fcn = log</tt>, these are residuals in (temperature, log(precipitation) space. </p> <p>From a trained <tt>emulator</tt> and generated new residual fields, <tt>residgrids</tt>, new full fields for temperature and precipitation are generated ( <a href="#pone.0223542.t001">Table 1</a>, right column, Steps 12-13) by <tt>generate.TP.fullgrids()</tt>. </p> <p>generate.TP.fullgrids(emulator, residgrids, tgav = tgav,</p> <p>         tvarunconvert_fcn = NULL,</p> <p>         pvarunconvert_fcn = exp,</p> <p>         reconstruction_function = pscl_apply) -&amp;gt;</p> <p>    fullgrids</p> </div> <div class="availability" title="sec"> <div class="title" tagx="title" title="title">
Availability</div> <div class="qualitycontrol" title="sec"> <div class="title" tagx="title" title="title">
Quality control</div> <p>Strict requirements for input files are documented. An example workflow for training an emulator and generating new residuals (using the commands outlined above) is included in the package. Using the R packages <tt>devtools</tt> and <tt>roxygen2</tt>, extensive documentation for every function created in <tt>fldgen</tt> is included. More detail of each step in <a href="#pone.0223542.t001">Table 1</a> may be found in the tutorial vignettes included with the package ( <tt>fldgen/vignettes/</tt>). Integrated testing (via the <tt>testthat</tt> R package and example NetCDF data included in <tt>fldgen/inst/extdata</tt>) is included and may be run with <tt>devtools::test()</tt>. The full suite of integrated tests is invoked in addition to a battery of standardized R checks with <tt>devtools::check()</tt>. </p> </div> <div class="systemrequirements" title="sec"> <div class="title" tagx="title" title="title">
System requirements</div> <p> <tt>fldgen</tt> has been tested successfully on Linux (64-bit), Windows 7 and Mac OS X. </p> <p> <tt>fldgen</tt> uses multiple enormous global gridded datasets for emulator training. Therefore, a minimum memory size of 8GB is necessary, and 16GB is recommended. Memory capacity determines how fast the code is able to run, how many variables <tt>fldgen</tt> is able to analyze the joint properties for, how many scenarios <tt>fldgen</tt> may train on, and how many generated fields may be held in memory. </p> </div> <div class="programminglanguage" title="sec"> <div class="title" tagx="title" title="title">
Programming language</div> <p>R (≥ 3.3.3).</p> <div class="dependencies" title="sec"> <div class="title" tagx="title" title="title">
Dependencies</div> <p>Required dependencies include the R packages: assertthat (≥ 0.2.0), dplyr (≥ 0.7), tidyr (≥ 0.7.1), tibble (≥ 1.3.4), ggplot2 (≥ 2.2.1), scales (≥ 0.5.0), reshape2 (≥ 1.4.2), ncdf4 (≥ 1.16), rlang (≥ 0.1.2). </p> <p>Optional dependencies include the R packages: testthat, gcammaptools (≥ 0.4), covr, knitr, rmarkdown. </p> </div> </div> <div class="softwarelocation" title="sec"> <div class="title" tagx="title" title="title">
Software location</div> <div class="archive" title="sec"> <div class="title" tagx="title" title="title">
Archive</div> <p>Name: zenodo</p> <p>Persistent identifier: <a href="http://doi.org/10.5281/zenodo.2605386">http://doi.org/10.5281/zenodo.2605386</a> </p> <p>Licence: BSD 2-Clause</p> <p>Publisher: Robert Link</p> <p>Version published: v2.0.0 prerelease</p> <p>Date published: archive of prerelease published 25/03/2019</p> </div> <div class="coderepository" title="sec"> <div class="title" tagx="title" title="title">
Code repository</div> <p>Name: GitHub</p> <p>Identifier: <a href="https://github.com/JGCRI/fldgen/tree/v2.0.0-rc.1">https://github.com/JGCRI/fldgen/tree/v2.0.0-rc.1</a> </p> <p>Licence: BSD 2-Clause</p> <p>Date published: prerelease published 25/03/2019</p> </div> </div> </div> </div> <div class="back" title="back"> <div class="references">
References</div> <div tag="ref-list"> <ul> <div class="title" tagx="title" title="title">
References</div> <li tag="ref"> <a name="pone.0223542.ref001" /> <span class="label" tagx="label" title="label">1</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Diffenbaugh</span> <span class="given-names" tagx="given-names" title="given-names">NS</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Singh</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Mankin</span> <span class="given-names" tagx="given-names" title="given-names">JS</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Horton</span> <span class="given-names" tagx="given-names" title="given-names">DE</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Swain</span> <span class="given-names" tagx="given-names" title="given-names">DL</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Touma</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">Quantifying the influence of global warming on unprecedented extreme climate events</span>. <span class="source" tagx="source" title="source">Proceedings of the National Academy of Sciences</span>. <span class="year" tagx="year" title="year">2017</span>; <span class="volume" tagx="volume" title="volume">114</span>( <span class="issue" tagx="issue" title="issue">19</span>): <span class="fpage" tagx="fpage" title="fpage">4881</span>– <span class="lpage" tagx="lpage" title="lpage">4886</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1073/pnas.1618082114">10.1073/pnas.1618082114</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref002" /> <span class="label" tagx="label" title="label">2</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Trenberth</span> <span class="given-names" tagx="given-names" title="given-names">KE</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Fasullo</span> <span class="given-names" tagx="given-names" title="given-names">JT</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Shepherd</span> <span class="given-names" tagx="given-names" title="given-names">TG</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Attribution of climate extreme events</span>. <span class="source" tagx="source" title="source">Nature Climate Change</span>. <span class="year" tagx="year" title="year">2015</span>; <span class="volume" tagx="volume" title="volume">5</span>( <span class="issue" tagx="issue" title="issue">8</span>): <span class="fpage" tagx="fpage" title="fpage">725</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1038/nclimate2657">10.1038/nclimate2657</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref003" /> <span class="label" tagx="label" title="label">3</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Rosenzweig</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Elliott</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Deryng</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ruane</span> <span class="given-names" tagx="given-names" title="given-names">AC</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Müller</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Arneth</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">Assessing agricultural risks of climate change in the 21st century in a global gridded crop model intercomparison </span>. <span class="source" tagx="source" title="source">Proceedings of the National Academy of Sciences</span>. <span class="year" tagx="year" title="year">2014</span>; <span class="volume" tagx="volume" title="volume">111</span>( <span class="issue" tagx="issue" title="issue">9</span>): <span class="fpage" tagx="fpage" title="fpage">3268</span>– <span class="lpage" tagx="lpage" title="lpage">3273</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1073/pnas.1222463110">10.1073/pnas.1222463110</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref004" /> <span class="label" tagx="label" title="label">4</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Calvin</span> <span class="given-names" tagx="given-names" title="given-names">K</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Patel</span> <span class="given-names" tagx="given-names" title="given-names">P</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Clarke</span> <span class="given-names" tagx="given-names" title="given-names">L</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Asrar</span> <span class="given-names" tagx="given-names" title="given-names">G</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Bond-Lamberty</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Cui</span> <span class="given-names" tagx="given-names" title="given-names">RY</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">GCAM v5.1: representing the linkages between energy, water, land, climate, and economic systems </span>. <span class="source" tagx="source" title="source">Geoscientific Model Development</span>. <span class="year" tagx="year" title="year">2019</span>; <span class="volume" tagx="volume" title="volume">12</span>( <span class="issue" tagx="issue" title="issue">2</span>): <span class="fpage" tagx="fpage" title="fpage">677</span>– <span class="lpage" tagx="lpage" title="lpage">698</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.5194/gmd-12-677-2019">10.5194/gmd-12-677-2019</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref005" /> <span class="label" tagx="label" title="label">5</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Cui</span> <span class="given-names" tagx="given-names" title="given-names">RY</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Calvin</span> <span class="given-names" tagx="given-names" title="given-names">K</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Clarke</span> <span class="given-names" tagx="given-names" title="given-names">L</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hejazi</span> <span class="given-names" tagx="given-names" title="given-names">M</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kim</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kyle</span> <span class="given-names" tagx="given-names" title="given-names">P</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">Regional responses to future, demand-driven water scarcity</span>. <span class="source" tagx="source" title="source">Environmental Research Letters</span>. <span class="year" tagx="year" title="year">2018</span>; <span class="volume" tagx="volume" title="volume">13</span>( <span class="issue" tagx="issue" title="issue">9</span>): <span class="fpage" tagx="fpage" title="fpage">094006</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1088/1748-9326/aad8f7">10.1088/1748-9326/aad8f7</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref006" /> <span class="label" tagx="label" title="label">6</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Tebaldi</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Knutti</span> <span class="given-names" tagx="given-names" title="given-names">R</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Evaluating the accuracy of climate change pattern emulation for low warming targets</span>. <span class="source" tagx="source" title="source">Environmental Research Letters</span>. <span class="year" tagx="year" title="year">2018</span>; <span class="volume" tagx="volume" title="volume">13</span>( <span class="issue" tagx="issue" title="issue">5</span>): <span class="fpage" tagx="fpage" title="fpage">055006</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1088/1748-9326/aabef2">10.1088/1748-9326/aabef2</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref007" /> <span class="label" tagx="label" title="label">7</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Link</span> <span class="given-names" tagx="given-names" title="given-names">R</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Snyder</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Lynch</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hartin</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kravitz</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Bond-Lamberty</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Fldgen v1.0: An Emulator with Internal Variability and Space-Time Correlation for Earth System Models </span>. <span class="source" tagx="source" title="source">Geoscientific Model Development</span>. <span class="year" tagx="year" title="year">2018</span>;. </span> </li> <li tag="ref"> <a name="pone.0223542.ref008" /> <span class="label" tagx="label" title="label">8</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Castruccio</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Stein</span> <span class="given-names" tagx="given-names" title="given-names">M</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Global space-time models for climate ensembles</span>. <span class="source" tagx="source" title="source">The Annals of Applied Statistics</span>. <span class="year" tagx="year" title="year">2013</span>; <span class="volume" tagx="volume" title="volume">7</span>( <span class="issue" tagx="issue" title="issue">3</span>): <span class="fpage" tagx="fpage" title="fpage">1593</span>– <span class="lpage" tagx="lpage" title="lpage">1611</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1214/13-AOAS656">10.1214/13-AOAS656</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref009" /> <span class="label" tagx="label" title="label">9</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Osborn</span> <span class="given-names" tagx="given-names" title="given-names">TJ</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Wallace</span> <span class="given-names" tagx="given-names" title="given-names">CJ</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Harris</span> <span class="given-names" tagx="given-names" title="given-names">IC</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Melvin</span> <span class="given-names" tagx="given-names" title="given-names">TM</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Pattern scaling using ClimGen: monthly-resolution future climate scenarios including changes in the variability of precipitation </span>. <span class="source" tagx="source" title="source">Climatic Change</span>. <span class="year" tagx="year" title="year">2015</span>; p. <span class="fpage" tagx="fpage" title="fpage">1</span>– <span class="lpage" tagx="lpage" title="lpage">17</span>. </span> </li> <li tag="ref"> <a name="pone.0223542.ref010" /> <span class="label" tagx="label" title="label">10</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Alexeeff</span> <span class="given-names" tagx="given-names" title="given-names">SE</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Nychka</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Sain</span> <span class="given-names" tagx="given-names" title="given-names">SR</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Tebaldi</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Emulating mean patterns and variability of temperature across and within scenarios in anthropogenic climate change experiments </span>. <span class="source" tagx="source" title="source">Climatic Change</span>. <span class="year" tagx="year" title="year">2016</span>; </span> </li> <li tag="ref"> <a name="pone.0223542.ref011" /> <span class="label" tagx="label" title="label">11</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Pfahl</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">O’Gorman</span> <span class="given-names" tagx="given-names" title="given-names">PA</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Fischer</span> <span class="given-names" tagx="given-names" title="given-names">EM</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Understanding the regional pattern of projected future changes in extreme precipitation</span>. <span class="source" tagx="source" title="source">Nature Climate Change</span>. <span class="year" tagx="year" title="year">2017</span>; <span class="volume" tagx="volume" title="volume">7</span>( <span class="issue" tagx="issue" title="issue">6</span>): <span class="fpage" tagx="fpage" title="fpage">423</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1038/nclimate3287">10.1038/nclimate3287</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref012" /> <span class="label" tagx="label" title="label">12</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Wakeel</span> <span class="given-names" tagx="given-names" title="given-names">M</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Chen</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hayat</span> <span class="given-names" tagx="given-names" title="given-names">T</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Alsaedi</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ahmad</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Energy consumption for water use cycles in different countries: A review</span>. <span class="source" tagx="source" title="source">Applied Energy</span>. <span class="year" tagx="year" title="year">2016</span>; <span class="volume" tagx="volume" title="volume">178</span>: <span class="fpage" tagx="fpage" title="fpage">868</span>– <span class="lpage" tagx="lpage" title="lpage">885</span>. </span> </li> <li tag="ref"> <a name="pone.0223542.ref013" /> <span class="label" tagx="label" title="label">13</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Zscheischler</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Seneviratne</span> <span class="given-names" tagx="given-names" title="given-names">SI</span> </span>. <span class="mixed-article-title" title="mixed-article-title">Dependence of drivers affects risks associated with compound events</span>. <span class="source" tagx="source" title="source">Science advances</span>. <span class="year" tagx="year" title="year">2017</span>; <span class="volume" tagx="volume" title="volume">3</span>( <span class="issue" tagx="issue" title="issue">6</span>): <span class="fpage" tagx="fpage" title="fpage">e1700263</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1126/sciadv.1700263">10.1126/sciadv.1700263</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/28782010">28782010</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref014" /> <span class="label" tagx="label" title="label">14</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hejazi</span> <span class="given-names" tagx="given-names" title="given-names">MI</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Edmonds</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Clarke</span> <span class="given-names" tagx="given-names" title="given-names">L</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kyle</span> <span class="given-names" tagx="given-names" title="given-names">P</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Davies</span> <span class="given-names" tagx="given-names" title="given-names">E</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Chaturvedi</span> <span class="given-names" tagx="given-names" title="given-names">V</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">Integrated assessment of global water scarcity over the 21st century under multiple climate change mitigation policies </span>. <span class="source" tagx="source" title="source">Hydrology and Earth System Sciences</span>. <span class="year" tagx="year" title="year">2014</span>; <span class="volume" tagx="volume" title="volume">18</span>( <span class="issue" tagx="issue" title="issue">8</span>): <span class="fpage" tagx="fpage" title="fpage">2859</span>– <span class="lpage" tagx="lpage" title="lpage">2883</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.5194/hess-18-2859-2014">10.5194/hess-18-2859-2014</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref015" /> <span class="label" tagx="label" title="label">15</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kilsby</span> <span class="given-names" tagx="given-names" title="given-names">CG</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Jones</span> <span class="given-names" tagx="given-names" title="given-names">P</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Burton</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ford</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Fowler</span> <span class="given-names" tagx="given-names" title="given-names">HJ</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Harpham</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">A daily weather generator for use in climate change studies</span>. <span class="source" tagx="source" title="source">Environmental Modelling &amp;amp; Software</span>. <span class="year" tagx="year" title="year">2007</span>; <span class="volume" tagx="volume" title="volume">22</span>( <span class="issue" tagx="issue" title="issue">12</span>): <span class="fpage" tagx="fpage" title="fpage">1705</span>– <span class="lpage" tagx="lpage" title="lpage">1719</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1016/j.envsoft.2007.02.005">10.1016/j.envsoft.2007.02.005</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref016" /> <span class="label" tagx="label" title="label">16</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Champeney</span> <span class="given-names" tagx="given-names" title="given-names">DC</span> </span>. <span class="source" tagx="source" title="source">Fourier Transforms and Their Physical Applications</span>. <span class="publisher-loc" tagx="publisher-loc" title="publisher-loc">New York</span>: <span class="publisher-name" tagx="publisher-name" title="publisher-name">Academic Press</span>; <span class="year" tagx="year" title="year">1973</span>. </span> </li> <li tag="ref"> <a name="pone.0223542.ref017" /> <span class="label" tagx="label" title="label">17</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation">Snyder A. Rank Correlation Coefficient verification supplement to’Joint emulation of Earth System Model temperature-precipitation realizations with internal variability and space-time and cross-variable correlation: fldgen v2.0 software description’; Published: August 20, 2019. Available from: <span class="pub-id"> <a href="https://dx.doi.org/10.5281/zenodo.3372579">10.5281/zenodo.3372579</a> </span>. </span> </li> <li tag="ref"> <a name="pone.0223542.ref018" /> <span class="label" tagx="label" title="label">18</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Xu</span> <span class="given-names" tagx="given-names" title="given-names">L</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Stige</span> <span class="given-names" tagx="given-names" title="given-names">LC</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Chan</span> <span class="given-names" tagx="given-names" title="given-names">KS</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Zhou</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Yang</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Sang</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span>, <span class="etal" title="etal"> <i>et al.</i> </span> <span class="mixed-article-title" title="mixed-article-title">Climate variation drives dengue dynamics</span>. <span class="source" tagx="source" title="source">Proceedings of the National Academy of Sciences</span>. <span class="year" tagx="year" title="year">2017</span>; <span class="volume" tagx="volume" title="volume">114</span>( <span class="issue" tagx="issue" title="issue">1</span>): <span class="fpage" tagx="fpage" title="fpage">113</span>– <span class="lpage" tagx="lpage" title="lpage">118</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1073/pnas.1618558114">10.1073/pnas.1618558114</a> </span> </span> </li> <li tag="ref"> <a name="pone.0223542.ref019" /> <span class="label" tagx="label" title="label">19</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Taylor</span> <span class="given-names" tagx="given-names" title="given-names">KE</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Stouffer</span> <span class="given-names" tagx="given-names" title="given-names">RJ</span> </span>, <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Meehl</span> <span class="given-names" tagx="given-names" title="given-names">GA</span> </span>. <span class="mixed-article-title" title="mixed-article-title">An overview of CMIP5 and the experiment design</span>. <span class="source" tagx="source" title="source">Bulletin of the American Meteorological Society</span>. <span class="year" tagx="year" title="year">2012</span>; <span class="volume" tagx="volume" title="volume">93</span>( <span class="issue" tagx="issue" title="issue">4</span>): <span class="fpage" tagx="fpage" title="fpage">485</span>– <span class="lpage" tagx="lpage" title="lpage">498</span>. <span class="pub-id"> <a href="https://dx.doi.org/10.1175/BAMS-D-11-00094.1">10.1175/BAMS-D-11-00094.1</a> </span> </span> </li> </ul> </div> </div>  </body></html>