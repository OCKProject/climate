<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec5" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <p id="Par49" xmlns="http://www.w3.org/1999/xhtml">In order to investigate the evolution of the mutation rate under directional climate change scenarios, we designed a spatially implicit individual-based model (IBM) of a panmictic diploid population of a sexual species with non-overlapping generations experiencing directional climate change (a trend of the mean climatic variable such as temperature). Our model is based on two previous IBMs: Björklund et al. [
  <a ref-type="bibr" rid="CR25" href="#CR25">25</a>] for the simulation of environmental scenarios (including noise color) and the density dependence effect on fecundity; and Cobben et al. [
  <a ref-type="bibr" rid="CR15" href="#CR15">15</a>], for the simulation of explicit genetics on the inheritance of mutator and adaptation loci. The population was assumed to be geographically isolated, thus no migration was possible, such that the focus was on local adaptation. The mutation rate could evolve, and different scenarios of linkage disequilibrium and beneficial mutations were considered.
 </p>
 <sec id="Sec6" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Environment</div>
  <p id="Par50" xmlns="http://www.w3.org/1999/xhtml">The environment was stochastic and defined an optimum mean phenotype 
   <span class="italic">θ</span>
   <sub>
    <span class="italic">t</span>
   </sub> that moved at constant speed per generation. This environmental scenario has been considered best suit to investigate the effect of climate change [
   <a ref-type="bibr" rid="CR18" href="#CR18">18</a>, 
   <a ref-type="bibr" rid="CR26" href="#CR26">26</a>]. Thus, 
   <span class="italic">θ</span>
   <sub>
    <span class="italic">t</span>
   </sub> 
   <span class="italic">= θ</span>
   <sub>
    <span class="italic">0</span>
   </sub> 
   <span class="italic">+ η t</span> impose the directional climate trend, where 
   <span class="italic">θ</span>
   <sub>
    <span class="italic">0</span>
   </sub> 
   <span class="italic">= 0</span> was the initial environmental optimum (when 
   <span class="italic">t = 0</span>) and 
   <span class="italic">η</span>, the rate of environmental change. The parameter 
   <span class="italic">η</span> was changed to simulate different scenarios of environmental change (e.g., no change, slow, medium, rapid change).
  </p>
  <p id="Par51" xmlns="http://www.w3.org/1999/xhtml">Environmental stochasticity or noise color was implemented as follows: The parameter 
   <span class="italic">θ</span>
   <span class="sup">
    <span class="italic">*</span>
   </span>
   <sub>
    <span class="italic">t</span>
   </sub> 
   <span class="italic">= θ</span>
   <sub>
    <span class="italic">t</span>
   </sub> 
   <span class="italic">+ ϕ</span>
   <sub>
    <span class="italic">t</span>
   </sub>, was the realized environmental state with noise 
   <span class="italic">ϕ</span>
   <sub>
    <span class="italic">t</span>
   </sub> 
   <span class="italic">= αϕ</span>
   <sub>
    <span class="italic">t-1</span>
   </sub> 
   <span class="italic">+ βξ</span>
   <sub>
    <span class="italic">t</span>
   </sub>. The autocorrelation coefficient 
   <span class="italic">α</span> indicated the level of environmental correlation and therefore the noise color: 
   <span class="italic">− 1 &lt; α &lt; 0</span>, blue noise; 
   <span class="italic">α = 0</span>, white noise, and 
   <span class="italic">0 &lt; α &lt; 1</span>, red noise. Three scenarios of 
   <span class="italic">α</span> were considered, based on Björklund et al. [
   <a ref-type="bibr" rid="CR25" href="#CR25">25</a>]: blue noise (
   <span class="italic">α = − 0.7</span>); white noise (
   <span class="italic">α = 0</span>), and red noise (
   <span class="italic">α = 0.7</span>). The parameter 
   <span class="italic">β</span> determined the environmental variance, according to 
   <span class="italic">β = σ</span>
   <div id="IEq1" class="inline-formula">
    <div class="alternatives">
     <span id="M1" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$ \sqrt{1-{\alpha}^2} $$\end{document}</span>
     <div id="M2" display="inline" class="math">
      <div class="msqrt">
       <div class="mrow">
        <span class="mn">1</span>
        <span class="mo">−</span>
        <div class="msup">
         <span class="mi">α</span>
         <span class="mn">2</span>
        </div>
       </div>
      </div>
     </div>
     <span xlink:href="12862_2019_1494_Article_IEq1.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>, as in [
   <a ref-type="bibr" rid="CR27" href="#CR27">27</a>], where 
   <span class="italic">σ</span>
   <span class="sup">
    <span class="italic">2</span>
   </span> 
   <span class="italic">= 1</span> was the environmental variance. The parameter 
   <span class="italic">ξ</span>
   <sub>
    <span class="italic">t</span>
   </sub> was a random value, normally distributed with zero mean and unity of variance.
  </p>
 </sec>
 <sec id="Sec7" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Population dynamics</div>
  <p id="Par52" xmlns="http://www.w3.org/1999/xhtml">ndividuals in the population were characterized by the following traits: sex, stage (whether adult or juvenile), phenotype 
   <span class="italic">zi</span>, determined by the alleles at the adaptation locus, and a mutator locus whose alleles determine the genetic mutation rate. The phenotype and the mutator locus were considered evolving traits for the model. At the beginning of each simulation run, the population composed of 1000 individuals, at carrying capacity 
   <span class="italic">K</span>, was assumed to be locally adapted. Therefore the alleles coding for the phenotype were initialized randomly from a normal distribution centered in 
   <span class="italic">θ</span>
   <sub>
    <span class="italic">0</span>
   </sub> and variance 
   <span class="italic">V = VG / 2 L</span>, where 
   <span class="italic">VG</span> is the initial genetic variance present in the population, and 
   <span class="italic">L</span> the number of loci which was set to 1 for all runs in this study. The phenotype 
   <span class="italic">z</span> of individual 
   <span class="italic">i</span> was determined by additive effects of alleles at the adaptation locus. As in Cobben et al. [
   <a ref-type="bibr" rid="CR15" href="#CR15">15</a>] the mutation rate was given by 
   <span class="italic">μ = 10</span>
   <span class="sup">
    <span class="italic">-exp</span>
   </span>, where 
   <span class="italic">exp = (l</span>
   <sub>
    <span class="italic">m,1</span>
   </sub> 
   <span class="italic">+ l</span>
   <sub>
    <span class="italic">m,2</span>
   </sub>
   <span class="italic">) / 2</span>. The alleles at the mutator locus 
   <span class="italic">l</span>
   <sub>
    <span class="italic">m,1</span>
   </sub> and 
   <span class="italic">l</span>
   <sub>
    <span class="italic">m,2</span>
   </sub> were initialized randomly according to a discrete uniform distribution in range 
   <span class="italic">[2; 4]</span>. Therefore, the model’s initial conditions already incorporated intraspecific variation in the mutation rate between individuals in the population (initial mean mutation rate of 
   <span class="italic">10</span>
   <span class="sup">
    <span class="italic">− 3</span>
   </span>). Assuming initial intraspecific variation in the mutation rate facilitates its evolutionary dynamic and reduces an otherwise relatively high extinction risk during early simulation time.
  </p>
 </sec>
 <sec id="Sec8" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Degree of local adaptation</div>
  <p id="Par53" xmlns="http://www.w3.org/1999/xhtml">Each individual was tested on its ability for local adaptation given by the match of its phenotype 
   <span class="italic">zi</span> to the current environmental optimum 
   <span class="italic">θ</span>
   <span class="sup">
    <span class="italic">*</span>
   </span>
   <sub>
    <span class="italic">t</span>
   </sub>. Stabilizing selection was assumed according to: 
   <div id="Equa" class="disp-formula">
    <div class="alternatives">
     <span id="M3" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$ wi={e}^{\frac{-{\left( zi-{\theta}^{\ast }t\right)}^2}{2{\upgamma}^2}} $$\end{document}</span>
     <div id="M4" display="block" class="math">
      <span mathvariant="italic" class="mi">wi</span>
      <span class="mo">=</span>
      <div class="msup">
       <span class="mi">e</span>
       <div class="mfrac">
        <div class="mrow">
         <span class="mo">−</span>
         <div class="msup">
          <div close=")" open="(" class="mfenced">
           <div class="mrow">
            <span mathvariant="italic" class="mi">zi</span>
            <span class="mo">−</span>
            <div class="msup">
             <span class="mi">θ</span>
             <span class="mo">∗</span>
            </div>
            <span class="mi">t</span>
           </div>
          </div>
          <span class="mn">2</span>
         </div>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
         <div class="msup">
          <span mathvariant="normal" class="mi">γ</span>
          <span class="mn">2</span>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div xlink:href="12862_2019_1494_Article_Equa.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>
  </p>
  <p id="Par54" xmlns="http://www.w3.org/1999/xhtml">The variable 
   <span class="italic">wi</span> indicates the degree of local adaptation of individual 
   <span class="italic">i</span>, and 
   <span class="italic">γ</span>, the strength of selection, affected the width of the fitness function, and was set to 2.2. This means that individuals having a phenotype departing from the optimum in 
   <span class="italic">1SD</span> phenotypic units (
   <span class="italic">SD</span>: standard deviation) will have a fitness of 90% (relative to the maximum fitness) which would be moderate selection according to [
   <a ref-type="bibr" rid="CR25" href="#CR25">25</a>].
  </p>
 </sec>
 <sec id="Sec9" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Fecundity</div>
  <p id="Par55" xmlns="http://www.w3.org/1999/xhtml">The mating system was random mating, where females mated only once and males could repeat mating (lottery polygyny). The fecundity 
   <span class="italic">λ</span> of the reproductive couple was the sum of the scaled degree of local adaptation values 
   <span class="italic">w’i</span> after considering density dependence effects, as in Björklund et al. [
   <a ref-type="bibr" rid="CR25" href="#CR25">25</a>]: 
   <div id="Equb" class="disp-formula">
    <div class="alternatives">
     <span id="M5" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$ w^{\prime }i={wie}^{\left(1-\frac{N}{K}\right)} $$\end{document}</span>
     <div id="M6" display="block" class="math">
      <span class="mi">w</span>
      <span class="mo">′</span>
      <span class="mi">i</span>
      <span class="mo">=</span>
      <div class="msup">
       <span mathvariant="italic" class="mi">wie</span>
       <div close=")" open="(" class="mfenced">
        <div class="mrow">
         <span class="mn">1</span>
         <span class="mo">−</span>
         <div class="mfrac">
          <span class="mi">N</span>
          <span class="mi">K</span>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div xlink:href="12862_2019_1494_Article_Equb.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>where 
   <span class="italic">N</span> is the population size and 
   <span class="italic">K</span>, the carrying capacity. Each couple (partners 
   <span class="italic">i</span>,
   <span class="italic">j</span>) produced a number of offspring randomly drawn from a Poisson distribution with expectancy 
   <span class="italic">λ = w’i + w’j.</span>
  </p>
 </sec>
 <sec id="Sec10" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Inheritance</div>
  <p id="Par56" xmlns="http://www.w3.org/1999/xhtml">Two scenarios of recombination were considered: unlinked and complete linkage (Table 
   <a rid="Tab1" ref-type="table" href="#Tab1">1</a>). During the process of inheritance, allele values for each locus (adaptation locus and mutator locus) of the inherited haplotype were picked randomly from the corresponding parental locus (unlinked scenario). In complete linkage scenario, alleles at the mutator locus were linked and migrated together with the corresponding alleles at the adaptation locus. For comparison, we also implemented an intermediate linkage (probability of recombination 
   <span class="italic">pR = 0.5</span>). Then, mutations took place with probability 
   <span class="italic">μ</span> determined by the alleles at the mutator locus as explained above. In case that a mutation occurred, its effect for the adaptation locus was randomly drawn from a normal distribution with zero mean and variance equals to the variance of the distribution of fitness effect size of mutations, which was an input parameter [
   <a ref-type="bibr" rid="CR18" href="#CR18">18</a>]. The assumption of a Gaussian distribution is consistent with analysis of mutation effects [
   <a ref-type="bibr" rid="CR28" href="#CR28">28</a>, 
   <a ref-type="bibr" rid="CR29" href="#CR29">29</a>]. In the model, the mean 
   <span class="italic">x</span> of the distribution of mutation effect size could change according to the scenario of percentage of beneficial mutations (input parameter, Table 
   <a rid="Tab1" ref-type="table" href="#Tab1">1</a>). This applied for the adaptation locus only. This approach granted that beneficial mutations – mutations that pushed the trait in the direction of 
   <span class="italic">θ</span>
   <sub>
    <span class="italic">t</span>
   </sub> – actually occurred at different probabilities as shown in the distribution of mutations fitness effect size (Fig. 
   <a rid="Fig3" ref-type="fig" href="#Fig3">3</a>). This can be important since under scenarios of directional selection the common assumption in individual-based models of explicit genetics of symmetric distribution of beneficial and deleterious mutations can overestimate the amount of arising beneficial mutations (e.g., [
   <a ref-type="bibr" rid="CR12" href="#CR12">12</a>, 
   <a ref-type="bibr" rid="CR17" href="#CR17">17</a>]). In fact, the shifted distributions approximates the mutational effects according to the model of slightly deleterious mutations [
   <a ref-type="bibr" rid="CR16" href="#CR16">16</a>, 
   <a ref-type="bibr" rid="CR17" href="#CR17">17</a>], albeit mutational effects under this model often exhibit skewed distributions. When a mutation occurred at the mutator locus, its effect consisted in adding a value randomly drawn from [− 1, 0, 1] to the mutated allele. 
   <div id="Tab1" class="table-wrap">
    <span class="label">Table 1</span>
    <div class="caption">
     <p>Parameters values and description (values in parentheses were implemented to evaluate the robustness of outcomes)</p>
    </div>
    <table frame="hsides" rules="groups">
     <thead>
      <tr>
       <th>Parameter</th>
       <th>Value</th>
       <th>Description</th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <span class="italic">K</span>
       </td>
       <td>1000</td>
       <td>Carrying capacity</td>
      </tr>
      <tr>
       <td>
        <span class="italic">γ</span>
       </td>
       <td>2.2 (3.2)</td>
       <td>Strength of selection</td>
      </tr>
      <tr>
       <td>
        <span class="italic">σ</span>
        <span class="sup">
         <span class="italic">2</span>
        </span>
       </td>
       <td>1</td>
       <td>Variance of the stochastic environment</td>
      </tr>
      <tr>
       <td>
        <span class="italic">θ</span>
        <sub>
         <span class="italic">0</span>
        </sub>
       </td>
       <td>0</td>
       <td>Initial environmental optimum</td>
      </tr>
      <tr>
       <td>
        <span class="italic">η</span>
       </td>
       <td>0, 0.01, 0.02, 0.03, 0.04</td>
       <td>Rate of environmental change</td>
      </tr>
      <tr>
       <td>
        <span class="italic">z</span>
       </td>
       <td>Evolving trait</td>
       <td>Ecological phenotype</td>
      </tr>
      <tr>
       <td>
        <span class="italic">VG</span>
       </td>
       <td>0.2</td>
       <td>Initial genetic variance present in the population</td>
      </tr>
      <tr>
       <td>
        <span class="italic">L</span>
       </td>
       <td>Number of loci per evolving trait</td>
       <td>1</td>
      </tr>
      <tr>
       <td>
        <span class="italic">μ</span>
       </td>
       <td>Evolving trait, range [0; 1]</td>
       <td>Mutation rate</td>
      </tr>
      <tr>
       <td>
        <span class="italic">MV</span>
       </td>
       <td>0.2</td>
       <td>Variance of the distribution of mutations fitness effect size</td>
      </tr>
      <tr>
       <td>
        <span class="italic">bm</span>
       </td>
       <td>10, 25, 40, 50</td>
       <td>Percentage (%) of beneficial mutations</td>
      </tr>
      <tr>
       <td>
        <span class="italic">pR</span>
       </td>
       <td>0 (unlinked), (0.5), 1 (complete linkage),</td>
       <td>Probability of recombination</td>
      </tr>
      <tr>
       <td>
        <span class="italic">t</span>
       </td>
       <td>300</td>
       <td>Time limit per simulation, in generations. The last 200 generations were exposed to the treatment of directional climate change</td>
      </tr>
     </tbody>
    </table>
   </div>
   <div id="Fig3" class="fig">
    <span class="label">Fig. 3</span>
    <div class="caption">
     <p>Distribution of fitness effects of mutations according to different scenarios of percentage of beneficial mutations 
      <span class="italic">bm</span>. Beneficial mutations are shown in light grey color. Variance of the distribution 
      <span class="italic">MV = 0.1</span>
     </p>
    </div>
    <div xlink:href="12862_2019_1494_Fig3_HTML" id="MO3" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p id="Par57" xmlns="http://www.w3.org/1999/xhtml">After the process of inheritance, all adults died, and newborns took over the population (non-overlapping generations).</p>
 </sec>
 <sec id="Sec11" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Method for beneficial mutations</div>
  <p id="Par58" xmlns="http://www.w3.org/1999/xhtml">The mean 
   <span class="italic">x</span> of the distribution of mutation effect size was given by 
   <span class="italic">x = ε – y</span>
   <div id="IEq2" class="inline-formula">
    <div class="alternatives">
     <span id="M7" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$ \sqrt{MV} $$\end{document}</span>
     <div id="M8" display="inline" class="math">
      <div class="msqrt">
       <span mathvariant="italic" class="mi">MV</span>
      </div>
     </div>
     <span xlink:href="12862_2019_1494_Article_IEq2.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>, where 
   <span class="italic">ε = 0</span> was the Z-score cutting value between deleterious and beneficial mutations. The parameter 
   <span class="italic">MV</span> was the variance of the distribution, and 
   <span class="italic">y</span> was given by the quantile function of the normal distribution with probability 
   <span class="italic">p = 1 – q</span>. The parameter 
   <span class="italic">q</span> was the desired proportion of beneficial mutation (e.g., 0.25 for 25% scenario of beneficial mutations).
  </p>
 </sec>
 <sec id="Sec12" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Simulation experiments</div>
  <p id="Par59" xmlns="http://www.w3.org/1999/xhtml">To study the evolution of the mutation rate, different scenarios of rate of environmental change, stochastic noise color, probability of recombination, and percentage of beneficial mutations were implemented (Table 
   <a rid="Tab1" ref-type="table" href="#Tab1">1</a>). The scenarios of beneficial mutations were implemented only for the environmental conditions 
   <span class="italic">η &gt; 0</span> (directional climate change). For the stable environment (
   <span class="italic">η = 0</span>), the effect of mutations was drawn from a gaussian distribution centered in zero as it is commonly done in IBMs of explicit genetics [
   <a ref-type="bibr" rid="CR2" href="#CR2">2</a>, 
   <a ref-type="bibr" rid="CR4" href="#CR4">4</a>, 
   <a ref-type="bibr" rid="CR15" href="#CR15">15</a>] and acted as a control. Note that under directional environmental change, this is exactly our scenario of 50% beneficial mutations. Simulation experiments consisted of 200 replicates, lasting for 300 generations each: 100 generations of stable environment followed by 200 generations of treatment of directional climate change. Simulations were run under white stochastic environmental noise unless otherwise specified. The sequence of operations in the model were: update of the environmental optimum, degree of local adaptation, reproduction, mortality of adults, and update of phenotype of the new generation before repeating the loop. If extinctions occurred, the data was not used for the analysis.
  </p>
  <p id="Par60" xmlns="http://www.w3.org/1999/xhtml">The visualization of the data was done in r project v3.4.2 and the model was programmed in Netlogo v6.0.2.</p>
 </sec>
</sec>
