<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec8" sec-type="materials|methods" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Material and Methods</div>
 <sec id="Sec9" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Biotic Survey Data</div>
  <p id="Par28" xmlns="http://www.w3.org/1999/xhtml">Primary producers are of special importance in most ecosystems, since they fuel other trophic levels with energy and organic matter
   <span class="sup">
    <a ref-type="bibr" rid="CR81" href="#CR81">81</a>
   </span>. Herbivores, in turn, control how much of this energy is transferred to higher trophic levels and thereby define the ecological efficiency of ecosystems
   <span class="sup">
    <a ref-type="bibr" rid="CR82" href="#CR82">82</a>
   </span>. The distribution data of the brown alga 
   <span class="italic">Fucus</span> and its herbivore 
   <span class="italic">Idotea</span> were combined from different sources: benthos database of the Estonian Marine Institute, University of Tartu (
   <span ext-link-type="uri" xlink:href="http://loch.ness.sea.ee/gisservices2/liikideinfoportaal/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://loch.ness.sea.ee/gisservices2/liikideinfoportaal/</span>); the VELMU database, Finnish Environment Institute (
   <span ext-link-type="uri" xlink:href="http://www.ymparisto.fi/en-US/VELMU" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.ymparisto.fi/en-US/VELMU</span>); database of the Swedish national monitoring programme (
   <span ext-link-type="uri" xlink:href="http://sharkdata.se/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://sharkdata.se/</span>), benthic inventory data collected by AquaBiota (
   <span ext-link-type="uri" xlink:href="http://www.aquabiota.se/en/researchservices/inventories-using-underwater-video/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.aquabiota.se/en/researchservices/inventories-using-underwater-video/</span>)
   <span class="sup">
    <a ref-type="bibr" rid="CR83" href="#CR83">83</a>
   </span>, EurOBIS (
   <span ext-link-type="uri" xlink:href="http://www.eurobis.org/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.eurobis.org/</span>), EMODnet (
   <span ext-link-type="uri" xlink:href="http://www.emodnet-biology.eu/portal/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.emodnet-biology.eu/portal/</span>), and the HELCOM Red List dataset
   <span class="sup">
    <a ref-type="bibr" rid="CR84" href="#CR84">84</a>
   </span> (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>).
  </p>
  <p id="Par29" xmlns="http://www.w3.org/1999/xhtml">Altogether 6407 stations from coastal hard bottom habitats of the Baltic Sea, that had quantitative information for both benthic macroalgae and associated invertebrates, were selected for this study (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>). All this dataset had a uniform sampling and sample processing protocol developed for the HELCOM COMBINE programme
   <span class="sup">
    <a ref-type="bibr" rid="CR85" href="#CR85">85</a>
   </span>. The included stations were sampled from June to August between 2005 and 2015. At each sampling site quantitative samples of macroalgae and associated invertebrate communities were collected by a diver using a standard bottom frame (0.04 m
   <span class="sup">2</span>). Samples were sieved in the field on 0.25 mm mesh screens. The residues were stored at −20 °C and subsequent sorting and counting of species was performed in the laboratory using a stereomicroscope. The dry weight of algae was obtained after drying the individuals at 60 °C for 2 weeks. These quantitative data were complemented by information on species occurrence (the HELCOM Red List dataset) (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>).
  </p>
 </sec>
 <sec id="Sec10" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Modelled environmental variables</div>
  <p id="Par30" xmlns="http://www.w3.org/1999/xhtml">When assessing the effects of climate change on species distribution, ecological understanding is a prerequisite to select the environmental covariates to include in SDM. Therefore, care was taken to include the most relevant ecological variables in order to reach the best projections about the role of climate-driven effects on biotic patterns. When the selection is inadequate, a model may pick up irrelevant variables and its predictive power is low
   <span class="sup">
    <a ref-type="bibr" rid="CR86" href="#CR86">86</a>
   </span>. Earlier studies have shown that water salinity and temperature conditions are anticipated to shape the large scale patterns of benthic macrophyte and invertebrate species in the Baltic Sea area
   <span class="sup">
    <a ref-type="bibr" rid="CR87" href="#CR87">87</a>
   </span> and these same variables are also expected to change the most in the light of future climate change
   <span class="sup">
    <a ref-type="bibr" rid="CR38" href="#CR38">38</a>,
    <a ref-type="bibr" rid="CR88" href="#CR88">88</a>,
    <a ref-type="bibr" rid="CR89" href="#CR89">89</a>
   </span>.
  </p>
  <p id="Par31" xmlns="http://www.w3.org/1999/xhtml">Modelled temperature and salinity data were produced by the Swedish Meteorological and Hydrological Institute (SMHI) using the echam5/RCAO model run covering the whole Baltic Sea at a grid resolution of 2 NM
   <span class="sup">
    <a ref-type="bibr" rid="CR89" href="#CR89">89</a>
   </span>. In addition to current environmental data, the SMHI datasets had two scenarios for seasonal means: a reference for the years 1978–2007 and the climate scenario A1B for the years 2069–2098. The A1B climate scenario is a scenario proposed in the Special Report on Emissions Scenarios by the Intergovernmental Panel on Climate Change
   <span class="sup">
    <a ref-type="bibr" rid="CR90" href="#CR90">90</a>
   </span>. The A1 scenario group describes a future world of very rapid economic growth, global population that peaks in mid-century and declines after that, and the rapid introduction of new and more efficient technologies. A1B foresees a balance between energy sources, where the balanced energy consumption is defined as not relying too heavily on one particular energy source under the assumption that similar improvement rates apply to all energy supplies and end-use technologies. In our models we used averages of three summer months (June to August) to match our experimental design (see below). The current modelled salinity values were used to divide the Baltic Sea into three regions: entrance (dynamic area between the North and Baltic Seas; salinity &gt; 12), central (the Baltic Proper; salinity 5–12) and marginal regions of the Baltic Sea (inner gulfs; salinity &lt; 5) (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>). These three functionally different regions characterised by genetically distinct and different proportions of marine, brackish and freshwater species
   <span class="sup">
    <a ref-type="bibr" rid="CR66" href="#CR66">66</a>,
    <a ref-type="bibr" rid="CR91" href="#CR91">91</a>
   </span> were used to define the sites of collection of the experimental organisms and to formalize separate model domains for the spatial predictive modelling (see below) in order to account for the different responses of locally adapted or otherwise differentiated populations.
  </p>
  <p id="Par32" xmlns="http://www.w3.org/1999/xhtml">In addition to the SMHI data layers, depth data acquired from the Baltic Sea Bathymetry Database
   <span class="sup">
    <a ref-type="bibr" rid="CR92" href="#CR92">92</a>
   </span> were also used as a modeling input variable for 
   <span class="italic">Fucus</span>.
  </p>
 </sec>
 <sec id="Sec11" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Experimental procedures</div>
  <p id="Par33" xmlns="http://www.w3.org/1999/xhtml">We quantified the joint effect of salinity and temperature on growth of 
   <span class="italic">Fucus</span> and survival of 
   <span class="italic">Idotea</span> in experiments carried out at the Archipelago Sea Research Institute in Seili, SW Finland (60°14′N, 21°58′E) in 2014–2015 (for detailed descriptions of these experiments, see
   <span class="sup">
    <a ref-type="bibr" rid="CR49" href="#CR49">49</a>,
    <a ref-type="bibr" rid="CR50" href="#CR50">50</a>
   </span>). Experimental organisms were collected from multiple populations originating from three functionally different regions defined above (entrance, central and marginal) (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>). 
   <span class="italic">Fucus</span> was collected by snorkelling on hard bottom habitats at 0.5–2 m from June to July in 2014. To avoid sampling of close relatives we kept a minimum of 5 m distance between sampled algae. 
   <span class="italic">Idotea</span> was sampled from 
   <span class="italic">Fucus</span> algae at 1–3 m depth from May to June in 2015. In order to account for among-population variation in tolerance to environmental change, sampling sites were randomly chosen within each region to represent the distributional range of these species along the Baltic Sea salinity gradient.
  </p>
  <p id="Par34" xmlns="http://www.w3.org/1999/xhtml">The collected 
   <span class="italic">Fucus</span> and 
   <span class="italic">Idotea</span> were exposed to the current (1978–2007) and future (2069–2098) conditions of surface seawater salinity and temperature (average for the main reproductive period: June to August for 
   <span class="italic">Fucus</span> and June for 
   <span class="italic">Idotea</span>; Supplementary Table 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">2</a>), separately for the three studied regions of the Baltic Sea (Supplementary Fig. 
   <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a>)
   <span class="sup">
    <a ref-type="bibr" rid="CR89" href="#CR89">89</a>
   </span>. We used aquarium racks with a recirculating water system to provide the appropriate climatic conditions for each of the six treatment combinations of temperature and salinity (i.e. current and future scenario at entrance, central and marginal regions). We started the experiments by putting the organisms in the current conditions of their original region and then adjusted salinity and temperature to match those of the future projections (over the course of 24 h in 
   <span class="italic">Fucus</span> and 5 days in 
   <span class="italic">Idotea</span>).
  </p>
  <p id="Par35" xmlns="http://www.w3.org/1999/xhtml">Before deployment, 
   <span class="italic">Fucus</span> individuals were harvested for apical branches and then half of the apical fronds were exposed to current conditions and the other half to future conditions so that each individual could face both climatic conditions. The apical branches were randomly allocated to replicate 24 l aquaria, each aquarium having 24–35 algae. Within each condition and region we had 12 replicate aquaria, totaling to 72 aquaria and to 2079 algae. For 
   <span class="italic">Idotea</span>, we only used females as their response is more important for the population growth. 
   <span class="italic">Idotea</span> were deployed individually in cylindrical cages (length 11 cm, diametre 3.5 cm) inside the aquaria, to allow their monitoring individually. Within each condition and region we had three replicate 54 l aquaria, each aquarium having 30–45 individuals totaling to 468 
   <span class="italic">Idotea</span>. 
   <span class="italic">Idotea</span> were fed with 
   <span class="italic">Fucus</span> fresh tissue. We monitored the survival and ran the experiments until about a third of the intial number of individuals was left, 140 days for 
   <span class="italic">Fucus</span> and 55 days for 
   <span class="italic">Idotea</span>.
  </p>
  <p id="Par36" xmlns="http://www.w3.org/1999/xhtml">During the experiment the survival of 
   <span class="italic">Fucus</span> was checked on a weekly basis and an individual frond was considered as dead when the thallus showed over 90% of tissue necrosis. The biomass growth of 
   <span class="italic">Fucus</span> was measured as a difference in algal wet weight between the starting point and the last day of the experiment. The survival of 
   <span class="italic">Idotea</span> was monitored every two days.
  </p>
 </sec>
 <sec id="Sec12" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Modelling environmental responses of 
   <span class="italic">Fucus</span> and 
   <span class="italic">Idotea</span> and their tolerance to current climate change
  </div>
  <p id="Par37" xmlns="http://www.w3.org/1999/xhtml">We used hierarchical Bayesian models
   <span class="sup">
    <a ref-type="bibr" rid="CR93" href="#CR93">93</a>
   </span> and Gaussian processes
   <span class="sup">
    <a ref-type="bibr" rid="CR35" href="#CR35">35</a>,
    <a ref-type="bibr" rid="CR37" href="#CR37">37</a>
   </span> to study the spatial patterns of 
   <span class="italic">Fucus</span> and 
   <span class="italic">Idotea</span> under current and future climate conditions. A rationale for using these methods is that they provide tools to model biologically reasonable joint effects of salinity and temperature. Moreover, they allow us to combine 
   <span class="italic">a priori</span> biological knowledge with all the information in heterogenous distribution and experimental data as well as to produce posterior distributions from which uncertainty summaries can easily be extracted
   <span class="sup">
    <a ref-type="bibr" rid="CR94" href="#CR94">94</a>
   </span>. We can also explicitly model the spatial autocorrelation in the data not explainable by the covariates
   <span class="sup">
    <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
   </span>.
  </p>
  <sec id="Sec13" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">Fucus model</div>
   <p id="Par38" xmlns="http://www.w3.org/1999/xhtml">We denote the 
    <span class="italic">Fucus</span> observations by 
    <div id="IEq1" class="inline-formula">
     <div class="alternatives">
      <span id="M1" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${y}_{i}$$\end{document}</span>
      <div id="M2" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">y</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq1.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, where 
    <div id="IEq2" class="inline-formula">
     <div class="alternatives">
      <span id="M3" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${y}_{i}=\varnothing $$\end{document}</span>
      <div id="M4" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">y</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">∅</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq2.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> corresponds to the absence of 
    <span class="italic">Fucus</span> in the survey data and the death of 
    <span class="italic">Fucus</span> within the study period in the experimental data, and where 
    <div id="IEq3" class="inline-formula">
     <div class="alternatives">
      <span id="M5" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${y}_{i}\in {\mathbb{R}}$$\end{document}</span>
      <div id="M6" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">y</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">∈</span>
       <span class="mi">ℝ</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq3.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> corresponds to a logarithmic estimate of the biomass (survey data) or growth of 
    <span class="italic">Fucus</span> (experimental data), given it is present, in the 
    <div id="IEq4" class="inline-formula">
     <div class="alternatives">
      <span id="M7" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$i\,$$\end{document}</span>
      <div id="M8" class="math">
       <span class="mi">i</span>
       <span width=".25em" class="mspace"/>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq4.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>th observation. In order to cover both presence/absence and biomass or growth observations, we built a hurdle model so that
    <div id="Equ1" class="disp-formula">
     <span class="label">1</span>
     <div class="alternatives">
      <span id="M9" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$p({y}_{i}|{\pi }_{i},{\mu }_{i},{\tau }_{i}^{2})=\{\begin{array}{c}(1-{\pi }_{i})\\ {\pi }_{i}\times N({y}_{i}|{\mu }_{i},{\tau }_{i}^{2})\end{array}\begin{array}{c}\,\mathrm{if}\,{y}_{i}=\varnothing \\ \,\mathrm{if}\,{y}_{i}\in {\mathbb{R}},\end{array}$$\end{document}</span>
      <div id="M10" display="block" class="math">
       <span class="mi">p</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">y</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">|</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">π</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <div class="mrow">
        <span stretchy="true" class="mo">{</span>
        <div class="mrow">
         <div class="mtable">
          <div class="mtr">
           <div class="mtd">
            <div class="mrow">
             <span stretchy="true" class="mo">(</span>
             <div class="mrow">
              <span class="mn">1</span>
              <span class="mo">−</span>
              <div class="msub">
               <div class="mrow">
                <span class="mi">π</span>
               </div>
               <div class="mrow">
                <span class="mi">i</span>
               </div>
              </div>
             </div>
             <span stretchy="true" class="mo">)</span>
            </div>
           </div>
          </div>
          <div class="mtr">
           <div class="mtd">
            <div class="mrow">
             <div class="msub">
              <div class="mrow">
               <span class="mi">π</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">×</span>
             <span class="mi">N</span>
             <span stretchy="false" class="mo">(</span>
             <div class="msub">
              <div class="mrow">
               <span class="mi">y</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
             </div>
             <span stretchy="false" class="mo">|</span>
             <div class="msub">
              <div class="mrow">
               <span class="mi">μ</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">,</span>
             <div class="msubsup">
              <div class="mrow">
               <span class="mi">τ</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
              <div class="mrow">
               <span class="mn">2</span>
              </div>
             </div>
             <span stretchy="false" class="mo">)</span>
            </div>
           </div>
          </div>
         </div>
         <div class="mtable">
          <div class="mtr">
           <div class="mtd">
            <div class="mrow">
             <span width=".25em" class="mspace"/>
             <span class="mi">if</span>
             <span width=".25em" class="mspace"/>
             <div class="msub">
              <div class="mrow">
               <span class="mi">y</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">=</span>
             <span class="mi">∅</span>
            </div>
           </div>
          </div>
          <div class="mtr">
           <div class="mtd">
            <div class="mrow">
             <span width=".25em" class="mspace"/>
             <span class="mi">if</span>
             <span width=".25em" class="mspace"/>
             <div class="msub">
              <div class="mrow">
               <span class="mi">y</span>
              </div>
              <div class="mrow">
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">∈</span>
             <span class="mi">ℝ</span>
             <span class="mo">,</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div xlink:href="41598_2018_38416_Article_Equ1.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>where 
    <div id="IEq5" class="inline-formula">
     <div class="alternatives">
      <span id="M11" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\pi }_{i}$$\end{document}</span>
      <div id="M12" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">π</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq5.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the probability of occurrence of 
    <span class="italic">Fucus</span> and 
    <div id="IEq6" class="inline-formula">
     <div class="alternatives">
      <span id="M13" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$N({y}_{i}|{\mu }_{i},{\tau }_{i}^{2})$$\end{document}</span>
      <div id="M14" class="math">
       <span class="mi">N</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">y</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">|</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq6.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the Gaussian probability density function with mean 
    <div id="IEq7" class="inline-formula">
     <div class="alternatives">
      <span id="M15" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mu }_{i}$$\end{document}</span>
      <div id="M16" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq7.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and variance 
    <div id="IEq8" class="inline-formula">
     <div class="alternatives">
      <span id="M17" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\tau }_{i}^{2}$$\end{document}</span>
      <div id="M18" class="math">
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq8.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. We used one variance parameter, 
    <div id="IEq9" class="inline-formula">
     <div class="alternatives">
      <span id="M19" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\tau }_{{\rm{exper}}}^{2}$$\end{document}</span>
      <div id="M20" class="math">
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">exper</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq9.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, for all experimental observations and another variance parameter, 
    <div id="IEq10" class="inline-formula">
     <div class="alternatives">
      <span id="M21" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\tau }_{{\rm{dist}}}^{2}$$\end{document}</span>
      <div id="M22" class="math">
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">dist</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq10.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, for all distribution observations. For ease of implementation we standardized both data to have zero mean and standard deviation of one before estimating the model parameters. Since we follow the Bayesian approach we gave the variance parameters a prior distribution. We used a half Student-
    <span class="italic">t</span> distribution with mean zero and scale 1 which gives weak prior preference for small variances but allows also the data to be explained as pure noise.
   </p>
   <p id="Par39" xmlns="http://www.w3.org/1999/xhtml">In the case of distribution data, we modelled the mean of the Gaussian distribution, 
    <div id="IEq11" class="inline-formula">
     <div class="alternatives">
      <span id="M23" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mu }_{i},$$\end{document}</span>
      <div id="M24" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">,</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq11.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and the logarithm of the odds ratio of the occurrence probability, 
    <div id="IEq12" class="inline-formula">
     <div class="alternatives">
      <span id="M25" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${{\rm{logit}}}^{-1}({\pi }_{i})=\,\mathrm{log}(\frac{{\pi }_{i}}{1-{\pi }_{i}})$$\end{document}</span>
      <div id="M26" class="math">
       <div class="msup">
        <div class="mrow">
         <span mathvariant="normal" class="mi">logit</span>
        </div>
        <div class="mrow">
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">π</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
       <span class="mo">=</span>
       <span width=".25em" class="mspace"/>
       <span class="mi">log</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="mfrac">
          <div class="mrow">
           <div class="msub">
            <div class="mrow">
             <span class="mi">π</span>
            </div>
            <div class="mrow">
             <span class="mi">i</span>
            </div>
           </div>
          </div>
          <div class="mrow">
           <span class="mn">1</span>
           <span class="mo">−</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">π</span>
            </div>
            <div class="mrow">
             <span class="mi">i</span>
            </div>
           </div>
          </div>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq12.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, as functions of salinity, temperature, depth and spatial location so that, e.g., 
    <div id="IEq13" class="inline-formula">
     <div class="alternatives">
      <span id="M27" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mu }_{i}=\alpha +{f}_{{\rm{ST}}}({x}_{{\rm{S}},i},{x}_{{\rm{T}},i})+{f}_{{\rm{D}}}({x}_{{\rm{D}},i})+{\rm{\varphi }}({s}_{i})$$\end{document}</span>
      <div id="M28" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">α</span>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">S</span>
           <span class="mo">,</span>
           <span class="mi">i</span>
          </div>
         </div>
         <span class="mo">,</span>
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">T</span>
           <span class="mo">,</span>
           <span class="mi">i</span>
          </div>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">D</span>
        </div>
       </div>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">D</span>
           <span class="mo">,</span>
           <span class="mi">i</span>
          </div>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">+</span>
       <span mathvariant="normal" class="mi">φ</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">s</span>
          </div>
          <div class="mrow">
           <span class="mi">i</span>
          </div>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq13.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. We will denote these additive models for 
    <div id="IEq14" class="inline-formula">
     <div class="alternatives">
      <span id="M29" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${{\rm{logit}}}^{-1}({\pi }_{i})$$\end{document}</span>
      <div id="M30" class="math">
       <div class="msup">
        <div class="mrow">
         <span mathvariant="normal" class="mi">logit</span>
        </div>
        <div class="mrow">
         <span class="mo">−</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">π</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq14.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and 
    <div id="IEq15" class="inline-formula">
     <div class="alternatives">
      <span id="M31" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mu }_{i}$$\end{document}</span>
      <div id="M32" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">μ</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq15.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> respectively as 
    <span class="italic">occurrence and biomass models</span>. Here,
    <div id="IEq16" class="inline-formula">
     <div class="alternatives">
      <span id="M33" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\,\alpha $$\end{document}</span>
      <div id="M34" class="math">
       <span width=".25em" class="mspace"/>
       <span class="mi">α</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq16.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the intercept, which was given a vague 
    <div id="IEq17" class="inline-formula">
     <div class="alternatives">
      <span id="M35" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$N(0,10)$$\end{document}</span>
      <div id="M36" class="math">
       <span class="mi">N</span>
       <span stretchy="false" class="mo">(</span>
       <span class="mn">0</span>
       <span class="mo">,</span>
       <span class="mn">10</span>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq17.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> prior, ϕ is the spatial random effect, 
    <div id="IEq18" class="inline-formula">
     <div class="alternatives">
      <span id="M37" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M38" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq18.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the response function along temperature, 
    <div id="IEq19" class="inline-formula">
     <div class="alternatives">
      <span id="M39" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${x}_{{\rm{T}}}$$\end{document}</span>
      <div id="M40" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">T</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq19.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, and salinity, 
    <div id="IEq20" class="inline-formula">
     <div class="alternatives">
      <span id="M41" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${x}_{{\rm{S}}}$$\end{document}</span>
      <div id="M42" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">S</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq20.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, and 
    <div id="IEq21" class="inline-formula">
     <div class="alternatives">
      <span id="M43" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{D}}}$$\end{document}</span>
      <div id="M44" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">D</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq21.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the response function along depth, 
    <div id="IEq22" class="inline-formula">
     <div class="alternatives">
      <span id="M45" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${x}_{{\rm{D}}}$$\end{document}</span>
      <div id="M46" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">D</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq22.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. The depth function accounts for different light, nutrient and wave force conditions in sampling sites and the spatial random effect accounts for spatially correlated overdispersion in the data, which causes nearby areas to have similar biomasses because of, for example, associations unexplained by the available covariates
    <span class="sup">
     <a ref-type="bibr" rid="CR5" href="#CR5">5</a>,
     <a ref-type="bibr" rid="CR6" href="#CR6">6</a>,
     <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
    </span>. The depth function and spatial random effect were set to zero for all experimental observations.
   </p>
   <p id="Par40" xmlns="http://www.w3.org/1999/xhtml">
    <span class="italic">Fucus</span> and 
    <span class="italic">Idotea</span> have a lower physical tolerance limit to salinity at around 4 and 3, respectively
    <span class="sup">
     <a ref-type="bibr" rid="CR41" href="#CR41">41</a>,
     <a ref-type="bibr" rid="CR95" href="#CR95">95</a>
    </span>; above these thresholds survival and growth rise and level-off at a saturation point
    <span class="sup">
     <a ref-type="bibr" rid="CR49" href="#CR49">49</a>,
     <a ref-type="bibr" rid="CR50" href="#CR50">50</a>,
     <a ref-type="bibr" rid="CR53" href="#CR53">53</a>
    </span>. Since 
    <span class="italic">Fucus</span> and 
    <span class="italic">Idotea</span> are boreal species and they do not like either too cold or warm environments
    <span class="sup">
     <a ref-type="bibr" rid="CR96" href="#CR96">96</a>
    </span> the response along temperature is positive at low temperatures and negative at large temperatures with optimal summer temperature at around 14–20 degrees
    <span class="sup">
     <a ref-type="bibr" rid="CR53" href="#CR53">53</a>,
     <a ref-type="bibr" rid="CR95" href="#CR95">95</a>
    </span>. However, the exact functional form of the responses is unknown and it is likely that temperature and salinity have also joint effects
    <span class="sup">
     <a ref-type="bibr" rid="CR47" href="#CR47">47</a>,
     <a ref-type="bibr" rid="CR48" href="#CR48">48</a>
    </span>. Hence, constructing a parametric model for the effects of salinity and temperature would be challenging. For this reason we modeled them using semi-parametric GP models. A GP is a stochastic process that defines probability distribution for functions. It is defined by a mean function and a covariance function, which determine the 
    <span class="italic">a priori</span> assumptions on properties of the process
    <span class="sup">
     <a ref-type="bibr" rid="CR97" href="#CR97">97</a>
    </span>; such as how large and how fast (smoothness) the responses along temperature and salinity are. The exact form of the response function is then estimated from the data by solving the posterior of the functions using the Bayes theorem
    <span class="sup">
     <a ref-type="bibr" rid="CR9" href="#CR9">9</a>,
     <a ref-type="bibr" rid="CR35" href="#CR35">35</a>,
     <a ref-type="bibr" rid="CR37" href="#CR37">37</a>
    </span>.
   </p>
   <p id="Par41" xmlns="http://www.w3.org/1999/xhtml">We gave the GP prior of 
    <div id="IEq23" class="inline-formula">
     <div class="alternatives">
      <span id="M47" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M48" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq23.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> zero mean and Gaussian covariance function
    <div id="Equa" class="disp-formula">
     <div class="alternatives">
      <span id="M49" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\begin{array}{c}{\rm{Cov}}({f}_{{\rm{ST}}}({x}_{{\rm{S}},i},{x}_{{\rm{T}},i}),\,{f}_{{\rm{ST}}}({x}_{{\rm{S}},j},\,{x}_{{\rm{T}},j}))={\sigma }_{{\rm{ST}}}^{2}{{\rm{e}}}^{-{r}_{ij}^{2}}\,{\rm{where}}\\ {r}_{ij}=\sqrt{{({x}_{{\rm{T}},i}-{x}_{{\rm{T}},j})}^{2}/{\lambda }_{{\rm{T}}}^{2}-{({x}_{{\rm{S}},i}-{x}_{{\rm{S}},j})}^{2}/{\lambda }_{{\rm{S}}}^{2}}\end{array}$$\end{document}</span>
      <div id="M50" display="block" class="math">
       <div columnalign="left" class="mtable">
        <div class="mtr">
         <div class="mtd">
          <span mathvariant="normal" class="mi">Cov</span>
          <div class="mrow">
           <span stretchy="true" class="mo">(</span>
           <div class="mrow">
            <div class="msub">
             <div class="mrow">
              <span class="mi">f</span>
             </div>
             <div class="mrow">
              <span mathvariant="normal" class="mi">ST</span>
             </div>
            </div>
            <div class="mrow">
             <span stretchy="true" class="mo">(</span>
             <div class="mrow">
              <div class="msub">
               <div class="mrow">
                <span class="mi">x</span>
               </div>
               <div class="mrow">
                <span mathvariant="normal" class="mi">S</span>
                <span class="mo">,</span>
                <span class="mi">i</span>
               </div>
              </div>
              <span class="mo">,</span>
              <div class="msub">
               <div class="mrow">
                <span class="mi">x</span>
               </div>
               <div class="mrow">
                <span mathvariant="normal" class="mi">T</span>
                <span class="mo">,</span>
                <span class="mi">i</span>
               </div>
              </div>
             </div>
             <span stretchy="true" class="mo">)</span>
            </div>
            <span class="mo">,</span>
            <span width=".25em" class="mspace"/>
            <div class="msub">
             <div class="mrow">
              <span class="mi">f</span>
             </div>
             <div class="mrow">
              <span mathvariant="normal" class="mi">ST</span>
             </div>
            </div>
            <div class="mrow">
             <span stretchy="true" class="mo">(</span>
             <div class="mrow">
              <div class="msub">
               <div class="mrow">
                <span class="mi">x</span>
               </div>
               <div class="mrow">
                <span mathvariant="normal" class="mi">S</span>
                <span class="mo">,</span>
                <span class="mi">j</span>
               </div>
              </div>
              <span class="mo">,</span>
              <span width=".25em" class="mspace"/>
              <div class="msub">
               <div class="mrow">
                <span class="mi">x</span>
               </div>
               <div class="mrow">
                <span mathvariant="normal" class="mi">T</span>
                <span class="mo">,</span>
                <span class="mi">j</span>
               </div>
              </div>
             </div>
             <span stretchy="true" class="mo">)</span>
            </div>
           </div>
           <span stretchy="true" class="mo">)</span>
          </div>
          <span class="mo">=</span>
          <div class="msubsup">
           <div class="mrow">
            <span class="mi">σ</span>
           </div>
           <div class="mrow">
            <span mathvariant="normal" class="mi">ST</span>
           </div>
           <div class="mrow">
            <span class="mn">2</span>
           </div>
          </div>
          <div class="msup">
           <div class="mrow">
            <span mathvariant="normal" class="mi">e</span>
           </div>
           <div class="mrow">
            <span class="mo">−</span>
            <div class="msubsup">
             <div class="mrow">
              <span class="mi">r</span>
             </div>
             <div class="mrow">
              <span class="mi">i</span>
              <span class="mi">j</span>
             </div>
             <div class="mrow">
              <span class="mn">2</span>
             </div>
            </div>
           </div>
          </div>
          <span width=".25em" class="mspace"/>
          <span mathvariant="normal" class="mi">where</span>
         </div>
        </div>
        <div class="mtr">
         <div class="mtd">
          <div class="msub">
           <div class="mrow">
            <span class="mi">r</span>
           </div>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mi">j</span>
           </div>
          </div>
          <span class="mo">=</span>
          <div class="msqrt">
           <div class="mrow">
            <div class="msup">
             <div class="mrow">
              <span stretchy="true" class="mo">(</span>
              <div class="mrow">
               <div class="msub">
                <div class="mrow">
                 <span class="mi">x</span>
                </div>
                <div class="mrow">
                 <span mathvariant="normal" class="mi">T</span>
                 <span class="mo">,</span>
                 <span class="mi">i</span>
                </div>
               </div>
               <span class="mo">−</span>
               <div class="msub">
                <div class="mrow">
                 <span class="mi">x</span>
                </div>
                <div class="mrow">
                 <span mathvariant="normal" class="mi">T</span>
                 <span class="mo">,</span>
                 <span class="mi">j</span>
                </div>
               </div>
              </div>
              <span stretchy="true" class="mo">)</span>
             </div>
             <span class="mn">2</span>
            </div>
            <span class="mo">/</span>
            <div class="msubsup">
             <div class="mrow">
              <span class="mi">λ</span>
             </div>
             <div class="mrow">
              <span mathvariant="normal" class="mi">T</span>
             </div>
             <div class="mrow">
              <span class="mn">2</span>
             </div>
            </div>
            <span class="mo">−</span>
            <div class="msup">
             <div class="mrow">
              <span stretchy="true" class="mo">(</span>
              <div class="mrow">
               <div class="msub">
                <div class="mrow">
                 <span class="mi">x</span>
                </div>
                <div class="mrow">
                 <span mathvariant="normal" class="mi">S</span>
                 <span class="mo">,</span>
                 <span class="mi">i</span>
                </div>
               </div>
               <span class="mo">−</span>
               <div class="msub">
                <div class="mrow">
                 <span class="mi">x</span>
                </div>
                <div class="mrow">
                 <span mathvariant="normal" class="mi">S</span>
                 <span class="mo">,</span>
                 <span class="mi">j</span>
                </div>
               </div>
              </div>
              <span stretchy="true" class="mo">)</span>
             </div>
             <span class="mn">2</span>
            </div>
            <span class="mo">/</span>
            <div class="msubsup">
             <div class="mrow">
              <span class="mi">λ</span>
             </div>
             <div class="mrow">
              <span mathvariant="normal" class="mi">S</span>
             </div>
             <div class="mrow">
              <span class="mn">2</span>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div xlink:href="41598_2018_38416_Article_Equa.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>is the scaled Euclidean distance between salinity-temperature locations, 
    <div id="IEq24" class="inline-formula">
     <div class="alternatives">
      <span id="M51" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\sigma }_{{\rm{ST}}}^{2}$$\end{document}</span>
      <div id="M52" class="math">
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq24.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the variance parameter governing the magnitude of the effect and 
    <div id="IEq25" class="inline-formula">
     <div class="alternatives">
      <span id="M53" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\lambda $$\end{document}</span>
      <div id="M54" class="math">
       <span class="mi">λ</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq25.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> are the length-scale parameters that govern the smoothness of responses along temperature and salinity. The variance and length-scale parameters were estimated so we gave priors for them. We used a half Studen
    <span class="italic">t</span>-
    <span class="italic">t</span> distribution with mean zero and scale one for 
    <div id="IEq26" class="inline-formula">
     <div class="alternatives">
      <span id="M55" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\sigma }_{{\rm{ST}}}$$\end{document}</span>
      <div id="M56" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq26.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> which gives equal prior weight to temperature-salinity effect as to the random variation in (1). In order to avoid too flexible response functions the length-scales should be of the same order of magnitude as the range of covariates
    <span class="sup">
     <a ref-type="bibr" rid="CR37" href="#CR37">37</a>
    </span>. The modeled salinity range is from 0 to 30 and the modeled temperature range is from 12 to 20 degrees. Hence, we gave the length-scales log-Gaussian prior distributions with location and scale parameters such that 90% of the prior probabilities were included within the salinity range 11–28 with median of 18 and the temperature range 5.5–13.5 degrees with median of 8.5 degrees. This ensures that the 
    <span class="italic">a priori</span> plausible functions can change rapidly but do not have many modes within the study limits (See Supplement). Moreover, in order to include the 
    <span class="italic">a priori</span> qualitative information that 
    <div id="IEq27" class="inline-formula">
     <div class="alternatives">
      <span id="M57" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M58" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq27.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> should be increasing with increasing salinities greater than 5, and that it should be decreasing with increasing temperatures above 20 degrees, we set constraints to the derivatives of 
    <div id="IEq28" class="inline-formula">
     <div class="alternatives">
      <span id="M59" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M60" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq28.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. These biologically realistic constraints were encoded into the model by virtual derivative observations
    <span class="sup">
     <a ref-type="bibr" rid="CR98" href="#CR98">98</a>
    </span>. We constructed two lattice grids, one that covered the modeled temperature range and salinities from 5 to 25 and another that covered the modeled salinity range at 24 degrees temperature. At the nodes of the former lattice we imposed positive derivative constraint along salinity by defining a probit likelihood function for the derivative of the latent function 
    <div id="IEq29" class="inline-formula">
     <div class="alternatives">
      <span id="M61" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\rm{\Phi }}(\partial {f}_{{\rm{ST}}}/\partial {x}_{S})$$\end{document}</span>
      <div id="M62" class="math">
       <span mathvariant="normal" class="mi">Φ</span>
       <span stretchy="false" class="mo">(</span>
       <span class="mi">∂</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
       <span class="mo">/</span>
       <span class="mi">∂</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span class="mi">S</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq29.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, where 
    <div id="IEq30" class="inline-formula">
     <div class="alternatives">
      <span id="M63" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\rm{\Phi }}(\,\cdot \,)$$\end{document}</span>
      <div id="M64" class="math">
       <span mathvariant="normal" class="mi">Φ</span>
       <span stretchy="false" class="mo">(</span>
       <span width="-.25em" class="mspace"/>
       <span class="mo">⋅</span>
       <span width="-.25em" class="mspace"/>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq30.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the standard Gaussian cumulative distribution function
    <span class="sup">
     <a ref-type="bibr" rid="CR98" href="#CR98">98</a>
    </span>. At the nodes of the latter lattice we imposed negative derivative constraint along temperature with likelihood 
    <div id="IEq31" class="inline-formula">
     <div class="alternatives">
      <span id="M65" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\rm{\Phi }}(\,-\,\partial {f}_{{\rm{ST}}}/\partial {x}_{{\rm{T}}})$$\end{document}</span>
      <div id="M66" class="math">
       <span mathvariant="normal" class="mi">Φ</span>
       <span stretchy="false" class="mo">(</span>
       <span width="-.25em" class="mspace"/>
       <span class="mo">−</span>
       <span width="-.25em" class="mspace"/>
       <span class="mi">∂</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
       <span class="mo">/</span>
       <span class="mi">∂</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">T</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq31.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. The resolution of the lattices was set so that they impose the monotonicity constraint with length-scales above their 
    <span class="italic">a priori</span> plausible values. See Supplementary Fig. 
    <a rid="MOESM1" ref-type="media" href="#MOESM1">2</a> for illustration.
   </p>
   <p id="Par42" xmlns="http://www.w3.org/1999/xhtml">We modeled also the effect of depth on 
    <span class="italic">Fucus</span> occurrence probability and biomass using a GP with zero mean and Gaussian covariance function. The spatial random effect was modeled with a spatial GP with zero mean and an exponential covariance function,
    <div id="Equb" class="disp-formula">
     <div class="alternatives">
      <span id="M67" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\rm{Cov}}({{\rm{\varphi }}}_{{\rm{\varphi }}}({s}_{i}),{{\rm{\varphi }}}_{{\rm{\varphi }}}({s}_{j}))={\sigma }_{{\rm{\varphi }}}^{2}{{\rm{e}}}^{-\sqrt{{\Sigma }_{d=1}^{2}{({s}_{d,i}-{s}_{d,j})}^{2}/{\lambda }_{{\rm{\varphi }}}^{2}}}.$$\end{document}</span>
      <div id="M68" display="block" class="math">
       <span mathvariant="normal" class="mi">Cov</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span mathvariant="normal" class="mi">φ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">φ</span>
          </div>
         </div>
         <div class="mrow">
          <span stretchy="true" class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <div class="mrow">
             <span class="mi">s</span>
            </div>
            <div class="mrow">
             <span class="mi">i</span>
            </div>
           </div>
          </div>
          <span stretchy="true" class="mo">)</span>
         </div>
         <span class="mo">,</span>
         <div class="msub">
          <div class="mrow">
           <span mathvariant="normal" class="mi">φ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">φ</span>
          </div>
         </div>
         <div class="mrow">
          <span stretchy="true" class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <div class="mrow">
             <span class="mi">s</span>
            </div>
            <div class="mrow">
             <span class="mi">j</span>
            </div>
           </div>
          </div>
          <span stretchy="true" class="mo">)</span>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">=</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">φ</span>
        </div>
        <div class="mrow">
         <span class="mn">2</span>
        </div>
       </div>
       <div class="msup">
        <div class="mrow">
         <span mathvariant="normal" class="mi">e</span>
        </div>
        <div class="mrow">
         <span class="mo">−</span>
         <div class="msqrt">
          <div class="mrow">
           <div class="msubsup">
            <div class="mrow">
             <span class="mi">Σ</span>
            </div>
            <div class="mrow">
             <span class="mi">d</span>
             <span class="mo">=</span>
             <span class="mi">1</span>
            </div>
            <div class="mrow">
             <span class="mn">2</span>
            </div>
           </div>
           <div class="msup">
            <div class="mrow">
             <span stretchy="true" class="mo">(</span>
             <div class="mrow">
              <div class="msub">
               <div class="mrow">
                <span class="mi">s</span>
               </div>
               <div class="mrow">
                <span class="mi">d</span>
                <span class="mo">,</span>
                <span class="mi">i</span>
               </div>
              </div>
              <span class="mo">−</span>
              <div class="msub">
               <div class="mrow">
                <span class="mi">s</span>
               </div>
               <div class="mrow">
                <span class="mi">d</span>
                <span class="mo">,</span>
                <span class="mi">j</span>
               </div>
              </div>
             </div>
             <span stretchy="true" class="mo">)</span>
            </div>
            <span class="mn">2</span>
           </div>
           <span class="mo">/</span>
           <div class="msubsup">
            <div class="mrow">
             <span class="mi">λ</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">φ</span>
            </div>
            <div class="mrow">
             <span class="mn">2</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
       <span class="mo">.</span>
      </div>
      <div xlink:href="41598_2018_38416_Article_Equb.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
   </p>
   <p id="Par43" xmlns="http://www.w3.org/1999/xhtml">We used again a half Student-
    <span class="italic">t</span> distribution with mean zero and scale one for the standard deviation parameters. In order to give more weight to smooth unimodal functions, the length-scale parameter of the depth effect was given a Gaussian prior with mean five meters and standard deviation 1. The inverse of the spatial length-scale was given a half Student-
    <span class="italic">t</span> prior which gives more weight to smooth spatial random effects and in the absence of spatial autocorrelation shrinks the spatial random effect to constant.
   </p>
  </sec>
  <sec id="Sec14" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">Idotea model</div>
   <p id="Par44" xmlns="http://www.w3.org/1999/xhtml">With 
    <span class="italic">Idotea</span> we analyzed only its occurrence probability. The occurrence models were otherwise the same as the occurrence models for 
    <span class="italic">Fucus</span> but the depth response function was replaced by the effect of 
    <span class="italic">Fucus</span> biomass, 
    <div id="IEq32" class="inline-formula">
     <div class="alternatives">
      <span id="M69" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${x}_{{\rm{F}}}$$\end{document}</span>
      <div id="M70" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq32.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>. 
    <span class="italic">Fucus</span> is amongst the most widespread habitat and food for 
    <span class="italic">Idotea</span> on hard bottoms (e.g.
    <span class="sup">
     <a ref-type="bibr" rid="CR54" href="#CR54">54</a>
    </span>). Hence, in the absence of 
    <span class="italic">Fucus</span> the probability of occurrence of 
    <span class="italic">Idotea</span> can be lower than in the presence of 
    <span class="italic">Fucus</span> and with elevating 
    <span class="italic">Fucus</span> biomass the probability is expected to increase to a threshold above where further changes are marginal. Hence, we modeled the effect of 
    <span class="italic">Fucus</span> biomass as a sum of delta and Michaelis-Menten (type II,
    <span class="sup">
     <a ref-type="bibr" rid="CR99" href="#CR99">99</a>
    </span> functions 
    <div id="IEq33" class="inline-formula">
     <div class="alternatives">
      <span id="M71" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{F}}}({x}_{{\rm{F}}})={\alpha }_{{\rm{F}}}\delta ({x}_{{\rm{F}}} &gt; 0)+{\beta }_{{\rm{F}}}{x}_{{\rm{F}}}/({c}_{{\rm{F}}}+{x}_{{\rm{F}}})$$\end{document}</span>
      <div id="M72" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">F</span>
          </div>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">=</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">α</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <span class="mi">δ</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">F</span>
          </div>
         </div>
         <span class="mo">&gt;</span>
         <span class="mn">0</span>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">β</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <span class="mo">/</span>
       <span stretchy="false" class="mo">(</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">c</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq33.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, where 
    <div id="IEq34" class="inline-formula">
     <div class="alternatives">
      <span id="M73" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\delta ({x}_{{\rm{F}}} &gt; 0)$$\end{document}</span>
      <div id="M74" class="math">
       <span class="mi">δ</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">x</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">F</span>
          </div>
         </div>
         <span class="mo">&gt;</span>
         <span class="mn">0</span>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq34.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is a delta function that is one if 
    <div id="IEq35" class="inline-formula">
     <div class="alternatives">
      <span id="M75" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${x}_{{\rm{F}}} &gt; 0$$\end{document}</span>
      <div id="M76" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">x</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
       <span class="mo">&gt;</span>
       <span class="mn">0</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq35.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and zero otherwise, and 
    <div id="IEq36" class="inline-formula">
     <div class="alternatives">
      <span id="M77" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\alpha }_{{\rm{F}}}$$\end{document}</span>
      <div id="M78" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">α</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq36.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> is the effect of presence of 
    <span class="italic">Fucus</span>; the weight 
    <div id="IEq37" class="inline-formula">
     <div class="alternatives">
      <span id="M79" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\beta }_{{\rm{F}}}$$\end{document}</span>
      <div id="M80" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">β</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq37.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> defines the asymptotic effect and the half saturation parameter, 
    <div id="IEq38" class="inline-formula">
     <div class="alternatives">
      <span id="M81" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${c}_{{\rm{F}}}$$\end{document}</span>
      <div id="M82" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">c</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq38.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, is the 
    <span class="italic">Fucus</span> biomass where the effect of the Michaelis-Menten response has reached the half of its maximum. We used vague 
    <div id="IEq39" class="inline-formula">
     <div class="alternatives">
      <span id="M83" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$N(0,10)$$\end{document}</span>
      <div id="M84" class="math">
       <span class="mi">N</span>
       <span stretchy="false" class="mo">(</span>
       <span class="mn">0</span>
       <span class="mo">,</span>
       <span class="mn">10</span>
       <span stretchy="false" class="mo">)</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq39.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> priors for 
    <div id="IEq40" class="inline-formula">
     <div class="alternatives">
      <span id="M85" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\alpha }_{{\rm{F}}}$$\end{document}</span>
      <div id="M86" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">α</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq40.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, 
    <div id="IEq41" class="inline-formula">
     <div class="alternatives">
      <span id="M87" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\beta }_{{\rm{F}}}$$\end{document}</span>
      <div id="M88" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">β</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq41.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and 
    <div id="IEq42" class="inline-formula">
     <div class="alternatives">
      <span id="M89" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${c}_{{\rm{F}}}$$\end{document}</span>
      <div id="M90" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">c</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">F</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq42.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>.
   </p>
  </sec>
  <sec id="Sec15" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">Combining experimental and distribution data</div>
   <p id="Par45" xmlns="http://www.w3.org/1999/xhtml">The physical tolerance of 
    <span class="italic">Fucus</span> and 
    <span class="italic">Idotea</span> to temperature and salinity is expected to be the same in experimental and natural conditions. Hence, when analyzing distribution and experimental data together we assumed that the functional form of the response along temperature and salinity, 
    <div id="IEq43" class="inline-formula">
     <div class="alternatives">
      <span id="M91" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M92" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq43.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, should be the same in both cases. However, the magnitude of the response might vary between experiments and observational data. These assumptions were encoded into the model by using 
    <div id="IEq44" class="inline-formula">
     <div class="alternatives">
      <span id="M93" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M94" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq44.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> directly as the response function in the experiments and scaling it by positive constant 
    <div id="IEq45" class="inline-formula">
     <div class="alternatives">
      <span id="M95" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$c$$\end{document}</span>
      <div id="M96" class="math">
       <span class="mi">c</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq45.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> in the distribution data, that is 
    <div id="IEq46" class="inline-formula">
     <div class="alternatives">
      <span id="M97" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${f}_{{\rm{ST}},{\rm{dist}}}=c{f}_{{\rm{ST}}}$$\end{document}</span>
      <div id="M98" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">dist</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">c</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq46.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> (Fig. 
    <a rid="Fig1" ref-type="fig" href="#Fig1">1</a>). In practice, this induces a zero mean multivariate Gaussian process prior for a vector valued function 
    <div id="IEq47" class="inline-formula">
     <div class="alternatives">
      <span id="M99" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\tilde{f}}_{{\rm{ST}}}=[{f}_{{\rm{ST}}},{f}_{{\rm{ST}},{\rm{dist}}}]$$\end{document}</span>
      <div id="M100" class="math">
       <div class="msub">
        <div class="mrow">
         <div accent="true" class="mover">
          <span class="mi">f</span>
          <span class="mo">˜</span>
         </div>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span stretchy="false" class="mo">[</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
        </div>
       </div>
       <span class="mo">,</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">f</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">dist</span>
        </div>
       </div>
       <span stretchy="false" class="mo">]</span>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq47.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> with cross covariance function.
    <div id="Equc" class="disp-formula">
     <div class="alternatives">
      <span id="M101" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\rm{Cov}}({f}_{{\rm{ST}}}({x}_{{\rm{S}},i},{x}_{{\rm{T}},i}),{f}_{{\rm{ST}},{\rm{dist}}}({x}_{{\rm{S}},j},{x}_{{\rm{T}},j}))={\sigma }_{{\rm{ST}},{\rm{exper}}}{\sigma }_{{\rm{ST}},{\rm{dist}}}{{\rm{e}}}^{-{({x}_{{\rm{T}},i}-{x}_{{\rm{T}},j})}^{2}/{\lambda }_{{\rm{T}}}^{2}-{({x}_{{\rm{S}},i}-{x}_{{\rm{S}},j})}^{2}/{\lambda }_{{\rm{S}}}^{2}}$$\end{document}</span>
      <div id="M102" display="block" class="math">
       <span mathvariant="normal" class="mi">Cov</span>
       <div class="mrow">
        <span stretchy="true" class="mo">(</span>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">f</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">ST</span>
          </div>
         </div>
         <div class="mrow">
          <span stretchy="true" class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">S</span>
             <span class="mo">,</span>
             <span class="mi">i</span>
            </div>
           </div>
           <span class="mo">,</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">T</span>
             <span class="mo">,</span>
             <span class="mi">i</span>
            </div>
           </div>
          </div>
          <span stretchy="true" class="mo">)</span>
         </div>
         <span class="mo">,</span>
         <div class="msub">
          <div class="mrow">
           <span class="mi">f</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">ST</span>
           <span class="mo">,</span>
           <span mathvariant="normal" class="mi">dist</span>
          </div>
         </div>
         <div class="mrow">
          <span stretchy="true" class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">S</span>
             <span class="mo">,</span>
             <span class="mi">j</span>
            </div>
           </div>
           <span class="mo">,</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">T</span>
             <span class="mo">,</span>
             <span class="mi">j</span>
            </div>
           </div>
          </div>
          <span stretchy="true" class="mo">)</span>
         </div>
        </div>
        <span stretchy="true" class="mo">)</span>
       </div>
       <span class="mo">=</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">exper</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">dist</span>
        </div>
       </div>
       <div class="msup">
        <div class="mrow">
         <span mathvariant="normal" class="mi">e</span>
        </div>
        <div class="mrow">
         <span class="mo">−</span>
         <div class="msup">
          <div class="mrow">
           <span stretchy="false" class="mo">(</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">T</span>
             <span class="mo">,</span>
             <span class="mi">i</span>
            </div>
           </div>
           <span class="mo">−</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">T</span>
             <span class="mo">,</span>
             <span class="mi">j</span>
            </div>
           </div>
           <span stretchy="false" class="mo">)</span>
          </div>
          <span class="mn">2</span>
         </div>
         <span class="mo">/</span>
         <div class="msubsup">
          <div class="mrow">
           <span class="mi">λ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">T</span>
          </div>
          <div class="mrow">
           <span class="mn">2</span>
          </div>
         </div>
         <span class="mo">−</span>
         <div class="msup">
          <div class="mrow">
           <span stretchy="false" class="mo">(</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">S</span>
             <span class="mo">,</span>
             <span class="mi">i</span>
            </div>
           </div>
           <span class="mo">−</span>
           <div class="msub">
            <div class="mrow">
             <span class="mi">x</span>
            </div>
            <div class="mrow">
             <span mathvariant="normal" class="mi">S</span>
             <span class="mo">,</span>
             <span class="mi">j</span>
            </div>
           </div>
           <span stretchy="false" class="mo">)</span>
          </div>
          <span class="mn">2</span>
         </div>
         <span class="mo">/</span>
         <div class="msubsup">
          <div class="mrow">
           <span class="mi">λ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">S</span>
          </div>
          <div class="mrow">
           <span class="mn">2</span>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div xlink:href="41598_2018_38416_Article_Equc.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>where 
    <div id="IEq48" class="inline-formula">
     <div class="alternatives">
      <span id="M103" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\sigma }_{{\rm{ST}},{\rm{exper}}}$$\end{document}</span>
      <div id="M104" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">exper</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq48.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and 
    <div id="IEq49" class="inline-formula">
     <div class="alternatives">
      <span id="M105" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\sigma }_{{\rm{ST}},{\rm{dist}}}$$\end{document}</span>
      <div id="M106" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">σ</span>
        </div>
        <div class="mrow">
         <span mathvariant="normal" class="mi">ST</span>
         <span class="mo">,</span>
         <span mathvariant="normal" class="mi">dist</span>
        </div>
       </div>
      </div>
      <span xlink:href="41598_2018_38416_Article_IEq49.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> are the marginal standard deviations of the experimental and distribution data responses. Hence, the correlation between these two GPs is one but they have different marginal variances. The rest of the model components were mutually independent between the experimental and distribution data. When predicting climate change scenarios, the shared response function allows information flow from the experiments to the projections concerning natural conditions. The extra variation in the observational data is then modeled by the spatial random effect and the response along depth (
    <span class="italic">Fucus</span> biomass in the 
    <span class="italic">Idotea</span> model) and the mutually independent intercept parameters allow for different overall prevalence in these data sets.
   </p>
  </sec>
  <sec id="Sec16" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">Model estimation and validation</div>
   <p id="Par46" xmlns="http://www.w3.org/1999/xhtml">Since the absence observations in 
    <span class="italic">Fucus</span> model (1) are not covered by the Gaussian distribution, the 
    <span class="italic">Fucus</span> model factorizes with respect to the occurrence/survival model and biomass/growth model. Hence, we estimated independently 
    <span class="italic">Fucus</span> occurrence/survival and biomass/growth models and 
    <span class="italic">Idotea</span> occurrence model for experimental and distribution data separately and for combined data. The model components (the intercept, effects of salinity-temperature, depth and 
    <span class="italic">Fucus</span>, as well as the spatial random effect) can be represented as GPs or Gaussian random variables. Hence, conditional on parameters of covariance functions and the half saturation parameter (
    <span class="italic">hyperparameters</span> from this on), our model is a GP SDM with additive covariance function, see
    <span class="sup">
     <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
    </span>, and their supplement for details). We estimated the hyperparameters with their 
    <span class="italic">maximum a posterior estimate</span> (MAP; the value maximizing their marginal posterior density) and calculated the posterior distributions of the response functions conditional on the MAP estimate of hyperparameters. The MAP estimate was searched with gradient based optimization of the marginal posterior of hyperparameters. We used the expectation propagation algorithm to construct approximations for the marginal posterior of hyperparameters. All the models were implemented by using the GPstuff toolbox
    <span class="sup">
     <a ref-type="bibr" rid="CR100" href="#CR100">100</a>
    </span>. For technical details on the inference method see the work of
    <span class="sup">
     <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
    </span> and the documentation of the GPstuff toolbox.
   </p>
   <p id="Par47" xmlns="http://www.w3.org/1999/xhtml">The models were used to study the responses along the covariates by drawing the relative change in biomass and occurrence probability along covariates compared to average biomass and 0.5 probability respectively
    <span class="sup">
     <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
    </span> (Fig. 
    <a rid="Fig2" ref-type="fig" href="#Fig2">2</a> and Supplementary Fig. 
    <a rid="MOESM1" ref-type="media" href="#MOESM1">3</a>). We used the models also to predict (i.e., calculate the posterior predictive probability of) the occurrence of 
    <span class="italic">Idotea</span> and the biomass of 
    <span class="italic">Fucus</span> across the Baltic Sea under the current and the future climate scenario at lattice grid with a cell size of 2 NM. Moreover, the projections were made separately for representative salinity and temperature values of three functionally different sub-regions of the Baltic Sea (Figs 
    <a rid="Fig1" ref-type="fig" href="#Fig1">1</a> and 
    <a rid="Fig3" ref-type="fig" href="#Fig3">3</a> and Supplementary Figs 
    <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a> and 
    <a rid="MOESM1" ref-type="media" href="#MOESM1">4</a>
    <span class="bold">)</span>.
   </p>
   <p id="Par48" xmlns="http://www.w3.org/1999/xhtml">We analyzed models’ explanatory power by calculating the coefficient of determination (R
    <span class="sup">2</span>) for the posterior mean of biomass/growth models and the Tjur R
    <span class="sup">2</span> summary statistics
    <span class="sup">
     <a ref-type="bibr" rid="CR101" href="#CR101">101</a>
    </span> for the occurrence models. Tjur R
    <span class="sup">2</span> is a coefficient of discrimination defined as the difference in the mean occurrence probability predicted for occupied versus unoccupied sampling units. We calculated the proportion of variation in models’ posterior mean projections for training data explained by different components by partitioning the total variation to its components as described in a supplement of reference
    <span class="sup">
     <a ref-type="bibr" rid="CR13" href="#CR13">13</a>
    </span>. We also validated and compared the models using independent test data. To test model performance in predicting 
    <span class="italic">Idotea</span> and 
    <span class="italic">Fucus</span> distribution under current conditions we used all experimental data and 2000 randomly sampled distribution data points for model estimation and used the rest of the distribution data samples (n = 4407) to compare the goodness of projections. Hence, the training and test sets spanned the same covariate range which corresponds to typical species distribution predictions under current conditions. To test model performance in predicting future conditions we split the distribution data at 17.5 degrees temperature and used the experimental data and distribution data below 17.5 degrees in the training set (n = 904) and distribution data above it in the test set (n = 2527). In this case training and test data span totally different covariate ranges which mimics species distribution projections under very drastic environmental change. In both tests, we calculated the percentage of true presence/absence classifications for each of the occurrence models and the root mean squared error (RMSE) in the case of the biomass models.
   </p>
  </sec>
 </sec>
</sec>
