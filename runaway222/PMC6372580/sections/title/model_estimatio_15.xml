<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec16" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Model estimation and validation</div>
 <p id="Par46" xmlns="http://www.w3.org/1999/xhtml">Since the absence observations in 
  <span class="italic">Fucus</span> model (1) are not covered by the Gaussian distribution, the 
  <span class="italic">Fucus</span> model factorizes with respect to the occurrence/survival model and biomass/growth model. Hence, we estimated independently 
  <span class="italic">Fucus</span> occurrence/survival and biomass/growth models and 
  <span class="italic">Idotea</span> occurrence model for experimental and distribution data separately and for combined data. The model components (the intercept, effects of salinity-temperature, depth and 
  <span class="italic">Fucus</span>, as well as the spatial random effect) can be represented as GPs or Gaussian random variables. Hence, conditional on parameters of covariance functions and the half saturation parameter (
  <span class="italic">hyperparameters</span> from this on), our model is a GP SDM with additive covariance function, see
  <span class="sup">
   <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
  </span>, and their supplement for details). We estimated the hyperparameters with their 
  <span class="italic">maximum a posterior estimate</span> (MAP; the value maximizing their marginal posterior density) and calculated the posterior distributions of the response functions conditional on the MAP estimate of hyperparameters. The MAP estimate was searched with gradient based optimization of the marginal posterior of hyperparameters. We used the expectation propagation algorithm to construct approximations for the marginal posterior of hyperparameters. All the models were implemented by using the GPstuff toolbox
  <span class="sup">
   <a ref-type="bibr" rid="CR100" href="#CR100">100</a>
  </span>. For technical details on the inference method see the work of
  <span class="sup">
   <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
  </span> and the documentation of the GPstuff toolbox.
 </p>
 <p id="Par47" xmlns="http://www.w3.org/1999/xhtml">The models were used to study the responses along the covariates by drawing the relative change in biomass and occurrence probability along covariates compared to average biomass and 0.5 probability respectively
  <span class="sup">
   <a ref-type="bibr" rid="CR15" href="#CR15">15</a>
  </span> (Fig. 
  <a rid="Fig2" ref-type="fig" href="#Fig2">2</a> and Supplementary Fig. 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">3</a>). We used the models also to predict (i.e., calculate the posterior predictive probability of) the occurrence of 
  <span class="italic">Idotea</span> and the biomass of 
  <span class="italic">Fucus</span> across the Baltic Sea under the current and the future climate scenario at lattice grid with a cell size of 2 NM. Moreover, the projections were made separately for representative salinity and temperature values of three functionally different sub-regions of the Baltic Sea (Figs 
  <a rid="Fig1" ref-type="fig" href="#Fig1">1</a> and 
  <a rid="Fig3" ref-type="fig" href="#Fig3">3</a> and Supplementary Figs 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">1</a> and 
  <a rid="MOESM1" ref-type="media" href="#MOESM1">4</a>
  <span class="bold">)</span>.
 </p>
 <p id="Par48" xmlns="http://www.w3.org/1999/xhtml">We analyzed models’ explanatory power by calculating the coefficient of determination (R
  <span class="sup">2</span>) for the posterior mean of biomass/growth models and the Tjur R
  <span class="sup">2</span> summary statistics
  <span class="sup">
   <a ref-type="bibr" rid="CR101" href="#CR101">101</a>
  </span> for the occurrence models. Tjur R
  <span class="sup">2</span> is a coefficient of discrimination defined as the difference in the mean occurrence probability predicted for occupied versus unoccupied sampling units. We calculated the proportion of variation in models’ posterior mean projections for training data explained by different components by partitioning the total variation to its components as described in a supplement of reference
  <span class="sup">
   <a ref-type="bibr" rid="CR13" href="#CR13">13</a>
  </span>. We also validated and compared the models using independent test data. To test model performance in predicting 
  <span class="italic">Idotea</span> and 
  <span class="italic">Fucus</span> distribution under current conditions we used all experimental data and 2000 randomly sampled distribution data points for model estimation and used the rest of the distribution data samples (n = 4407) to compare the goodness of projections. Hence, the training and test sets spanned the same covariate range which corresponds to typical species distribution predictions under current conditions. To test model performance in predicting future conditions we split the distribution data at 17.5 degrees temperature and used the experimental data and distribution data below 17.5 degrees in the training set (n = 904) and distribution data above it in the test set (n = 2527). In this case training and test data span totally different covariate ranges which mimics species distribution projections under very drastic environmental change. In both tests, we calculated the percentage of true presence/absence classifications for each of the occurrence models and the root mean squared error (RMSE) in the case of the biomass models.
 </p>
</sec>
