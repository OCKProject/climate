<?xml version="1.0" encoding="UTF-8"?>
<sec id="sec3dot3dot3-sensors-19-02940" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">3.3.3. Big Data-Oriented Ecosystem</div>
 <p xmlns="http://www.w3.org/1999/xhtml">The big data-oriented ecosystem integrates the heterogeneous datasets and resources in a data lake, the urban data lake, under a big data architecture paradigm that allows the production and consumption of data flows. The ecosystem is the operational and transactional backend that supports all resources, open source toolsets, and operational data for developing and packaging services that support the modelling and real-time data provision/consumption from the mobile application. The data ecosystem acts as a backend that houses different physical nodes servers where information is stored, processed, and retrieved. This backend facilitates the delivery of services through the provision of distributed technologies, integration of standards, further scalability for science growth, and resource component management based in a distributed computing paradigm [
  <a rid="B36-sensors-19-02940" ref-type="bibr" href="#B36-sensors-19-02940">36</a>].
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">The data ecosystem responds to four levels of applications or contexts of information where data are gathered and processed: the mobile context (data interaction gathering), user context (citizen science data gathering), environmental context (data sampling and collection), and big data context (data fusion). These contexts provide different interlinked spaces, which ensure the integration of data collection and processing protocols needed to adhere to scientific standards, especially for publicly collected data. 
  <a ref-type="fig" rid="sensors-19-02940-f005" href="#sensors-19-02940-f005">Figure 5</a> shows a diagram of the data ecosystem.
 </p>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Mobile Context</div>
  <p xmlns="http://www.w3.org/1999/xhtml">This represents the data layer that supports the data consumption and interaction through the application. It provides a tool that hides the complexity of the data flows and provides the information in one coherent integrated visualization layer. This layer allows the user to capture, gather, and share personal data from the socio-demographic, health status, neighbourhood perception, geolocation, quality of life, and so on. Furthermore, the user can share the activity data of a health tracker device (e.g., Fitbit) and the GPS position. The application continuously displays information to the user, including health risks (e.g., asthma, cardiovascular, and type 2 diabetes risks) [
   <a rid="B37-sensors-19-02940" ref-type="bibr" href="#B37-sensors-19-02940">37</a>], feedback information, sensing services from the wearable activity tracker (e.g., steps, calories burnt, and kilometres walked), current location, and current pollution exposure values, among others. It is based on the following software artefacts able to run in different the different smartphones brand types (iOS and Android):
   <div list-type="bullet" class="list">
    <div class="list-item">
     <p>Graphical User Interfaces (GUI): they represent all the screens as described in 
      <a ref-type="sec" rid="sec3dot3dot1-sensors-19-02940" href="#sec3dot3dot1-sensors-19-02940">Section 3.3.1</a>. They refer to four main activities for the users: the Citizen module that refers to the individual information and ways to promote healthy habits. The City module contains all the screens related to the health, green behavior, and pollution maps. “Preferences” contains all the screens for user’s preferences, and the “Home” page is the initial interaction flow.
     </p>
    </div>
    <div class="list-item">
     <p>Intervention Engine (IE): this is a mechanism to provide the intervention in the application. It is based on a scheduler that executes a questionnaire engine able to process the intervention by proposing a set of activities to the user to promote green and healthy habits.</p>
    </div>
    <div class="list-item">
     <p>Feedback Engine (FE): this is the logic that triggers the proper feedback to the users. There are multi modalities of feedbacks depending on the context and nature of the data. Feedback can be in form of charts (e.g., evolution of the daily steps from the health tracker), educational content (in form of texts, infographics, web pages, or videos), personalized feedbacks (messages build based on rules of a decision support system), or notifications or reminders that are triggered to push users to perform an activity.</p>
    </div>
    <div class="list-item">
     <p>Sensing Service (SE): the artefact abstracts the complexity of the sensor connection and provides access to the internal sensor of the mobile phone (currently the GPS), sensors that are available on the WiFi network of the users, and third-party services.</p>
    </div>
    <div class="list-item">
     <p>Synchronization Service (SS): this service communicates with the big data context to transfer the citizen data to the citizen database; the position of the user is then used (if available) to assess the environmental context and enrich the feedback to the users (e.g., pollution maps).</p>
    </div>
    <div class="list-item">
     <p>App Database (AD): the service offers full data persistence inside the smartphone. The database is securely encrypted and stored in a non-accessible area of the smartphone.</p>
    </div>
   </div>
  </p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">User Context</div>
  <p xmlns="http://www.w3.org/1999/xhtml">This represents the world of IoT devices and wearable devices that can be used to get information about health status, presence, geolocation, and trajectories followed in space and time by single citizens using the application or a specific service. Users can decide to connect a specific device (e.g., Fitbit) and share the activity data with the platform. This research considered the use of a health tracker (i.e., Fitbit), but the types of devices can be extended to other health devices like holters, blood pressure monitors, and so on. This architectural layer allows citizen science data gathering that is uploaded in the cloud infrastructure.</p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Environmental Context </div>
  <p xmlns="http://www.w3.org/1999/xhtml">This provides relevant information on the environment in the city area where the user is located. Data are captured from public information measurement nodes or infrastructure; mainly produced by the city sensors’ network (i.e., fixed or mobile sensors) or satellites (e.g., satellite optical or hyperspectral images). Additionally, these data are coupled with public services data (e.g., public health data) and resources, such as transportation, police, or other related public services aiming at supporting mobility.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">Furthermore, this layer supports the data sampling and collection process. The data obtained comes from public access sources, which allows the most relevant information to be integrated in a single system for the user, and thus uploaded to the cloud infrastructure. The most relevant data gathered within the environmental and public services context comprise the following:
   <div list-type="bullet" class="list">
    <div class="list-item">
     <p>Air Quality (AQ): Air quality data of the area where the user is located, coming from fixed and mobile sensors or measurement stations deployed throughout the city or satellites, among others.</p>
    </div>
    <div class="list-item">
     <p>Weather: updated information of the weather in the user’s location.</p>
    </div>
    <div class="list-item">
     <p>Mobility: public transport stops, pedestrian routes, bike lanes, public rental bicycles, and other types of green transportation.</p>
    </div>
    <div class="list-item">
     <p>Public Services: information of police and firemen stations, public health organizations, hospitals, and schools, among others.</p>
    </div>
   </div>
  </p>
 </sec>
 <sec class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Big Data Context</div>
  <p xmlns="http://www.w3.org/1999/xhtml">This represents the core business logic that gathers all the contextual information of the user and uses it to assess the individual health risk and pollution exposure. This layer supports data fusion, which provides personalized interventions that are implemented considering a context for risk and resilience, which results from the local policies and directives‘ assessment on urban health and resilience [
   <a rid="B38-sensors-19-02940" ref-type="bibr" href="#B38-sensors-19-02940">38</a>]. The intervention is then personalized according to the available local resources in terms of educational materials, events to join, recommended places, or challenging activities to adopt specific household or healthy behaviours.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Furthermore, this layer enables data fusion, which supports the integration of data and knowledge from several sources. Three data fusion schemes are used: (i) data association, (ii) state estimation, and (iii) decision fusion. These schemes support the combination of data from multisensory environments and data modelling, and allow parameter estimation from the multiple sources by providing resources that enable multi-level process dealing with the association, correlation, and combination of data and information from single and multiple sources to complete and provide timely assessments of situations and their significance.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">The big data context, presented in 
   <a ref-type="fig" rid="sensors-19-02940-f005" href="#sensors-19-02940-f005">Figure 5</a>, comprises three main components: storage infrastructure, modelling and predictive resources, and visualization (presentation) resources. The storage infrastructure component stores all readings in a central repository, named an “urban data lake”. Data are harvested and semantically treated to allow interoperability. 
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The model and intervention resources allow data modelling and abstraction over the collected data enabling data consumption; aiming at linking health, citizens’, and environmental data to detect and predict risk factors. Spatio-temporal and risk stratification models, as well as statistical analysis (such as regression and correlation analysis), are used to personalize environmental and health risk estimations, support interpolation of data, estimate pollution concentrations on urban spaces, or enable individual assessments in these domains [
   <a rid="B39-sensors-19-02940" ref-type="bibr" href="#B39-sensors-19-02940">39</a>]. In this context, the models comprise the data production and fusion stage, in order to support personalized interventions and information for the app, such as air pollution level and exposure to be presented in the maps (e.g., users’ data consumption) [
   <a rid="B40-sensors-19-02940" ref-type="bibr" href="#B40-sensors-19-02940">40</a>]. The presentation resources push produces data to the mobile application, enabling data and information presentation, and interaction trough the mobile application modules and maps. This allows the user to input data, sense-based air quality inputs, and present data to application modules (e.g., pollution value points for the pollution exposure map).
  </p>
 </sec>
</sec>
