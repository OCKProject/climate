<?xml version="1.0" encoding="UTF-8"?><html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
   <div class="sec" title="sec">
      <div xmlns="http://www.w3.org/1999/xhtml">Methods</div>
      <div class="sec" title="sec">
         <div xmlns="http://www.w3.org/1999/xhtml">Data</div>
         <p xmlns="http://www.w3.org/1999/xhtml">Proxy records of northern African palaeoclimate are derived from a variety of sources.
            These range from lake-level, dust deposition, pollen and geochemical records. The
            data used in Figs. 
            <a>2a</a>, 
            <a>5a</a> are derived from the database compiled and interpreted by Shanahan et al.
            <span><a>3</a></span>. For every 500 year interval, the climate state has been subjectively determined
            <span><a>3</a></span> as either wet, moderate or dry (Fig. 
            <a>2a</a>). As with the sensitivity metric (Eq. 
            <a>7</a>), we date the collapse as the first time in which humid conditions are not present
            (Fig. 
            <a>5</a>). This compilation of proxy records may provide a geographically and typographically
            biased sample, but is not clear what alternate approaches are availabel to estimate
            an end-date for the green Sahara in a probabilistic fashion.
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">The relative population levels (Figs. 
            <a>2b</a>, 
            <a>5b</a>) are a summed probability distribution analysis based on a comprehensive review of
            the abundance of carbon-14 dated archaeological sites across northern Africa
            <span><a>22</a></span>. The underlying principle of this method assumes a monotonic relationship between
            the amount of data and the amount of human presence, which is reliant on the law of
            large numbers to overcome small-scale temporal and spatial biases. Full details on
            the methods are described in Shennan et al.
            <span><a>52</a></span>, whilst criticisms
            <span><a>53</a>,
               <a>54</a></span>, and subsequent defense
            <span><a>55</a>,
               <a>56</a></span> of the method have been presented in several publications. The population estimates
            used in the present analysis
            <span><a>22</a></span> were created from a dataset comprising 3287 radiocarbon dates from 1011 “Neolithic”
            sites. Radiocarbon dates from state level social contexts such as Pharaonic or later
            Garamantian sites were not included in that analysis. The population estimates can
            only provide relative time series and the size of populations cannot be compared between
            the regions shown in Fig. 
            <a>2b</a>. To date, these are the only explicit reconstructions of Holocene demographic trends
            on a trans-Saharan scale, although similar curves have been produced for the western
            desert in Egypt
            <span><a>45</a></span>. Furthermore, it is this curve which Wright suggests corresponds with “the variable
            tempo and intensity of the termination of the AHP” and “local transitions to shrubland
            environments and accelerated rates of soil erosion”
            <span><a>2</a></span>. We exclude African palaeoclimate reconstructions south of 13.42°N from our analysis,
            as this is the most southerly archaeological site used to reconstruct the population
            estimates
            <span><a>22</a></span>.
            
         </p>
      </div>
      <div class="sec" title="sec">
         <div xmlns="http://www.w3.org/1999/xhtml">Idealised model formulation</div>
         <p xmlns="http://www.w3.org/1999/xhtml">The simplest model of climate–vegetation interactions consists of the vegetation cover
            being determined by rainfall, which itself depends on external forcing and vegetation
            cover
            <span><a>31</a></span>. We adapt the non-dimensionalised model of Liu
            <span><a>28</a></span> that captures inter-annual variability
            <span><a>27</a></span> with the modification that the time-invariant background rainfall is now considered
            a linearised function of precession and carbon dioxide forcing. This idealised model
            incorporates a vegetation cover, 
            <span>v</span>, that ranges from shrubland (1; “green”) to desert (−1; “yellow”). The vegetation
            cover changes at a rate
            
            <div><span>1</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$\frac{{{\mathrm{d}}\nu }}{{{\mathrm{d}}t}}
                     = \frac{1}{{\tau _\nu }}{\mathrm{tanh}}(R) - \nu,$$\end{document}</span><div>
                     <div>
                        <div><span>d</span><span>ν</span></div>
                        <div><span>d</span><span>t</span></div>
                     </div><span>=</span><div>
                        <div><span>1</span></div>
                        <div>
                           <div>
                              <div><span>τ</span></div>
                              <div><span>ν</span></div>
                           </div>
                        </div>
                     </div><span>tanh</span><div><span>(</span><div><span>R</span></div><span>)</span></div><span>-</span><span>ν</span><span>,</span></div>
                  <div></div>
               </div>
            </div>where 
            <span>τ</span><sub><span>v</span></sub> is the vegetation timescale (in years) and 
            <span>R</span> is the non-dimensionalised rainfall. 
            <span>R</span> is centred around a sensitive range that spreads from (−1, 1). It is given by:
            
            <div><span>2</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$R = a + bP + cF + {\mathrm{d}}\nu
                     + N,$$\end{document}</span><div><span>R</span><span>=</span><span>a</span><span>+</span><span>b</span><span>P</span><span>+</span><span>c</span><span>F</span><span>+</span><span>d</span><span>ν</span><span>+</span><span>N</span><span>,</span></div>
                  <div></div>
               </div>
            </div>where 
            <span>P</span> is the eccentricity-modulated precession
            <span><a>29</a></span>, 
            
            <div>
               <div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$\varepsilon {\mathrm{sin}}\varpi$$\end{document}</span><div><span>ε</span><span>sin</span><span>ϖ</span></div><span></span></div>
            </div>, (Fig. 
            <a>4a</a>) and 
            <span>F</span> is the radiative forcing with respect to the preindustrial. Here the radiative forcing
            (Fig. 
            <a>4a</a>) represents solely carbon-di-oxide and is calculated as 5.35 ln(CO
            <sub>2</sub>/278), where CO
            <sub>2</sub> is the carbon dioxide concentration
            <span><a>30</a></span> in parts-per-million by volume [278 ppm was the preindustrial concentration]. The
            feedback of vegetation onto the rainfall is captured by the d
            <span>v</span> term in Eq. 
            <a>2</a>, where 
            <span>d</span> sets the magnitude of the feedback. Previous work
            <span><a>28</a></span> has used 
            <span>d</span> ranging from 0.8 to 1.2; a wider range is sampled here to encompass a broader spread
            of uncertainty (see Supplementary Table 
            <a>1</a>). The red noise term, 
            <span>N</span>, is given by
            
            <div><span>3</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$\frac{{{\mathrm{d}}N}}{{{\mathrm{d}}t}}
                     = \frac{{\sigma \varsigma (t) - N}}{{\tau _N}},$$\end{document}</span><div>
                     <div>
                        <div><span>d</span><span>N</span></div>
                        <div><span>d</span><span>t</span></div>
                     </div><span>=</span><div>
                        <div><span>σ</span><span>ς</span><div><span>(</span><div><span>t</span></div><span>)</span></div><span>-</span><span>N</span></div>
                        <div>
                           <div>
                              <div><span>τ</span></div>
                              <div><span>N</span></div>
                           </div>
                        </div>
                     </div><span>,</span></div>
                  <div></div>
               </div>
            </div>where 
            <span>τ</span><sub><span>N</span></sub> is soil moisture timescale (in years) and 
            
            <div>
               <div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$\varsigma$$\end{document}</span><div><span>ς</span></div><span></span></div>
            </div> is a random sample from a unit normal distribution scaled by a tunable parameter,
            
            <span>σ</span>.
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">The impact of a doubling in CO
            <sub>2</sub> has previously been shown to expand the critical range of rainfall
            <span><a>31</a></span>. However, it is incorporated here as an additive term (expressed as a radiative forcing
            change from preindustrial in W/m
            <span>2</span>) as attempts with a multiplicative factor were unsuccessful in replicating the observed
            lack of green states during MIS3 (Fig. 
            <a>4b</a>). The modified background rainfall, 
            <span>a</span> + 
            <span>bP</span> + 
            <span>cF</span>, must at times be less than 1 otherwise the system would never leave the green state
            and is generally less than 0 to prevent the green state becoming the predominant condition.
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">Iteration is achieved through a forward timestepping approach
            <span><a>28</a></span> with a timestep, Δ
            <span>t</span>, of 1 year.
            
            <div><span>4</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$\nu _{k + 1} = \nu _k + \frac{{\Delta
                     t}}{{\tau _\nu }}\left[ {{\mathrm{tanh}}\left( {\frac{{a + bP}}{{c{\mathrm{CO}}_2}}
                     + {\mathrm{d}}\nu + N_k} \right) - \nu _k} \right],$$\end{document}</span><div>
                     <div>
                        <div><span>ν</span></div>
                        <div><span>k</span><span>+</span><span>1</span></div>
                     </div><span>=</span><div>
                        <div><span>ν</span></div>
                        <div><span>k</span></div>
                     </div><span>+</span><div>
                        <div><span>Δ</span><span>t</span></div>
                        <div>
                           <div>
                              <div><span>τ</span></div>
                              <div><span>ν</span></div>
                           </div>
                        </div>
                     </div>
                     <div>
                        <div><span>tanh</span><div>
                              <div>
                                 <div>
                                    <div><span>a</span><span>+</span><span>b</span><span>P</span></div>
                                    <div><span>c</span><div>
                                          <div><span>CO</span></div>
                                          <div><span>2</span></div>
                                       </div>
                                    </div>
                                 </div><span>+</span><span>d</span><span>ν</span><span>+</span><div>
                                    <div><span>N</span></div>
                                    <div><span>k</span></div>
                                 </div>
                              </div>
                           </div><span>-</span><div>
                              <div><span>ν</span></div>
                              <div><span>k</span></div>
                           </div>
                        </div>
                     </div><span>,</span></div>
                  <div></div>
               </div>
            </div>
            <div><span>5</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$N_{k + 1} = N_k - \frac{{N_k\Delta
                     t}}{{\tau _N}} + \frac{{\sqrt {\Delta t} \sigma W_k}}{{\tau _N}}$$\end{document}</span><div>
                     <div>
                        <div><span>N</span></div>
                        <div><span>k</span><span>+</span><span>1</span></div>
                     </div><span>=</span><div>
                        <div><span>N</span></div>
                        <div><span>k</span></div>
                     </div><span>-</span><div>
                        <div>
                           <div>
                              <div><span>N</span></div>
                              <div><span>k</span></div>
                           </div><span>Δ</span><span>t</span></div>
                        <div>
                           <div>
                              <div><span>τ</span></div>
                              <div><span>N</span></div>
                           </div>
                        </div>
                     </div><span>+</span><div>
                        <div>
                           <div><span>Δ</span><span>t</span></div><span>σ</span><div>
                              <div><span>W</span></div>
                              <div><span>k</span></div>
                           </div>
                        </div>
                        <div>
                           <div>
                              <div><span>τ</span></div>
                              <div><span>N</span></div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div></div>
               </div>
            </div>
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">Previous work
            <span><a>28</a></span> has shown that this system can exhibit bimodality (switching between two different
            states) despite being monostable (i.e., having a single potential well, Eq. 
            <a>6</a>). The stochasticity (Eq. 
            <a>3</a>, best thought of as interannual variability in the soil moisture
            <span><a>27</a>,
               <a>28</a></span>) combined with the non-linear dependence of vegetation on rainfall (Eq. 
            <a>1</a>) can lead to the simulation often passing through the state with minimum equilibrium
            potential
            <span><a>28</a></span>. The bimodality explored previously in this style of system
            <span><a>28</a></span> occurs with a background rainfall (and hence minimum equilibrium potential) centred
            on 
            <span>v</span> = 0. It is under this condition that the system is most responsive to noise. Otherwise
            (as for the vast majority of the 230 ka simulated here), the stochastic contribution
            is effectively biased towards either the green or yellow state. This means the model
            is not exhibiting the canonical form of abrupt collapse (i.e., a bistable system rapidly
            flipping state). Rather this model represents forced changes overprinted with substantial
            stochasticity, which leads to shifts between two predominant states that may be abrupt
            in nature.
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">The idealised model has seven unknown parameters: three related to the background
            rainfall (
            <span>a</span>, 
            <span>b</span>, and 
            <span>c</span>); the feedback strength, 
            <span>d</span>; two inherent timescales (
            <span>τ</span><sub><span>v</span></sub> and 
            <span>τ</span><sub><span>N</span></sub>); and the climate noise scaling, 
            <span>σ</span>. These cannot be individually constrained from observations, in part due to their
            idealised nature. A 100,000-member ensemble is created to explore parameter and internal
            variability uncertainty. For each ensemble member, the values of the seven parameters
            are randomly selected from a uniform distribution over the ranges shown in Supplementary
            Table 
            <a>1</a>. The remaining subset of 12,099 simulations are considered as “not implausible”.
            Interestingly roughly a third (
            <span>n</span> = 3534) of this subset never leave the green state during the Holocene.
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">In the absence of stochastic noise, the equilibrium potential for the idealised model
            above is
            
            <div><span>6</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$$U(\nu ) = \frac{{\nu ^2}}{2} -
                     \frac{{{\mathrm{ln}}\left( {{\mathrm{cosh}}\left( {a + bP + c{\mathrm{CO}}_{\mathrm{2}}
                     + {\mathrm{d}}\nu } \right)} \right)}}{d}$$\end{document}</span><div><span>U</span><div><span>(</span><div><span>ν</span></div><span>)</span></div><span>=</span><div>
                        <div>
                           <div>
                              <div><span>ν</span></div>
                              <div><span>2</span></div>
                           </div>
                        </div>
                        <div><span>2</span></div>
                     </div><span>-</span><div>
                        <div><span>ln</span><div>
                              <div><span>cosh</span><div>
                                    <div><span>a</span><span>+</span><span>b</span><span>P</span><span>+</span><span>c</span><div>
                                          <div><span>CO</span></div>
                                          <div><span>2</span></div>
                                       </div><span>+</span><span>d</span><span>ν</span></div>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div><span>d</span></div>
                     </div>
                  </div>
                  <div></div>
               </div>
            </div>
         </p>
      </div>
      <div class="sec" title="sec">
         <div xmlns="http://www.w3.org/1999/xhtml">Simulated sensitivity metric</div>
         <p xmlns="http://www.w3.org/1999/xhtml">If the noiseless system were left to reach equilibrium with a given forcing, it would
            end in the state with the minimum equilibrium potential. The time-varying nature of
            the forcings suggests that even with the addition of noise an individual model simulation
            can be adequately approximated by its equilibrium state (Supplementary Fig. 
            <a>1A</a>). This permits identification of when the system should flip between the green and
            yellow states. We define a threshold time, 
            <span>t</span><span>∗</span>, at which the minimum equilibrium potential changes side of the 
            <span>v</span> = 0 line (Supplementary Fig. 
            <a>1A</a>). Following from Eq. 
            <a>6</a>, the threshold time, 
            <span>t</span><span>∗</span>, occurs when
            
            <div><span>7</span><div><span>\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts}
                     \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek}
                     \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mathrm{sgn}}\left( {a + bP_{t^
                     \ast } + cF_{t^ \ast }} \right) \ne {\mathrm{sgn}}\left( {a + bP_{(t^ \ast - \Delta
                     t)} + cF_{(t^ \ast - \Delta t)}} \right)$$\end{document}</span><div><span>sgn</span><div>
                        <div><span>a</span><span>+</span><span>b</span><div>
                              <div><span>P</span></div>
                              <div>
                                 <div>
                                    <div><span>t</span></div>
                                    <div><span>*</span></div>
                                 </div>
                              </div>
                           </div><span>+</span><span>c</span><div>
                              <div><span>F</span></div>
                              <div>
                                 <div>
                                    <div><span>t</span></div>
                                    <div><span>*</span></div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div><span>≠</span><span>sgn</span><div>
                        <div><span>a</span><span>+</span><span>b</span><div>
                              <div><span>P</span></div>
                              <div>
                                 <div><span>(</span><div>
                                       <div>
                                          <div><span>t</span></div>
                                          <div><span>*</span></div>
                                       </div><span>-</span><span>Δ</span><span>t</span></div><span>)</span></div>
                              </div>
                           </div><span>+</span><span>c</span><div>
                              <div><span>F</span></div>
                              <div>
                                 <div><span>(</span><div>
                                       <div>
                                          <div><span>t</span></div>
                                          <div><span>*</span></div>
                                       </div><span>-</span><span>Δ</span><span>t</span></div><span>)</span></div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div></div>
               </div>
            </div>
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">This allows us to define a simulated sensitivity metric as the number of not-implausible
            ensemble members exhibiting threshold behaviour at that time, i.e., SS(
            <span>t</span>) = 
            <span>n</span>(
            <span>t</span><span>∗</span> = 
            <span>t</span>). Exclusion of ensemble members that do not collapse during the Holocene does not
            alter the simulated sensitivity time series. This simulated sensitivity shows a definite
            spike at 14.7 ka (Supplementary Fig. 
            <a>1B</a>) demonstrating the ability of our approach to capture the onset of the African humid
            period. Such a consistent signal is not shown for its termination (Fig. 
            <a>5c</a>).
            
         </p>
         <p xmlns="http://www.w3.org/1999/xhtml">An alternate approach to sampling the uncertainty contained within the model’s tunable
            parameters would be to only select the ensemble members with a good fit to observations.
            Selecting just the 1500 ensemble members best correlated (i.e., with the highest 
            <span>R</span><span>2</span> values) to the Ba/Al observations shown in Fig. 
            <a>4b</a> would lead to a single sole peak in simulated sensitivity at ~6.5 ka. Given that
            sapropel S1 is observed to terminate ~1000 years earlier than the compilation in Fig. 
            <a>5a</a><span><a>3</a>,
               <a>24</a></span>, it would be hard to conclude an anthropogenic delay from this subset of best-correlated
            models
            <span><a>57</a></span>. Our “not implausible” approach is only conditioned on sapropel existence rather
            than timing—removing any circularity.
            
         </p>
      </div>
      <div class="sec" title="sec">
         <div xmlns="http://www.w3.org/1999/xhtml">Code availability</div>
         <p xmlns="http://www.w3.org/1999/xhtml">The idealised model has been programmed in NCL, as were all the codes to plot the
            figures presented here. A single model instance for the Holocene has been written
            in Python as a Jupyter Notebook. All programs can be accessed from the repository
            via the EarthArXiv at 10.17605/OSF.IO/WYAFZ.
         </p>
      </div>
   </div>
</html>