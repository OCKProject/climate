<?xml version="1.0" encoding="UTF-8"?>
<sec id="Sec3" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Overview of causal inference methods</div>
 <p id="Par14" xmlns="http://www.w3.org/1999/xhtml">Observational causal inference from time series has come a long way since Wiener’s
  <span class="sup">
   <a ref-type="bibr" rid="CR34" href="#CR34">34</a>
  </span> and Granger’s
  <span class="sup">
   <a ref-type="bibr" rid="CR9" href="#CR9">9</a>
  </span> seminal works in the 1950s and 1960s and a plethora of different methods have been developed since then. Importantly, in the past few decades the works of Pearl, Spirtes, Glymour, Scheines, and Rubin
  <span class="sup">
   <a ref-type="bibr" rid="CR3" href="#CR3">3</a>,
   <a ref-type="bibr" rid="CR4" href="#CR4">4</a>,
   <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
   <a ref-type="bibr" rid="CR35" href="#CR35">35</a>
  </span> have grounded causal reasoning and inference as a rigorous mathematical framework, elucidating the conditions under which discovering causal graphical models, also called Bayesian networks
  <span class="sup">
   <a ref-type="bibr" rid="CR36" href="#CR36">36</a>
  </span>, from purely observational data is at all possible. These are known as identifiability conditions in the field of statistics and causal inference. Many causal inference methods for time series are grounded on the assumptions of time-order (causes precede effects), Causal Sufficiency, meaning that all direct common drivers are observed, and the Causal Markov Condition, stating that in a graphical model a variable 
  <span class="italic">Y</span> is independent of every other variable (that is not affected by 
  <span class="italic">Y</span>) conditional on 
  <span class="italic">Y</span>’s direct causes, among other, more technical, assumptions
  <span class="sup">
   <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
   <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
  </span>. However, recent work shows that some of these assumptions can be relaxed. Peters et al.
  <span class="sup">
   <a ref-type="bibr" rid="CR13" href="#CR13">13</a>
  </span> summarize recent progress of methods that utilize assumptions on the noise structure and dependency types in the framework of SCMs. Many causal inference methods are not restricted to time series to infer causal relations.
 </p>
 <sec id="Sec4" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Granger causality</div>
  <p id="Par15" xmlns="http://www.w3.org/1999/xhtml">The concept of Granger causality
   <span class="sup">
    <a ref-type="bibr" rid="CR9" href="#CR9">9</a>
   </span> was the first formalization of a practically quantifiable causality definition from time series. The original idea, based on work by Wiener
   <span class="sup">
    <a ref-type="bibr" rid="CR34" href="#CR34">34</a>
   </span>, is to test whether omitting the past of a time series 
   <span class="italic">X</span> in a time series model including 
   <span class="italic">Y</span>’s own and other covariates’ past increases the prediction error of the next time step of 
   <span class="italic">Y</span> (Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2a</a>). The concept of GC can be implemented with different time series models. Classically, the Granger causality test is based on linear autoregressive modeling (see Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>), but nonlinear dependencies can be modeled with more complex time series models or even the information-theoretic analog transfer entropy
   <span class="sup">
    <a ref-type="bibr" rid="CR37" href="#CR37">37</a>
   </span>. While bivariate time series models do not explicitly account for indirect links or common drivers as shown in Fig. 
   <a rid="Fig1" ref-type="fig" href="#Fig1">1a</a>, more variables can be included in multivariate extensions of GC. Nevertheless, as illustrated in Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a> GC is limited to lagged causal dependencies and, furthermore, has known deficiencies in the presence of subsampled time series and other issues
   <span class="sup">
    <a ref-type="bibr" rid="CR38" href="#CR38">38</a>
   </span>. GC has a long history of applications across a wide range of scientific domains, including Earth system science
   <span class="sup">
    <a ref-type="bibr" rid="CR39" href="#CR39">39</a>–
    <a ref-type="bibr" rid="CR41" href="#CR41">41</a>
   </span>.
   <div id="Fig2" class="fig">
    <span class="label">Fig. 2</span>
    <div class="caption">
     <p>Overview of causal inference methods. 
      <span class="bold">a</span> Multivariate Granger causality tests whether omitting the past of a time series 
      <span class="italic">X</span> (black dashed box) in a time series model including 
      <span class="italic">Y</span>’s own and other covariates’ past (blue solid box) increases the prediction error of 
      <span class="italic">Y</span> at time 
      <span class="italic">t</span> (black node). Hence, only time-lagged causal relations can be found. 
      <span class="bold">b</span> The nonlinear state-space method convergent cross-mapping (CCM), illustrated for the chaotic Lorenz system, reconstructs the variables’ state spaces 
      <span class="italic">(M</span>
      <sub>
       <span class="italic">X</span>
      </sub>
      <span class="italic">, M</span>
      <sub>
       <span class="italic">Y</span>
      </sub>
      <span class="italic">)</span> using time-lagged coordinate embedding and concludes on 
      <span class="italic">X</span>→
      <span class="italic">Y</span> if points on 
      <span class="italic">M</span>
      <sub>
       <span class="italic">X</span>
      </sub> can be predicted using nearest neighbors in 
      <span class="italic">M</span>
      <sub>
       <span class="italic">Y</span>
      </sub> (orange ellipse) and the prediction improves the more points on the attractor are sampled. 
      <span class="bold">c</span> Causal network learning algorithms cope well with high dimensionality and can often also identify the direction of contemporaneous links. Exemplified on the model of Box 
      <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>, the PC algorithm
      <span class="sup">
       <a ref-type="bibr" rid="CR12" href="#CR12">12</a>
      </span>, adapted to time series, starts from a graph where all unconditionally (
      <span class="italic">p</span> = 0) dependent variable pairs (assuming stationarity, only links ending at time 
      <span class="italic">t</span> are represented) are connected and iteratively tests conditional independence with increasing number of conditions 
      <span class="italic">p</span>. Lagged links are oriented forward in time (causes precede effects), while contemporaneous links are left undirected (circle marks at the ends) in this skeleton discovery phase. For example, 
      <span class="italic">X</span>
      <sub>
       <span class="italic">t</span>−1
      </sub> and 
      <span class="italic">Z</span>
      <sub>
       <span class="italic">t</span>
      </sub> (black nodes) are correctly identified as independent already in the second iteration step (
      <span class="italic">p</span> = 1) where the dependence through 
      <span class="italic">Y</span>
      <sub>
       <span class="italic">t-1</span>
      </sub> (blue box) is conditioned out, while we need to condition on two variables to detect that 
      <span class="italic">Z</span>
      <sub>
       <span class="italic">t</span>−2
      </sub> and 
      <span class="italic">W</span>
      <sub>
       <span class="italic">t</span>
      </sub> are independent (
      <span class="italic">p</span> = 2). In contrast to GC, PC avoids conditioning on the whole past leading to lower estimation dimensions. Contemporaneous links are then oriented by applying a set of rules in the orientation phase. Here the finding that 
      <span class="italic">W</span>
      <sub>
       <span class="italic">t-1</span>
      </sub> and 
      <span class="italic">Z</span>
      <sub>
       <span class="italic">t</span>
      </sub> are independent conditional on 
      <span class="italic">Z</span>
      <sub>
       <span class="italic">t</span>−1
      </sub>, but not conditional on 
      <span class="italic">W</span>
      <sub>
       <span class="italic">t</span>
      </sub>, allows to identify 
      <span class="italic">Z</span>
      <sub>
       <span class="italic">t</span>
      </sub>→
      <span class="italic">W</span>
      <sub>
       <span class="italic">t</span>
      </sub> because the other causal direction is not consistent with the observed conditional independencies. However, for the link between 
      <span class="italic">X</span>
      <sub>
       <span class="italic">t</span>
      </sub> and 
      <span class="italic">Y</span>
      <sub>
       <span class="italic">t</span>
      </sub> no such rule can be applied since all conditional-independence based algorithms resolve causal graphs only up to a Markov equivalence class. 
      <span class="bold">d</span> Structural causal models utilize different assumptions than the previous approaches to detect causal directions within Markov equivalence classes by exploiting asymmetries between cause and effect (principle of independence of mechanisms
      <span class="sup">
       <a ref-type="bibr" rid="CR13" href="#CR13">13</a>
      </span>). Shown is the LiNGAM method
      <span class="sup">
       <a ref-type="bibr" rid="CR54" href="#CR54">54</a>
      </span> (assuming a linear model with non-Gaussian noise) which can identify 
      <span class="italic">Y</span>
      <sub>
       <span class="italic">t</span>
      </sub>
      <div id="IEq104" class="inline-formula">
       <div class="alternatives">
        <span id="M1" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
        <div id="M2" class="math">
         <span class="mo">→</span>
        </div>
        <span xlink:href="41467_2019_10105_Article_IEq104.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
       </div>
      </div>
      <span class="italic">X</span>
      <sub>
       <span class="italic">t</span>
      </sub> since the residual of the model for this direction (black fit line) is independent of 
      <span class="italic">Y</span> (top subplot), while this is not the case for 
      <span class="italic">X</span>
      <sub>
       <span class="italic">t</span>
      </sub>
      <div id="IEq105" class="inline-formula">
       <div class="alternatives">
        <span id="M3" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
        <div id="M4" class="math">
         <span class="mo">→</span>
        </div>
        <span xlink:href="41467_2019_10105_Article_IEq105.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
       </div>
      </div>
      <span class="italic">Y</span>
      <sub>
       <span class="italic">t</span>
      </sub> (red line)
     </p>
    </div>
    <div xlink:href="41467_2019_10105_Fig2_HTML" id="d29e1288" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
 </sec>
 <sec id="Sec5" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Nonlinear state-space methods</div>
  <p id="Par16" xmlns="http://www.w3.org/1999/xhtml">While GC and also the other frameworks discussed here view systems as having interactions that arise from an underlying stochastic process, convergent cross-mapping
   <span class="sup">
    <a ref-type="bibr" rid="CR11" href="#CR11">11</a>
   </span> (CCM) and related methods
   <span class="sup">
    <a ref-type="bibr" rid="CR10" href="#CR10">10</a>,
    <a ref-type="bibr" rid="CR42" href="#CR42">42</a>
   </span> take a different dynamical systems perspective. These methods assume that interactions occur in an underlying dynamical system and attempt to uncover causal relationships based on Takens’ theorem and nonlinear state-space reconstruction. Thus, for these methods to apply it is necessary to demonstrate that a deterministic nonlinear attractor can be recovered from the data. In this sense it is thought to be complementary to the more statistical approaches discussed here. As illustrated in Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2b, a</a> causal relationship between two dynamical variables 
   <span class="italic">X</span> and 
   <span class="italic">Y</span> can be established if they belong to a common dynamical system, which can be reconstructed from time-delay embedding of each of the observed time series. More specifically, if variable 
   <span class="italic">X</span> can be predicted using the reconstructed system based on the time-delay embedding of variable 
   <span class="italic">Y</span>, then we know that 
   <span class="italic">X</span> had a causal effect on 
   <span class="italic">Y</span>. Nonlinear state-space methods have been applied to ecology
   <span class="sup">
    <a ref-type="bibr" rid="CR11" href="#CR11">11</a>,
    <a ref-type="bibr" rid="CR43" href="#CR43">43</a>
   </span> as shown in Fig. 
   <a rid="Fig1" ref-type="fig" href="#Fig1">1c</a>, as well as in climate science
   <span class="sup">
    <a ref-type="bibr" rid="CR44" href="#CR44">44</a>
   </span>.
  </p>
 </sec>
 <sec id="Sec6" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Causal network learning algorithms</div>
  <p id="Par17" xmlns="http://www.w3.org/1999/xhtml">For time series that are of a stochastic nature, CCM is less well suited. Multivariate extensions of GC fail if too many variables are considered or dependencies are contemporaneous due to time-sampling
   <span class="sup">
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span> and in other cases (see also the challenges section). Causal network learning algorithms of various types have been developed for the reconstruction of large-scale causal graphical models. They can be classified by their search architecture, that is, whether they start with an empty or fully connected graph, and the statistical criterion for removing or adding an edge. The common feature of these algorithms is that they assume the Markov condition mentioned above together with the Faithfulness assumption, which requires that all observed conditional independencies arise from the causal structure
   <span class="sup">
    <a ref-type="bibr" rid="CR12" href="#CR12">12</a>
   </span>. Taken together, these two conditions allow to infer information about causal interactions from testing which conditional independencies hold true for the observed data. For example, the PC algorithm
   <span class="sup">
    <a ref-type="bibr" rid="CR45" href="#CR45">45</a>
   </span> (named after its inventors Peter and Clark) and related approaches
   <span class="sup">
    <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>,
    <a ref-type="bibr" rid="CR46" href="#CR46">46</a>,
    <a ref-type="bibr" rid="CR47" href="#CR47">47</a>
   </span> start with a fully connected graph and test for the removal of a link between two variables iteratively based on conditioning sets of growing cardinality (Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2c</a>). In this way also causal directions for contemporaneous links can often be assessed. Greedy equivalence search
   <span class="sup">
    <a ref-type="bibr" rid="CR48" href="#CR48">48</a>
   </span>, on the other hand, starts with an empty graph and iteratively adds edges. The statistical criterion for removing or adding an edge can either be a conditional independence test or a properly defined score function that quantifies the likelihood of a particular graph structure given the data. Conditional independencies can flexibly be tested with different types of tests: Linear conditional independence can be assessed with partial correlation, while a wealth of recent machine learning approaches on nonparametric tests addresses a wide range of independence and dependence types
   <span class="sup">
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>,
    <a ref-type="bibr" rid="CR49" href="#CR49">49</a>,
    <a ref-type="bibr" rid="CR50" href="#CR50">50</a>
   </span>. Score functions can be based on Bayesian or information-theoretic approaches. Sun et al.
   <span class="sup">
    <a ref-type="bibr" rid="CR51" href="#CR51">51</a>
   </span>, for example, cast causal network learning as an information-theoretic optimization problem. Causal network learning algorithms can incorporate time-order as a constraint (causes precede effects) and utilize a set of causal orientation rules to identify causal directions. The PC-based method PCMCI
   <span class="sup">
    <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
    <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
   </span> applied in Fig. 
   <a rid="Fig1" ref-type="fig" href="#Fig1">1a</a> addresses the particular challenges of autocorrelated high-dimensional and nonlinear time series data based on a condition-selection step (PC), followed by the momentary conditional independence (MCI) test. As illustrated in Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>, some network learning approaches, e.g., FCI
   <span class="sup">
    <a ref-type="bibr" rid="CR12" href="#CR12">12</a>
   </span>, account for unobserved direct common drivers and can still partially identify which links must be causal. Causal network learning algorithms have started to be applied in Earth system sciences only recently, mainly focusing on climate science
   <span class="sup">
    <a ref-type="bibr" rid="CR23" href="#CR23">23</a>,
    <a ref-type="bibr" rid="CR25" href="#CR25">25</a>,
    <a ref-type="bibr" rid="CR52" href="#CR52">52</a>,
    <a ref-type="bibr" rid="CR53" href="#CR53">53</a>
   </span>.
  </p>
 </sec>
 <sec id="Sec7" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Structural causal model framework</div>
  <p id="Par18" xmlns="http://www.w3.org/1999/xhtml">GC requires a time delay between cause and effect to identify causal directionality. If causation occurs almost instantaneously, or at least faster than the observable sampling interval, then causal directions cannot be identified in general. Many causal network learning algorithms, on the other hand, are also applicable to contemporaneous dependencies, but they can only identify causal graphs up to a Markov-equivalence class. For example, under the Faithfulness assumption, measuring that 
   <span class="italic">X</span> is conditionally independent of 
   <span class="italic">Y</span> given 
   <span class="italic">Z</span>, while all other (conditional) relationships are dependent, gives rise to three different causal graphs that are Markov-equivalent if no additional information about time-order is available: 
   <span class="italic">X</span>
   <div id="IEq100" class="inline-formula">
    <div class="alternatives">
     <span id="M5" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\leftarrow$$\end{document}</span>
     <div id="M6" class="math">
      <span class="mo">←</span>
     </div>
     <span xlink:href="41467_2019_10105_Article_IEq100.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>
   <span class="italic">Z</span>→
   <span class="italic">Y, X</span>→
   <span class="italic">Z</span>→
   <span class="italic">Y</span>, or 
   <span class="italic">X</span>
   <div id="IEq101" class="inline-formula">
    <div class="alternatives">
     <span id="M7" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\leftarrow$$\end{document}</span>
     <div id="M8" class="math">
      <span class="mo">←</span>
     </div>
     <span xlink:href="41467_2019_10105_Article_IEq101.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>
   <span class="italic">Z</span>
   <div id="IEq102" class="inline-formula">
    <div class="alternatives">
     <span id="M9" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\leftarrow$$\end{document}</span>
     <div id="M10" class="math">
      <span class="mo">←</span>
     </div>
     <span xlink:href="41467_2019_10105_Article_IEq102.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    </div>
   </div>
   <span class="italic">Y</span>. As illustrated in Box 
   <a rid="Sec8" ref-type="sec" href="#Sec8">1</a>, the simplest example of Markov equivalence are two contemporaneously dependent variables where the causal direction cannot be inferred with conditional independence-based methods. Structural causal models (SCMs) (Fig. 
   <a rid="Fig2" ref-type="fig" href="#Fig2">2d</a>) can identify causal directions in such cases because they permit assumptions about the functional class of models (e.g., linear or nonlinear, additivity, noise distributions)
   <span class="sup">
    <a ref-type="bibr" rid="CR54" href="#CR54">54</a>–
    <a ref-type="bibr" rid="CR56" href="#CR56">56</a>
   </span>. Other methods exploit heterogeneity in the data by searching for models that are invariant over space or time
   <span class="sup">
    <a ref-type="bibr" rid="CR57" href="#CR57">57</a>–
    <a ref-type="bibr" rid="CR61" href="#CR61">61</a>
   </span>. For an overview see references
   <span class="sup">
    <a ref-type="bibr" rid="CR13" href="#CR13">13</a>,
    <a ref-type="bibr" rid="CR38" href="#CR38">38</a>
   </span>. Most of these principles extend to settings with temporal dependence as further elaborated in the Way forward section. SCMs have not yet been applied in Earth system sciences except for one work in remote sensing
   <span class="sup">
    <a ref-type="bibr" rid="CR62" href="#CR62">62</a>
   </span>.
  </p>
 </sec>
 <sec id="Sec8" class="sec">
  <div class="boxed-text" xmlns="http://www.w3.org/1999/xhtml">
   <span class="label">Box 1 very short introduction to causal inference</span>
   <p id="Par19">
    <span xlink:href="41467_2019_10105_Figa_HTML.gif" id="d29e1525" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>Consider the time-dependent causal relations
    <div id="Equ1" class="disp-formula">
     <span class="label">1</span>
     <div class="alternatives">
      <span id="M11" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$X_t = aY_t + E_t^X\\ Y_t = E_t^Y\\ Z_t = bZ_{t - {\it{1}}} + cY_{t - {\it{1}}} + E_t^Z\\ W_t = dW_{t - {\it{1}}} + eZ_t + E_t^W,$$\end{document}</span>
      <div id="M12" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">X</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">a</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Y</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">E</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <div class="mrow">
         <span class="mi">X</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Y</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">E</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <div class="mrow">
         <span class="mi">Y</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Z</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">b</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Z</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <span class="mi">c</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Y</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">E</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <div class="mrow">
         <span class="mi">Z</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">W</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <span class="mi">d</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">W</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mn">1</span>
        </div>
       </div>
       <span class="mo">+</span>
       <span class="mi">e</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Z</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msubsup">
        <div class="mrow">
         <span class="mi">E</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
        <div class="mrow">
         <span class="mi">W</span>
        </div>
       </div>
       <span class="mo">,</span>
      </div>
      <div xlink:href="41467_2019_10105_Article_Equ1.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
   </p>
   <p id="Par20">with nonzero coefficients and where the noise terms 
    <span class="italic">E</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <span class="sup">
     <span class="italic">Z</span>
    </span>, 
    <span class="italic">E</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <span class="sup">
     <span class="italic">W</span>
    </span> are standard normal and 
    <span class="italic">E</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <span class="sup">
     <span class="italic">X</span>
    </span>, 
    <span class="italic">E</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <span class="sup">
     <span class="italic">Y</span>
    </span> uniformly distributed. The causal relations of this model are visualized in a time series graph (see Figure, panel a) with the repeated grey links indicating stationarity. The model features autocorrelation, lagged, and contemporaneous links that can emerge due to time aggregation (Fig. 
    <a rid="Fig4" ref-type="fig" href="#Fig4">4</a>).
   </p>
   <p id="Par21">Lagged correlation (see Figure, panel b) here yields spurious associations between 
    <span class="italic">X</span> and 
    <span class="italic">Z</span> due to 
    <span class="italic">Y</span> acting as a common driver. Furthermore, 
    <span class="italic">Y</span> and 
    <span class="italic">W</span> are correlated via an indirect path 
    <span class="italic">Y</span>
    <div id="IEq106" class="inline-formula">
     <div class="alternatives">
      <span id="M13" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M14" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq106.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">Z</span>
    <div id="IEq107" class="inline-formula">
     <div class="alternatives">
      <span id="M15" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M16" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq107.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">W</span>, and 
    <span class="italic">X</span> and 
    <span class="italic">W</span> are also spuriously correlated. Multivariate Granger causality is designed to account for common drivers and indirect links and can be implemented as a vector autoregressive model. In the present example (see Figure, panel c), 
    <span class="italic">Y</span> Granger-causing 
    <span class="italic">W</span> is concluded by evaluating the two models
    <div id="Equ2" class="disp-formula">
     <span class="label">2</span>
     <div class="alternatives">
      <span id="M17" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$W_{t} = {\mathop{\sum}\limits_{\tau = 1}^{\tau_{\mathrm{max}}}} {\boldsymbol{\beta}}_{\tau} {{\bf{V}}}_{t - \tau } + \alpha_{\tau} Y_{t - \tau } + {\rm{error}}_{t}$$\end{document}</span>
      <div id="M18" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">W</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div accent="false" accentunder="false" class="munderover">
        <div class="mrow">
         <span class="mo">∑</span>
        </div>
        <div class="mrow">
         <span class="mi">τ</span>
         <span class="mo">=</span>
         <span class="mn">1</span>
        </div>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">τ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">max</span>
          </div>
         </div>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span mathvariant="bold-italic" class="mi">β</span>
        </div>
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span mathvariant="bold" class="mi">V </span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mi">τ</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span class="mi">α</span>
        </div>
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span class="mi">Y</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mi">τ</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span mathvariant="normal" class="mi">error</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
      </div>
      <div xlink:href="41467_2019_10105_Article_Equ2.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <div id="Equ3" class="disp-formula">
     <span class="label">3</span>
     <div class="alternatives">
      <span id="M19" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$W_t = {\mathop{\sum}\limits_{\tau = 1}^{\tau_{\mathrm{max}}}} { \tilde{\boldsymbol{\beta}}}_{\tau} {\bf{V}}_{t - \tau } + {\rm{error}}_{t}$$\end{document}</span>
      <div id="M20" class="math">
       <div class="msub">
        <div class="mrow">
         <span class="mi">W</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
       <span class="mo">=</span>
       <div accent="false" accentunder="false" class="munderover">
        <div class="mrow">
         <span class="mo">∑</span>
        </div>
        <div class="mrow">
         <span class="mi">τ</span>
         <span class="mo">=</span>
         <span class="mn">1</span>
        </div>
        <div class="mrow">
         <div class="msub">
          <div class="mrow">
           <span class="mi">τ</span>
          </div>
          <div class="mrow">
           <span mathvariant="normal" class="mi">max</span>
          </div>
         </div>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <div accent="true" class="mover">
          <div class="mrow">
           <span mathvariant="bold-italic" class="mi">β</span>
          </div>
          <span class="mo">~</span>
         </div>
        </div>
        <div class="mrow">
         <span class="mi">τ</span>
        </div>
       </div>
       <div class="msub">
        <div class="mrow">
         <span mathvariant="bold" class="mi">V </span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
         <span class="mo">-</span>
         <span class="mi">τ</span>
        </div>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <div class="mrow">
         <span mathvariant="normal" class="mi">error</span>
        </div>
        <div class="mrow">
         <span class="mi">t</span>
        </div>
       </div>
      </div>
      <div xlink:href="41467_2019_10105_Article_Equ3.gif" position="anchor" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
   </p>
   <p id="Par22">with 
    <span class="bold">V</span> = 
    <span class="italic">(W</span>, 
    <span class="italic">Z</span>, 
    <span class="italic">X)</span> and establishing that the residual variance of model (
    <a rid="Equ2" ref-type="" href="#Equ2">2</a>) is smaller than that of model (
    <a rid="Equ3" ref-type="" href="#Equ3">3</a>). Put more generally, the information in the past of 
    <span class="italic">Y</span> helps in predicting 
    <span class="italic">W</span> beyond the remaining past (Fig. 
    <a rid="Fig2" ref-type="fig" href="#Fig2">2a</a>). However, the link 
    <span class="italic">Y</span>
    <div id="IEq108" class="inline-formula">
     <div class="alternatives">
      <span id="M21" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M22" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq108.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">W</span> is spurious since 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>−1
    </sub> improves predicting 
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub> only indirectly via the contemporaneous 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> and GC does not account for contemporaneous confounders or mediating variables. Furthermore, GC misses the contemporaneous causal relation 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <div id="IEq109" class="inline-formula">
     <div class="alternatives">
      <span id="M23" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M24" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq109.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">X</span>
    <sub>
     <span class="italic">t</span>
    </sub> because only information from the past is tested.
   </p>
   <p id="Par23">The PC algorithm represents the framework of causal network learning algorithms
    <span class="sup">
     <a ref-type="bibr" rid="CR12" href="#CR12">12</a>
    </span> and overcomes some of these shortcomings. As explained in Fig. 
    <a rid="Fig2" ref-type="fig" href="#Fig2">2c</a> the PC algorithm, adapted to time series, detects common drivers and indirect links also between contemporaneous variables. It unveils all spurious links and identifies the links 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>−1
    </sub>
    <div id="IEq110" class="inline-formula">
     <div class="alternatives">
      <span id="M25" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M26" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq110.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> and 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <div id="IEq111" class="inline-formula">
     <div class="alternatives">
      <span id="M27" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M28" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq111.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub> (see Figure, panel d), while the link between 
    <span class="italic">X</span>
    <sub>
     <span class="italic">t</span>
    </sub> and 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>
    </sub> cannot be oriented since the PC algorithm, and conditional independence-based network learning algorithms in general, can only detect causal graphs up to their Markov equivalence class (marked by circles at the end of links).
   </p>
   <p id="Par24">SCMs allow to identify causal directions also within a Markov equivalence class, if certain assumptions on the structural form of the underlying process are fulfilled. Shown here (see Figure, panel e) is the LiNGAM approach (explained in Fig. 
    <a rid="Fig2" ref-type="fig" href="#Fig2">2d</a>) which can be adapted to time series and assumes that the model is linear and at least one of the noise terms is non-Gaussian. Here, LiNGAM can identify the linear causal influence 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <div id="IEq112" class="inline-formula">
     <div class="alternatives">
      <span id="M29" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M30" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq112.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">X</span>
    <sub>
     <span class="italic">t</span>
    </sub> because 
    <span class="italic">X</span> and 
    <span class="italic">Y</span> are driven by non-Gaussian noise. Note that already the presence of autocorrelation in either 
    <span class="italic">X</span> or 
    <span class="italic">Y</span> would allow the PC algorithm (but not GC) to identify the causal direction between the two. CCM, as a method that does not explicitly condition on other variables, is not well suited for multivariate, purely stochastic processes
    <span class="sup">
     <a ref-type="bibr" rid="CR24" href="#CR24">24</a>
    </span>.
   </p>
   <p id="Par25">The preceding analysis was based on methods whose output can be interpreted in a causal sense only under the assumption of Causal Sufficiency, that is, that no unobserved common drivers exist. The Fast Causal Inference (FCI) algorithm
    <span class="sup">
     <a ref-type="bibr" rid="CR12" href="#CR12">12</a>,
     <a ref-type="bibr" rid="CR47" href="#CR47">47</a>
    </span> belongs to the class of network learning algorithms that do not require Causal Sufficiency. Like the PC algorithm, FCI is based on iterative conditional independence tests followed by (more involved) additional phases. Suppose FCI outputs the causal graph shown in the Figure in panel f. Here, the link between 
    <span class="italic">X</span>
    <sub>
     <span class="italic">t</span>
    </sub> and 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>
    </sub> still cannot be oriented, and also for the link 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t−</span>1
    </sub>
    <div id="IEq113" class="inline-formula">
     <div class="alternatives">
      <span id="M31" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M32" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq113.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> we cannot exclude the possibility that a common driver induced this link (as marked by the circle at the tail of the link which stands for the two possibilities 
    <div id="IEq114" class="inline-formula">
     <div class="alternatives">
      <span id="M33" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M34" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq114.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div> and 
    <div id="IEq115" class="inline-formula">
     <div class="alternatives">
      <span id="M35" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\leftrightarrow$$\end{document}</span>
      <div id="M36" class="math">
       <span class="mo">↔</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq115.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>, the latter denoting a common driver link). However, the FCI output 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub>
    <div id="IEq116" class="inline-formula">
     <div class="alternatives">
      <span id="M37" class="tex-math">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow$$\end{document}</span>
      <div id="M38" class="math">
       <span class="mo">→</span>
      </div>
      <span xlink:href="41467_2019_10105_Article_IEq116.gif" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     </div>
    </div>
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub> (without a circle at the tail) tells us that 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> causes 
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub>, potentially indirectly, but there cannot be a common driver since such a confounder would induce dependencies that are not consistent with the observation that here 
    <span class="italic">Y</span>
    <sub>
     <span class="italic">t</span>−1
    </sub> is conditionally independent of 
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub> given 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> (or also that 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>−1
    </sub> is conditionally independent of 
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>
    </sub> given 
    <span class="italic">Z</span>
    <sub>
     <span class="italic">t</span>
    </sub> and 
    <span class="italic">W</span>
    <sub>
     <span class="italic">t</span>−1
    </sub>).
   </p>
   <p id="Par26">This example demonstrates that even for very general cases, and without assuming away unobserved drivers, causal inference methods can extract causal information from observed conditional independencies and potentially further model assumptions. In practice, however, for short sample sizes some methods may strongly suffer from unreliable graph estimates.</p>
  </div>
 </sec>
</sec>
