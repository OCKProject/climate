<?xml version="1.0" encoding="UTF-8"?>
<sec id="s6" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Step 4: Clustering Cultivars Based on the Agroclimatic PC Scores.</div>
 <p xmlns="http://www.w3.org/1999/xhtml">We clustered the cultivars based on their yield responses to agroclimatic variables (step 2). Clustering was based on the PC scores, calculated as a byproduct of PCA (step 3). The cultivars were clustered with Ward’s (
  <a rid="r33" ref-type="bibr" href="#r33">33</a>) method, which starts with 
  <span class="italic">n</span> clusters of size one and continues until all of the observations are included in one cluster. The squared Euclidean distances between data points were used. The number of clusters (nine) was selected based on the dendrogram, the pseudo 
  <span class="italic">t</span>
  <span class="sup">2</span> criterion,
  <span class="sup">,</span> and the variation in 
  <span class="italic">R</span>
  <span class="sup">2</span> values (
  <a rid="r34" ref-type="bibr" href="#r34">34</a>). PC loadings (obtained in step 3) were used to weight the average yield responses to the agroclimatic variables (
  <a rid="r18" ref-type="bibr" href="#r18">18</a>). The PC loadings were squared and divided by the eigenvalue of each PC. Therefore, 
  <div class="inline-formula">
   <div id="i3" class="math">
    <div class="mrow">
     <div displaystyle="true" class="mstyle">
      <div class="msubsup">
       <span class="mo">∑</span>
       <div class="mrow">
        <span class="mi">i</span>
        <span class="mo">=</span>
        <span class="mn">1</span>
       </div>
       <span class="mi">n</span>
      </div>
      <div class="mrow">
       <div class="msub">
        <span class="mi">w</span>
        <span class="mi">i</span>
       </div>
      </div>
     </div>
     <span class="mo">=</span>
     <span class="mn">1</span>
    </div>
   </div>
  </div>, where 
  <span class="italic">n</span> is the number of agroclimatic variables and component loadings. The weighted means and SEs were calculated according to the following equation:
  <div id="uneq2" class="disp-formula">
   <div id="me2" class="math">
    <div class="mrow">
     <div class="mrow">
      <div accent="true" class="mover">
       <span class="mi">x</span>
       <span class="mo">¯</span>
      </div>
     </div>
     <span class="mo">=</span>
     <div class="mfrac">
      <div class="mrow">
       <div class="msubsup">
        <div displaystyle="true" class="mstyle">
         <span class="mo">∑</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mo">=</span>
         <span class="mn">1</span>
        </div>
        <span class="mi">n</span>
       </div>
       <div class="msub">
        <span class="mi">w</span>
        <span class="mi">i</span>
       </div>
       <div class="msub">
        <span class="mi">x</span>
        <span class="mi">i</span>
       </div>
      </div>
      <div class="mrow">
       <div class="msubsup">
        <div displaystyle="true" class="mstyle">
         <span class="mo">∑</span>
        </div>
        <div class="mrow">
         <span class="mi">i</span>
         <span class="mo">=</span>
         <span class="mn">1</span>
        </div>
        <span class="mi">n</span>
       </div>
       <div class="msub">
        <span class="mi">w</span>
        <span class="mi">i</span>
       </div>
      </div>
     </div>
     <span class="mo">,</span>
     <span class="mo"> </span>
     <span class="mi">S</span>
     <span class="mi">E</span>
     <span class="mo">=</span>
     <div class="msqrt">
      <div class="mrow">
       <div class="mfrac">
        <div class="mrow">
         <div class="msubsup">
          <div displaystyle="true" class="mstyle">
           <span class="mo">∑</span>
          </div>
          <div class="mrow">
           <span class="mi">i</span>
           <span class="mo">=</span>
           <span class="mn">1</span>
          </div>
          <span class="mi">n</span>
         </div>
         <div class="msub">
          <span class="mi">w</span>
          <span class="mi">i</span>
         </div>
         <div class="msup">
          <div class="mrow">
           <span class="mo">(</span>
           <div class="msub">
            <span class="mi">x</span>
            <span class="mi">i</span>
           </div>
           <span class="mo">−</span>
           <div class="mrow">
            <div accent="true" class="mover">
             <span class="mi">x</span>
             <span class="mo">¯</span>
            </div>
           </div>
           <span class="mo">)</span>
          </div>
          <span class="mn">2</span>
         </div>
        </div>
        <span class="mi">n</span>
       </div>
      </div>
     </div>
     <span class="mo">,</span>
    </div>
   </div>
  </div>
 </p>
 <p content-type="flushleft" xmlns="http://www.w3.org/1999/xhtml">where 
  <span class="italic">w</span>
  <sub>
   <span class="italic">i</span>
  </sub> is the weight and 
  <span class="italic">x</span>
  <sub>
   <span class="italic">i</span>
  </sub> is the average yield response to the 
  <span class="italic">i</span>th agroclimatic variable.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">The connection between the interannual stability of the yield and response diversity was investigated by calculating the relationship between the variation in the yield response to each of the nine PCs and the accumulated number of clusters. The pooled SDs, which are weighted averages of the SDs for several clusters, were calculated for the number of accumulated clusters from one to nine based on the dendrogram. For example, when eight clusters were compared with nine, only one of the former clusters was divided, and all others remained unchanged. The pooled SD was calculated as follows:
  <div id="uneq3" class="disp-formula">
   <div id="me3" class="math">
    <div class="mrow">
     <div class="msub">
      <div class="mrow">
       <span class="mtext">SD</span>
      </div>
      <div class="mrow">
       <span class="mi">p</span>
       <span class="mi">o</span>
       <span class="mi">o</span>
       <span class="mi">l</span>
       <span class="mi">e</span>
       <span class="mi">d</span>
      </div>
     </div>
     <span class="mo">=</span>
     <div class="msqrt">
      <div class="mrow">
       <div class="mfrac">
        <div class="mrow">
         <div class="mrow">
          <span class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">n</span>
            <span class="mn">1</span>
           </div>
           <span class="mo">−</span>
           <span class="mn">1</span>
          </div>
          <span class="mo">)</span>
         </div>
         <div class="msubsup">
          <span class="mi">s</span>
          <span class="mn">1</span>
          <span class="mn">2</span>
         </div>
         <span class="mo">+</span>
         <div class="mrow">
          <span class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">n</span>
            <span class="mn">2</span>
           </div>
           <span class="mo">−</span>
           <span class="mn">1</span>
          </div>
          <span class="mo">)</span>
         </div>
         <div class="msubsup">
          <span class="mi">s</span>
          <span class="mn">2</span>
          <span class="mn">2</span>
         </div>
         <span class="mo">+</span>
         <span class="mo">…</span>
         <span class="mo">+</span>
         <div class="mrow">
          <span class="mo">(</span>
          <div class="mrow">
           <div class="msub">
            <span class="mi">n</span>
            <span class="mi">k</span>
           </div>
           <span class="mo">−</span>
           <span class="mn">1</span>
          </div>
          <span class="mo">)</span>
         </div>
         <div class="msubsup">
          <span class="mi">s</span>
          <span class="mi">k</span>
          <span class="mn">2</span>
         </div>
        </div>
        <div class="mrow">
         <div class="msub">
          <span class="mi">n</span>
          <span class="mn">1</span>
         </div>
         <span class="mo">+</span>
         <div class="msub">
          <span class="mi">n</span>
          <span class="mn">2</span>
         </div>
         <span class="mo">+</span>
         <span class="mo">…</span>
         <span class="mo">+</span>
         <div class="msub">
          <span class="mi">n</span>
          <span class="mi">k</span>
         </div>
         <span class="mo">−</span>
         <span class="mi">k</span>
        </div>
       </div>
      </div>
     </div>
     <span class="mo">,</span>
     <span class="mi">k</span>
     <span class="mo">=</span>
     <span class="mn">1</span>
     <span class="mo">,</span>
     <span class="mo">…</span>
     <span class="mo">,</span>
     <span class="mn">9</span>
     <span class="mo">,</span>
    </div>
   </div>
  </div>
 </p>
 <p content-type="flushleft" xmlns="http://www.w3.org/1999/xhtml">where 
  <span class="italic">s</span> is the SD of the 
  <span class="italic">k</span>th cluster and 
  <span class="italic">n</span> is the number of cultivars of the 
  <span class="italic">k</span>th cluster.
 </p>
</sec>
