<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="materials|methods" id="sec011" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <sec id="sec012" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Data</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We studied the top ten global crops from around the world where they are commonly harvested. Not all crops are harvested everywhere and each year.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">To conduct the study we used two datasets 1) climate and weather, and 2) crop yields and harvested areas. Climate and weather variables were all derived from the Climate Research Unit (CRU) TS4.01 [
   <a rid="pone.0217148.ref018" ref-type="bibr" href="#pone.0217148.ref018">18</a>] dataset and its previous data versions have been commonly used in previous studies [
   <a rid="pone.0217148.ref013" ref-type="bibr" href="#pone.0217148.ref013">13</a>, 
   <a rid="pone.0217148.ref016" ref-type="bibr" href="#pone.0217148.ref016">16</a>, 
   <a rid="pone.0217148.ref020" ref-type="bibr" href="#pone.0217148.ref020">20</a>]. The CRU TS4.01 data is a major upgrade and supersedes all previous versions of the CRU data. We mapped the half-degree CRU derived climate and weather information to the crop harvested areas of each political unit (
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a> section 1.1).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">We carried out two major revisions to our crop data that were accessed from public sources [
   <a rid="pone.0217148.ref016" ref-type="bibr" href="#pone.0217148.ref016">16</a>] and links to the sources are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a> section 1. We increased the spatial resolution tracked to ~20,000 political units, and from four major crops being tracked–maize, rice, wheat, and soybean–to tracking the top ten global crops–barley, cassava, maize, oil palm, rapeseed, rice, sorghum, soybean, sugarcane, and wheat. Further details of the crop data and the countries now being tracked at the sub-national levels (one or two levels below the national scale) are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a> section 1. The new political units were mapped using information from the public source GADM (
   <span ext-link-type="uri" xlink:href="https://gadm.org/" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">https://gadm.org/</span>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Inclusion of sub-national information enables capturing geographical differences, which is missed when studies are restricted to country level political units, especially applicable in cases dealing with geographically large countries. We could not entirely remove this challenge i.e. countries such as Kazakhstan were studied as a single political unit, but in 86 large countries (
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a>) we conducted the study at one to two administrative divisions down from the country level.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">To show the effects of studying large countries as a single unit versus sub-national analysis consider the impact of climate change on rice in Cambodia and Malaysia. When analyzed at the country level, rice yield change of -0.03, and +0.15 tons/ha/year was found for Cambodia and Malaysia respectively. Analysis conducted at the subnational scale when summarized to the country level however shows -0.12, and -0.06 tons/ha/year rice yield change for Cambodia and Malaysia respectively. The difference is because when studied at subnational level we are able to isolate the impacts among regions. In the case of Cambodia in the rice bowl central plains region (like Kampong Thom district) and surrounding districts large rice yield losses occur. In the southern districts along the Gulf of Thailand (districts like Koh Kong) climate change benefitted rice yields, but the gains were not enough to overcome the losses elsewhere, leading to overall national level rice yield losses. Similar effect of geography is seen in Malaysia between the eastern (gains in rice yield) and western parts (losses in rice yields) of peninsular Malaysia on the two parts of the natural divide of the Titiwangsa Range; this subnational signal can only be captured through sub-national high-resolution analysis. Thus where possible higher resolution analysis will lead to more precise results.</p>
 </sec>
 <sec id="sec013" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Analysis</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Our statistical model is a 15-parameter equation, relating crop yields to weather variables at each political unit and of the form: 
   <div id="pone.0217148.e001" class="disp-formula">
    <div class="alternatives">
     <div xlink:href="pone.0217148.e001.jpg" id="pone.0217148.e001g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M1" class="math">
      <div class="mrow">
       <span mathvariant="normal" class="mi">c</span>
       <span mathvariant="normal" class="mi">r</span>
       <span mathvariant="normal" class="mi">o</span>
       <span mathvariant="normal" class="mi">p</span>
       <span width="0.25em" class="mspace"/>
       <span mathvariant="normal" class="mi">y</span>
       <span mathvariant="normal" class="mi">i</span>
       <span mathvariant="normal" class="mi">e</span>
       <span mathvariant="normal" class="mi">l</span>
       <span mathvariant="normal" class="mi">d</span>
       <span class="mo">=</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">1</span>
       </div>
       <span mathvariant="normal" class="mi">t</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">2</span>
       </div>
       <div class="msup">
        <span mathvariant="normal" class="mi">t</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">3</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <span mathvariant="normal" class="mi">P</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">4</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <span mathvariant="normal" class="mi">T</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">5</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">P</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">6</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">T</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">7</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <span mathvariant="normal" class="mi">P</span>
       <span mathvariant="normal" class="mi">*</span>
       <span mathvariant="normal" class="mi">s</span>
       <span mathvariant="normal" class="mi">T</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">8</span>
       </div>
       <span mathvariant="normal" class="mi">s</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">P</span>
        <span class="mn">2</span>
       </div>
       <span mathvariant="normal" class="mi">*</span>
       <span mathvariant="normal" class="mi">s</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">T</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <span class="mn">9</span>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <span mathvariant="normal" class="mi">P</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <div class="mrow">
         <span class="mn">10</span>
        </div>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <span mathvariant="normal" class="mi">T</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <div class="mrow">
         <span class="mn">11</span>
        </div>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">P</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <div class="mrow">
         <span class="mn">12</span>
        </div>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">T</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <div class="mrow">
         <span class="mn">13</span>
        </div>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <span mathvariant="normal" class="mi">P</span>
       <span mathvariant="normal" class="mi">*</span>
       <span mathvariant="normal" class="mi">a</span>
       <span mathvariant="normal" class="mi">T</span>
       <span class="mo">+</span>
       <div class="msub">
        <span mathvariant="normal" class="mi">α</span>
        <div class="mrow">
         <span class="mn">14</span>
        </div>
       </div>
       <span mathvariant="normal" class="mi">a</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">P</span>
        <span class="mn">2</span>
       </div>
       <span mathvariant="normal" class="mi">*</span>
       <span mathvariant="normal" class="mi">a</span>
       <div class="msup">
        <span mathvariant="normal" class="mi">T</span>
        <span class="mn">2</span>
       </div>
       <span class="mo">+</span>
       <span mathvariant="normal" class="mi">k</span>
       <span class="mo">+</span>
       <span mathvariant="normal" class="mi">ε</span>
      </div>
     </div>
    </div>
    <span class="label">(1)</span>
   </div> where, t = time (year). The time term is included to account for technological/management changes. We have linear (t) and squared time (t
   <span class="sup">2</span>) terms to account for slow and rapid changes respectively as similarly used in previous studies [
   <a rid="pone.0217148.ref016" ref-type="bibr" href="#pone.0217148.ref016">16</a>, 
   <a rid="pone.0217148.ref019" ref-type="bibr" href="#pone.0217148.ref019">19</a>]. α
   <sub>1</sub> and α
   <sub>2</sub> are the coefficients associated with the linear and squared time terms respectively. Time terms account for omitted variable bias. sP and sT are terms to account for the contribution of gradual/linear fluctuations in the main crop growing season average precipitation (temperature) conditions on crop yield; α
   <sub>3</sub> and α
   <sub>4</sub> are respectively the coefficients associated with the seasonal precipitation and temperature. P and T respectively represent precipitation and temperature. sP
   <span class="sup">2</span> and sT
   <span class="sup">2</span> are terms that account for the contribution of extreme/quadratic seasonal precipitation and temperature conditions respectively to crop yields. α
   <sub>5</sub> and α
   <sub>6</sub> are the coefficients associated with these two terms. The contribution of the interaction between linear and extreme seasonal precipitation and temperature to crop yield at the political unit is from the sP*sT and sP
   <span class="sup">2</span>*sT
   <span class="sup">2</span> terms respectively; α
   <sub>7</sub> and α
   <sub>8</sub> are the coefficients associated with these two terms. aP and aT terms are similar to the seasonal sP and sT terms respectively, but for capturing the contribution of annual (one year prior to harvest) weather conditions to yields; α
   <sub>9</sub> and α
   <sub>10</sub> are the coefficients associated with these two terms. Similarly we have terms aP
   <span class="sup">2</span> and aT
   <span class="sup">2</span> to account for contribution of annual extreme weather to yields, and annual interaction terms aP*aT and aP
   <span class="sup">2</span>*aT
   <span class="sup">2</span>. Coefficients associated with them are α
   <sub>11</sub>, α
   <sub>12</sub>, α
   <sub>13</sub> and α
   <sub>14</sub>. Annual terms account for antecedent weather conditions, secondary, and third season crops, and staggered crop production, and is similar to previous modeling setup [
   <a rid="pone.0217148.ref016" ref-type="bibr" href="#pone.0217148.ref016">16</a>]. The constant of the regression is k and ε is the error term. Each political unit had this form of the model.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Setting up our regression as time series analysis allows us to more accurately capture the effect of precipitation variations. This is because precipitation variations are highly heterogeneous and previous attempts that used panel regressions are less sensitive to precipitation variations [
   <a rid="pone.0217148.ref050" ref-type="bibr" href="#pone.0217148.ref050">50</a>]. The setting up of this form of the model is uniquely to answer only questions on climate trends/mean climate change impact on crop yields for historical and current conditions. To answer other questions such as identifying temperature thresholds beyond which crops have severe yield losses other forms of model specifications are required, such as an eighth-order polynomial function of temperature [
   <a rid="pone.0217148.ref039" ref-type="bibr" href="#pone.0217148.ref039">39</a>].
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">A linear fit using observed weather variables (
   <a ref-type="fig" rid="pone.0217148.g002" href="#pone.0217148.g002">Fig 2</a>) with observed yield (
   <a ref-type="disp-formula" rid="pone.0217148.e001" href="#pone.0217148.e001">Eq 1</a> above) was thus constructed for each crop and political unit (the fitting method is QR decomposition). The model was next tested for significance at the p &lt; 0.05 levels (ANOVA F-statistics; NULL model is the average yield). If the linearly fitted model was significant it was then used to conduct predictions of yield for historical and current climate condition (which are in-sample predictions, as historical and current climate condition are within the range of observed weather–
   <a ref-type="fig" rid="pone.0217148.g002" href="#pone.0217148.g002">Fig 2</a>). The difference in the predicted yield is the likely observed impact on crops yield due to mean climate change/climate trends at the level of the political unit (see more elaboration in 
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a> sections 2). Residuals were found to be normally distributed and not autocorrelated (
   <a ref-type="supplementary-material" rid="pone.0217148.s008" href="#pone.0217148.s008">S7 Fig</a>), with overall R
   <span class="sup">2</span> of the models generally greater than 0.8 (
   <a ref-type="supplementary-material" rid="pone.0217148.s016" href="#pone.0217148.s016">S3 Table</a>, 
   <a ref-type="supplementary-material" rid="pone.0217148.s009" href="#pone.0217148.s009">S8 Fig</a>), indicating that the models could be used to answer questions on climate change. The lowest (minimum) R
   <span class="sup">2</span> value in the linear regressions retained for this analysis from anywhere globally was in wheat (0.42 for the political unit of Ryazan oblast in the Central Federal region of the Russian Federation; the root-mean-squared error here was 0.4 tons/ha whereas the observed average yields are ~2.7 tons/ha/year). In all these cases, the goodness of fit test rejects the hypothesis of a lack of fit to the data (at the p = 0.05 level). Cross validation of model yield predictions against observations (2009 to 2013) showed low prediction errors (
   <a ref-type="supplementary-material" rid="pone.0217148.s015" href="#pone.0217148.s015">S2 Table</a>).
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">We do not report the Akaike or Bayesian Information criteria (AIC/BIC) here since these merely reinforce the goodness-of-fit results. Coefficient confidence intervals may be obtained by routine methods, and are not reported here for brevity, but are available. Low model R
   <span class="sup">2</span> that exists in some regions for some crops such as in Ryazan oblast for wheat should be borne in mind when interpreting results for those areas. Consistent with this approach, we restrict use of our models to climate conditions within the bounds of the observed weather conditions under which the models were constructed i.e. we conducted within-sample predictions and avoided out-of-sample predictions (see 
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a> section 2 and 
   <a ref-type="supplementary-material" rid="pone.0217148.s006" href="#pone.0217148.s006">S5</a> and 
   <a ref-type="supplementary-material" rid="pone.0217148.s007" href="#pone.0217148.s007">S6</a> Figs). Predictions being from statistical analysis, these are not deterministic, and the globally harvested area averaged model Mean Squared Errors (MSE) are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s019" href="#pone.0217148.s019">S6 Table</a> and mapped in 
   <a ref-type="supplementary-material" rid="pone.0217148.s012" href="#pone.0217148.s012">S11 Fig</a> for each crop. Sensitivity to individual model coefficients (sensitivity = coefficient/change in variable) connected to seasonal temperature, squared seasonal temperature, precipitation and squared seasonal precipitation are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s013" href="#pone.0217148.s013">S12 Fig</a> for maize, rice and wheat that shows how differently each term behaves; the temperature only and precipitation only change impact is provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s010" href="#pone.0217148.s010">S9</a> and 
   <a ref-type="supplementary-material" rid="pone.0217148.s011" href="#pone.0217148.s011">S10</a> Figs and the full impact in 
   <a ref-type="fig" rid="pone.0217148.g001" href="#pone.0217148.g001">Fig 1</a>. The model formulation per crop and political unit that we determined are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s020" href="#pone.0217148.s020">S7 Table</a> and the corresponding maize, rice, soybean and wheat yield data for the study period is provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s021" href="#pone.0217148.s021">S8 Table</a>.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">We have used a relatively simple statistical framework to tease out the main effects of changed climatic conditions on crop yields. A potential limitation of the analysis presented is that regression models were separately estimated within each geographical unit, thus we ignore spatial auto-correlations. Given our spatial scales–even though finer scaled compared to the country scale–each political unit nevertheless are hundreds to thousands of squared kilometers spatially–diffusion of agronomic knowledge and other socio-economic variables i.e. spatial autocorrelation effects would be relatively limited compared to analyses at much more finer spatial scales such as at village levels. Future studies should explore spatial and temporal multi-scale effects [
   <a rid="pone.0217148.ref050" ref-type="bibr" href="#pone.0217148.ref050">50</a>]; we do not consider potential physical interaction between the explanatory variables at different scales in different geographical units. We would also like to caveat against interpreting our regression-based analysis as causality. Needless to say, detailed studies using technically more complex statistical models, including causal models, and more extensive model diagnostics, is needed. Ignoring spatial autocorrelation does not necessarily bias the final results, however inclusion of such effects may improve the precision of the estimates. On the other hand, spatio-temporal statistical models can be computationally and mathematically very challenging. Future publications should try to address spatio-temporal dependency, diagnostics associated with statistical modeling and other issues mentioned above in global-scale studies.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">For computing production change we multiplied the climate change driven yield change with the 5-year average harvested areas (2004–2008); for computing percentage yield change with respect to recent yields we similarly computed a 5-year average yield (2004–2008) at each political unit. Country- and global-scale numbers are similarly all harvested area weighted. Finally we determined the change in food calories in a country as the sum of all of individual crop impacts out of the maximum of ten crops studied; most countries did not harvest all ten crops. Details are provided in 
   <a ref-type="supplementary-material" rid="pone.0217148.s001" href="#pone.0217148.s001">S1 Text</a>.
  </p>
 </sec>
 <sec id="sec014" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Mapping</div>
  <p xmlns="http://www.w3.org/1999/xhtml">After determining the yield change at the political unit due to climate change we mapped the result back at the political unit level. Each political unit contains grid cells that harvested a crop and we assign all these grid cells the same yield change impact. The results are thus valid only at the scale of the political unit for which data were available. In cases where sub-national data were not available there is a marked difference at the state or country borders. For example, Kazakhstan was studied at the country level only and therefore results are valid only at that scale and the contrast with for example the Russian Federation boundary are from mapping. In regions of the world where higher resolution information was available boundary effects are not present e.g. US-Mexico boundary for maize, India-Nepal-Bangladesh boundary for wheat or rice.</p>
 </sec>
</sec>
