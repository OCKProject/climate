<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="materials|methods" id="sec002" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <sec id="sec003" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Early warning signals</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Many systems have a so-called attractive stable state, i.e. a state that the system does not leave, even under small perturbations [
   <a rid="pone.0211072.ref017" ref-type="bibr" href="#pone.0211072.ref017">17</a>]. Most complex systems have several such states and due to internal or external dynamics, the system can change from one stable state to a different stable state. When this change is sudden, the transition is called a critical transition [
   <a rid="pone.0211072.ref018" ref-type="bibr" href="#pone.0211072.ref018">18</a>]. The most interesting point during such a transition is the tipping point, where the system is influenced by the attraction of two ore more stable states and could evolve into either one. Even though the proximity to a tipping point is not sufficient for a critical transition to occur (the system could as well bounce back to its original state) it is a necessary requirement for a critical transition. In order to identify if a system is close to such a tipping point, EWS analysis can be used.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Systems close to a tipping point show slightly different behavior than systems far away from it. When perturbed their recovery time increases: They need longer to evolve back to their original state. This effect is called critical slowing down (CSD) [
   <a rid="pone.0211072.ref019" ref-type="bibr" href="#pone.0211072.ref019">19</a>]. CSD leaves different statistical markers that can be detected by EWS analysis. On the one hand, the variance of the data increases, which is a direct effect of the increased recovery time: If the system needs more time to return to its stable state, it will spend more time away from this state, increasing the variance when compared to a system that instantly returns to its stable state. Furthermore, the slow recovery also leads to a higher autocorrelation. Systems close to a tipping point can also become less symmetric, which shows in the skewness of a time series. Skewness can be seen as a measure of the degree of asymmetry of a given distribution. In the context of EWS, the analyzed data points do not originate from a distribution, but are small sections of a given time series [
   <a rid="pone.0211072.ref020" ref-type="bibr" href="#pone.0211072.ref020">20</a>]. Nevertheless, calculating skewness is done in the usual way, see 
   <a ref-type="disp-formula" rid="pone.0211072.e003" href="#pone.0211072.e003">Eq (3)</a>. Also single values that are further away from the mean become more frequent near a tipping point. This phenomenon is called flickering [
   <a rid="pone.0211072.ref021" ref-type="bibr" href="#pone.0211072.ref021">21</a>] and can be detected in the kurtosis [
   <a rid="pone.0211072.ref022" ref-type="bibr" href="#pone.0211072.ref022">22</a>] of a time series.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">In order to perform an EWS analysis we will look at the following four properties of a time series:</p>
  <div list-type="bullet" class="list" xmlns="http://www.w3.org/1999/xhtml">
   <div class="list-item">
    <p>Standard deviation 
     <span class="italic">SD</span>
    </p>
   </div>
   <div class="list-item">
    <p>Autocorrelation at lag 1 
     <span class="italic">AC</span>
     <span class="sup">(1)</span>
    </p>
   </div>
   <div class="list-item">
    <p>Skewness 
     <span class="italic">S</span>
    </p>
   </div>
   <div class="list-item">
    <p>Kurtosis 
     <span class="italic">K</span>
    </p>
   </div>
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">For the time series 
   <span class="italic">X</span> containing 
   <span class="italic">N</span> elements labeled 
   <span class="italic">x</span>
   <sub>
    <span class="italic">i</span>
   </sub>, these properties are calculated using the following equations: 
   <div id="pone.0211072.e001" class="disp-formula">
    <div class="alternatives">
     <div xlink:href="pone.0211072.e001.jpg" id="pone.0211072.e001g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M1" class="math">
      <div displaystyle="true" class="mtable">
       <div class="mtr">
        <div columnalign="right" class="mtd">
         <div class="mrow">
          <span class="mi">σ</span>
          <span class="mo">(</span>
          <span class="mi">X</span>
          <span class="mo">)</span>
         </div>
         <div class="mrow">
          <span class="mo">=</span>
          <div class="msqrt">
           <div class="mfrac">
            <div class="mrow">
             <div class="msubsup">
              <span class="mo">∑</span>
              <div class="mrow">
               <span class="mi">i</span>
               <span class="mo">=</span>
               <span class="mn">1</span>
              </div>
              <span class="mi">N</span>
             </div>
             <div class="msup">
              <div class="mrow">
               <span class="mo">(</span>
               <div class="msub">
                <span class="mi">x</span>
                <span class="mi">i</span>
               </div>
               <span class="mo">-</span>
               <div class="mover">
                <span class="mi">x</span>
                <span class="mo">¯</span>
               </div>
               <span class="mo">)</span>
              </div>
              <span class="mn">2</span>
             </div>
            </div>
            <div class="mrow">
             <span class="mi">N</span>
             <span class="mo">-</span>
             <span class="mn">1</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(1)</span>
   </div>
   <div id="pone.0211072.e002" class="disp-formula">
    <div class="alternatives">
     <div xlink:href="pone.0211072.e002.jpg" id="pone.0211072.e002g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M2" class="math">
      <div displaystyle="true" class="mtable">
       <div class="mtr">
        <div columnalign="right" class="mtd">
         <div class="mrow">
          <span class="mi">A</span>
          <div class="msup">
           <span class="mi">C</span>
           <div class="mrow">
            <span class="mo">(</span>
            <span class="mn">1</span>
            <span class="mo">)</span>
           </div>
          </div>
          <div class="mrow">
           <span class="mo">(</span>
           <span class="mi">X</span>
           <span class="mo">)</span>
          </div>
         </div>
         <div class="mrow">
          <span class="mo">=</span>
          <div class="mfrac">
           <span class="mn">1</span>
           <div class="mrow">
            <span class="mi">N</span>
            <span class="mo">-</span>
            <span class="mn">1</span>
           </div>
          </div>
          <div class="munderover">
           <span class="mo">∑</span>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mo">=</span>
            <span class="mn">1</span>
           </div>
           <span class="mi">N</span>
          </div>
          <span class="mo">(</span>
          <div class="mfrac">
           <div class="mrow">
            <div class="msub">
             <span class="mi">x</span>
             <span class="mi">i</span>
            </div>
            <span class="mo">-</span>
            <div accent="true" class="mover">
             <span class="mi">x</span>
             <span class="mo">¯</span>
            </div>
           </div>
           <div class="msub">
            <span class="mi">σ</span>
            <span class="mi">x</span>
           </div>
          </div>
          <span class="mo">)</span>
          <span class="mo">(</span>
          <div class="mfrac">
           <div class="mrow">
            <div class="msub">
             <span class="mi">y</span>
             <span class="mi">i</span>
            </div>
            <span class="mo">-</span>
            <div accent="true" class="mover">
             <span class="mi">y</span>
             <span class="mo">¯</span>
            </div>
           </div>
           <div class="msub">
            <span class="mi">σ</span>
            <span class="mi">y</span>
           </div>
          </div>
          <span class="mo">)</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(2)</span>
   </div>
   <div id="pone.0211072.e003" class="disp-formula">
    <div class="alternatives">
     <div xlink:href="pone.0211072.e003.jpg" id="pone.0211072.e003g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M3" class="math">
      <div displaystyle="true" class="mtable">
       <div class="mtr">
        <div columnalign="right" class="mtd">
         <div class="mrow">
          <span class="mi">S</span>
          <span class="mo">(</span>
          <span class="mi">X</span>
          <span class="mo">)</span>
         </div>
         <div class="mrow">
          <span class="mo">=</span>
          <div class="mfrac">
           <div class="mrow">
            <div displaystyle="false" scriptlevel="0" class="mstyle">
             <div class="mfrac">
              <span class="mn">1</span>
              <span class="mi">N</span>
             </div>
            </div>
            <div class="msubsup">
             <span class="mo">∑</span>
             <div class="mrow">
              <span class="mi">i</span>
              <span class="mo">=</span>
              <span class="mn">1</span>
             </div>
             <span class="mi">N</span>
            </div>
            <div class="msup">
             <div class="mrow">
              <span class="mo">(</span>
              <div class="msub">
               <span class="mi">x</span>
               <span class="mi">i</span>
              </div>
              <span class="mo">-</span>
              <div class="mover">
               <span class="mi">x</span>
               <span class="mo">¯</span>
              </div>
              <span class="mo">)</span>
             </div>
             <span class="mn">3</span>
            </div>
           </div>
           <div class="msup">
            <div class="msqrt">
             <div class="mrow">
              <div displaystyle="false" scriptlevel="0" class="mstyle">
               <div class="mfrac">
                <span class="mn">1</span>
                <div class="mrow">
                 <span class="mi">N</span>
                 <span class="mo">-</span>
                 <span class="mn">1</span>
                </div>
               </div>
              </div>
              <div class="msubsup">
               <span class="mo">∑</span>
               <div class="mrow">
                <span class="mi">i</span>
                <span class="mo">=</span>
                <span class="mn">1</span>
               </div>
               <span class="mi">N</span>
              </div>
              <div class="msup">
               <div class="mrow">
                <span class="mo">(</span>
                <div class="msub">
                 <span class="mi">x</span>
                 <span class="mi">i</span>
                </div>
                <span class="mo">-</span>
                <div class="mover">
                 <span class="mi">x</span>
                 <span class="mo">¯</span>
                </div>
                <span class="mo">)</span>
               </div>
               <span class="mn">2</span>
              </div>
             </div>
            </div>
            <div class="mrow">
             <span width="0.166667em" class="mspace"/>
             <span class="mn">3</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(3)</span>
   </div>
   <div id="pone.0211072.e004" class="disp-formula">
    <div class="alternatives">
     <div xlink:href="pone.0211072.e004.jpg" id="pone.0211072.e004g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M4" class="math">
      <div displaystyle="true" class="mtable">
       <div class="mtr">
        <div columnalign="right" class="mtd">
         <div class="mrow">
          <span class="mi">K</span>
          <span class="mo">(</span>
          <span class="mi">X</span>
          <span class="mo">)</span>
         </div>
         <div class="mrow">
          <span class="mo">=</span>
          <div class="mfrac">
           <div class="mrow">
            <div displaystyle="false" scriptlevel="0" class="mstyle">
             <div class="mfrac">
              <span class="mn">1</span>
              <span class="mi">N</span>
             </div>
            </div>
            <div class="msubsup">
             <span class="mo">∑</span>
             <div class="mrow">
              <span class="mi">i</span>
              <span class="mo">=</span>
              <span class="mn">1</span>
             </div>
             <span class="mi">N</span>
            </div>
            <div class="msup">
             <div class="mrow">
              <span class="mo">(</span>
              <div class="msub">
               <span class="mi">x</span>
               <span class="mi">i</span>
              </div>
              <span class="mo">-</span>
              <div class="mover">
               <span class="mi">x</span>
               <span class="mo">¯</span>
              </div>
              <span class="mo">)</span>
             </div>
             <span class="mn">4</span>
            </div>
           </div>
           <div class="msup">
            <div class="mrow">
             <span class="mo">(</span>
             <div displaystyle="false" scriptlevel="0" class="mstyle">
              <div class="mfrac">
               <span class="mn">1</span>
               <span class="mi">N</span>
              </div>
             </div>
             <div class="msubsup">
              <span class="mo">∑</span>
              <div class="mrow">
               <span class="mi">i</span>
               <span class="mo">=</span>
               <span class="mn">1</span>
              </div>
              <span class="mi">N</span>
             </div>
             <div class="msup">
              <div class="mrow">
               <span class="mo">(</span>
               <div class="msub">
                <span class="mi">x</span>
                <span class="mi">i</span>
               </div>
               <span class="mo">-</span>
               <div class="mover">
                <span class="mi">x</span>
                <span class="mo">¯</span>
               </div>
               <span class="mo">)</span>
              </div>
              <span class="mn">2</span>
             </div>
             <span class="mo">)</span>
            </div>
            <span class="mn">2</span>
           </div>
          </div>
          <span class="mo">-</span>
          <span class="mn">3</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <span class="label">(4)</span>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Here 
   <div id="pone.0211072.e005" class="inline-formula">
    <div class="alternatives">
     <div xlink:href="pone.0211072.e005.jpg" id="pone.0211072.e005g" mimetype="image" position="anchor" orientation="portrait" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
     <div id="M5" class="math">
      <div class="mover">
       <span class="mi">x</span>
       <span accent="true" class="mo">¯</span>
      </div>
     </div>
    </div>
   </div> denotes the mean of 
   <span class="italic">x</span> and 
   <span class="italic">y</span>
   <sub>
    <span class="italic">i</span>
   </sub> are the elements of a time series that is generated by shifting X by 1, so to that 
   <span class="italic">y</span>
   <sub>
    <span class="italic">i</span>
   </sub> = 
   <span class="italic">x</span>
   <sub>
    <span class="italic">i</span>−1
   </sub>.
  </p>
 </sec>
 <sec id="sec004" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Investigated systems</div>
  <p xmlns="http://www.w3.org/1999/xhtml">In order to generate results that are not specific to individual systems, but rather universal properties of EWS analysis, we focus our investigation on generic systems. To cover a broad range of possible applications we simulate the most common forms of growth and decay. An overview of the investigated systems is given in in 
   <a rid="pone.0211072.t001" ref-type="table" href="#pone.0211072.t001">Table 1</a>. Numerical details on how the time series were produced can be found in Appendix A. By this choice of example functions, many common systems can be described. Linear systems are, for example, often encountered in ecology and economics [
   <a rid="pone.0211072.ref023" ref-type="bibr" href="#pone.0211072.ref023">23</a>, 
   <a rid="pone.0211072.ref024" ref-type="bibr" href="#pone.0211072.ref024">24</a>]. Economic growth and population growth can be described as an exponential growth, as long as we are far away from the maximal capacity [
   <a rid="pone.0211072.ref025" ref-type="bibr" href="#pone.0211072.ref025">25</a>, 
   <a rid="pone.0211072.ref026" ref-type="bibr" href="#pone.0211072.ref026">26</a>] or with a logistic function when the effect of the maximal capacity becomes relevant [
   <a rid="pone.0211072.ref027" ref-type="bibr" href="#pone.0211072.ref027">27</a>]. Also the more exotic investigated functions, like the trigonometric ones, have scientific applications. The solar cycle [
   <a rid="pone.0211072.ref028" ref-type="bibr" href="#pone.0211072.ref028">28</a>] as well as many climate oscillations [
   <a rid="pone.0211072.ref029" ref-type="bibr" href="#pone.0211072.ref029">29</a>, 
   <a rid="pone.0211072.ref030" ref-type="bibr" href="#pone.0211072.ref030">30</a>] are sine-like. Although not all systems of interest to EWS analysis can be described or approximated by the chosen systems or linear combinations thereof, we hope that essential features identified for these generic systems can also be translated to specific ones.
  </p>
  <div id="pone.0211072.t001" orientation="portrait" position="float" class="table-wrap" xmlns="http://www.w3.org/1999/xhtml">
   <span pub-id-type="doi" class="object-id">10.1371/journal.pone.0211072.t001</span>
   <span class="label">Table 1</span>
   <div class="caption">
    <div class="title">Investigated systems and their abbreviations.</div>
   </div>
   <div class="alternatives">
    <div id="pone.0211072.t001g" xlink:href="pone.0211072.t001" class="graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    <table frame="box" rules="all" border="0">
     <colgroup span="1">
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
      <col align="left" valign="middle" span="1"/>
     </colgroup>
     <thead>
      <tr>
       <th align="center" rowspan="1" colspan="1"/>
       <th align="center" rowspan="1" colspan="1">linear</th>
       <th align="center" rowspan="1" colspan="1">quadratic</th>
       <th align="center" rowspan="1" colspan="1">exponential</th>
       <th align="center" rowspan="1" colspan="1">logarithmic</th>
       <th align="center" rowspan="1" colspan="1">trigonometric</th>
       <th align="center" rowspan="1" colspan="1">logistic</th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center" rowspan="1" colspan="1">growth</td>
       <td align="center" rowspan="1" colspan="1">LG</td>
       <td align="center" rowspan="1" colspan="1">QG</td>
       <td align="center" rowspan="1" colspan="1">EG</td>
       <td align="center" rowspan="1" colspan="1">LNG</td>
       <td align="center" rowspan="1" colspan="1">TG</td>
       <td align="center" rowspan="1" colspan="1">LOG</td>
      </tr>
      <tr>
       <td align="center" rowspan="1" colspan="1">decay</td>
       <td align="center" rowspan="1" colspan="1">LD</td>
       <td align="center" rowspan="1" colspan="1">QD</td>
       <td align="center" rowspan="1" colspan="1">ED</td>
       <td align="center" rowspan="1" colspan="1">LND</td>
       <td align="center" rowspan="1" colspan="1">TD</td>
       <td align="center" rowspan="1" colspan="1">LOD</td>
      </tr>
     </tbody>
    </table>
   </div>
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">Note, that by design none of the investigated systems are capable of having critical transitions. That way the distinction between false positives and correct positives becomes trivial, since all detected EWS must be false positives. This property makes the systems ideal for identifying systematically false positives.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">All systems are simulated with statistical noise, so that they resemble real measurements or simulations more closely. This noise can be absolute (i.e. independent of the value 
   <span class="italic">x</span>
   <sub>
    <span class="italic">i</span>
   </sub>) or relative to 
   <span class="italic">x</span>
   <sub>
    <span class="italic">i</span>
   </sub>. We produce time series of 10000 time steps and calculate the previously defined properties relevant for EWS analysis in rolling windows of size 500. Then we search for significant EWSs: an increase in both 
   <span class="italic">σ</span> and 
   <span class="italic">AC</span>
   <span class="sup">(1)</span>, a change in 
   <span class="italic">S</span> or an increase in 
   <span class="italic">K</span>. The simulations were performed using Python. After initialization of each system their time development is calculated from the equations given in Appendix A. As a next step artificial noise is added. For absolute noise a Gaussian-distributed random number is added, while for relative noise each data point is multiplied by a Gaussian-distributed random number. Details on the random numbers are also given in Appendix A. The generated time series can be downloaded from 
   <span ext-link-type="uri" xlink:href="https://figshare.com/articles/falseEWS_rar/7472099" class="ext-link" xmlns:xlink="http://www.w3.org/1999/xlink">https://figshare.com/articles/falseEWS_rar/7472099</span>.
  </p>
 </sec>
 <sec id="sec005" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Scaling and detrending</div>
  <p xmlns="http://www.w3.org/1999/xhtml">In systems that show systematic false positives we look at strategies for removing those signals. Different approaches are thinkable and it is not a priori clear which are suitable and which are not. We use methods related to scaling and detrending, commonly used in data preparation [
   <a rid="pone.0211072.ref031" ref-type="bibr" href="#pone.0211072.ref031">31</a>–
   <a rid="pone.0211072.ref034" ref-type="bibr" href="#pone.0211072.ref034">34</a>]. The effect of five distinct methods is investigated:
  </p>
  <div list-type="bullet" class="list" xmlns="http://www.w3.org/1999/xhtml">
   <div class="list-item">
    <p>Local scaling</p>
   </div>
   <div class="list-item">
    <p>Global scaling</p>
   </div>
   <div class="list-item">
    <p>Detrending by local first-order polynomial fits</p>
   </div>
   <div class="list-item">
    <p>Detrending by global higher-order polynomial fits</p>
   </div>
   <div class="list-item">
    <p>Detrending by moving averages</p>
   </div>
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">For local scaling, we calculate the mean of every rolling window and subtract it from every data point. That way, the average value of each rolling window is zero, thus the absolute value of the original data point has no influence on the EWS analysis, possibly reducing the chance for false positives.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">Global scaling is not done for each rolling window individually, but for the investigated time series as a whole. In addition to subtracting the global average, we also use a multiplicative factor on the whole time series to fix the standard deviation to 1. This can only be done on a global scale, since scaling the data for each rolling window individually would eliminate any EWS originating from standard deviation.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">One possible way for detrending is to calculate a linear fit for the data of each rolling window using linear regression [
   <a rid="pone.0211072.ref035" ref-type="bibr" href="#pone.0211072.ref035">35</a>, 
   <a rid="pone.0211072.ref036" ref-type="bibr" href="#pone.0211072.ref036">36</a>]. We then subtract this fit from the data to find the residuals. These residuals are then the input signals for the EWS analysis. In addition to setting the mean of each rolling window to 0, this process also filters out macroscopic linear trends, so that the investigated data is more directly related to the micro-scale. Note, that this process only filters out the linear trend. This means that higher order trends remain in the detrended data and can be analyzed. In this sense, linear regression is not performed for the usual reason: Traditionally, linear regression is used to approximate a time series by a linear function as best as possible. Here on the other hand, the regression line is subtracted from the data. Thus the goal is not to approximate the data, but to remove the linear part to focus on the nonlinear effects.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">A different approach to detrending works on a global scale, i.e. the whole time series, not just the investigated window. We calculate a fit using a 5th order polynomial. This order is high enough to satisfyingly describe the investigated systems. Subtracting this global fit should completely filter out macroscopic changes of the system and thus reduce false positives in EWS analysis.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">The computationally inexpensive, and therefore most prominent way, of detrending data is using moving averages. For this technique the average value of the previous 
   <span class="italic">x</span> time steps is subtracted from each data point. It is also possible to define an exponential weight factor, to increase the weight of closer data points. In any case, subtracting the moving average removes the macroscopic trend of a time series and we can investigate microscopic fluctuations in the form of residuals. For this study, we used 
   <span class="italic">x</span> = 50, but the actual value of 
   <span class="italic">x</span> does not change whether an EWS can be detected or not, but only influences the smoothness of the data and resulting signals.
  </p>
 </sec>
</sec>
