<?xml version="1.0" encoding="UTF-8"?>
<sec id="sec005" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Scaling and detrending</div>
 <p xmlns="http://www.w3.org/1999/xhtml">In systems that show systematic false positives we look at strategies for removing those signals. Different approaches are thinkable and it is not a priori clear which are suitable and which are not. We use methods related to scaling and detrending, commonly used in data preparation [
  <a rid="pone.0211072.ref031" ref-type="bibr" href="#pone.0211072.ref031">31</a>â€“
  <a rid="pone.0211072.ref034" ref-type="bibr" href="#pone.0211072.ref034">34</a>]. The effect of five distinct methods is investigated:
 </p>
 <div list-type="bullet" class="list" xmlns="http://www.w3.org/1999/xhtml">
  <div class="list-item">
   <p>Local scaling</p>
  </div>
  <div class="list-item">
   <p>Global scaling</p>
  </div>
  <div class="list-item">
   <p>Detrending by local first-order polynomial fits</p>
  </div>
  <div class="list-item">
   <p>Detrending by global higher-order polynomial fits</p>
  </div>
  <div class="list-item">
   <p>Detrending by moving averages</p>
  </div>
 </div>
 <p xmlns="http://www.w3.org/1999/xhtml">For local scaling, we calculate the mean of every rolling window and subtract it from every data point. That way, the average value of each rolling window is zero, thus the absolute value of the original data point has no influence on the EWS analysis, possibly reducing the chance for false positives.</p>
 <p xmlns="http://www.w3.org/1999/xhtml">Global scaling is not done for each rolling window individually, but for the investigated time series as a whole. In addition to subtracting the global average, we also use a multiplicative factor on the whole time series to fix the standard deviation to 1. This can only be done on a global scale, since scaling the data for each rolling window individually would eliminate any EWS originating from standard deviation.</p>
 <p xmlns="http://www.w3.org/1999/xhtml">One possible way for detrending is to calculate a linear fit for the data of each rolling window using linear regression [
  <a rid="pone.0211072.ref035" ref-type="bibr" href="#pone.0211072.ref035">35</a>, 
  <a rid="pone.0211072.ref036" ref-type="bibr" href="#pone.0211072.ref036">36</a>]. We then subtract this fit from the data to find the residuals. These residuals are then the input signals for the EWS analysis. In addition to setting the mean of each rolling window to 0, this process also filters out macroscopic linear trends, so that the investigated data is more directly related to the micro-scale. Note, that this process only filters out the linear trend. This means that higher order trends remain in the detrended data and can be analyzed. In this sense, linear regression is not performed for the usual reason: Traditionally, linear regression is used to approximate a time series by a linear function as best as possible. Here on the other hand, the regression line is subtracted from the data. Thus the goal is not to approximate the data, but to remove the linear part to focus on the nonlinear effects.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">A different approach to detrending works on a global scale, i.e. the whole time series, not just the investigated window. We calculate a fit using a 5th order polynomial. This order is high enough to satisfyingly describe the investigated systems. Subtracting this global fit should completely filter out macroscopic changes of the system and thus reduce false positives in EWS analysis.</p>
 <p xmlns="http://www.w3.org/1999/xhtml">The computationally inexpensive, and therefore most prominent way, of detrending data is using moving averages. For this technique the average value of the previous 
  <span class="italic">x</span> time steps is subtracted from each data point. It is also possible to define an exponential weight factor, to increase the weight of closer data points. In any case, subtracting the moving average removes the macroscopic trend of a time series and we can investigate microscopic fluctuations in the form of residuals. For this study, we used 
  <span class="italic">x</span> = 50, but the actual value of 
  <span class="italic">x</span> does not change whether an EWS can be detected or not, but only influences the smoothness of the data and resulting signals.
 </p>
</sec>
